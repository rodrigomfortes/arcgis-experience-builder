"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-b08223"],{1925:(e,t,r)=>{r.d(t,{a:()=>o,g:()=>n,s:()=>s});var i=r(4280),a=r(983);function o(e,t){try{return null!=e&&e.length>0?null!=t&&t.length>0?(i.T.setToken(e,t),a.B.i18n("ok")):a.B.i18n("invalid-token"):a.B.i18n("invalid-username")}catch(e){return e}}function s(e){try{return null!=e&&e.length>0?(i.S.setEnvironment(e),a.B.i18n("ok")):a.B.i18n("invalid-environment")}catch(e){return e}}async function n(e,t=!1,r,a){return await i.G.getInfographicTemplatesList(e,t,r,a)}},7224:(e,t,r)=>{r.r(t),r.d(t,{arcgis_infographic:()=>p});var i=r(8796),a=r(983),o=r(1925),s=r(4280);class n{fixForLint;constructor(){this.fixForLint=""}static showDebugConsoleLogs=!1;static log(e,...t){if(n.showDebugConsoleLogs&&(console.log("=======>"+e+": "),t&&t.length))for(let e=0;e<t.length;e++)console.log("...",t[e])}}class h{constructor(){}static _infographicsPlayerPageUrl;static openInfographics(e,t,r,i){try{h._getInfographicsPlayerUrl().then((a=>{h._openInfographicsTab(a,h._getInfographicsParams(e,t,r,i))}))}catch(e){console.log("InfographicHelper Error while getting player URL: ",e)}}static _getInfographicsPlayerUrl(){return new Promise((async(e,t)=>{if(!h._infographicsPlayerPageUrl){var r=s.E.getUrl("infographics");fetch(r,{method:"HEAD"}).then((i=>{i.ok?e(r):t()})).catch((e=>{t(e)}))}}))}static _openInfographicsTab(e,t){var r,i,a=window.open(e,"_blank");window.addEventListener("message",(r=a,i=function(a){var o=a.data&&a.data.href,s=a.data&&a.data.status;o===e&&"waiting_for_infographic_parameters"===s&&r.postMessage({type:"infographic_parameters",infographicParameters:t},o),window.removeEventListener("message",i)}))}static _getInfographicsParams(e,t,r,i){var a=s.T.token.access_token,o=s.T.token.username;let n=Date.now()+6e5;var h=Math.floor(n/6e4+.5),l={server:s.S.getPortalBaseUrl(),userId:o,token:a,expires:h,reportID:e,countryID:i,hierarchy:t,analysisAreas:[{feature:{geometry:r}}]};return JSON.stringify(l)}}class l{fixForLint;constructor(){this.fixForLint=""}static setToken(e,t){s.T.setToken(e,t)}static async getBuffers(e,t,r,i,o,n,h){if(a.a.Log("TransportUtil GET BUFFERS"),"drivetime"!==e&&"walktime"!==e)throw new Error("TransportUtil - invalid args");if(l.hasText(t)&&l.hasText(r)&&i&&void 0!==o&&void 0!==n){let a=await l.getParams(e,t,r,i,"drivetime"===e?h:void 0,o,n),d=await s.G.enrich(a),c=d.results[0].value.FeatureSet[0].spatialReference,p=l.parseRings(d);if(Array.isArray(p)&&p.length>0)for(let t=0;t<p.length;t++)if(p[t]){let r=p[t];r.transport="drivetime"===e?"drive":"walk",r.latitude=n,r.longitude=o,r.spatial=c,r.location={geometry:{x:o,y:n,spatialReference:{wkid:4326}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}}}return p}return null}static parseRings(e){var t=[],r={};try{if(e&&e.results&&e.results.length>0){let i=e.results[0].value.FeatureSet[0];if(i.features&&i.features.length>0){for(let e=0;e<i.features.length;e++){let a=i.features[e],o=a.attributes.bufferRadii;if(!r[o]){r[o]=!0;let e=a.attributes.bufferUnits,i=a.geometry.rings;t.push({value:o,units:e,rings:i})}}return t}}}catch(e){console.log("TransportUtil parse GE result is invalid")}}static hasText(e){return void 0!==e&&e.trim().length>0}static calculateSimplification(e,t,r){let i=10,a=1;for(let e=0;e<r.length;e++)a=r[e]>a?r[e]:a;if("drivetime"===e)switch(t){case"minutes":i=Math.max(10,.00614*a*a+3.5*a-40);break;case"miles":i=Math.max(10,8.5*a-100);break;case"kilometers":i=Math.max(10,5.3233*a-60)}else if("walktime"===e)switch(t){case"minutes":i=Math.max(2,.1437*a-8.7);break;case"miles":i=Math.max(2,4.7*a-26.8);break;case"kilometers":i=Math.max(2,3.11*a-32.7)}return i}static async getParams(e,t,r,i,a,o,s){let n="minutes"==r.toLowerCase(),h="drivetime"==e;const l=this.calculateSimplification(e,r,i);let d;if(h){let e={attributeParameterValues:[{attributeName:"TravelTime",parameterName:"Vehicle Maximum Speed (km/h)",value:0},{attributeName:"Avoid Carpool Roads",parameterName:"Restriction Usage",value:"PROHIBITED"},{attributeName:"Avoid Express Lanes",parameterName:"Restriction Usage",value:"PROHIBITED"},{attributeName:"Avoid Gates",parameterName:"Restriction Usage",value:"AVOID_MEDIUM"},{attributeName:"Avoid Private Roads",parameterName:"Restriction Usage",value:"AVOID_MEDIUM"},{attributeName:"Avoid Unpaved Roads",parameterName:"Restriction Usage",value:"AVOID_HIGH"},{attributeName:"Driving an Automobile",parameterName:"Restriction Usage",value:"PROHIBITED"},{attributeName:"Roads Under Construction Prohibited",parameterName:"Restriction Usage",value:"PROHIBITED"},{attributeName:"Through Traffic Prohibited",parameterName:"Restriction Usage",value:"AVOID_HIGH"}],distanceAttributeName:"Kilometers",id:"FEgifRtFndKNcJMJ",impedanceAttributeName:n?"TravelTime":"Kilometers",name:n?"Driving Time":"Driving Distance",restrictionAttributeNames:["Avoid Carpool Roads","Avoid Express Lanes","Avoid Gates","Avoid Private Roads","Avoid Unpaved Roads","Driving an Automobile","Roads Under Construction Prohibited","Through Traffic Prohibited"],simplificationTolerance:l,simplificationToleranceUnits:"esriMeters",timeAttributeName:"TravelTime",type:"AUTOMOBILE",useHierarchy:!0,uturnAtJunctions:"esriNFSBAtDeadEndsAndIntersections",description:"Models the movement of cars and other similar small automobiles, such as pickup trucks, and finds solutions that optimize travel time. Travel obeys one-way roads, avoids illegal turns, and follows other rules that are specific to cars. When you specify a start time, dynamic travel speeds based on traffic are used where it is available."};if(a?.travelModeData&&Object.keys(a.travelModeData).length>0){const t=this.cleanTravelModeData(a.travelModeData);e={...e,...t},e.simplificationTolerance=l,e.simplificationToleranceUnits="esriMeters",n?e.impedanceAttributeName="TravelTime":e.distanceAttributeName&&(e.impedanceAttributeName=e.distanceAttributeName)}else e.simplificationTolerance=l;d=[{bufferUnits:n?"Minutes":"miles"==r?"esriMiles":"esriKilometers",bufferRadii:i,areaType:"NetworkServiceArea",travel_mode:e,networkOptions:{polygon_overlap_type:"Disks"},returnGeometry:!0,geometry:{x:o,y:s,spatialReference:{wkid:4326,latestWkid:4326}}}];let t=d[0];const h=Date.now().valueOf();"Towards Facility"===a?.travelDirection&&(t.networkOptions.travel_direction="Towards Facility"),a?.useTrafficEnabled&&a?.useTrafficChecked&&"live"===a?.trafficType&&(t.networkOptions.time_of_day=h,t.networkOptions.time_zone_for_time_of_day="UTC")}else d=[{bufferUnits:n?"Minutes":"miles"==r?"esriMiles":"esriKilometers",bufferRadii:i,areaType:"NetworkServiceArea",travel_mode:{attributeParameterValues:[{parameterName:"Restriction Usage",attributeName:"Avoid Private Roads",value:"AVOID_MEDIUM"},{parameterName:"Restriction Usage",attributeName:"Walking",value:"PROHIBITED"},{parameterName:"Restriction Usage",attributeName:"Preferred for Pedestrians",value:"PREFER_LOW"},{parameterName:"Walking Speed (km/h)",attributeName:"WalkTime",value:5},{parameterName:"Restriction Usage",attributeName:"Avoid Roads Unsuitable for Pedestrians",value:"AVOID_HIGH"}],description:"Follows paths and roads that allow pedestrian traffic and finds solutions that optimize travel time. The walking speed is set to 5 kilometers per hour.",impedanceAttributeName:n?"WalkTime":"Kilometers",simplificationToleranceUnits:"esriMeters",uturnAtJunctions:"esriNFSBAllowBacktrack",restrictionAttributeNames:["Avoid Private Roads","Avoid Roads Unsuitable for Pedestrians","Preferred for Pedestrians","Walking"],useHierarchy:!1,simplificationTolerance:l,timeAttributeName:"WalkTime",distanceAttributeName:"Kilometers",type:"WALK",id:"caFAgoThrvUpkFBW",name:n?"Walking Time":"Walking Distance"},networkOptions:{polygon_overlap_type:"Disks"},returnGeometry:!0,geometry:{x:o,y:s,spatialReference:{wkid:4326,latestWkid:4326}}}];d.forEach((e=>{e.hasOwnProperty("travelModeData")&&(console.warn("\u26a0\ufe0f Removing extraneous travelModeData property from request - only travel_mode should be used"),delete e.travelModeData),e.travel_mode&&(e.travel_mode=this.cleanTravelModeData(e.travel_mode))}));return{dataCollections:["GlobalIntersect"],returnGeometry:!0,outSR:'{"wkid":4326, "latestWkid":4326}',studyareas:JSON.stringify(d),useData:JSON.stringify({sourceCountry:t}),forStorage:!1,f:"json"}}static cleanTravelModeData(e){if(!e||"object"!=typeof e)return e;const t={...e};return t.travelModeData&&(console.warn("\u26a0\ufe0f Removing nested travelModeData property to prevent malformed request"),delete t.travelModeData),Object.keys(t).forEach((e=>{"travelModeData"!==e&&t[e]&&"object"==typeof t[e]&&!Array.isArray(t[e])&&(t[e]=this.cleanTravelModeData(t[e]))})),t}}class d{static getRings(e,t,r,i,a,o){if(!i||i.length<=0||i.length>3||"miles"!=r&&"kilometers"!=r||!e||!t)throw console.log("GeometryUtil: invalid args",e,t,i),"GeometryUtil: invalid args";let s=[];for(let n=0;n<i.length;n++){let h=this.getAnalysisAreaRings(e,t,r,i,n,a,o);s.push(h)}return s}static getAnalysisAreaRings(e,t,r,i,o,s,h){if(!e||!t||null==r||!i||i.length<0||i.length>3)throw n.log("arcgis-infographic analysisAreas invalid args: ",e,t,r,i),"GeometryUtil.getAnalysisAreaRings: invalid args";let l=1==i[o]?"miles"==r?a.B.i18n("mile"):a.B.i18n("kilometer"):"miles"==r?a.B.i18n("milesLowercase"):a.B.i18n("kilometersLowercase");function c(){let e="miles"==r?" "+a.B.i18n("mile"):" "+a.B.i18n("kilometer");return a.B.i18n("ring-semicolon")+" "+i[o]+e+" "+a.B.i18n("radiusLowercase")}function p(){return i[o]+" "+l}function u(){return i[o]+" "+l}let g={feature:{geometry:{rings:[]},attributes:{RING:o+1,DESCRIPTION:"",latitude:e,longitude:t,name:p(),shortName:u(),description:c()}},latitude:e,longitude:t,location:{geometry:{x:t,y:e,spatialReference:{wkid:4326}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}},name:s||p(),address:"",shortName:u(),locationName:s||p(),description:c()};if(h){const e={...h,...g.feature.attributes};g.feature.attributes=e}let f=d._generateRing(e,t,r,i[o]);return g.feature.geometry.rings.push(f),g}static getAnalysisAreasFromRings(e,t,r){var i={analysisAreas:[]};for(let a=0;a<e.length;a++){let o=e[a];const s=d._getDescriptions(o);let n={feature:{geometry:{rings:o.rings,spatialReference:{wkid:4326}},attributes:{RING:a,SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:o.latitude,longitude:o.longitude,name:t||"",address:"",shortName:s.shortName,locationName:t||"",description:s.description,location:{geometry:{x:o.longitude,y:o.latitude,spatialReference:{wkid:"4326"}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}}};if(r){const e={...r,...n.feature.attributes};n.feature.attributes=e}i.analysisAreas.push(n)}let a=JSON.stringify(i).replace('{"analysisAreas"','"analysisAreas"');return a.substr(0,a.length-1)}static getAnalysisAreasFromPolygon(e,t,r,i){if(!e||!e.rings||!e.spatial)return n.log("getAnalysisAreasFromPolygon","invalid args",e),"";const a="string"==typeof i?JSON.parse(i):i,o={analysisAreas:[{feature:{name:t||"",geometry:{rings:e.rings,spatialReference:e.spatial},...a&&{symbol:a},attributes:{RING:1,...a?{symbol:a}:{SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}}},name:t||"",description:t||"feature polygon"}]};if(r){const e={...r,...o.analysisAreas[0].feature.attributes};o.analysisAreas[0].feature.attributes=e}let s=JSON.stringify(o).replace('{"analysisAreas"','"analysisAreas"');return s.substr(0,s.length-1)}static _getDescriptions(e){if(!e||!e.units||!e.value)throw new Error("GeometryUtil _getDescriptions invalid arg");let t="minutes"==e.units.toLowerCase(),r=e.units.toLowerCase().indexOf("miles")>=0;const i=e.value.toString(),o=1==e?.value,s="en-us"===a.B._locale;let n;n=t?s?"minute":a.B.i18n("minutes"):o?r?a.B.i18n("mile"):a.B.i18n("kilometer"):r?a.B.i18n("milesLowercase"):a.B.i18n("kilometersLowercase");let h="",l="drive"==e.transport?a.B.i18n("drive"):a.B.i18n("walk"),d=e.value.toString()+" "+n+" "+l.toLowerCase();{let e=t?" "+a.B.i18n("time-semicolon")+" ":" "+a.B.i18n("distance-semicolon")+" ",r=n;s&&!o&&(r=a.B.i18n("minutes")),h=l+e+i+" "+r}return{transport:l,shortName:d,description:h}}static getAnalysisAreasFromEnrichBuffers(e,t,r){if(!e||e.length<=0)return n.log("getAnalysisAreasFromEnrichBuffers","invalid args",e),"";const i={analysisAreas:[],spatialReference:e[0].spatial};let a,o;for(let s=0;s<e.length;s++){let n=e[s];if(!(n&&n.latitude&&n.longitude&&n.rings))continue;const h=d._getDescriptions(n);a||(a=n.latitude),o||(o=n.longitude);let l={feature:{geometry:{rings:n.rings},attributes:{RING:1,SYMBOL:{color:[204,51,0,128],outline:{color:[204,51,0,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}},latitude:a,longitude:o,description:h.description,shortName:h.shortName,name:t||"",location:{geometry:{x:o,y:a,spatialReference:{wkid:4326}},symbol:{type:"esriPMS",width:14,height:26.6,xoffset:0,yoffset:12.6,contentType:"image/png",imageData:"iVBORw0KGgoAAAANSUhEUgAAABMAAAAjCAYAAAB2KjFhAAACtUlEQVRIS+2WS0wTURSG/zvT0kpfkGJ4pGCViA1Em9CtCQVx5QIWhiVRo8GdSNypqHElkcgOlzVh5ap1X6nEiAkQXzGBxkSKtZC0jdTSB7SdMXdwRjudB+w5q5t7T775z3/OzR0CWbT4x90Glh0CMEx43g1C3FIKz6/zhKwDCJYrldBWZIaupSDiqsE/3mBjmGeMyXLF7GiBubEVhmN2sIY6KblS3kO58BvFX5soZrbA7eYCWY67vR2Z2aZJAoyqMTLMvLXN47a1eeRiUSrmUSrmhHSGNYA11oGtMyO3FcVOYnW9xHH9VKUAcw1MfHSc9HktzvYaEN34B6suymSxCwozsQ+ReHi6n7gG7/iNZvv88W6/Ikgdtl+Y2d6I5NfXqJQK/cQ1MPHQ1uZ5oFSeSFdWtn9Ky93b/olsYvURhUWcXef7TPamGmWXfM3oPeVAi8OIeDKLpWgSrxY3qvIY1gjCl5GOvn2jCLOaWUyN9sDX6aj5wNJaErdm3yNbKAlnurCp0W709ThVPQy+i+H+ixV92OlWC+bGe1VB4sHlx2GsxTPayqhPkyNdurB7gRWEFmPasBsXT+D6YIcu7MnLz5gLf9OG0e7Njp3ThV2bXsBSNKUNo518ftML6p1aUK+oZwfqJgVRIAXLg47E1acLgvkHgtGk1kYTJkfOCEMrxnI0hbuBZSTSeWlPd87kaprqeWwkUopVHxqmdTePYMqTdeRZ9d1svzARtLnODlmbO1XvoqpnhMBkaUAhHUM2/iVE6ONrZZjIoZ+6v6BiZhOZ7yufdjjOL7ybesAaZQog+qpX/R6oKayCqYCoKAmmpVCCaYBqYGpAAbabF8z+3yPxh0XsXJUycVPuYWm3IIyAFkhRmRowl/4hdU2uSFOZHFjv7PDm0xtC+9VAmspkwOAOxw1rgWj+H4uVH6hj08HSAAAAAElFTkSuQmCC"}}};if(r){const e={...r,...l.feature.attributes};l.feature.attributes=e}i.analysisAreas.push(l)}let s=JSON.stringify(i).replace('{"analysisAreas"','"analysisAreas"');return s.substring(0,s.length-1)}static getDemoPolygon(){return'"analysisAreas": [       {         "feature": {           "geometry": {             "rings": [               [                 [                   -118.000083501802,                   34.0609396322877                 ],                 [                   -118.000083501802,                   34.0700406810389                 ],                 [                   -118.000083501802,                   34.0791407522251                 ],                 [                   -118.000083501802,                   34.0882398457216                 ],                 [                   -117.989097176058,                   34.0882398457216                 ],                 [                   -117.989097176058,                   34.0973379614042                 ],                 [                   -117.978110850314,                   34.1064350991486                 ],                 [                   -117.96712452457,                   34.1064350991486                 ],                 [                   -117.956138198827,                   34.1064350991486                 ],                 [                   -117.956138198827,                   34.1155312878821                 ],                 [                   -117.956138198827,                   34.1246264693743                 ],                 [                   -117.945151873083,                   34.1246264693743                 ],                 [                   -117.945151873083,                   34.1155312878821                 ],                 [                   -117.945151873083,                   34.1064350991486                 ],                 [                   -117.945151873083,                   34.0973379614042                 ],                 [                   -117.945151873083,                   34.0882398457216                 ],                 [                   -117.945151873083,                   34.0791407522251                 ],                 [                   -117.956138198827,                   34.0791407522251                 ],                 [                   -117.956138198827,                   34.0700406810389                 ],                 [                   -117.96712452457,                   34.0700406810389                 ],                 [                   -117.978110850314,                   34.0700406810389                 ],                 [                   -117.978110850314,                   34.0609396322877                 ],                 [                   -117.989097176058,                   34.0609396322877                 ],                 [                   -118.000083501802,                   34.0609396322877                 ]               ]             ],             "spatialReference": {               "wkid": 4326             }           },           "attributes": {             "OBJECTID": 6,             "NAME": "06 103",             "DESCRIPTION": "Area: 8.1 square miles",             "CREATED": 1518736922977,             "MODIFIED": 1518736922977,             "CREATOR": "fasil_ba",             "EDITOR": "fasil_ba",             "REGION": "US",             "FLAGS": 2,             "SYMBOL": {"color":[255,255,178,230],"outline":{"color":[0,0,0,255],"width":1.5,"type":"esriSLS","style":"esriSLSSolid","marker":null},"type":"esriSFS","style":"esriSFSSolid"},             "STATEFP": "06",             "UNSDLEA": "03690",             "GEOID": "0603690",             "NAME_": "Baldwin Park Unified School District",             "LSAD": "00",             "LOGRADE": "KG",             "HIGRADE": "12",             "MTFCC": "G5420",             "SDTYP": " ",             "FUNCSTAT": "E",             "ALAND": 22081431,             "AWATER": 626574,             "INTPTLAT": "+34.0896602",             "INTPTLON": "-117.9687223",             "GEOID2": 603690,             "COUNT_": 0,             "COUNT_1": 0,             "OID1": 75,             "YEAR_1": 1314,             "COUNTY_1": 19,             "DISTRICT_1": 1964287,             "DISTRICT_2": "Baldwin Park Unified",             "GEOGRAPH_1": "Baldwin Park Unified School District, CA",             "GEOID_12": 603690,             "HISP_1": 16310,             "PCTHISP_1": 86.91,             "AMIND_1": 62,             "PCTAMIND_1": 0.33,             "ASIAN_1": 731,             "PCTASIAN_1": 3.9,             "PAC_1": 32,             "PCTPAC_1": 0.17,             "FIL_1": 326,             "PCTFIL_1": 1.74,             "AFAM_1": 635,             "PCTAFAM_1": 3.38,             "WHITE_1": 552,             "PCTWHITE_1": 2.94,             "TWOORMOR_1": 107,             "PCTTWOOR_1": 0.57,             "NONEREPO_1": 12,             "PCTNONER_1": 0.06,             "TOTAL_1": 18767,             "NONWHITE_1": 18203,             "PCTNONWH_1": 97,             "SHAPE__Area": null,             "SHAPE__Length": null           }         },         "name": "06 103",         "address": "06 103",         "shortName": "06 103",         "description": "Area: 8.1 square miles"       }]'}static _generateRing(e,t,r,i){e&&t&&("miles"==r||"kilometers"==r)&&null!=i||console.log("GeometryUtil Error: _generateRing invalid args=",e,t,r,i);var a=[];function o(e){return e*Math.PI/180}function s(e){return 180*e/Math.PI}var n,h,l="miles"==r?1609.344*i:1e3*i,d=o(e),c=o(t),p=l/6371e3;for(let e=0;e<=360;e+=4){var u=o(e),g=Math.asin(Math.sin(d)*Math.cos(p)+Math.cos(d)*Math.sin(p)*Math.cos(u)),f=Math.atan2(Math.sin(u)*Math.sin(p)*Math.cos(d),Math.cos(p)-Math.sin(d)*Math.sin(g)),m=(n=c+f+Math.PI,h=2*Math.PI,n%h-Math.PI);let t=[];t.push(s(m)),t.push(s(g)),a.push(t)}return a}}class c{fixForLint;_iFrame;_idPrefix;username;token;environment;geoenrichmentUrl="";portalUrl="";portalOnlineGEProxy=!1;reportId;langCode="en-us";sourceCountry="US";selectedHierarchy="";bufferType="ring";bufferUnits="miles";bufferSizes=[1,3,5];useLatestDataSource=!1;standardInfographicID;drivetimeOptions={travelDirection:a.T.away,trafficType:a.b.live,offsetTime:0,offsetDay:a.D.mon,offsetHr:"12:00 PM",useTrafficEnabled:!0,useTrafficChecked:!1,travelModeData:{}};_containerShadowRoot;reportLocation;reportGeometry;reportGeography;reportSymbol;reportLocationName;reportLocationAttributes;reportShowHeader;viewMode;reportHeaderButtonPrint;reportHeaderButtonExcel;reportHeaderButtonZoomLevel;reportHeaderButtonFullscreen;reportHeaderButtonImage;reportHeaderButtonPdf;reportHeaderButtonDynHtml;reportColorBackground;reportColorHeader;reportColorHeaderText;runReportOnClick;showSearch;constructor(e,t,r,i){n.showDebugConsoleLogs=!0,this.username=e,this.token=t,this.environment=r,this._idPrefix="ba-infographic-frame-";const o=a.E.generateId(this._idPrefix);this._iFrame={id:o.id,container:null,instance:null},this.setOptions(i)}setShadowRoot(e){this._containerShadowRoot=e}resetOptions(){this.bufferType="ring",this.bufferUnits="miles",this.bufferSizes=[1,3,5],this.useLatestDataSource=!1,this.standardInfographicID=void 0,this.drivetimeOptions={travelDirection:a.T.away,trafficType:a.b.live,offsetTime:0,offsetDay:a.D.mon,offsetHr:"12:00 PM",useTrafficEnabled:!0,useTrafficChecked:!1,travelModeData:{}},this.viewMode="auto",this.reportShowHeader=!0,this.reportHeaderButtonPrint=!0,this.reportHeaderButtonZoomLevel=!0,this.reportHeaderButtonFullscreen=!0,this.reportHeaderButtonExcel=!0,this.reportHeaderButtonImage=!0,this.reportHeaderButtonPdf=!0,this.reportHeaderButtonDynHtml=!0,this.reportColorBackground="#fff",this.reportColorHeader="blue",this.reportColorHeaderText="#fff",this.runReportOnClick=!0,this.showSearch=!0}setOptions(e,t){if(void 0===e||null==e||!a.U.hasText(e))return!1;try{t&&this.resetOptions();const r=JSON.parse(e);return!(!r||"object"!=typeof r)&&(a.U.hasText(r.bufferType)&&["ring","drivetime","walktime"].includes(r.bufferType)&&(this.bufferType=r.bufferType),a.U.hasText(r.bufferUnits)&&["miles","kilometers","minutes"].includes(r.bufferUnits)&&(this.bufferUnits=r.bufferUnits),r.bufferSizes&&Array.isArray(r.bufferSizes)&&r.bufferSizes.length>0&&r.bufferSizes.length<=3&&(this.bufferSizes=r.bufferSizes),r.drivetimeOptions&&"object"==typeof r.drivetimeOptions&&(this.drivetimeOptions={travelDirection:"string"==typeof r.drivetimeOptions.travelDirection?r.drivetimeOptions.travelDirection:this.drivetimeOptions.travelDirection,useTrafficEnabled:!0,useTrafficChecked:"boolean"==typeof r.drivetimeOptions.useTrafficChecked?r.drivetimeOptions.useTrafficChecked:this.drivetimeOptions.useTrafficChecked,trafficType:"string"==typeof r.drivetimeOptions.trafficType?r.drivetimeOptions.trafficType:this.drivetimeOptions.trafficType,offsetTime:"string"==typeof r.drivetimeOptions.offsetTime?r.drivetimeOptions.offsetTime:this.drivetimeOptions.offsetTime,offsetDay:"string"==typeof r.drivetimeOptions.offsetDay?r.drivetimeOptions.offsetDay:this.drivetimeOptions.offsetDay,offsetHr:"string"==typeof r.drivetimeOptions.offsetHr?r.drivetimeOptions.offsetHr:this.drivetimeOptions.offsetHr,travelModeData:"object"==typeof r.drivetimeOptions.travelModeData?r.drivetimeOptions.travelModeData:this.drivetimeOptions.travelModeData}),a.U.hasText(r.viewMode)&&["full","stack","slides","stack-all"].includes(r.viewMode)&&(this.viewMode=r.viewMode),r.report&&(void 0!==r.report.showHeader&&(this.reportShowHeader=r.report.showHeader),void 0!==r.report.showZoomLevel&&(this.reportHeaderButtonZoomLevel=r.report.showZoomLevel),void 0!==r.report.showFullscreen&&(this.reportHeaderButtonFullscreen=r.report.showFullscreen)),r.export&&(void 0!==r.export.excel&&(this.reportHeaderButtonExcel=r.export.excel),void 0!==r.export.image&&(this.reportHeaderButtonImage=r.export.image),void 0!==r.export.pdf&&(this.reportHeaderButtonPdf=r.export.pdf),void 0!==r.report.print&&(this.reportHeaderButtonPrint=r.export.print),void 0!==r.export.dynamicHtml&&(this.reportHeaderButtonDynHtml=r.export.dynamicHtml)),r.style&&(void 0!==r.style.igBackgroundColor?this.reportColorBackground=r.style.igBackgroundColor:void 0!==r.style.backgroundColor&&(this.reportColorBackground=r.style.backgroundColor),void 0!==r.style.headerColor&&(this.reportColorHeader=r.style.headerColor),void 0!==r.style.headerTextColor&&(this.reportColorHeaderText=r.style.headerTextColor)),r.map&&(void 0!==r.map.runReportOnClick&&(this.runReportOnClick=r.map.runReportOnClick),void 0!==r.map.showSearch&&(this.showSearch=r.map.showSearch)),void 0!==r.useLatestDataSource&&(this.useLatestDataSource=r.useLatestDataSource),!0)}catch(e){console.log("InfographicCard error: ",e)}return!1}_createInfographicPlayerStyleOptions(){let e=[],t=[],r=[];if(e.push('"showCloseButton":false'),null!=this.reportShowHeader&&0==this.reportShowHeader&&e.push('"showHeader":false'),null!=this.viewMode){let t={full:"full-pages",stack:"panels-in-stack",slides:"panels-in-slides","stack-all":"panels-in-stack-all"}[this.viewMode];t&&e.push('"viewMode":"'+t+'","resizeMode":"auto"')}return this.reportHeaderButtonFullscreen&&e.push('"showFullscreenButton": true'),this.reportHeaderButtonZoomLevel&&e.push('"disableZoom": true'),this.reportHeaderButtonExcel&&t.push('"excel": true'),this.reportHeaderButtonImage&&t.push('"image": true'),this.reportHeaderButtonPdf&&t.push('"pdf": true'),this.reportHeaderButtonPrint&&t.push('"print": true'),this.reportHeaderButtonDynHtml&&t.push('"dynamicHtml": true'),this.reportColorBackground&&r.push('"background":"'+this.reportColorBackground+'"'),this.reportColorHeader&&r.push('"headerBackground":"'+this.reportColorHeader+'"'),this.reportColorHeaderText&&r.push('"headerText":"'+this.reportColorHeaderText+'"'),t.length>0&&e.push('"exportOptions": {'+t.toString()+"}"),r.length>0&&e.push('"theme": {'+r.toString()+"}"),e.toString()}_validateSetup(){return!!a.U.hasText(this.environment)&&(a.U.hasText(this.token)?a.U.hasText(this.username)?a.U.hasText(this.reportId)?!!(this.reportLocation||this.reportGeometry||this.reportGeography)||(n.log("InfographicCard","invalid location, geometry or geography"),!1):(n.log("InfographicCard","invalid report ID"),!1):(n.log("InfographicCard","invalid username"),!1):(n.log("InfographicCard","invalid token"),!1))}_checkBuffersAssignDefaults(){void 0===this.bufferType&&(this.bufferType="ring"),void 0===this.bufferUnits&&(this.bufferUnits="miles"),(void 0===this.bufferSizes||isNaN(this.bufferSizes[0]))&&(this.bufferSizes=[1])}async regenerateContent(e){const t=this;try{(!e||t._iFrame.container&&t._iFrame.instance)&&(t._iFrame.container&&a.U.removeChildren(t._iFrame.container),t._iFrame.instance=void 0,await t.loadInfographic(t._iFrame.id,t._iFrame.container,t.reportLocation,t.reportGeometry,t.reportId,t.reportGeography))}catch(e){console.log("InfographicCard: regenerateContent",e)}}_validateReportGeometry(e){if(e&&e.length>0){for(let t=0;t<e.length;t++){let r=e[t];if(!(r&&a.U.hasText(r.transport)&&r.latitude&&r.longitude&&r.value&&a.U.hasText(r.units)&&r.rings))return!1}return!0}return!1}async _getReportGeometryAnalysisAreas(){let e="";if(this.reportGeometry)this.reportGeometry.type&&"polygon"===this.reportGeometry.type?e=d.getAnalysisAreasFromPolygon(this.reportGeometry,this.reportLocationName,this.reportLocationAttributes,this.reportSymbol):"drivetime"!==this.bufferType&&"walktime"!==this.bufferType||(this._validateReportGeometry(this.reportGeometry)?e=d.getAnalysisAreasFromRings(this.reportGeometry,this.reportLocationName,this.reportLocationAttributes):n.log("_getReportGeometryAnalysisAreas","reportGeometry is invalid",this.reportGeometry));else if("drivetime"===this.bufferType||"walktime"===this.bufferType){l.setToken(this.username,this.token);let t=await l.getBuffers(this.bufferType,this.sourceCountry,this.bufferUnits,this.bufferSizes,this.reportLocation.lon,this.reportLocation.lat,this.drivetimeOptions);e=d.getAnalysisAreasFromEnrichBuffers(t,this.reportLocationName,this.reportLocationAttributes)}return e}_checkBuffers(){void 0===this.bufferType&&(this.bufferType="ring"),void 0===this.bufferUnits&&(this.bufferUnits="miles"),(void 0===this.bufferSizes||isNaN(this.bufferSizes[0]))&&(this.bufferSizes=[1])}generateNotReadyHtml(){return'<div id="'+a.E.generateId("notReadyDiv")+'" class="notReadyOuter" >           <svg class="notReadySvg" preserveAspectRatio="xMidYMid meet" width="66" height="58">             <g transform="matrix(0.65909094 0 0 0.65909094 0.09090962 -0)">               <g>                 <path                   d="M48.445312 0.15625C 48.125 0.234375 47.5625 0.445312 47.195312 0.632812C 46.648438 0.90625 46.375 1.117188 45.734375 1.757812C 45.257812 2.226562 44.765625 2.804688 44.507812 3.203125C 43.84375 4.234375 39.1875 12.441406 21.367188 43.960938C 15.171875 54.91797 7.976562 67.65625 5.375 72.25391C 2.773438 76.85547 0.554688 80.83203 0.445312 81.08984C -0.171875 82.55469 -0.117188 84.171875 0.59375 85.46094C 0.710938 85.67969 1.09375 86.13281 1.4375 86.47656C 2.148438 87.17969 2.820312 87.5625 3.828125 87.84375L3.828125 87.84375L4.421875 88L50.351562 87.984375L96.28906 87.96094L96.921875 87.75C 99.75781 86.78125 100.78125 83.85156 99.296875 80.88672C 99.13281 80.55078 92.27344 68.53906 84.05469 54.183594C 75.83594 39.835938 66.02344 22.695312 62.25 16.097656C 58.46875 9.503906 55.148438 3.75 54.859375 3.320312C 53.9375 1.9375 52.765625 0.890625 51.585938 0.40625C 50.609375 0 49.460938 -0.09375 48.445312 0.15625zM61 26.804688C 67.19531 37.61328 76.77344 54.339844 82.28125 63.96875L82.28125 63.96875L92.30469 81.47266L71.11719 81.49609C 59.460938 81.50391 40.382812 81.50391 28.71875 81.49609L28.71875 81.49609L7.507812 81.47266L20.523438 58.45703C 45.429688 14.402344 49.625 7.011719 49.695312 7.097656C 49.726562 7.128906 54.8125 15.996094 61 26.804688z"                   stroke="none"                   fill="#D4D7DD"                   fill-rule="nonzero"                 />                 <path                   d="M49.140625 26.460938C 49.03125 26.484375 48.664062 26.570312 48.328125 26.65625C 45.28125 27.421875 42.8125 30.363281 42.8125 33.19922C 42.8125 33.558594 42.984375 35.183594 43.203125 36.80078C 43.414062 38.41797 44.085938 43.5 44.6875 48.101562C 46.257812 60.097656 46.242188 59.95703 46.375 60.45703C 46.703125 61.75 47.476562 62.78125 48.492188 63.28125C 49.015625 63.539062 49.164062 63.578125 49.804688 63.601562C 50.992188 63.65625 51.726562 63.367188 52.523438 62.539062C 53.296875 61.71875 53.648438 60.789062 53.898438 58.910156C 53.984375 58.253906 54.375 55.30078 54.765625 52.339844C 55.148438 49.382812 55.789062 44.554688 56.171875 41.59375C 56.5625 38.640625 56.953125 35.683594 57.039062 35.027344C 57.226562 33.60547 57.234375 32.64453 57.070312 32.003906C 56.429688 29.480469 54.257812 27.320312 51.65625 26.640625C 51.070312 26.484375 49.578125 26.382812 49.140625 26.460938z"                   stroke="none"                   fill="#D4D7DD"                   fill-rule="nonzero"                 />                 <path                   d="M49.390625 66.59375C 46.695312 66.9375 44.75 69.49219 45.078125 72.26953C 45.234375 73.56641 45.75 74.62109 46.671875 75.47266C 47.5625 76.30859 48.523438 76.72266 49.726562 76.80078C 51.1875 76.88672 52.351562 76.43359 53.4375 75.33984C 54.484375 74.29297 54.9375 73.20703 54.945312 71.70703C 54.953125 70.796875 54.84375 70.27344 54.492188 69.515625C 53.554688 67.47656 51.53125 66.32031 49.390625 66.59375z"                   stroke="none"                   fill="#D4D7DD"                   fill-rule="nonzero"                 />               </g>             </g>           </svg>         </div>'}findNestedKeysByName(e,t,r,i){!function e(a){if("object"==typeof a&&null!==a)for(const o in a)r?o===t&&(a[o]=i):o.toLowerCase()===t.toLowerCase()&&(a[o]=i),e(a[o])}(e)}geographyFixHierarchy(e,t){e&&t&&a.A.hasText(e)&&a.A.hasText(t);const r=JSON.parse(t);return r&&this.findNestedKeysByName(r,"hierarchy",!1,e),JSON.stringify(r)}async loadInfographic(e,t,r,i,n,l,c){const p=this;if(!(e&&t&&(r&&r.lat&&r.lon||i||l)&&n))throw new Error("infographicCard error: invalid args loading infographic");let u=this.standardInfographicID&&a.A.hasText(this.standardInfographicID)?this.standardInfographicID:void 0;if(p._iFrame={id:e,container:t,instance:null},p.reportGeometry=i,p.reportId=n,p.reportGeography=l,p.reportLocation=r,p.reportSymbol=c,p.reportGeography&&a.A.hasText(p.reportGeography.hierarchy)){const e=p.sourceCountry,t=p.token,r=void 0!==p.useLatestDataSource&&p.useLatestDataSource,i=await s.G.applyUseLatestDataSource(r,e,l.hierarchy,t,u);p.reportGeography.hierarchy=i}a.U.removeChildren(t),p._iFrame.container.innerHTML='<iframe id="'+p._iFrame.id+'" class="arcgisInfographicFrame"></iframe>';setTimeout((async()=>{if(p._iFrame.instance=p._containerShadowRoot.querySelector(a.U.fixId(this._iFrame.id)),p._iFrame.instance)try{const e=s.E.getEnvironment();p.environment=e,(0,o.s)(p.environment);const t=await h._getInfographicsPlayerUrl(),r="dev"===p.environment?"devext":"qa"===p.environment?"qaext":"www",i=p.reportLocation?p.reportLocation.lat:0,a=p.reportLocation?p.reportLocation.lon:0;if(p.reportGeometry||p.reportLocation&&i&&a||p.reportGeography){p.langCode=p.langCode||"en-us",p.sourceCountry=p.sourceCountry||"US";let e=await s.G.getGEDefaultHierarchy(p.sourceCountry,p.portalOnlineGEProxy||!s.E.isAGOPortal(p.portalUrl)?p.token:"");p.selectedHierarchy&&!p.useLatestDataSource&&(e=p.selectedHierarchy);const o=await s.G.applyUseLatestDataSource(p.useLatestDataSource,p.sourceCountry,e,p.token,u),n=5===p.langCode.length?p.langCode.substring(0,3)+p.langCode.substring(3).toUpperCase():p.langCode;let h,l='{                 "userId":"'+p.username+'",                 "token":"'+p.token+'",                 "expires":"'+Math.floor(Date.now()+86400000.5).toString()+'",                 "componentId":"'+p._iFrame.id+'",                 "reportID":"'+p.reportId+'",                 "countryID":"'+p.sourceCountry+'",                 "langCode":"'+n+'",                 "allLanguages":true,                 "hierarchy":"'+o+'", ';if(p.geoenrichmentUrl&&(l+=' "geoenrichmentUrl":"'+p.geoenrichmentUrl+'", '),p.portalUrl?l+=' "server":"'+p.portalUrl+'", ':l+=' "server":"https://'+r+'.arcgis.com" ,',p.portalOnlineGEProxy&&(l+=' "portalOnlineGEProxy":true ,'),p.portalOnlineGEProxy&&!p.username&&(l+=' "publicUser":true ,'),l+=' "appID":"'+s.G.appID+'",',p.reportGeography?(p.reportSymbol&&(p.reportGeography.symbol=p.reportSymbol),p.reportGeography.hierarchy=o,h=' "analysisAreas": [{"locationName":"'+p.reportLocationName+'", "geographies":['+JSON.stringify(p.reportGeography)+"]}] "):h=await p._getReportGeometryAnalysisAreas(),h)l+=h;else{"minutes"===p.bufferUnits&&(p.bufferUnits="miles");let e=d.getRings(i,a,p.bufferUnits,p.bufferSizes,p.reportLocationName,p.reportLocationAttributes);l+=' "analysisAreas": '+JSON.stringify(e)}let c=p._createInfographicPlayerStyleOptions();c&&c.length>0&&(l+=","+c),l+=" }",p.reportGeography&&(l=p.geographyFixHierarchy(o,l)),p._iFrame.instance.onload=()=>{setTimeout((()=>{p._iFrame&&p._iFrame.instance&&p._iFrame.instance.contentWindow&&p._iFrame.instance.contentWindow.postMessage({type:"infographic_parameters",infographicParameters:l},t)}),500)},p._iFrame.instance.src=t}else console.log("InfographicCard error: invalid location, geometry or geography",p.reportLocation,p.reportGeometry,p.reportGeography)}catch(e){console.log("InfographicCard error",e)}}),0)}updateInfographic(){this.regenerateContent()}setReportLocation(e){e&&e.lat&&e.lon&&(this.reportLocation=e,this.regenerateContent(!0))}setReportGeometry(e){e&&(this.reportGeometry=e,this.regenerateContent(!0))}async setReportGeography(e){if(e){let t=this.standardInfographicID&&a.A.hasText(this.standardInfographicID)?this.standardInfographicID:this.reportId;const r=this.sourceCountry,i=this.token,o=void 0!==this.useLatestDataSource&&this.useLatestDataSource,n=await s.G.applyUseLatestDataSource(o,r,e.hierarchy,i,t);e.hierarchy=n,this.reportGeography=e,this.regenerateContent(!0)}}async generateBuffers(){if(!this.sourceCountry)return{success:!1,error:"InfographicCard sourceCountry not valid"};if(!this.bufferType||"drivetime"!==this.bufferType&&"walktime"!==this.bufferType)return{success:!1,error:`[${this.bufferType}] invalid bufferType (must be "drivetime" or "walktime")`};if(!this.bufferSizes||this.bufferSizes.length<=0)return{success:!1,error:"missing bufferSizes"};if("drivetime"===this.bufferType&&"object"!=typeof this.drivetimeOptions)return{success:!1,error:"drivetimeOptions must be an object"};if(!this.bufferUnits||"miles"!==this.bufferUnits&&"kilometers"!==this.bufferUnits&&"minutes"!==this.bufferUnits)return{error:"invalid units"};if(!this.reportLocation||!this.reportLocation.lat)return{error:"invalid latitude"};if(!this.reportLocation||!this.reportLocation.lon)return{error:"invalid longitude"};l.setToken(this.username,this.token);let e=this.reportLocation.lat,t=this.reportLocation.lon;a.a.Log("InfographicCard GENERATE BUFFERS");let r=await l.getBuffers(this.bufferType,this.sourceCountry,this.bufferUnits,this.bufferSizes,t,e,this.drivetimeOptions);return this.reportGeometry=r,r}}const p=class{get el(){return(0,i.g)(this)}_instanceId;_containerId;_iframeId;_onChangeCallback;_isInternalUpdate=!1;_debounceTimer;_idPrefix="arcgis-infographic-";_hasSetEnv=!1;_defaultOptions=JSON.stringify({bufferType:"ring",bufferUnits:"miles",bufferSizes:"1,3,5",viewMode:"auto"});_infographicCard;constructor(e){(0,i.r)(this,e),this.invalidHierarchy=(0,i.c)(this,"invalidHierarchy",6),this.env=void 0,this.token=void 0,this.username=void 0,this.reportId=void 0,this.theme=void 0,this.locationName=void 0,this.locationAttributes=void 0,this.langCode=void 0,this.sourceCountry=void 0,this.selectedHierarchy=void 0,this.geoenrichmentUrl=void 0,this.portalUrl=void 0,this.portalOnlineGEProxy=void 0,this.useLatestDataSource=void 0,this.standardInfographicID=void 0,this.options=void 0,this.reportLocation=void 0,this.reportgeometry=void 0,this.reportgeography=void 0,this.reportsymbol=void 0,this.stEnv=void 0,this.stToken=void 0,this.stUsername=void 0,this.stLocationDisplayName=void 0,this.stLocationAttributes=void 0,this.stLangCode=void 0,this.stSourceCountry=void 0,this.stSelectedHierarchy=void 0,this.stReportId=void 0,this.stTheme=void 0,this.stOptions=void 0,this.stSelectedFeatureId=void 0,this.stReportLocation=void 0,this.stReportGeometry=void 0,this.stReportGeography=void 0,this.stReportSymbol=void 0,this.stUseLatestDataSource=void 0,this.stStandardInfographicID=void 0,this.stWorkflowOwner=void 0}onEnvChanged(){this.stEnv=this.env,s.E.setEnvironment(this.env),this._infographicCard&&(this._infographicCard.environment=this.env),this._onPropChanged()}onTokenChanged(){this.stToken=this.token,this._infographicCard&&(this._infographicCard.token=this.token),this._onPropChanged()}onUsernameChanged(){this.stUsername=this.username,this._infographicCard&&(this._infographicCard.username=this.username),this._onPropChanged()}onLocationDisplayNameChanged(){this.stLocationDisplayName=this.locationName,this._infographicCard&&(this._infographicCard.reportLocationName=this.locationName),this._onPropChanged()}onLocationAttributesChanged(){this.stLocationAttributes=this.locationAttributes?JSON.parse(this.locationAttributes):{},this._infographicCard&&(this._infographicCard.reportLocationAttributes=this.stLocationAttributes),this._onPropChanged()}onLangCodeChanged(){this.stLangCode=this.langCode,this._infographicCard&&(this._infographicCard.langCode=this.langCode),a.B._initialize(this.stLangCode),this._onPropChanged()}onCountryChanged(){this.stSourceCountry=this.sourceCountry,this._infographicCard&&(this._infographicCard.sourceCountry=this.sourceCountry),this._onPropChanged()}onHierarchyChanged(){this.stSelectedHierarchy=this.selectedHierarchy,this._infographicCard&&(this._infographicCard.selectedHierarchy=this.selectedHierarchy),this._onPropChanged()}onOptionsChanged(){this.stOptions=this.options,a.a.Log("BAC arcgis-infographic options changing...",this.options),this._infographicCard&&this._infographicCard.setOptions(this.options,!0),this._onPropChanged()}onReportIdChanged(){this.stReportId=this.reportId,this._infographicCard&&(this._infographicCard.reportId=this.reportId),this._onPropChanged()}onThemeChanged(){this.stTheme=JSON.parse(this.theme),this._onPropChanged()}onReportLocationChanged(){try{this.stReportLocation=this.reportLocation,this._onPropChanged()}catch(e){a.a.Error("onReportLocationChanged",e)}}onReportGeometryChanged(){this.stReportGeometry=this.reportgeometry,this._onPropChanged()}onReportGeographyChanged(){this.stReportGeography=this.reportgeography,this._onPropChanged()}invalidHierarchy;onReportSymbolChanged(){this.stReportSymbol=this.reportsymbol,this._onPropChanged()}onUseLatestDataSourceChanged(){this.stUseLatestDataSource=this.useLatestDataSource,this._infographicCard&&(this._infographicCard.useLatestDataSource=this.useLatestDataSource),this._onPropChanged()}onStandardInfographicIdChanged(){this.stStandardInfographicID=this.standardInfographicID,this._infographicCard&&(this._infographicCard.standardInfographicID=this.standardInfographicID),this._onPropChanged()}reportSelectedEventHandler(e){let t=e.detail?.value;if(t){this.stReportId=t,e.detail?.reportID&&(this.stStandardInfographicID=e.detail.reportID);let r=a.A.queryElementById(this._iframeId);r&&r.parentNode&&r.parentNode.removeChild(r),this.componentDidLoad()}}async generateBuffers(e,t,r,i,o){const s=this._infographicCard;a.a.Log("arcgis-infographic GENERATE BUFFERS");try{if(!s)return null;if(a.A.hasText(e)&&["ring","drivetime","walktime"].includes(e)&&(s.bufferType=e),t&&t.trim().length>0){let e=[],r=t.split(",");for(let t=0;t<r.length;t++)t<3&&r[t]&&r[t].trim().length>0&&e.push(parseFloat(r[t].trim()));e.length>0&&(s.bufferSizes=e)}if(a.A.hasText(r)&&["miles","kilometers","minutes"].includes(e)&&(s.bufferUnits=r),a.A.hasText(i)&&a.A.hasText(o)){let e=parseFloat(i),t=parseFloat(o);s.reportLocation={lat:e,lon:t},this.reportLocation=o+", "+i}return this._isInternalUpdate=!0,s.generateBuffers()}catch(e){return a.a.Error("arcgis-infographic: generate buffers error: ",e),{error:"exception: "+e.toString()}}}async onPropChange(e,t){this._onChangeCallback={fn:e,ctx:t}}async setUseLatestDataSource(e,t){this._infographicCard&&(this._infographicCard.useLatestDataSource=e,this._infographicCard.standardInfographicID=t),this.useLatestDataSource=e,this.standardInfographicID=t,this.onUseLatestDataSourceChanged(),this.onStandardInfographicIdChanged()}async updateInfographic(e,t,r,i,o,s){e&&a.A.hasText(e)&&(this.locationName=e,this.stLocationDisplayName=e),t&&a.A.hasText(t)&&(this.reportId=t,this.stReportId=t),r&&(this.reportLocation=r,this.stReportLocation=r),i&&(this.reportgeometry=i,this.stReportGeometry=i),o&&(this.reportgeography=o,this.stReportGeography=o),s&&(this.reportsymbol=s,this.stReportSymbol=s)}_debounce2(e,t){const r=this;r._debounceTimer&&clearTimeout(r._debounceTimer),r._debounceTimer=setTimeout((function(){r._debounceTimer=null,e.apply(r)}),t)}_onFilteredPropChanged(){this._onChangeCallback?this._onChangeCallback.fn(this._onChangeCallback.ctx,this.reportLocation):a.a.Log("WARN- arcgis-infographic component: property sync callback not found"),this.attemptInfographicRender()}_onPropChanged(){this._debounce2(this._onFilteredPropChanged,250)}_debounce(e,t,r){let i;const a=this;return function(){let o=a,s=arguments,n=r&&!i;clearTimeout(i),i=setTimeout((function(){i=null,r||e.apply(o,s)}),t),n&&e.apply(o,s)}}componentWillLoad(){a.a.Log("BAC arcgis-infographic willLoad",this.options),a.a.Log("BAC arcgis-infographic willLoad creds",this.username,this.token);try{this._instanceId||(this._instanceId=a.E.generateId(this._idPrefix).id),this._containerId||(this._containerId=a.E.generateId("componentOuter").id),this._iframeId||(this._iframeId=a.E.generateId("igFrame").id),this.stEnv=this.env,this.stToken=this.token,this.stUsername=this.username,this.stLocationDisplayName=this.locationName,this.stUseLatestDataSource=void 0!==this.useLatestDataSource&&this.useLatestDataSource,this.stStandardInfographicID=this.standardInfographicID;try{this.stLocationAttributes=JSON.parse(this.locationAttributes)}catch(e){this.stLocationAttributes={}}this.stLangCode=a.A.hasText(this.langCode)?this.langCode:"en-us",this.stSourceCountry=a.A.hasText(this.sourceCountry)?this.sourceCountry:"US",this.stSelectedHierarchy=a.A.hasText(this.selectedHierarchy)?this.selectedHierarchy:"",this.stReportId=this.reportId,this.stTheme=null,this.options&&a.A.hasText(this.options)||(this.options=this._defaultOptions),this.stOptions=JSON.parse(this.options),!this._hasSetEnv&&this.env&&(this._hasSetEnv=!0,this.stEnv=this.env,s.E.setEnvironment(this.env)),a.B._initialize(this.stLangCode),this.geoenrichmentUrl&&s.E.setGeoenrichmentUrl(this.geoenrichmentUrl),this.portalUrl&&s.E.setPortalUrl(this.portalUrl),a.a.Log("BAC arcgis-infographic willLoad2",this.options),this._infographicCard?(void 0!==this.stUseLatestDataSource&&(this._infographicCard.useLatestDataSource=this.stUseLatestDataSource),void 0!==this.stStandardInfographicID&&(this._infographicCard.standardInfographicID=this.stStandardInfographicID)):(a.a.Log("BAC arcgis-infographic creating new InfographicCard"),this._infographicCard=new c(this.username,this.token,this.env,this.options),this._infographicCard.setOptions(this.options,!0),this._infographicCard.geoenrichmentUrl=this.geoenrichmentUrl,this._infographicCard.portalUrl=this.portalUrl,this._infographicCard.portalOnlineGEProxy=this.portalOnlineGEProxy,this._infographicCard.reportLocationName=this.stLocationDisplayName,this._infographicCard.reportLocationAttributes=this.stLocationAttributes,this._infographicCard.sourceCountry=this.stSourceCountry,this._infographicCard.selectedHierarchy=this.stSelectedHierarchy,this._infographicCard.langCode=this.stLangCode,this._infographicCard.useLatestDataSource=this.stUseLatestDataSource,this._infographicCard.standardInfographicID=this.stStandardInfographicID,this._infographicCard.setShadowRoot(this.el.shadowRoot))}catch(e){a.a.Error("arcgis-infographic ComponentWillLoad",e)}}async attemptInfographicRender(){let e,t,r,i,o,n=a.A.queryElementById.call(this,this._containerId),h=!0;const l=await s.G.getValidHierarchies(this.stSourceCountry,this.token);if(l){const e=l.dataSources;if(void 0===this.stSelectedHierarchy||""!=this.stSelectedHierarchy&&!e.some((e=>e.id===this.stSelectedHierarchy))){if(h=!1,n){n.replaceChildren(),n.classList.add("arcgisInfographicDeprecatedContainer");const e=a.B.i18n("deprecatedHierarchy"),t=document.createElement("div");t.classList.add("arcgisInfographicDeprecatedMessage"),t.innerHTML=e,n.append(t)}this.invalidHierarchy.emit()}else n.replaceChildren(),n.classList.remove("arcgisInfographicDeprecatedContainer")}if(h){if(this._infographicCard&&(this.options&&this._infographicCard.setOptions(this.options,!0),this._infographicCard.useLatestDataSource=this.useLatestDataSource,this._infographicCard.standardInfographicID=this.stStandardInfographicID),a.a.Log("BAC arcgis-infographic attemptInfographicRender",this._infographicCard),a.a.Log("BAC arcgis-infographic attemptRender creds",this.username,this.token),this.reportLocation){let t=this.reportLocation.split(",");if(t&&2==t.length&&void 0!==t[0]&&void 0!==t[1]){e={lat:parseFloat(t[1]),lon:parseFloat(t[0])},this._infographicCard.setReportLocation(e)}}this.reportgeometry&&(t=JSON.parse(this.reportgeometry),this._infographicCard.setReportGeometry(t)),this.reportgeography&&(r=JSON.parse(this.reportgeography),this._infographicCard.setReportGeography(r)),this.reportId&&(i=this.reportId,this._infographicCard.reportId=this.reportId),this.reportsymbol&&(o=this.reportsymbol,this._infographicCard.reportSymbol=o),n&&(e||t||r)&&i&&await this._infographicCard.loadInfographic(this._iframeId,n,e,t,i,r,o)}}componentDidLoad(){const e=this;requestAnimationFrame((()=>{e.attemptInfographicRender()}))}render(){return(0,i.h)("div",{key:"1c9302d5b6e7093801d73b7c21785030e8ef324c",id:this._containerId,class:"componentOuter"})}static get watchers(){return{env:["onEnvChanged"],token:["onTokenChanged"],username:["onUsernameChanged"],locationName:["onLocationDisplayNameChanged"],locationAttributes:["onLocationAttributesChanged"],langCode:["onLangCodeChanged"],sourceCountry:["onCountryChanged"],selectedHierarchy:["onHierarchyChanged"],options:["onOptionsChanged"],reportId:["onReportIdChanged"],theme:["onThemeChanged"],reportLocation:["onReportLocationChanged"],reportgeometry:["onReportGeometryChanged"],reportgeography:["onReportGeographyChanged"],reportsymbol:["onReportSymbolChanged"],useLatestDataSource:["onUseLatestDataSourceChanged"],standardInfographicID:["onStandardInfographicIdChanged"]}}};p.style=":host{display:block}.notReadyOuter{position:absolute;top:0;left:0;width:100%;height:100%}.notReadyDiv{position:absolute;top:calc(50% - 50px);left:calc(50% - 50px);width:100px;height:100px}.notReadySvg{position:absolute;top:calc(50% - 29px);left:calc(50% - 33px)}.arcgisInfographicFrame{position:absolute;top:0;left:0;width:100%;height:100%;border:none}.arcgisInfographicDeprecatedContainer{width:100%;height:100%;display:flex;text-align:center;justify-content:center;align-items:center}.arcgisInfographicDeprecatedMessage{position:relative;padding:30px;color:black;max-width:540px}"}}]);