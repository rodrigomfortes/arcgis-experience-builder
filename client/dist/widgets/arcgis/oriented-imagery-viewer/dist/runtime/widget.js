System.register(["esri/core/reactiveUtils","esri/widgets/OrientedImageryViewer","calcite-components","jimu-arcgis","jimu-core","jimu-core/react","esri/core/maybe"],(function(e,t){var l={},i={},a={},o={},r={},n={},s={};return{setters:[function(e){l.once=e.once,l.watch=e.watch},function(e){i.default=e.default},function(e){a.CalciteButton=e.CalciteButton,a.CalciteOption=e.CalciteOption,a.CalciteSelect=e.CalciteSelect,a.CalciteTooltip=e.CalciteTooltip},function(e){o.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.WidgetState=e.WidgetState,r.css=e.css,r.jsx=e.jsx,r.utils=e.utils},function(e){n.memo=e.memo,n.useCallback=e.useCallback,n.useEffect=e.useEffect,n.useState=e.useState},function(e){s.abortMaybe=e.abortMaybe,s.destroyMaybe=e.destroyMaybe}],execute:function(){e((()=>{var e={62243:e=>{"use strict";e.exports=l},62686:e=>{"use strict";e.exports=o},68972:e=>{"use strict";e.exports=n},71155:e=>{"use strict";e.exports=s},79244:e=>{"use strict";e.exports=r},98357:e=>{"use strict";e.exports=i},99037:e=>{"use strict";e.exports=a}},t={};function d(l){var i=t[l];if(void 0!==i)return i.exports;var a=t[l]={exports:{}};return e[l](a,a.exports,d),a.exports}d.d=(e,t)=>{for(var l in t)d.o(t,l)&&!d.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.p="";var c={};return d.p=window.jimuConfig.baseUrl,(()=>{"use strict";d.r(c),d.d(c,{__set_webpack_public_path__:()=>m,default:()=>v});var e=d(62243),t=d(98357),l=d(99037),i=d(62686),a=d(79244),o=d(68972);var r=d(71155);const n=e=>{var t,l,i,a,o;const n=e.viewModel;n._updateFootprintTask=(0,r.abortMaybe)(n._updateFootprintTask),n._clickTask=(0,r.abortMaybe)(n._clickTask),null===(t=n.coverageFrustums)||void 0===t||t.destroy(),null===(l=n.coveragePolygons)||void 0===l||l.destroy(),null===(i=n.pointSources)||void 0===i||i.destroy(),null===(a=n.additionalFootprints)||void 0===a||a.destroy(),null===(o=n.additionalCameraLocations)||void 0===o||o.destroy(),n.bestFeatureFootprint=(0,r.destroyMaybe)(n.bestFeatureFootprint),n.bestFeatureCurrentFootprint=(0,r.destroyMaybe)(n.bestFeatureCurrentFootprint),n._crossSymbol=(0,r.destroyMaybe)(n._crossSymbol),n._referencePointOnGround=(0,r.destroyMaybe)(n._referencePointOnGround),n._referencePointOnImage=(0,r.destroyMaybe)(n._referencePointOnImage),n._overlays&&n._overlays.graphics.removeAll(),e.viewModel.resetImage(),n.resetVideo()},s={_widgetLabel:"Oriented Imagery Viewer",noOiLayersError:"No Oriented Imagery Layer in the selected map.",noMapSelectedError:"No Map selected.",defaultError:"Failed to load the widget.",enableViewer:"Enable viewer",disableViewer:"Disable viewer",oiLayerSelector:"Oriented Imagery Layer Selector"};function u(r){var d;const{state:c,config:u,intl:v}=r,[m,p]=(0,o.useState)(null),[y,b]=(0,o.useState)(null),[g,f]=(0,o.useState)([]),[w,E]=(0,o.useState)(!0),[x,C]=(0,o.useState)(null),S=!m||!(null==g?void 0:g.length),j=`oi-viewer-container-${r.id}-${a.utils.getUUID()}`,M=(0,o.useCallback)((e=>{if(e){const t=document.getElementById(j);b(null),t&&(t.innerHTML=""),n(e)}}),[j]),h=(0,o.useCallback)(((e,l=null)=>{const i=new t.default({view:e,disabled:!1,container:j,layer:l});i.visibleElements.title=!1,i.visibleElements.closeButton=!1,i.visibleElements.viewerTools=!1,b(i)}),[j]),O=(0,o.useCallback)((e=>e.filter((e=>"oriented-imagery"===e.type&&e.loaded)).map((e=>({id:"type"in e.parent&&"group"===e.parent.type?`${e.parent.id}-${e.id}`:e.id,layer:e}))).toArray()),[]),_=(0,o.useCallback)((e=>{var t,l;const i=O(e.map.allLayers);let a=x;i.map((e=>e.id)).includes(null==x?void 0:x.id)||(a=i[0]),y?(n(y),k(y,"view",e),k(y,"layer",null!==(t=null==a?void 0:a.layer)&&void 0!==t?t:null)):h(e,null!==(l=null==a?void 0:a.layer)&&void 0!==l?l:null),f(i),C(a)}),[x,y,h,O]);(0,o.useEffect)((()=>()=>{y&&n(y)}),[y]),(0,o.useEffect)((()=>{if(m){const t=e.watch((()=>{var e,t;return null===(t=null===(e=m.map)||void 0===e?void 0:e.allLayers)||void 0===t?void 0:t.filter((e=>"oriented-imagery"===e.type&&e.loaded)).length}),(()=>{_(m)}));return()=>{t.remove()}}}),[m,_]),(0,o.useEffect)((()=>{!m||c&&c!==a.WidgetState.Opened?c===a.WidgetState.Closed&&y&&k(y,"disabled",!0):y&&k(y,"disabled",!w)}),[m,c,y,w]),(0,o.useEffect)((()=>{m?x&&m&&((null==x?void 0:x.layer.loaded)?m.goTo(null==x?void 0:x.layer.fullExtent):e.once((()=>null==x?void 0:x.layer.loaded)).then((()=>{m.goTo(null==x?void 0:x.layer.fullExtent)}))):M(y)}),[x,m,y,M]),(0,o.useEffect)((()=>{var e,t;if(y){const l=y;l.visibleElements.imageGallery=u.imageGalleryEnabled,l.visibleElements.imageEnhancement=u.imageEnahncementEnabled,l.visibleElements.navigationTool=u.navigationToolEnabled,l.visibleElements.directionalNavigation=null!==(e=u.directionalNavigationEnabled)&&void 0!==e&&e,l.visibleElements.sequentialNavigation=null!==(t=u.sequentialNavigationEnabled)&&void 0!==t&&t,l.visibleElements.coverageMenu=u.viewerToolsEnabled,l.visibleElements.mapImageConversionTool=u.mapImageConversionToolEnabled,l.visibleElements.showPopupsAction=u.showPopupsActionEnabled,l.visibleElements.measurementTools=u.measurementToolsEnabled,l.visibleElements.imageOverlays=u.imageOverlaysEnabled,l.dataCaptureEnabled=u.dataCaptureEnabled,b(l)}}),[y,u]);const T=e=>v?v.formatMessage({id:e,defaultMessage:s[e]}):e,k=(e,t,l)=>{e[t]=l,b(e)},V=e=>{const t=e.target.selectedOption.value,l=g.find((e=>e.id===t));C(l),k(y,"layer",l.layer),n(y)},N=()=>{E((e=>!e))},F=()=>(0,a.jsx)(l.CalciteSelect,{label:T("oiLayerSelector"),"aria-label":T("oiLayerSelector"),"data-select-id":"imagery-layer-selector",className:"mb-1",value:null==x?void 0:x.id,onCalciteSelectChange:V},null==g?void 0:g.map((e=>(0,a.jsx)(l.CalciteOption,{key:e.id,value:e.id,selected:x.id===e.id},e.layer.title))));return(0,a.jsx)("div",{css:a.css`
    --calcite-color-brand: var(--sys-color-primary-main);
    --calcite-color-brand-press: var(--sys-color-primary-dark);
    --calcite-color-brand-hover: var(--sys-color-primary-light);
    --calcite-color-text-inverse: var(--sys-color-primary-text)};
  `,className:"jimu-widget overflow-auto p-2",style:{backgroundColor:r.theme.ref.palette.white}},(0,a.jsx)(i.JimuMapViewComponent,{useMapWidgetId:null===(d=r.useMapWidgetIds)||void 0===d?void 0:d[0],onActiveViewChange:e=>{if(e){const t=e.view;p(t),_(t)}else p(null),f([]),C(null)}}),(0,a.jsx)("div",{className:"h-100 w-100 flex-column "+(S?"d-none":"d-flex")},(0,a.jsx)("div",{className:"d-flex"},(0,a.jsx)("div",{className:"mr-1"},y?(0,a.jsx)("div",null,(0,a.jsx)(l.CalciteButton,{appearance:"solid",kind:"brand",label:T(w?"disableViewer":"enableViewer"),iconStart:w?"view-visible":"view-hide",id:`oi-viewer-toggle-${r.id}`,onClick:N}),(0,a.jsx)(l.CalciteTooltip,{"aria-label":T(w?"disableViewer":"enableViewer"),id:`oi-viewer-toggle-tooltip-${r.id}`,referenceElement:`oi-viewer-toggle-${r.id}`},T(w?"disableViewer":"enableViewer"))):null),(0,a.jsx)("div",{className:"flex-grow-1"},F())),(0,a.jsx)("div",{className:"d-flex flex-grow-1 justify-content-center",id:j})),(()=>{if(!S)return null;let e=T("defaultError");return m?(null==g?void 0:g.length)||(e=T("noOiLayersError")):e=T("noMapSelectedError"),(0,a.jsx)("div",{className:"d-flex align-items-center justify-content-center w-100 h-100 px-3 text-center"},(0,a.jsx)("div",null,e))})())}u.mapExtraStateProps=(e,t)=>({locale:e.appContext.locale});const v=(0,o.memo)(u);function m(e){d.p=e}})(),c})())}}}));