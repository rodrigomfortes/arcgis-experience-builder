/*! For license information please see arcgis_display-order_node_modules_arcgis_imagery-components_dist_c-a404da.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_display-order_node_modules_arcgis_imagery-components_dist_c-a404da"],{192:(e,t,i)=>{i.d(t,{A:()=>s,I:()=>a,S:()=>n,a:()=>y,b:()=>f,c:()=>d,d:()=>p,e:()=>l,f:()=>v,g:()=>I,h:()=>g,i:()=>m,j:()=>u,k:()=>r,s:()=>c});var s=(e=>(e.VISIBLE="visible",e.DISPLAY_EXTENT="displayExtent",e.ALL="all",e))(s||{}),a=(e=>(e.ALL="all",e.SELECT="select",e))(a||{}),n=(e=>(e.ASC="asc",e.DESC="desc",e))(n||{}),r=(e=>(e.BRAND="brand",e.DANGER="danger",e.INFO="info",e.SUCCESS="success",e.WARNING="warning",e))(r||{});function l(e){return"object"==typeof e&&null!==e&&"name"in e&&"AbortError"===e.name}const o=new Set(["small-integer","big-integer","integer","single","double","oid"]),c=new Set([...o,"date","string"]);function m(e){return o.has(e)}function d(e){return!!e?.domain?.codedValues}function g(e){return d(e)&&"MosaicCatalogItemCategoryDomain"===e?.domain?.name}function I(e,t=!1){if(!e)return null;const i=new Date(e),s=t?i.getUTCFullYear():i.getFullYear(),a=t?i.getUTCMonth():i.getMonth(),n=t?i.getUTCDate():i.getDate(),r=t?i.getUTCHours():i.getHours(),l=t?i.getUTCMinutes():i.getMinutes(),o=t?i.getUTCSeconds():i.getSeconds();return`${s}-${h((a+1).toString(),2,"0")}-${h(n.toString(),2,"0")} ${h(r.toString(),2,"0")}:${h(l.toString(),2,"0")}:${h(o.toString(),2,"0")}`}function h(e,t,i){for(i=i||" ";e.length<t;)e=i+e;return e}function u(e,t,i){return e+t-1>i?i:e+t-1}function p(e,t,i="en"){return"string"==typeof e&&"string"==typeof t?e.localeCompare(t,i):e<t?-1:e>t?1:0}function f(e,t){if(!e||!t)return;let i=t.assetsPath;i.endsWith("/")||(i+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${i}esri/themes/light/main.css" />`)}function y(e,t){return`${e} IN (${t.map((e=>`${e}`)).join(",")})`}const v=(e,t="en")=>{const i=e.toString();if(i.includes("e")){const[e,t]=i.split("e"),s=v(Number.parseFloat(e)),a=Number.parseInt(t,10);return a<0?s-a:Math.max(0,s-a)}const s=i.indexOf(".");if(-1===s)return 0;const a=i.length-s-1;return new Intl.NumberFormat(t).formatToParts(1.1).find((e=>"decimal"===e.type))?a:0}},4843:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>I,c:()=>w,d:()=>u,e:()=>h,f:()=>g,g:()=>d,h:()=>y,i:()=>o,j:()=>c,k:()=>m,l:()=>v,m:()=>F,r:()=>S});var s=i(8423),a=i(2373),n=i(1552),r=i(192);function l(e){const t=e.find((e=>"best"===e.name.toLowerCase()));if(t)return t;const i=e.find((e=>"acquisitiondate"===e.name.toLowerCase()));if(i)return i;return e.find((e=>"date"===e.name.toLowerCase()))||e.find((e=>"double"===e.type||"integer"===e.type))}async function o(e,t,i){return await e.queryObjectIds(t,{signal:i})}async function c(e,t,i){t.outFields=["*"],t.returnGeometry=!0;const s=await e.queryRasters(t,{signal:i,timeout:12e4});return s?.features?.length?s:null}function m(e,t){const i=e.fields;let s=i.find((e=>"name"===e.name.toLowerCase()));return s||(s=i.find((t=>t.name===e.objectIdField))),s&&s.name!==t.name?[s,t]:[t]}function d(e){return Array.isArray(e)?e.filter((e=>r.s.has(e.type))):[]}function g(e){const{layer:t,queryField:i,queryValues:s,isIncludeOverviews:a,extent:n,selectedImageItemOids:l}=e,o=t.createQuery();if(s&&s.length>0){let e="";if("date"===i?.type&&s[0]){const t=new Date(s[0]),a=(0,r.g)(s[0],!0),n=1===s.length||s[0]===s[1]?(0,r.g)(t.setDate(t.getDate()+1),!0):(0,r.g)(s[1],!0);e=`${i.name} BETWEEN timestamp '${a}' AND timestamp '${n}'`}else{const t=s.filter((e=>"string"==typeof e||"number"==typeof e));if(1===t.length||2===t.length){const[a,n]=s,r="string"==typeof a;e=1===t.length?`${i?.name}=${r?`'${a}'`:a}`:`${i?.name} BETWEEN ${r?`'${a}'`:a} AND ${r?`'${n}'`:n}`}}o.where=e}const c="(Category = 1)";if(a)o.where=o.where?.replace(c,"");else{const e=c+(o.where?` AND (${o.where})`:"");o.where=e}let m="";return l&&l.length>0&&(m=(0,r.a)(t.objectIdField,l)),o.where=m?`${o.where} AND (${m})`:o.where,t.definitionExpression&&(o.where=o.where?`${o.where} AND (${t.definitionExpression})`:t.definitionExpression),n&&(o.geometry=n),o}function I(e){return e.extent?.clone().expand(.75)}async function h(e,t,i,s,a){if(!t)return[];const n=[{onStatisticField:t.name,outStatisticFieldName:"cnt",statisticType:"count"}],l=await p(e,i,s,n,[t.name]);if(l){const i=await e.queryRasters(l,{signal:a});if(i?.features?.length>0){const e=(0,r.i)(t.type);return i.features.map((i=>{const s=i.attributes[t.name];return e?Number(s):s}))}}return[]}async function u(e,t,i,s,a){if(!t.name)return[];const n=[{statisticType:"min",onStatisticField:t.name,outStatisticFieldName:"min_field_value"},{statisticType:"max",onStatisticField:t.name,outStatisticFieldName:"max_field_value"}],r=await p(e,i,s,n);if(r){const t=await e.queryRasters(r,{signal:a});if(t?.features?.length>0){const[e]=t.features;return[e.attributes.min_field_value,e.attributes.max_field_value]}}return[]}async function p(e,t,i,s,a=[]){const n=e.createQuery();if(n.returnGeometry=!1,t===r.A.DISPLAY_EXTENT&&(n.geometry=I(i)),t===r.A.VISIBLE){const t=await f(e,i);if(!(t.length>0))return null;n.where=(0,r.a)(e.objectIdField,t)}return e.definitionExpression&&(n.where=n.where?`${n.where} AND (${e.definitionExpression})`:e.definitionExpression),n.outStatistics=s,a.length>0&&(n.groupByFieldsForStatistics=a),n}async function f(e,t){const i=[],a=function(e,t){const{extent:i,width:a,height:r}=t,l=i.width/a,o=i.height/r,c=new s.default({x:l,y:o});c.spatialReference=i.spatialReference;const m=new n.default;m.geometry=I(t),m.returnGeometry=!0,m.pixelSize=c,m.maxItemCount=e.sourceJSON?.maxMosaicImageCount,m.returnPixelValues=!1;const d=e.mosaicRule.clone();return e.definitionExpression&&(d.where=e.definitionExpression),m.mosaicRule=d,e.useViewTime&&t.timeExtent&&(m.timeExtent=t.timeExtent),m}(e,t),r=await e.identify(a,{timeout:12e4});if(!r?.catalogItems?.features||!r?.catalogItemVisibilities)return[];for(let t=0;t<r.catalogItems.features.length;t++)r.catalogItemVisibilities[t]>0&&i.push(r.catalogItems.features[t].attributes[e.objectIdField]);return i}async function y(e,t,i){const s=await f(e,t);if(!(s.length>0))return null;i.objectIds=s,i.outFields=["*"],i.returnGeometry=!0;const a=await e.queryRasters(i,{timeout:12e4});return a?.features?.length>0?a:null}function v(e,t){if(t.length){const i=new a.default;i.method="lock-raster",i.lockRasterIds=t,e.definitionExpression&&(i.where=e.definitionExpression),e.mosaicRule=i}}function S(e,t){t&&(e.mosaicRule=t.clone())}function F(e,t,i){const{title:s}=e,a=t.name;let n="";const l=i.map((e=>e.attributes[a])).map((e=>"date"===t.type?(0,r.g)(e):e));return l.sort(((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:String(e).localeCompare(String(t)))),1===l.length&&(n=`(${l[0]})`),l.length>1&&(n=`(${l[0]} - ${l[l.length-1]})`),`${s} - ${a} ${n}`}function w(e,t){return Math.abs(t.extent.center.x-e.center.x)<t.resolution&&Math.abs(t.extent.center.y-e.center.y)<t.resolution}},4957:(e,t,i)=>{i.r(t),i.d(t,{ArcgisImageryCollectionExplorer:()=>L});var s=i(3174),a=i(4312),n=i(3661),r=i(2797),l=i(6798),o=i(1072),c=i(3438),m=i(588),d=i(1840),g=i(9327),I=i(8927),h=i(2373),u=i(7274),p=i(6024),f=i(192),y=i(4843),v=i(9722),S=i(7960),F=i(5860);function w(e){return`ImageryCollectionExplorer_${e}`}function C(e,t,i){const s={...A(w(e)),selectedImageItems:t,selectedImageItemOids:i};$(w(e),s)}function b(e){!function(e){window.sessionStorage.removeItem(e)}(w(e))}function $(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))}function A(e){const t=window.sessionStorage.getItem(e);return t&&JSON.parse(t)}const x=i(6011).AH`:host{display:flex;flex-direction:column;flex:1 1 auto;overflow:hidden}.image-item-list-container{display:flex;flex-direction:column;flex:1 1 auto;padding:5px 5px 0;overflow-y:hidden}.image-item-card-list{width:100%;padding:0;margin:0;overflow-y:auto;list-style:none}.image-item-list-selection-button-wrapper{display:flex;align-items:center;justify-content:space-between;padding:.5rem}.image-item-info-container{display:flex;align-items:center;flex-wrap:wrap;gap:10px}.image-item-info-container>img{max-width:50%}.image-item-info-text-section{flex:1;word-break:break-word}.image-item-info-text-section>div{margin-bottom:10px;font-size:var(--calcite-font-size--1);font-weight:var(--calcite-font-weight-medium);color:var(--calcite-color-text-1)}.list-pagination-info-wrapper{padding:.2rem 0;display:flex;justify-content:space-between;align-items:center}.image-item-inspect-button-group{text-align:start}.image-item-card-displayed-field-list{list-style-type:none;padding:0;margin:0;word-break:break-word}.sort-image-item-action-wrapper{border-inline-start:1px solid var(--calcite-color-foreground-3);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.pagination-wrapper{display:flex;justify-content:center;padding:.5rem 0;.hide{display:none}}.no-image-item-coach-wrapper{display:flex;height:100%;flex-direction:column;align-items:center;justify-content:center;text-align:center;gap:1rem}`;class L extends F.WF{constructor(){super(),this.messages=(0,p.u)({blocking:!0}),this.refCloseButtonNode=(0,S._)(),this.isSavedImageOidsMerged=!1,this.selectedAOI=f.A.DISPLAY_EXTENT,this.activeImageItemListNavTab=f.I.ALL,this.totalImageItemCount=-1,this.imageItemFeatures=[],this.selectedImageItemFeatures=[],this.selectedImageItemFeatureOids=[],this.imageItemCardDisplayedFields=[],this.isShowingImageItemInspectPopover=!1,this.isShowingListSettingsPopover=!1,this.isShowingFiltersPopover=!1,this.isShowingSortPopover=!1,this.isShowingThumbnails=!1,this.isQueryingImageItems=!1,this.imageItemSortOrder=f.S.ASC,this.allImageItemListCurPageStartIndex=1,this.allImageItemListPrevPageStartIndex=1,this.selectedImageItemListCurPageStartIndex=1,this.selectedImageItemListPrevPageStartIndex=1,this.isFilterApplied=!1,this.isShowingQueryFailureAlert=!1,this.isShowingExceedMaxMosaicImageCountAlert=!1,this.isShowingImageSelectionCountAlert=!1,this.isSelectAll=!1,this.arcgisClose=(0,F.lh)(),this.listen("arcgisImageItemFiltersPopoverClose",this.handleImageItemFiltersPopoverClose),this.listen("arcgisImageItemListSettingsPopoverClose",this.handleImageItemListSettingsPopoverClose),this.listen("arcgisImageItemSortPopoverClose",this.handleImageItemSortPopoverClose),this.listen("arcgisImageItemInspectPopoverClose",this.handleImageItemInspectPopoverClose),this.listen("arcgisImageItemSortChangeSave",this.handleImageItemsSortChangeSave),this.listen("arcgisImageItemListSettingsSave",this.handleImageItemListSettingsSave),this.listen("arcgisImageItemToInspectChange",this.handleImageItemToInspectChange),this.listen("arcgisImageItemFilterApply",this.handleImageItemFilterApply)}static{this.properties={activeQueryField:16,selectedAOI:16,activeImageItemListNavTab:16,totalImageItemCount:16,imageItemFeatures:16,selectedImageItemFeatures:16,selectedImageItemFeatureOids:16,imageItemInfo:16,inspectImageItemFeature:16,imageItemCardDisplayedFields:16,isShowingImageItemInspectPopover:16,isShowingListSettingsPopover:16,isShowingFiltersPopover:16,isShowingSortPopover:16,isShowingThumbnails:16,isQueryingImageItems:16,imageItemSortOrder:16,imageItemSortField:16,allImageItemListCurPageStartIndex:16,allImageItemListPrevPageStartIndex:16,selectedImageItemListCurPageStartIndex:16,selectedImageItemListPrevPageStartIndex:16,isFilterApplied:16,currentFilterDetail:16,isShowingQueryFailureAlert:16,isShowingExceedMaxMosaicImageCountAlert:16,isShowingImageSelectionCountAlert:16,isSelectAll:16,portal:0,layer:0,view:0}}static{this.styles=x}async setFocus(){this.refCloseButtonNode.value?.setFocus()}async load(){this.locale=this.messages._t9nLocale,this.loadSavedUIOptionsFromLocalStorage(this.layer.id),this.currentMapExtent=this.view.extent;const{fields:e,sourceJSON:t,mosaicRule:i}=this.layer||{},s=(0,y.g)(e),n=(0,y.a)(s);this.activeQueryField=this.activeQueryField||n,this.imageItemSortField=this.imageItemSortField||n,this.layerInitialMosaicRule=i.clone(),this.imageItemCountPerPage=Math.min(60,t?.maxRecordCount||60),this.handleImageItemInitialQuery(),this.manager.onLifecycle((()=>(0,a.watch)((()=>[this.view.stationary,this.view.extent]),(0,u.sg)((()=>{if(this.view.stationary&&!(0,y.c)(this.currentMapExtent,this.view)){this.fetchAbortController?.abort(),this.isSelectAll=!1;const e=(0,y.b)(this.view);this.currentFilterDetail&&(this.currentFilterDetail.displayExtent=e),this.isFilterApplied?this.handleImageItemFilterQuery(this.currentFilterDetail):this.handleImageItemInitialQuery()}}),300))))}willUpdate(e){e.has("selectedImageItemFeatureOids")&&(this.hasUpdated||this.selectedImageItemFeatureOids?.length>0)&&this.handleSelectedImageItemsChange(this.selectedImageItemFeatureOids),e.has("activeQueryField")&&this.handleDisplayedFieldsInImageItemCardChange(this.activeQueryField)}disconnectedCallback(){super.disconnectedCallback(),(0,y.r)(this.layer,this.layerInitialMosaicRule),this.removeImageItemHighlight()}handleImageItemFiltersPopoverClose(){this.isShowingFiltersPopover=!1}handleImageItemListSettingsPopoverClose(){this.isShowingListSettingsPopover=!1}handleImageItemSortPopoverClose(){this.isShowingSortPopover=!1}handleImageItemInspectPopoverClose(){this.isShowingImageItemInspectPopover=!1}async handleImageItemsSortChangeSave(e){const{sortField:t,sortOrder:i}=e.detail;this.imageItemSortOrder=i,this.imageItemSortField=t;const{currentFilterDetail:s,layer:a,selectedImageItemFeatures:r,selectedImageItemFeatureOids:l}=this,{queryField:o,queryValues:c,isIncludeOverviews:m,displayExtent:d}=s,g="extent"===d?.type?d:n.default.fromJSON(d),I=(0,y.f)({layer:a,queryField:o,queryValues:c,isIncludeOverviews:m,extent:g});if(this.resetAllImageItemListPagination(),this.resetSelectedImageItemListPagination(),this.imageItemFeatures=[],await this.queryImageCollectionItemsAndCount(I),r.length===l.length&&r.every((e=>l.includes(e.attributes[a.objectIdField]))))this.sortSelectedImageItems(r);else{this.selectedImageItemFeatures=[];const e=(0,y.f)({layer:this.layer,isIncludeOverviews:!0,extent:null,selectedImageItemOids:l});await this.queryImageCollectionItemsAndCount(e,!0)}(function(e,t){const i={...A(w(e)),sortingOption:t};$(w(e),i)})(a.id,e.detail),C(a.id,r,l)}handleImageItemListSettingsSave(e){const{selectedFields:t,isShowingThumbnails:i}=e.detail;this.isShowingThumbnails=i,this.imageItemCardDisplayedFields=t.length>0?t:[this.activeQueryField],function(e,t){const i={...A(w(e)),listSettingsOption:t};$(w(e),i)}(this.layer.id,{isShowingThumbnails:i,selectedFields:this.imageItemCardDisplayedFields})}handleImageItemToInspectChange(e){const t=e.detail;this.handleSelectNewImageItemToInspect(t)}handleImageItemFilterApply(e){this.isFilterApplied=!0,this.isSelectAll=!1;const t=e.detail;this.currentFilterDetail=t,this.handleImageItemFilterQuery(t),function(e,t){const i={...A(w(e)),filterOptions:t};$(w(e),i)}(this.layer.id,t)}handleSelectedImageItemsChange(e){this.isSelectAll=this.isSelectAll&&e.length>0||this.allImageItemOids?.every((e=>this.selectedImageItemFeatureOids.includes(e))),0===e.length&&(this.selectedImageItemFeatures=[],(0,y.r)(this.layer,this.layerInitialMosaicRule),this.activeImageItemListNavTab===f.I.SELECT&&this.handleImageItemListNavTabChange(f.I.ALL)),e.length>0&&(this.isShowingImageSelectionCountAlert=e.length>1e3,this.isShowingExceedMaxMosaicImageCountAlert=e.length>this.layer.sourceJSON?.maxMosaicImageCount,!this.isShowingExceedMaxMosaicImageCountAlert&&!this.isShowingImageSelectionCountAlert&&(0,y.l)(this.layer,e)),C(this.layer.id,this.selectedImageItemFeatures,this.selectedImageItemFeatureOids)}handleCloseClick(){b(this.layer.id),this.closeAllPopovers(),this.arcgisClose.emit()}handleImageItemInitialQuery(){const{view:e,layer:t}=this,i=(0,y.b)(e);this.currentFilterDetail=this.currentFilterDetail??{selectedAOI:this.selectedAOI,isIncludeOverviews:!1,displayExtent:i};const{queryField:s,queryValues:a,isIncludeOverviews:n}=this.currentFilterDetail,r=(0,y.f)({layer:t,queryField:s,queryValues:a,isIncludeOverviews:n,extent:i});this.totalImageItemCount=-1,this.imageItemFeatures=[],this.resetAllImageItemListPagination(),this.resetSelectedImageItemListPagination(),this.queryImageCollectionItemsAndCount(r)}async handleImageItemFilterQuery(e){const{selectedAOI:t,queryField:i,queryValues:s,isIncludeOverviews:a,displayExtent:n,isRangeModeEnabled:r}=e,{layer:l}=this;this.selectedAOI=t,this.activeQueryField=i;let o=s;(i&&s&&(0,f.i)(i.type)||"date"===i?.type)&&(o=r?s:s?.[1]?[s[1]]:[]);const c=(0,y.f)({layer:l,queryField:i,queryValues:o,isIncludeOverviews:a,extent:this.selectedAOI===f.A.ALL?null:n});this.totalImageItemCount=-1,this.resetAllImageItemListPagination(),this.imageItemFeatures=[],this.queryImageCollectionItemsAndCount(c)}async queryImageCollectionItemsAndCount(e,t=!1){const{selectedAOI:i,layer:s,view:a,imageItemSortField:n,imageItemSortOrder:r,selectedImageItemFeatureOids:l,selectedImageItemFeatures:o,isSavedImageOidsMerged:c,fetchAbortController:m}=this;this.isShowingQueryFailureAlert=!1,this.isQueryingImageItems=!0,m&&m.abort();try{let m=null;if(this.fetchAbortController=new AbortController,e.orderByFields=[`${n.name} ${r}`],i===f.A.VISIBLE)m=await(0,y.h)(s,a,e),this.totalImageItemCount=m?.features?.length??0,this.allImageItemOids=this.getObjectIdsFromImageItemFeatures(m?.features);else{if(this.totalImageItemCount<0){const t=await(0,y.i)(s,e,this.fetchAbortController?.signal);this.totalImageItemCount=t.length,this.allImageItemOids=t}this.totalImageItemCount>=0&&(e.num=Math.min(5*this.imageItemCountPerPage,this.layer.sourceJSON?.maxRecordCount||this.imageItemCountPerPage),m=await(0,y.j)(s,e,this.fetchAbortController?.signal))}if(!c){if(l?.length>0){const e=this.getOidIntersection(l,this.allImageItemOids);this.selectedImageItemFeatureOids=e,this.selectedImageItemFeatures=o.filter((e=>this.selectedImageItemFeatureOids.includes(e.attributes[s.objectIdField])))}this.isSavedImageOidsMerged=!0}const d=this.allImageItemOids?.every((e=>this.selectedImageItemFeatureOids?.includes(e)));if(this.isSelectAll=d,this.isSelectAll&&(this.selectedImageItemFeatureOids=[...new Set([...this.allImageItemOids,...this.selectedImageItemFeatureOids])]),this.isQueryingImageItems=!1,!(m&&m.features?.length>0))return void(t||(this.imageItemFeatures=[],this.inspectImageItemFeature=void 0));const g=e.start||0,I=t?this.selectedImageItemFeatures.map((e=>e.attributes[s.objectIdField])):this.imageItemFeatures.map((e=>e.attributes[s.objectIdField])),h=m.features.filter((e=>!I.includes(e.attributes[s.objectIdField])));for(let e=0;e<h.length;e++)t?this.selectedImageItemFeatures[g+e]=h[e]:this.imageItemFeatures[g+e]=h[e]}catch(e){const i=(0,f.e)(e);if(this.isQueryingImageItems=i,i)return;this.isShowingQueryFailureAlert=!0,(t?this.selectedImageItemFeatures.some((e=>!!e)):this.imageItemFeatures.some((e=>!!e)))?t?this.selectedImageItemListCurPageStartIndex=this.selectedImageItemListPrevPageStartIndex:this.allImageItemListCurPageStartIndex=this.allImageItemListPrevPageStartIndex:(this.totalImageItemCount=-1,t?this.selectedImageItemFeatures=[]:this.imageItemFeatures=[])}}handleSelectNewImageItemToInspect(e){const t=this.getNewImageItemFeatureToInspect(e);this.inspectImageItemFeature=t,this.refreshImageItemInfo(t)}getNewImageItemFeatureToInspect(e){const{activeImageItemListNavTab:t,inspectImageItemFeature:i,imageItemFeatures:s,layer:a,selectedImageItemFeatures:n}=this,r=t===f.I.ALL?s:n,l=r.findIndex((e=>e.attributes[a.objectIdField]===i?.attributes[a.objectIdField]));return r[("previous"===e?l-1+r.length:l+1)%r.length]}async refreshImageItemInfo(e){const{layer:t}=this,i=await t.getCatalogItemRasterInfo(e?.attributes[t.objectIdField]);this.imageItemInfo=i}handleDisplayedFieldsInImageItemCardChange(e){const{imageItemCardDisplayedFields:t,layer:i,activeQueryField:s}=this;let a=[...t];const n=t.findIndex((t=>t.name===e.name));n>=0&&(a=[...t.splice(n,1),...t]),n<0&&a.length<4&&(a=[e,...t]),(0,y.k)(i,s).forEach((e=>{a.findIndex((t=>t.name===e.name))<0&&a.length<4&&a.push(e)})),this.imageItemCardDisplayedFields=a}handleOpenImageItemFiltersPopover(){const{isShowingFiltersPopover:e}=this;this.closeAllPopovers(),this.isShowingFiltersPopover=!e}handleOpenImageItemListSettingsPopover(){const{isShowingListSettingsPopover:e}=this;this.closeAllPopovers(),this.isShowingListSettingsPopover=!e}handleOpenImageItemSortPopover(){const{isShowingSortPopover:e}=this;this.closeAllPopovers(),this.isShowingSortPopover=!e}closeAllPopovers(){this.isShowingFiltersPopover=!1,this.isShowingImageItemInspectPopover=!1,this.isShowingListSettingsPopover=!1,this.isShowingSortPopover=!1}async highlightImageItem(e){const{view:t,layer:i}=this;this.removeImageItemHighlight();const s=await t.whenLayerView(i);this.highlightImageItemHandler=s.highlight(e)}removeImageItemHighlight(){this.highlightImageItemHandler?.remove()}clearAllImageItemSelections(){this.selectedImageItemFeatures=[],this.selectedImageItemFeatureOids=[]}zoomToSelectedImageItems(e){const{view:t}=this,i=e.filter((e=>!!e));t.goTo(i)}openImageItemInspectPopover(e){const{layer:t,inspectImageItemFeature:i,isShowingImageItemInspectPopover:s}=this,a=e.attributes[t.objectIdField];i?.attributes[t.objectIdField]===a&&s?this.isShowingImageItemInspectPopover=!1:(this.closeAllPopovers(),this.isShowingImageItemInspectPopover=!0),this.removeImageItemHighlight(),this.inspectImageItemFeature=e,this.refreshImageItemInfo(e)}handleSelectAllButtonClick(){const{isSelectAll:e,selectedImageItemFeatureOids:t}=this;this.isSelectAll=!(e&&t.length>0),this.isSelectAll?(this.selectedImageItemFeatures=this.getUniqueImageItems(this.selectedImageItemFeatures,this.imageItemFeatures),this.selectedImageItemFeatureOids=[...new Set([...this.allImageItemOids,...t])]):(this.clearAllImageItemSelections(),this.resetSelectedImageItemListPagination())}async handleAddSelectedImageItemsAsNewLayer(e){if(!e)return;const{layer:t,view:i,activeQueryField:s,imageItemFeatures:a,selectedImageItemFeatures:n}=this,r=(0,f.a)(t.objectIdField,e),c=a.filter((e=>!!e)).map((e=>e.attributes[t.objectIdField]));let m=[];m=e.every((e=>c.includes(e)))?a.filter((i=>!!i&&e.includes(i.attributes[t.objectIdField]))):n.filter((i=>!!i&&e.includes(i.attributes[t.objectIdField])));const g=(0,y.m)(t,s,m),I=m.map((e=>e.geometry)),u=l.executeMany(I);let p;o.isLoaded()||await o.load(),u?.extent&&(p=o.execute(u.extent,this.layer.spatialReference));const v=new d.default({url:t.url,title:g,renderer:t.renderer,definitionExpression:r,useViewTime:!1,rasterFunction:t.rasterFunction,...p?.extent&&{fullExtent:p.extent}}),S=new h.default({method:"lock-raster",lockRasterIds:e});v.mosaicRule=S,i.map?.add(v)}handleImageItemListNavTabChange(e){this.activeImageItemListNavTab=e,this.resetAllImageItemListPagination(),this.resetSelectedImageItemListPagination(),this.isShowingImageItemInspectPopover&&(this.isShowingImageItemInspectPopover=!1)}handleZoomToLayer(){const{view:e,layer:t}=this;t.fullExtent&&e.goTo(t.fullExtent)}handleImageItemListPageChange(e){if(this.activeImageItemListNavTab===f.I.ALL){const t=(0,f.j)(e,this.imageItemCountPerPage,this.totalImageItemCount);if(!this.imageItemFeatures[t-1]){const{queryField:t,queryValues:i,isIncludeOverviews:s,displayExtent:a}=this.currentFilterDetail,n=(0,y.f)({layer:this.layer,queryField:t,queryValues:i,isIncludeOverviews:s,extent:a});n.start=e-1,this.queryImageCollectionItemsAndCount(n)}}if(this.activeImageItemListNavTab===f.I.SELECT){const t=(0,f.j)(e,this.imageItemCountPerPage,this.isSelectAll?this.totalImageItemCount:this.selectedImageItemFeatureOids.length);if(!this.selectedImageItemFeatures[t-1]){const t=(0,y.f)({layer:this.layer,isIncludeOverviews:!0,extent:null,selectedImageItemOids:this.selectedImageItemFeatureOids});t.start=e-1,this.queryImageCollectionItemsAndCount(t,!0)}}}resetAllImageItemListPagination(){this.allImageItemListCurPageStartIndex=1,this.allImageItemListPrevPageStartIndex=1}resetSelectedImageItemListPagination(){this.selectedImageItemListCurPageStartIndex=1,this.selectedImageItemListPrevPageStartIndex=1}getObjectIdsFromImageItemFeatures(e){const{layer:t}=this;return Array.isArray(e)?e.filter((e=>!!e)).map((e=>e.attributes[t.objectIdField])):[]}sortSelectedImageItems(e){const{imageItemSortField:t,imageItemSortOrder:i,locale:s}=this,a=e.sort(((e,a)=>{const n=e.attributes[t.name],r=a.attributes[t.name];return i===f.S.ASC?(0,f.d)(n,r,s):(0,f.d)(r,n,s)}));this.selectedImageItemFeatures=a}getUniqueImageItems(e,t){const i=[...e,...t],s=new Map;return i.forEach((e=>{e&&s.set(e.attributes[this.layer.objectIdField],e)})),Array.from(s.values())}getOidIntersection(e,t){const i=new Set(e);return[...new Set(t)].filter((e=>i.has(e)))}loadSavedUIOptionsFromLocalStorage(e){if(!e)return;const t=(i=e,A(w(i))?.sortingOption);var i;t&&(this.imageItemSortOrder=t.sortOrder,this.imageItemSortField=I.default.fromJSON(t.sortField));const s=function(e){return A(w(e))?.listSettingsOption}(e);s&&(this.imageItemCardDisplayedFields=s.selectedFields.map((e=>I.default.fromJSON(e))),this.isShowingThumbnails=s.isShowingThumbnails);const a=function(e){return A(w(e))?.filterOptions}(e);a&&(this.currentFilterDetail={...a,queryField:I.default.fromJSON(a.queryField)},this.selectedAOI=a.selectedAOI,this.isFilterApplied=!0,this.activeQueryField=I.default.fromJSON(a.queryField));const n=function(e){return A(w(e))?.selectedImageItems}(e);if(n){const e=n.map((e=>c.default.fromJSON(e)));this.selectedImageItemFeatures=e}this.selectedImageItemFeatureOids=function(e){return A(w(e))?.selectedImageItemOids??[]}(e)}handleImageSelectionCountAlertClosed(){this.isShowingImageSelectionCountAlert=!1,this.isShowingExceedMaxMosaicImageCountAlert=!1}handleExceedMaxMosaicImageCountAlertClosed(){this.isShowingExceedMaxMosaicImageCountAlert=!1}handleQueryFailedAlertClosed(){this.isShowingQueryFailureAlert=!1}render(){const{messages:e,locale:t,imageItemInfo:i,inspectImageItemFeature:s,imageItemCardDisplayedFields:a,isShowingThumbnails:n,imageItemSortField:r,imageItemSortOrder:l,isShowingImageItemInspectPopover:o,isShowingListSettingsPopover:c,isShowingSortPopover:m,isShowingFiltersPopover:d,isShowingQueryFailureAlert:g,isShowingExceedMaxMosaicImageCountAlert:I,isShowingImageSelectionCountAlert:h,layer:u,view:p}=this,S=!u?.loaded;return v.qy`<calcite-panel .loading=${S} .heading=${e.imageCollectionExplorer} class="panel">${this.renderPanelCloseButton()}${this.renderActionBar()}${this.renderImageItemList()}</calcite-panel><arcgis-imagery-item-filters-popover .locale=${t} .layer=${u} .view=${p} .referenceElement=${this.el} .messages=${e} .open=${d} .currentFilterDetail=${this.currentFilterDetail}></arcgis-imagery-item-filters-popover><arcgis-imagery-item-list-settings-popover .referenceElement=${this.el} .messages=${e} .fields=${(0,y.g)(u.fields)} .preselectedFields=${a} .isShowingThumbnails=${n} .open=${c}></arcgis-imagery-item-list-settings-popover><arcgis-imagery-item-sort-popover .open=${m} .referenceElement=${this.el} .messages=${e} .fields=${u.fields} .preselectedSortField=${r} .preselectedSortOrder=${l}></arcgis-imagery-item-sort-popover><arcgis-imagery-item-details-popover .layer=${u} .view=${p} .referenceElement=${this.el} .messages=${e} .open=${o} .imageItemInfo=${i} .imageItemFeatureGraphic=${s}></arcgis-imagery-item-details-popover>${this.renderAlert("",e.filterFailedErrorMessage,f.k.DANGER,g,this.handleQueryFailedAlertClosed)}${this.renderAlert("",e.exceedMaxMosaicImageCountWarningMessage,f.k.WARNING,I&&!h,this.handleExceedMaxMosaicImageCountAlertClosed)}${this.renderAlert("",e.imageSelectionCountWarningMessage,f.k.WARNING,h,this.handleImageSelectionCountAlertClosed)}`}renderPanelCloseButton(){const{messages:e}=this;return v.qy`<calcite-action .text=${e.close} icon=x slot=header-actions-end @click=${this.handleCloseClick} ${(0,S.K)(this.refCloseButtonNode)}></calcite-action>`}renderActionBar(){const{messages:e,imageItemSortOrder:t,imageItemSortField:i,isShowingFiltersPopover:s,isShowingListSettingsPopover:a,isShowingSortPopover:n}=this,r=t===f.S.ASC;return v.qy`<calcite-action-bar slot=action-bar expanded expand-disabled layout=horizontal scale=l><calcite-action icon=sliders text title=${e.filters??v.s6} .active=${s} @click=${this.handleOpenImageItemFiltersPopover}></calcite-action><calcite-action icon=list text title=${e.listSettings??v.s6} .active=${a} @click=${this.handleOpenImageItemListSettingsPopover}></calcite-action><div class="sort-image-item-action-wrapper"><calcite-action .icon=${r?"sort-ascending":"sort-descending"} text-enabled .text=${`${e.sortBy} ${i?.name}`} title=${(r?e.sortImageItemAscendingOrder:e.sortImageItemDescendingOrder)??v.s6} .active=${n} @click=${this.handleOpenImageItemSortPopover}></calcite-action></div></calcite-action-bar>`}renderImageItemListTabs(){const{messages:e,activeImageItemListNavTab:t,selectedImageItemFeatureOids:i}=this,s=i.length>0;return v.qy`<calcite-tabs layout=center><calcite-tab-nav slot=title-group><calcite-tab-title .selected=${t===f.I.ALL} @click=${()=>this.handleImageItemListNavTabChange(f.I.ALL)}>${e.all}</calcite-tab-title><calcite-tab-title .selected=${t===f.I.SELECT} .disabled=${!s} @click=${()=>this.handleImageItemListNavTabChange(f.I.SELECT)}>${e.selected}</calcite-tab-title></calcite-tab-nav></calcite-tabs>`}renderImageItemList(){const{messages:e,isQueryingImageItems:t,totalImageItemCount:i,selectedImageItemFeatureOids:s,imageItemFeatures:a,activeImageItemListNavTab:n}=this;if(t)return v.qy`<calcite-loader .label=${e.loading} scale=m></calcite-loader>`;const r=n===f.I.ALL?i>0&&a?.length>0:s.length>0;return v.qy`<div class="image-item-list-container">${this.renderImageItemListTabs()}${s?.length>0&&this.renderImageItemListSelectionButtonGroup()||""}${!r&&this.renderNoImageItemFetchedCoachMessage()||""}${r&&this.renderImageItemListPaginationInfo()||""}${r&&this.renderImageItemCardList()||""}${r&&this.renderImageItemListPagination()||""}</div>`}renderSelectedImageItemCount(){const{messages:e,selectedImageItemFeatureOids:t}=this,i=t.length,s=e.selectedImageItemCountInfo.replace("${selectedCount}",`${i}`);return i>0&&v.qy`<calcite-chip .label=${s} kind=brand closable @calciteChipClose=${()=>this.clearAllImageItemSelections()}>${s}</calcite-chip>`||""}renderImageItemListSelectionButtonGroup(){const{messages:e,selectedImageItemFeatures:t,selectedImageItemFeatureOids:i}=this;return v.qy`<div class="image-item-list-selection-button-wrapper">${this.renderSelectedImageItemCount()}<div style=${(0,F.zl)({display:"flex"})}><calcite-button .label=${e.addToMap} appearance=transparent icon-start=add-layer kind=neutral scale=s title=${e.addToMap??v.s6} @click=${()=>this.handleAddSelectedImageItemsAsNewLayer(i)}></calcite-button><calcite-button .label=${e.zoomToSelection} appearance=transparent icon-start=zoom-to-object kind=neutral scale=s title=${e.zoomToSelection??v.s6} @click=${()=>this.zoomToSelectedImageItems(t)}></calcite-button></div></div>`}renderImageItemListPaginationInfo(){const{messages:e,activeImageItemListNavTab:t,totalImageItemCount:i,allImageItemListCurPageStartIndex:s,selectedImageItemListCurPageStartIndex:a,selectedImageItemFeatureOids:n}=this,r=t===f.I.ALL?i:n.length,l=t===f.I.ALL?s:a,o=(0,f.j)(l,this.imageItemCountPerPage,r),c=e.imageItemPaginationAndTotalCountInfo.replace("${totalCount}",`${r}`).replace("${start}",`${l}`).replace("${end}",`${o}`);return v.qy`<div class="list-pagination-info-wrapper"><div>${c}</div>${t===f.I.ALL&&this.renderSelectAllButton()||""}</div>`}renderSelectAllButton(){const{messages:e,isSelectAll:t}=this;return v.qy`<calcite-button name=select-all kind=brand appearance=transparent @click=${this.handleSelectAllButtonClick}>${t?e.deselectAll:e.selectAll}</calcite-button>`}renderImageItemCardList(){const{messages:e,activeImageItemListNavTab:t,imageItemFeatures:i,selectedImageItemFeatures:s,selectedImageItemFeatureOids:a,layer:n,isShowingThumbnails:r,allImageItemListCurPageStartIndex:l,selectedImageItemListCurPageStartIndex:o,inspectImageItemFeature:c,isShowingImageItemInspectPopover:m}=this,d=t===f.I.ALL?i:s,g=t===f.I.ALL?l:o,I=(0,f.j)(g,this.imageItemCountPerPage,d.length),h=d?.slice(g-1,I).map((t=>{if(!t)return null;const i=t.attributes[n.objectIdField],l=this.isSelectAll||this.selectedImageItemFeatureOids.includes(i),o=m&&c?.attributes[n.objectIdField]===i;return v.qy`<li @mouseover=${()=>this.highlightImageItem(t)} @mouseout=${this.removeImageItemHighlight}><calcite-card><div class="image-item-info-container">${r?this.renderPreviewThumbnail(i):null}<div class="image-item-info-text-section"><div>${t.attributes.Name||t.attributes.name}</div>${this.renderFeatureAttributesInImageItemCard(t)}</div></div><div slot=footer-start style=${(0,F.zl)({"flex-wrap":"wrap"})}><calcite-button kind=neutral icon-start=information .appearance=${o?"solid":"transparent"} title=${e.viewImageDetails??v.s6} @click=${()=>this.openImageItemInspectPopover(t)}></calcite-button><calcite-button kind=neutral icon-start=zoom-to-object appearance=transparent title=${e.zoomToImage??v.s6} @click=${()=>this.zoomToSelectedImageItems([t])}></calcite-button><calcite-button kind=neutral icon-start=add-layer appearance=transparent title=${e.addImageToMap??v.s6} @click=${()=>this.handleAddSelectedImageItemsAsNewLayer([i])}></calcite-button></div><div slot=footer-end><calcite-button .appearance=${l?"solid":"outline"} kind=neutral .iconEnd=${l?"x":""} @click=${()=>{l&&this.isSelectAll&&(this.isSelectAll=!1);const e=l?s.filter((e=>e?.attributes[n.objectIdField]!==i)):[...s,t];this.sortSelectedImageItems(e);const r=l?a.filter((e=>e!==i)):[...a,i];this.selectedImageItemFeatureOids=r}}>${l?e.selected:e.select}</calcite-button></div></calcite-card></li>`}));return v.qy`<ul class="image-item-card-list">${h}</ul>`}renderPreviewThumbnail(e){const{layer:t}=this,i=m.default.findCredential(t.url),{token:s}=i||{},a=`${t.url}/${e}/thumbnail${s?`?token=${s}`:""}`;return v.qy`<img src=${a??v.s6}>`}renderFeatureAttributesInImageItemCard(e){const{imageItemCardDisplayedFields:t,layer:i,view:s}=this,a=t.map((t=>{let a=e.attributes[t.name];if("date"===t.type&&a){const{fieldInfos:e}=i.popupTemplate??{},n=Array.isArray(e)&&e.find((e=>e.fieldName===t.name));a=r.formatDate(a,{...r.convertDateFormatToIntlOptions(n&&n.format?.dateFormat?n.format.dateFormat:"short-date-short-time"),timeZone:s?.timeZone||"system"})}if((0,f.c)(t)){const e=t.domain;a="function"==typeof e.getName?e.getName(a):g.default.fromJSON(t.domain).getName(a)}if(Number.isFinite(a)&&!(0,f.c)(t)&&(0,f.i)(t.type)){const{fieldInfos:e}=i.popupTemplate??{},s=Array.isArray(e)&&e.find((e=>e.fieldName===t.name));if(s){const{digitSeparator:e,places:t}=s.format??{},i=r.convertNumberFormatToIntlOptions({style:"decimal",places:t,digitSeparator:e});a=r.formatNumber(a,i)}}return v.qy`<li>${`${t.name} : ${a??""}`}</li>`}));return v.qy`<ul class="image-item-card-displayed-field-list">${a}</ul>`}renderImageItemListPagination(){const{messages:e,activeImageItemListNavTab:t,totalImageItemCount:i,allImageItemListCurPageStartIndex:s,selectedImageItemListCurPageStartIndex:a,selectedImageItemFeatureOids:n}=this,r=t===f.I.ALL?i:n.length,l=t===f.I.ALL?s:a;return v.qy`<div class="pagination-wrapper"><calcite-pagination @calcitePaginationChange=${e=>{const i=e.target;t===f.I.ALL&&(this.allImageItemListPrevPageStartIndex=this.allImageItemListCurPageStartIndex,this.allImageItemListCurPageStartIndex=i.startItem,this.handleImageItemListPageChange(this.allImageItemListCurPageStartIndex)),t===f.I.SELECT&&(this.selectedImageItemListPrevPageStartIndex=this.selectedImageItemListCurPageStartIndex,this.selectedImageItemListCurPageStartIndex=i.startItem,this.handleImageItemListPageChange(this.selectedImageItemListCurPageStartIndex))}} .startItem=${l} .totalItems=${r} .pageSize=${this.imageItemCountPerPage} .messageOverrides=${{next:e.next,previous:e.previous}} class=${(0,F.CP)({hide:!r||r<this.imageItemCountPerPage})}></calcite-pagination></div>`}renderNoImageItemFetchedCoachMessage(){const{messages:e,isFilterApplied:t}=this;return v.qy`<div class="no-image-item-coach-wrapper"><calcite-icon scale=l icon=overview></calcite-icon>${t?e.updateFilterOrZoomToBrowseImages:e.zoomToBrowseImages}${t?v.qy`<calcite-button kind=neutral appearance=outline @click=${this.handleOpenImageItemFiltersPopover}>${e.updateFilters}</calcite-button>`:v.qy`<calcite-button kind=neutral appearance=outline @click=${this.handleZoomToLayer}>${e.zoomToImages}</calcite-button>`}</div>`}renderAlert(e,t,i,s,a){return v.qy`<calcite-alert .kind=${i} .label=${e} .open=${s} icon=exclamation-mark-circle auto-close auto-close-duration=fast @calciteAlertClose=${a}><div slot=title>${e}</div><div slot=message>${t}</div></calcite-alert>`}}(0,s.c)("arcgis-imagery-collection-explorer",L)},6024:(e,t,i)=>{i.d(t,{u:()=>g});var s=i(310);const a=(e,{host:t,key:i,isReactive:a},n)=>{const r=t,l=r[i]!==e.exports,o=r[i]!==n,c=n!==e.exports;l&&!o&&c&&(r[i]=e.exports);if(t===e.component){if(a){const t=e.component.manager;o&&t.W(e,r[i]),e.onUpdate((s=>{if(s.has(i)){const s=r[i];s!==e.exports&&t.W(e,s)}}))}e.O=a?void 0:i}const m=e.component.constructor.elementProperties.get(i)?.readOnly;e.watchExports((()=>{r[i]!==e.exports&&(m?(0,s.h)((()=>{r[i]=e.exports})):r[i]=e.exports)}))};i(9722);var n=i(7274);const r=e=>o(void 0,e);class l extends s.C{constructor(e,t){super(e);const i=this.exports;try{(0,s.s)(this.component);const e=t(this.component,this),a=this.exports!==i;if((0,s.i)(e)){a||this.setProvisionalExports(e);const t=e.then((e=>{this.exports=e,super.catchUpLifecycle()})).catch((e=>{this.P.reject(e),console.error(e)}));this.onLoad((async()=>await t))}else a&&void 0===e||(this.exports=e),queueMicrotask((()=>super.catchUpLifecycle()))}catch(e){this.P.reject(e),console.error(e)}}catchUpLifecycle(){}}const o=(c=l,(...e)=>{const t=(0,s.e)(),i=new c(...e),n=i.exports;(0,s.d)(t.at(-1));const r=i.component.manager;r.W(i,n),i.watchExports(r.W.bind(r,i)),(0,s.o)(i);const l=[i.component,...t].reverse();return(0,s.t)(l,(e=>void 0===e?void 0:a(i,e,n)),n)});var c;s.C;const m=(e,t)=>{if(!t)return e;const i={...e};return Object.entries(t).forEach((([t,s])=>{i[t]="object"==typeof s?m(e[t],s):s??e[t]})),i};var d=i(3174);const g=(I=d.g,(e={})=>r(((t,i)=>{const s=(0,n.kn)(t.el),a={_lang:s.lang,_t9nLocale:s.t9nLocale,_loading:!0},r=t;i.onLifecycle((()=>(0,n.hd)(t.el,(()=>I("./assets")),(({t9nLocale:e,t9nStrings:s,lang:a})=>{const n={...s,_lang:a,_t9nLocale:e,_loading:!1};i.exports=n;const o=s.componentLabel;"string"==typeof o&&"label"in t&&null==t.label&&(t.label??=o),l(r.messageOverrides)}),e.name)));const l=e=>{const t=i.exports,s=t._original??t,a=m(s,e);e&&(a._original=s),i.exports=a};return"messageOverrides"in r&&i.onUpdate((e=>{e.has("messageOverrides")&&l(r.messageOverrides)})),e.blocking?(i.setProvisionalExports(a,!1),i.ready):a})));var I},7960:(e,t,i)=>{i.d(t,{_:()=>I,K:()=>p});var s=i(7513),a=i(5987),n=i(3715);const r=(e,t)=>{const i=e._$AN;if(void 0===i)return!1;for(const e of i)e._$AO?.(t,!1),r(e,t);return!0},l=e=>{let t,i;do{if(void 0===(t=e._$AM))break;i=t._$AN,i.delete(e),e=t}while(0===i?.size)},o=e=>{for(let t;t=e._$AM;e=t){let i=t._$AN;if(void 0===i)t._$AN=i=new Set;else if(i.has(e))break;i.add(e),d(t)}};function c(e){void 0!==this._$AN?(l(this),this._$AM=e,o(this)):this._$AM=e}function m(e,t=!1,i=0){const s=this._$AH,a=this._$AN;if(void 0!==a&&0!==a.size)if(t)if(Array.isArray(s))for(let e=i;e<s.length;e++)r(s[e],!1),l(s[e]);else null!=s&&(r(s,!1),l(s));else r(this,e)}const d=e=>{e.type==n.OA.CHILD&&(e._$AP??=m,e._$AQ??=c)};class g extends n.WL{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,i){super._$AT(e,t,i),o(this),this.isConnected=e._$AU}_$AO(e,t=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),t&&(r(this,e),l(this))}setValue(e){if((0,a.Rt)(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}const I=()=>new h;class h{}const u=new WeakMap,p=(0,n.u$)(class extends g{render(e){return s.s6}update(e,[t]){const i=t!==this.G;return i&&void 0!==this.G&&this.rt(void 0),(i||this.lt!==this.ct)&&(this.G=t,this.ht=e.options?.host,this.rt(this.ct=e.element)),s.s6}rt(e){if(this.isConnected||(e=void 0),"function"==typeof this.G){const t=this.ht??globalThis;let i=u.get(t);void 0===i&&(i=new WeakMap,u.set(t,i)),void 0!==i.get(this.G)&&this.G.call(this.ht,void 0),i.set(this.G,e),void 0!==e&&this.G.call(this.ht,e)}else this.G.value=e}get lt(){return"function"==typeof this.G?u.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}})}}]);