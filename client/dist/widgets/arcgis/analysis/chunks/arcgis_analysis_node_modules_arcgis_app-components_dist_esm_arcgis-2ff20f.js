/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-2ff20f"],{6750:(e,t,i)=>{function a(e){var t,i;const{dataLayer:a,type:n,sourceDataLayer:s}=e,l=null!==(t=null==a?void 0:a.geometryType)&&void 0!==t?t:null===(i=null==a?void 0:a.layerInfo)||void 0===i?void 0:i.geometryType,o="table"===(null==s?void 0:s.type.toLowerCase()),r=null==a?void 0:a.type;if("Microsoft Excel"===n||"CSV"===n){if(("address"===a.locationType&&a.addressFields||"coordinates"===a.locationType)&&"esriGeometryPoint"===(null==s?void 0:s.geometryType))return null;if(!l||"none"===a.locationType||o)return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==s?void 0:s.geometryType)!==l)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else{if((null==s?void 0:s.geometryType)!==(null==a?void 0:a.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"};if(o&&"table"===r.toLowerCase())return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if(o)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}}function n(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||("esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>n,v:()=>a})},35536:(e,t,i)=>{i.d(t,{a:()=>l});var a=i(50637),n=i(52763),s=i(32710);async function l(e){var t,i,l;const o=(0,n.g)(e),r=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,a.r)(r,o,{},"post"),{status:i,recordCount:n}=await(0,s.g)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:i,recordCount:n}}}catch(e){let t="unhandledError";const a={error:e},n=(null===(i=a.error.description)||void 0===i?void 0:i.toLowerCase())||(null===(l=a.error.message)||void 0===l?void 0:l.toLowerCase());switch(!0){case n.includes("the create unique index statement terminated because a duplicate key was found for the object name"):t="invalidUniqueIdentifier";break;case n.includes("does not allow nulls"):t="cannotAddNullData";break;case n.includes("the value violates the maxlength limit of this column"):t="exceededMaxFieldLength";break;case n.includes("input string was not in a correct format"):t="invalidFieldType"}return console.error(e),{error:{code:t,message:JSON.stringify(e)}}}}},45831:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>y});var a=i(87849),n=i(35536),s=i(90470),l=i(43555),o=i(3826),r=i(95878),d=i(6750),p=i(52763),c=i(50020),u=i(59317);i(50637),i(931),i(93814),i(87744),i(32710),i(83929),i(76246),i(63054),i(15912),i(24869),i(72257),i(37762),i(86562),i(15332),i(75294),i(38295),i(51102),i(56175),i(50822),i(60743),i(11163),i(8214),i(66111),i(26854),i(31544),i(44069);const y=class{constructor(e){(0,a.r)(this,e),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,a.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,a.c)(this,"newItemPrevPage",7),this.newItemSetButtonState=(0,a.c)(this,"newItemSetButtonState",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===r.u.workflow?"attribute":"uploaded",this.i18n=r.u.i18n.appendSelectUpdateType,"append"===r.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,d.v)({dataLayer:o.a.dataLayer,type:o.a.type,sourceDataLayer:o.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),r.u.nextText="updateAppend",this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!1}})}async handleNext(){const e=this.selected;if("update"===r.u.workflow){o.a.addUpdateItemPropertiesOption=e;const t="uploaded"!==e;o.a.keepDescription=t,this.handleUpdate()}else o.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=r.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:a,fileName:n}=o.a,l=await(0,c.f)(a.owner,a.portal),d=(0,c.g)(l,a.portal),p=await(0,s.u)(a,d,{file:e,overwrite:t,keepDescription:i,fileName:n});p.success?this.workflowComplete.emit({success:p.success}):(this.loading=!1,this.error={title:r.u.i18n.error,description:r.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e,t;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=r.u.i18n.append.appendLoadingMessages.appendCloseNotice;const i=await(0,n.a)({portal:null===u.c||void 0===u.c?void 0:u.c.portal,sourceDataLayer:o.a.sourceDataLayer,existingItem:o.a.existingItem,timezone:o.a.timezone,analyzeResults:o.a.analyzeResults,type:o.a.type,fieldMappings:o.a.fieldMappings,dataLayer:o.a.dataLayer,id:o.a.id,uidPair:o.a.uidPair,addAppendSelectOption:o.a.addAppendSelectOption,attachmentsEnabled:o.a.attachmentsEnabled,insertAttachmentsEnabled:o.a.insertAttachmentsEnabled,featureAttachmentOption:o.a.featureAttachmentOption});if("completed"!==(null===(e=null==i?void 0:i.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,p.h)(null!==(t=null==i?void 0:i.error)&&void 0!==t?t:{code:"unhandledError"},{appendErrorMessages:r.u.i18n.append.appendErrorMessages});else{await(0,l.d)(o.a.id,{permanentDelete:!0});const e=Object.assign({appendType:o.a.addAppendSelectOption,insertAttachmentsEnabled:o.a.insertAttachmentsEnabled},i);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:n,error:s}=this;let l=t,d=e.header,p="appendOptions";return"update"===r.u.workflow&&(l=i,d=e.itemPropertiesHeader,p="updateOptions"),"Raster function template"===o.a.type&&(p="updateRFTOptions"),(0,a.h)(a.H,{key:"2154a59c986e791c5a0c944040454a6e34b988b4",class:{"overflow-hidden":this.loading}},(0,a.h)("arcgis-new-item-description",{key:"dd4b1c9cadbb741f8783f3384f97cc261cf0e290",header:d}),(0,a.h)("div",{key:"7579d9102c7f6195ce8571e6a5f6aa468b0b4f20",class:"w-full"},(0,a.h)("div",{key:"42bf8e3b17e34eb7076e2c939158cc2fcd8f66cc",class:"w-full"},(0,a.h)("calcite-tile-group",{key:"b2ca803a2f5de94a295680bf3c319e800d57a1c0",layout:"vertical",class:"tile-select",label:d,selectionMode:"single-persist"},Object.keys(l).map((t=>{const{icon:i}=l[t];return(0,a.h)("calcite-tile",{key:t,selected:this.selected===t,heading:e[p][t].title,description:e[p][t].description,icon:i,"input-enabled":!0,"data-value":t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelect:e=>this.selected=e.target.dataset.value})}))))),"append"===r.u.workflow&&this.cannotUpdateGeometry&&(0,a.h)("calcite-notice",{key:"44aefa683aae3485d1a664e4803345ff53a71b54",class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,a.h)("div",{key:"03f1daec7dce564352b3e04cdb1ee196e7389b1e",slot:"title"},e[n.title]),(0,a.h)("div",{key:"209d900d1aae19d61883fbe58b4841fcc1b46596",slot:"message"},e[n.description])),(0,a.h)("arcgis-new-item-loader",{key:"9bfce21a9397ca0c174929a49603c1db0e470f21",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,a.h)("arcgis-new-item-alert",{key:"2968ffa477ef132d77e1f90f16e731f75de1c4c9",heading:null==s?void 0:s.title,description:null==s?void 0:s.description,link:{href:null==s?void 0:s.link,title:null==s?void 0:s.linkText},active:!!s,onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.a)(this)}};y.style=".div-w-full{width:100%}.tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}calcite-tile-group{inline-size:100%}calcite-tile{max-inline-size:100%;min-inline-size:100%}"},52763:(e,t,i)=>{i.d(t,{a:()=>p,c:()=>r,g:()=>d,h:()=>c});var a=i(3826),n=i(8214),s=i(15912),l=i(95878),o=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(i[a[n]]=e[a[n]])}return i};function r(e,t){var i;const a=(null==e?void 0:e.type)||null,n=(null==t?void 0:t.type)||null;return n&&(n===a||(null===(i={esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger"],esriFieldTypeInteger:["esriFieldTypeInteger","esriFieldTypeSmallInteger"],esriFieldTypeSingle:["esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeDouble","esriFieldTypeSingle","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeDate","esriFieldTypeGUID","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeBigInteger"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeOID:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger"],esriFieldTypeGlobalID:["esriFieldTypeGlobalID","esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDateOnly:["esriFieldTypeDateOnly"],esriFieldTypeTimeOnly:["esriFieldTypeTimeOnly"],esriFieldTypeTimestampOffset:["esriFieldTypeTimestampOffset"],esriFieldTypeBigInteger:["esriFieldTypeBigInteger"]}[a])||void 0===i?void 0:i.includes(n)))}function d(e){var t;const{timezone:i,analyzeResults:r,type:d,fieldMappings:p,dataLayer:c,id:u,portal:y,uidPair:m,addAppendSelectOption:g,sourceDataLayer:h,attachmentsEnabled:f,insertAttachmentsEnabled:T,featureAttachmentOption:b}=e;let v,F;const{publishParameters:w}=r,O=o(r,["publishParameters"]),I="upsert"===g||"update"===g,k=function(e){const t=e.filter((e=>e.source!==`<${l.u.i18n.appendKeyValuePair.noneField}>`)),i=t.map((({source:e,name:t})=>({source:e,name:t})));return i}(p),M=function(e){const t=e.map((e=>e.name));return t}(k),D={dateFieldsTimeReference:Object.assign(Object.assign({},(null==y?void 0:y.isPortal)?{timezone:i||"UTC"}:{ianaTimeZone:i||"GMT"}),{respectsDaylightSaving:!0})},S={sourceTableName:c.name,fieldMappings:(null==k?void 0:k.length)?JSON.stringify(k):null,upsert:I,skipInserts:"update"===g,skipUpdates:!1,useGlobalIds:I&&"esriFieldTypeGlobalID"===(null==m?void 0:m.type),updateGeometry:!I||"attributeAndGeometry"===a.a.addAppendSelectUpdateTypeOption,appendFields:M.length?JSON.stringify(M):null,appendItemId:u,appendUploadFormat:s.a[a.a.type].appendUploadFormat,rollbackOnFailure:!0};"Table"===h.type&&(w.locationType="none");const A=o(w,["layers"]);if("CSV"===d)w.layerInfo.dateFieldsTimeReference=D.dateFieldsTimeReference,F=Object.assign(Object.assign(Object.assign({},D),w),O);else if("Microsoft Excel"===d){const e=function(e,t){const i=Object.assign({},e);i.locationType=(null==t?void 0:t.locationType)||e.locationType,"address"===i.locationType?(i.addressFields=t.addressFields,i.sourceCountry=t.sourceCountry):"coordinates"===i.locationType&&(i.coordinateFieldType=t.coordinateFieldType,"LatitudeAndLongitude"===i.coordinateFieldType?(i.latitudeFieldName=t.latitudeFieldName,i.longitudeFieldName=t.longitudeFieldName):i.coordinateFieldName=t.coordinateFieldName);return i}((0,n.a)({},!0),A);e.dateFieldsTimeReference=D.dateFieldsTimeReference,A.name=c.name,F=Object.assign(Object.assign(Object.assign(Object.assign({},D),{layers:[e]}),A),O)}else F=Object.assign(Object.assign(Object.assign({},D),w),O);return v=Object.assign(Object.assign(Object.assign({},S),{appendSourceInfo:JSON.stringify(F)}),f&&function({insertAttachmentsEnabled:e}){return e?{skipAttachmentInserts:!1,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}:{skipAttachmentInserts:!0,skipAttachmentUpdates:!0,skipAttachmentDeletes:!0}}({appendType:g,insertAttachmentsEnabled:T,featureAttachmentOption:b})),"add"===g?v.upsertMatchingField=h.objectIdField||(null===(t=h.uniqueField)||void 0===t?void 0:t.name):I&&(null==m?void 0:m.isUniqueIndex)&&(v.upsertMatchingField=null==m?void 0:m.name),v}function p(e,t,i){return"File Geodatabase"===e&&i.hasAttachments&&t.hasAttachments}function c(e,t){const i=t.appendErrorMessages;let a=l.u.i18n.error,n=i.appendError;switch(e.code){case"invalidUniqueIdentifier":a=i.invalidUniqueIdentifier.title,n=i.invalidUniqueIdentifier.description;break;case"cannotAddNullData":a=i.cannotAddNullData.title,n=i.cannotAddNullData.description;break;case"exceededMaxFieldLength":a=i.exceededMaxFieldLength.title,n=i.exceededMaxFieldLength.description;break;case"invalidFieldType":a=i.invalidFieldType.title,n=i.invalidFieldType.description}return{title:a,description:n}}}}]);