/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_overwr-38ed4d.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_overwr-38ed4d"],{11163:(e,r,t)=>{t.d(r,{D:()=>a,T:()=>l,a:()=>u,b:()=>d,c:()=>g,d:()=>s,e:()=>o,f:()=>i,g:()=>c,p:()=>p,t:()=>n});const i=["standard","custom"],n=["IntegratedMesh","3DObject"],a=n[0],s=["vector","raster","3dTiles"],l=147914382,o=0,c=[{level:0,label:"1:591,657,528",scale:591657527.591555},{level:1,label:"1:295,828,764",scale:295828763.795777},{level:2,label:"1:147,914,382",scale:147914381.897889},{level:3,label:"1:73,957,191",scale:73957190.948944},{level:4,label:"1:36,978,595",scale:36978595.474472},{level:5,label:"1:18,489,298",scale:18489297.737236},{level:6,label:"1:9,244,649",scale:9244648.868618},{level:7,label:"1:4,622,324",scale:4622324.434309},{level:8,label:"1:2,311,162",scale:2311162.217155},{level:9,label:"1:1,155,581",scale:1155581.108577},{level:10,label:"1:577,791",scale:577790.554289},{level:11,label:"1:288,895",scale:288895.277144},{level:12,label:"1:144,448",scale:144447.638572},{level:13,label:"1:72,224",scale:72223.819286},{level:14,label:"1:36,112",scale:36111.909643},{level:15,label:"1:18,056",scale:18055.954822},{level:16,label:"1:9,028",scale:9027.977411},{level:17,label:"1:4,514",scale:4513.988705},{level:18,label:"1:2,257",scale:2256.994353},{level:19,label:"1:1,128",scale:1128.497176},{level:20,label:"1:564",scale:564.248588},{level:21,label:"1:282",scale:282.124294},{level:22,label:"1:141",scale:141.062147}],u={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:256,cols:256,dpi:96,preciseDpi:96,lods:[{level:0,resolution:156543.033928,scale:591657527.591555},{level:1,resolution:78271.5169639999,scale:295828763.795777},{level:2,resolution:39135.7584820001,scale:147914381.897889},{level:3,resolution:19567.8792409999,scale:73957190.948944},{level:4,resolution:9783.93962049996,scale:36978595.474472},{level:5,resolution:4891.96981024998,scale:18489297.737236},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.99245256249,scale:4622324.434309},{level:8,resolution:611.49622628138,scale:2311162.217155},{level:9,resolution:305.748113140558,scale:1155581.108577},{level:10,resolution:152.874056570411,scale:577790.554289},{level:11,resolution:76.4370282850732,scale:288895.277144},{level:12,resolution:38.2185141425366,scale:144447.638572},{level:13,resolution:19.1092570712683,scale:72223.819286},{level:14,resolution:9.55462853563415,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.38865713397468,scale:9027.977411},{level:17,resolution:1.19432856685505,scale:4513.988705},{level:18,resolution:.597164283559817,scale:2256.994353},{level:19,resolution:.298582141647617,scale:1128.497176},{level:20,resolution:.14929107082380833,scale:564.248588},{level:21,resolution:.07464553541190416,scale:282.124294},{level:22,resolution:.03732276770595208,scale:141.062147}]},p={spatialReference:{wkid:102100,latestWkid:3857},origin:{x:-20037508.342787,y:20037508.342787},rows:512,cols:512,dpi:96,preciseDpi:96,lods:[{level:0,resolution:78271.51696399994,scale:295828763.795777},{level:1,resolution:39135.75848200009,scale:147914381.897889},{level:2,resolution:19567.87924099992,scale:73957190.948944},{level:3,resolution:9783.93962049996,scale:36978595.474472},{level:4,resolution:4891.96981024998,scale:18489297.737236},{level:5,resolution:2445.98490512499,scale:9244648.868618},{level:6,resolution:1222.992452562495,scale:4622324.434309},{level:7,resolution:611.4962262813797,scale:2311162.217155},{level:8,resolution:305.74811314055756,scale:1155581.108577},{level:9,resolution:152.87405657041106,scale:577790.554289},{level:10,resolution:76.43702828507324,scale:288895.277144},{level:11,resolution:38.21851414253662,scale:144447.638572},{level:12,resolution:19.10925707126831,scale:72223.819286},{level:13,resolution:9.554628535634155,scale:36111.909643},{level:14,resolution:4.77731426794937,scale:18055.954822},{level:15,resolution:2.388657133974685,scale:9027.977411},{level:16,resolution:1.1943285668550503,scale:4513.988705},{level:17,resolution:.5971642835598172,scale:2256.994353},{level:18,resolution:.29858214164761665,scale:1128.497176},{level:19,resolution:.14929107082380833,scale:564.248588},{level:20,resolution:.07464553541190416,scale:282.124294},{level:21,resolution:.03732276770595208,scale:141.062147},{level:22,resolution:.01866138385297604,scale:70.5310735},{level:23,resolution:.009330691929342804,scale:35.265536760789715}]},d={format:"indexedVector",compressionQuality:0,antialiasing:!1},g={format:"PNG32",compressionQuality:0,antialiasing:!0}},26854:(e,r,t)=>{t.d(r,{a:()=>o,c:()=>c,g:()=>a,h:()=>n,i:()=>s,r:()=>l});var i=t(15332);function n(e){const r=document.createElement("textarea");return r.innerHTML=e,r.innerText}function a(e){return function(e){return null==e?void 0:e.replace(/&#10;&#13;|&#10;|&#13;|\r\n|\r|\n/g,"<br>")}(function(e){return null==e?void 0:e.replace(/(?:\r)/g,"&#10;").replace(/(?:\n)/g,"&#13;")}(function(e){return null==e?void 0:e.replace(/(https?:\/\/[^\s]+)/g,(e=>`<a href="${e}" target="_blank">${e}</a>`))}(function(e){return null==e?void 0:e.replace(/(?:&#10;)/g,"\r").replace(/(?:&#13;)/g,"\n")}(e))))}function s(e){return e.replace(/\$\{startSup\}/g,"<sup>").replace(/\$\{endSup\}/g,"</sup>")}function l(e,r,t){return e.replace(/\$\{startLink\}/g,`<calcite-link label="${t}" href="${r}" target="_blank">`).replace(/\$\{endLink\}/g,"</calcite-link>")}function o(e){return e.replace(/\$\{startStrong\}/g,"<strong>").replace(/\$\{endStrong\}/g,"</strong>")}function c(e){return(0,i.s)((null==e?void 0:e.trim())||"").replace(/[!*+\-&|()[\]{}^~?:"\\]/g,"\\$&")}},31544:(e,r,t)=>{t.d(r,{a:()=>d,b:()=>y,c:()=>u,d:()=>g,g:()=>v,s:()=>p});var i=t(87849),n=t(50637),a=t(87744),s=t(50822),l=t(32710),o=t(59317),c=t(931);function u(e,r){const t=e.type,i=e.thumbnail,n=r&&(0,s.u)(e,r);return null===i&&n&&["Dashboard"].includes(t)}function p(e,r,t){var i,n;const a=e.thumbnail,l=function(e,r){return e&&!(null==e?void 0:e.includes("images/transparent.gif"))&&(!r.isPortal&&!(null==e?void 0:e.includes("thumbnail/ago_downloaded."))||r.isPortal&&!(null==e?void 0:e.includes("Utilities/PrintingTools")))}(a,r),o=["Feature Service","Vector Tile Service"].includes(e.type)&&!l,c="Feature Service"===e.type&&e.typeKeywords.includes("Location Tracking Service"),u=null===(i=e.typeKeywords)||void 0===i?void 0:i.includes("Table");if("Image"===e.type||a&&!o||c||u)return!1;const p=null===(n=e.typeKeywords)||void 0===n?void 0:n.includes("Tiled Imagery"),d=e.type,g="Image Service"===d&&!p||"Map Service"===d,v=t&&(0,s.u)(e,t);return v&&g||v&&"Feature Service"===d||"Vector Tile Service"===d||v&&"KML"===d}function d(e,r,t,i){null!=t||(t=(0,a.g)(e));const s=(0,n.g)(e),l=s&&!i?`token=${s}`:"",o=`${t}content/items/${r.id}`;if(r.thumbnail){const e=r.thumbnailUrl;if(e){const r=new URL(e);return r.searchParams.append("w","400"),r.href}return`${o}/info/${r.thumbnail}?w=400${s?"&":""}${l}`}return"Image"!==r.type||i?v(r):`${o}/data?${l}`}async function g(e,r,t){return t?d(e,r,"https://www.arcgis.com/sharing/rest/",!0):d(e,r)}function v(e){const r=function(e){var r;const t=null===(r=e.type)||void 0===r?void 0:r.toLowerCase(),i=e.typeKeywords||[];switch(t){case"web mapping application":return"webapp.png";case"mobile application":return"mobileapp.png";case"notebook code snippets":case"notebook code snippet library":return"notebookcodesnippets.png";case"notebook":return"notebook.png";case"style":return i.includes("Dictionary")?"dictionarystyle.png":"style.png";case"feature service":return i.includes("Location Tracking View")?"locationtrackingservice.png":i.includes("IndoorPositioningDataService")?"indoor-positioning-data-service.png":"default.png";case"pro presentation":return"pro-presentation.png";case"reality mapping project":case"reality mapping project":return"realitymappingproject.png";case"urban project":case"urban project":return"urbanproject.png";case"raster function template":return"rasterfunctiontemplate.png";case"workforce project":return"workforceproject.png";case"hub initiative":return"hubinitiative.png";case"hub page":return"hubpage.png";case"hub site application":return"hubsite.png";case"hub event":return"hubevent.png";case"hub project":return"hubproject.png";case"dashboard":return i.includes("ArcGIS Dashboards")?"dashboards.png":"opsdashboard.png";case"geoprocessing service":return i.includes("Notebook Web Tool")?"notebookwebtool.png":"webtool.png";case"web scene":case"scene service":return"scene.png";case"ortho mapping project":return"orthomappingproject.png";case"ortho mapping template":return"orthomappingtemplate.png";case"insights theme":return"insightstheme.png";case"insights workbook package":return"insightsworkbookpackage.png";case"solution":return"solution.png";case"mobile scene package":return"mobilescenepackage.png";case"deep learning package":return"deeplearningpackage.png";case"big data analytic":return"bigdataanalytic.png";case"real time analytic":return"realtimeanalytic.png";case"feed":return"feed.png";case"excalibur imagery project":return"excaliburimageryproject.png";case"storymap":return(null==i?void 0:i.includes("storymapcollection"))?"storymapcollection.png":"storymap.png";case"survey123 add in":return"survey123addin.png";case"mission":return"mission.png";case"mission template":return"missiontemplate.png";case"quickcapture project":return"quickcaptureproject.png";case"pro report":return"proreport.png";case"pro package":return"propackage.png";case"pro report template":return"proreporttemplate.png";case"urban model":return"urbanmodel.png";case"web experience":return"webexperience.png";case"web experience template":return"webexperiencetemplate.png";case"experience builder widget":return"experiencebuilderwidget.png";case"experience builder widget package":return"experiencebuilderwidgetpackage.png";case"workflow":return"workflow.png";case"insights script":return"insightsscript.png";case"kernel gateway connection":return"kernelgatewayconnection.png";case"hub initiative template":return"hubinitiativetemplate.png";case"image service":return(null==i?void 0:i.includes("Tile Imagery"))?"tiledimagerylayer.png":"imagerylayer.png";case"mission report":return"missionreport.png";case"administrative report":return"administrativereport.png";case"storymap theme":return"storymaptheme.png";case"knowledge graph":return"knowledgegraph.png";case"knowledge graph layer":return"knowledgegraphlayer.png";case"knowledge studio project":return"knowledgestudio.png";case"earth configuration":return"earthconfiguration.png";case"link chart":return"linkchart.png";case"investigation":return"investigation.png";case"apache parquet":return"apacheparquet.png";case"video service":return"mediaservice.png";case"geodata service":return"geodataservice.png";case"suitability model":return"suitabilitymodel.png";case"esri classifier definition":return"classifierdefinition.png";case"deep learning studio project":return"deeplearningstudioproject.png";case"esri classification schema":return"classificationschema.png";case"insights data engineering workbook":return"dataengineeringworkbook.png";case"insights data engineering model":return"dataengineeringmodel.png";case"discussion":return"discussion.png";case"api key":return"apikey.png";case"data pipeline":return"datapipeline.png";case"analysis model":return"analysismodel.png";case"service connection":return"serviceconnection.png";default:return"default.png"}}(e);return(0,i.d)(`./assets/arcgis-item-thumbnail/${r}`)}async function y(e,r,t){const i=e.type,n=v(e);try{if(["Image Service","Map Service","Feature Service"].includes(i)){return await(0,l.D)({type:i,url:e.url,serviceInfo:t,extent:e.extent,id:e.id,isSecured:{secured:!1}})||n}if("Vector Tile Service"===i){const{id:t,title:i,extent:u}=e,p=await async function({id:e,title:r,itemUrl:t,extent:i}){const[n]=3===(null===o.c||void 0===o.c?void 0:o.c.api)?await(0,c.l)(["esri/SpatialReference"]):await(0,c.l)(["esri/geometry/SpatialReference"]),a={operationalLayers:[],baseMap:{baseMapLayers:[{id:e,type:"VectorTileLayer",layerType:"VectorTileLayer",title:r,styleUrl:`${t}/resources/styles/root.json`,visibility:!0,opacity:1}],title:"Topographic"},spatialReference:{wkid:102100,latestWkid:3857},authoringApp:"WebMapViewer",authoringAppVersion:"5.3",version:"2.10"};let s=[];if("string"==typeof i){const e=i.split(",");s=[[parseFloat(e[0]),parseFloat(e[1])],[parseFloat(e[2]),parseFloat(e[3])]]}else s=i&&i.length>0?i:[[-180,-90],[180,90]];return(0,l.C)(a,s,new n({wkid:102100}))}({id:t,title:i,itemUrl:(0,s.g)(t,(0,a.g)(r)),extent:u});return p||n}if("KML"===i){return await(0,l.E)({url:e.url,type:i,id:e.id,title:e.title,extent:e.extent})||n}}catch(e){console.error(e)}return n}},44069:(e,r,t)=>{t.d(r,{A:()=>n,a:()=>a,b:()=>s,c:()=>o,d:()=>l,u:()=>i});const i=["esriFieldTypeOID","esriFieldTypeGlobalID"],n={"file geodatabase":"filegeodatabase",shapefile:"shapefile",geojson:"geojson",csv:"CSV","microsoft excel":"excel",geopackage:"geoPackage","service definition":"serviceDefinition"},a={Shapefile:"shapefile","File Geodatabase":"fileGeodatabase",CSV:"csv","Microsoft Excel":"excel",GeoJson:"geojson",GeoPackage:"geoPackage"},s={csv:"CSV",excel:"Microsoft Excel",shapefile:"Shapefile",fgdb:"File Geodatabase",geojson:"GeoJson",googlesheets:"Microsoft Excel"},l=["zip","csv","xls","xlsx","geojson","gpkg","json","sd"],o=["zip","csv","xls","xlsx"]},60743:(e,r,t)=>{t.d(r,{a:()=>d,c:()=>g,p:()=>y});var i=t(59317),n=t(3826),a=t(95878),s=t(11163),l=t(72411),o=t(8214),c=t(32710),u=t(43555),p=t(50637);async function d(e,r){var t,a,l,o,c;const p=null!==(t=null!=r?r:i.c.user)&&void 0!==t?t:i.c.portal.user,{cloudProviderResource:d,geoJSONResource:g,locationType:v,csvResource:y,existingItem:m}=n.a,{result:f}=await(0,u.a)(e.id),b=[...f.typeKeywords];if((d||g||y)&&b.push("Cloud Drive"),"address"===v&&b.push("showUnmatchedAddresses"),["3DTiles Package","3DTiles Service"].includes(f.type))if("3dTiles"===n.a.tileLayerPublishType)b.push(n.a.tilesLayer3dTilesLayerType);else if(m){const e=[...m.typeKeywords].find((e=>s.t.includes(e)));e&&b.push(e)}return(null===(l=null===(a=i.c.portal)||void 0===a?void 0:a.sourceJSON)||void 0===l?void 0:l.hasClassificationSchema)&&(n.a.classification.createdUser=i.c.user.username,n.a.classification.createdDate=Date.now()),(0,u.u)(e.id,Object.assign({typeKeywords:null==b?void 0:b.join(",")},(null===(c=null===(o=i.c.portal)||void 0===o?void 0:o.sourceJSON)||void 0===c?void 0:c.hasClassificationSchema)?{classification:JSON.stringify(n.a.classification)}:{}),p)}async function g(e){const r=await(0,c.g)(e.id,{success:e.success});if("failed"===r.status)throw new Error(r.statusMessage)}function v(e,r,t){const{selectedFields:i,timezone:a,analyzeResults:s,type:l}=n.a,c=s.publishParameters,u=(0,o.a)();u.fields=Object.keys(i).map((e=>{const r=i[e];var t;return t=r.type,["esriFieldTypeDouble","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeSmallInteger"].includes(t)&&(r.sqlType=function(e){switch(e){case"esriFieldTypeDouble":return"sqlTypeDouble";case"esriFieldTypeInteger":case"esriFieldTypeOID":return"sqlTypeInteger";case"esriFieldTypeString":return"sqlTypeNVarchar";case"esriFieldTypeSingle":return"sqlTypeFloat";case"esriFieldTypeSmallInteger":return"sqlTypeSmallInt";case"esriFieldTypeDate":return"sqlTypeDate";default:return"sqlTypeOther"}}(r.type),delete r.length),r})),u.capabilities="Query",c.capabilities="Query",u.hasStaticData=!0,c.hasStaticData=!0,c.persistErrorRecordsForReview=!0,c.name=e;const p=(null==t?void 0:t.isPortal)?{timezone:a||"UTC"}:{ianaTimeZone:a||Intl.DateTimeFormat().resolvedOptions().timeZone||"GMT"};return r||"GeoJson"===l?u.dateFieldsTimeReference=p:c.dateFieldsTimeReference=p,c}async function y(e,r){var t,i,s,o;const{user:c,portal:u,title:d,itemId:g,extension:y,type:m,dataUrl:f,itemOwnerUrl:b}=e;null!=r||(r=Object.assign({},function(e,r,t,i,a,s){r=(0,l.a)(r);let o="Scene Service"===a?a:t.toLowerCase();"zip"===o&&(o=a);const c="Microsoft Excel"===a,u={name:r,maxRecordCount:2e3},p=("GeoJson"===a||"CSV"===a)&&s,d=n.a.cloudProvider||p?{deleteSourceItemUponCompletion:!0}:{},g=JSON.stringify(u),y=JSON.stringify(Object.assign(Object.assign(Object.assign({},u),{hasStaticData:!0,layerInfo:{capabilities:"Query"}}),"geojson"===o||"json"===o?{fieldTypesVersion:"V2"}:{}));switch(o){case"3tz":return{itemId:e,publishParameters:JSON.stringify({name:r}),filetype:"3DTilesPackage",outputType:"3DTilesService"};case"csv":case"xls":case"xlsx":return Object.assign({itemId:e,filetype:c?"excel":"csv",publishParameters:JSON.stringify(v(r,c,i))},d);case"featurecollection":return{itemId:e,filetype:"featureCollection",publishParameters:y};case"geojson":case"json":return Object.assign({itemId:e,filetype:"geojson",publishParameters:y},d);case"tpk":case"tpkx":return{itemId:e,filetype:"tilePackage",publishParameters:g,buildInitialCache:!0};case"vtpk":return{itemId:e,filetype:"vectortilepackage",publishParameters:g,outputType:"vectorTiles",buildInitialCache:!0};case"spk":case"slpk":return{itemId:e,filetype:"scenepackage",publishParameters:g,outputType:"sceneService",buildInitialCache:!0};case"Scene Service":return{itemId:e,filetype:"featureService",publishParameters:JSON.stringify({name:r,targetSR:{wkid:4326,latestWkid:4326}}),outputType:"sceneService",buildInitialCache:!1};case"sd":return{itemId:e,filetype:"serviceDefinition",buildInitialCache:!1};case"File Geodatabase":return Object.assign({itemId:e,filetype:"fileGeodatabase",publishParameters:y},d);case"Shapefile":return Object.assign({itemId:e,filetype:"shapefile",publishParameters:y},d);case"gpkg":return{itemId:e,filetype:"geoPackage",publishParameters:g};case"Image Collection":return{itemId:e,filetype:"imageCollection",outputType:"image service",publishParameters:g};default:return{itemId:e,publishParameters:g}}}(g,d,y,u,m,f)));const h=`${"append"===a.u.workflow?b:c.userContentUrl}/publish`;try{const e=await(0,p.r)(h,r,{},"post");if(e.services&&e.services.length){if(null===(i=null===(t=e.services[0])||void 0===t?void 0:t.error)||void 0===i?void 0:i.message)throw null===(o=null===(s=e.services[0])||void 0===s?void 0:s.error)||void 0===o?void 0:o.message;return{result:e}}throw this.i18n.errorPublishing}catch(e){return console.error(e),e.includes("Service name")?{error:{code:"serviceNameExists"}}:{error:{code:"unhandledError"}}}}},90470:(e,r,t)=>{t.d(r,{a:()=>S,b:()=>T,c:()=>f,d:()=>I,f:()=>b,g:()=>x,p:()=>m,r:()=>k,u:()=>h});var i=t(50020),n=t(3826),a=t(32710),s=t(60743),l=t(43555),o=t(24869),c=t(26854),u=t(31544),p=t(44069),d=t(50637);const g=(e,r)=>{const t=!!r.overwrite,i=(e=>{const{name:r,title:t,tags:i,type:n,typeKeywords:a,accessInformation:s,licenseInfo:l,description:o,snippet:c,extent:u}=e,p={name:r,title:t,tags:i,type:n,typeKeywords:a,accessInformation:s,licenseInfo:l,description:o,snippet:c,extent:u};return Object.entries(p).reduce(((e,r)=>{const[t,i]=r;return e[t]=i||"",e}),p)})(e),n=new FormData;return Object.keys(i).forEach((e=>{var t;"description"===e||"snippet"===e||"extent"===e?n.append(e,r.keepDescription?i[e]:""):n.append(e,null!==(t=i[e])&&void 0!==t?t:"")})),n.set("filename",r.fileName),n.set("multipart",String(r.multipart)),n.set("overwrite","true"),n.set("async","true"),n.set("file",r.file,e.title),t&&n.set("overwriteService","on"),n.set("useDescription","on"),n},v=(e,r)=>{const t=e.querySelector(r);return(0,c.h)((null==t?void 0:t.innerHTML)||"")},y=(e,r)=>{const t=Object.assign({},r);t.name=e.name,t.sourceSR=e.sourceSR,t.targetSR=e.targetSR,t.fieldTypesVersion="V2";for(let e=0;e<t.tables.length;e++)"Review"!=t.tables[e].name&&(t.layers[t.layers.length]=t.tables[e]);for(let r of t.layers)t.layers[r.id]=Object.assign({},e.layers[r.id]);return t},m=async(e,r,t,n,a)=>{var l,o;const c=await f(e,t,n,a),u=(0,i.g)(await(0,i.f)(e.owner,t),t),p=await(0,s.p)({itemId:a.sourceData.id,user:n,portal:t,title:r,itemOwnerUrl:u},c);if(null==p?void 0:p.error)return{error:{code:"unhandledError"}};const d=null===(o=null===(l=p.result)||void 0===l?void 0:l.services)||void 0===o?void 0:o[0];return{result:{id:null==d?void 0:d.serviceItemId,jobId:null==d?void 0:d.jobId,serviceType:null==d?void 0:d.type,serviceUrl:null==d?void 0:d.serviceurl,overwriteStatus:""}}},f=async(e,r,t,i,n)=>{const{result:a}=await w(e,r,!1,t);return((e,r,t,i)=>{var n,a,s,l,o,c;let u;const d=t.publishParameters,g=null!==(n=t.sourceData)&&void 0!==n?n:r;if(t.cloudProviderInfo){const e=t.cloudProviderInfo;u="zip"===(null==e?void 0:e.mimeType)?null==e?void 0:e.zipItemType:p.b[null==e?void 0:e.mimeType]}else u=null===(a=t.sourceData)||void 0===a?void 0:a.type;const v={itemId:null!=i?i:g.id,filetype:p.A[u.toLowerCase()],overwrite:!0,deleteSourceItemUponCompletion:!!i};let m;const f=(null===(l=null===(s=null==t?void 0:t.adminServiceInfo)||void 0===s?void 0:s.adminServiceInfo)||void 0===l?void 0:l.name)||(null===(o=t.itemData)||void 0===o?void 0:o.title);switch(u){case"CSV":const t=Object.assign(Object.assign({},null===(c=e.layers)||void 0===c?void 0:c[0]),{fields:d.layerInfo.fields});m=Object.assign(Object.assign({layerInfo:t,name:d.name||f.replace(/ /g,"_")},d),e);break;case"Microsoft Excel":m=y(d,e);break;case"GeoJSON":case"GeoJson":m=Object.assign(Object.assign(Object.assign({},d),e),{name:f?f.replace(/ /g,"_"):r.title.replace(/ /g,"_"),fieldTypesVersion:"V2"});break;default:m=Object.assign(Object.assign(Object.assign({},d),e),{name:f?f.replace(/ /g,"_"):r.title.replace(/ /g,"_")})}return v.publishParameters=JSON.stringify(m),v})(a,e,i,n)},b=async(e,r,t)=>{var i;const n=(null===(i=t.file)||void 0===i?void 0:i.size)>a.M;try{return await h(e,r,{file:t.file,overwrite:t.overwrite,keepDescription:t.keepDescription,fileName:t.fileName,multipart:n,existingItemId:t.existingItemId}),await(0,s.c)({id:e.id,folder:"",success:!0}),{}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},h=async(e,r,t)=>{var i;const s=`${r}/items/${e.id}/update`,l=(null===(i=t.file)||void 0===i?void 0:i.size)>a.M,c=g(e,{file:t.file,overwrite:t.overwrite,keepDescription:t.keepDescription,fileName:t.fileName,multipart:l});return"Raster function template"===e.type&&await(async(e,r)=>{const t=r.get("file"),i=r.get("filename");if(!t||!i)return{error:{code:"unhandledError"}};const{extension:n}=(0,o.a)(i),a=new FileReader;return new Promise(((i,s)=>{a.onload=async t=>{var a;const s=t.target.result;if(!s)return r.set("snippet",""),r.set("description",""),i({});let l,o;if("rft.json"===n){const e=JSON.parse(s);({description:l,thumbnailEx:o}=e)}else if("rft.xml"===n){const e=(new DOMParser).parseFromString(s,"text/xml");l=v(e,"Description"),o=v(e,"ThumbnailEx")}if(!o||"string"==typeof o&&(null===(a=null==o?void 0:o.trim())||void 0===a?void 0:a.length)<1){const r=(0,u.g)(e);try{const e=await fetch(r);o=await e.blob()}catch(e){console.error(e)}}r.set("snippet",l);try{await e.updateThumbnail({thumbnail:o})}catch(e){console.error(e)}i({})},a.onerror=()=>{a.abort(),s({code:"unhandledError"})},a.readAsText(t)}))})(e,c),l?(n.a.id=e.id,await(0,a.B)({updateUrl:s,updateFormData:c,updateSourceDataId:e.id})):await(0,d.a)(s,c,{},"post")},w=async(e,r,t,i)=>{try{const{url:r}=e,t=await(0,d.r)(r),i=await(0,d.r)(r+"/layers"),n=null==i?void 0:i.layers.map((e=>(delete e.fields,e)));return t.tables=[...null==i?void 0:i.tables],t.layers=[...n],{result:t}}catch(n){return!t&&(499===(null==n?void 0:n.code)&&"Token Required"===(null==n?void 0:n.message)||403===n.code)&&i?w(e,r,!0,i):(console.error(n),{error:{code:"unhandledError"}})}},k=async e=>{let r=e.typeKeywords.toString();const t={title:e.title||"",tags:e.tags.toString()||""};-1!==e.typeKeywords.indexOf("Involved Lookup")&&(r+=",showUnmatchedAddresses",t.typeKeywords=r);try{return{result:await(0,l.u)(e.id,t)}}catch(e){return console.error("error:",e),{error:{code:"unhandledError"}}}},S=async(e,r,t)=>{const i=e.folderId||e.ownerFolder,n=`${r}/${i||""}/items/${e.id}/updateResources`,a=new FormData;a.set("file",t.file),a.set("resourcesPrefix","styles"),a.set("filename","root.json");try{return{result:await(0,d.a)(n,a,{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},T=async(e,r,t)=>{const i=e.folderId||e.ownerFolder,n=`${r}/${i||""}/items/${e.id}/addResources`,a=new FormData;a.set("file",t.file),a.set("resourcesPrefix","styles"),a.set("filename","root.json");try{return{result:await(0,d.a)(n,a,{},"post")}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},I=async(e,r,t)=>{let i=["Cloud Drive"];const n=JSON.parse(e);"address"===n.locationType||n.layers[0]&&"address"===n.layers[0].locationType?(i.push("showUnmatchedAddresses"),i.push("Involved Lookup")):("none"===n.locationType||n.layers[0]&&"none"===n.layers[0].locationType)&&i.push("Table");const a=i.join(",");return await(0,l.u)(r.id,{folderId:(null==r?void 0:r.folderId)||r.ownerFolder,id:t,typeKeywords:a})};async function x(e){try{return{result:await e.connect()}}catch(e){return{error:{code:"unhandledError"}}}}}}]);