"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_dist_esm-9f464d"],{32818:(e,t,a)=>{a.r(t),a.d(t,{rfx_analysis_wrapper:()=>i.R});var i=a(57746);a(83628),a(5839),a(48001),a(5294),a(24360),a(92991),a(32513),a(44345),a(13661),a(18423),a(21255),a(35431),a(93442),a(588),a(55448),a(2924),a(11840),a(52373),a(33752),a(440),a(66744),a(42335),a(71144),a(74579),a(23795),a(17902),a(56451),a(71802),a(36596)},57746:(e,t,a)=>{a.d(t,{R:()=>h});var i=a(83628),s=a(5839),r=a(48001),l=a(74579),n=(a(5294),a(92991)),o=a(93442);a(23795),a(17902),a(56451),a(588),a(71802),a(44345),a(32513),a(33752),a(36596);const h=class{constructor(e){(0,i.r)(this,e),this.analysisToolDataChange=(0,i.c)(this,"analysisToolDataChange"),this.analysisToolClose=(0,i.c)(this,"analysisToolclose"),this.analysisUnsupportedFunction=(0,i.c)(this,"analysisUnsupportedFunction"),this.analysisRFTLoadError=(0,i.c)(this,"analysisRFTLoadError"),this.analysisRFxHelpPopoverChange=(0,i.c)(this,"analysisRFxHelpPopoverChange"),this.analysisRFxBrowseLayerClick=(0,i.c)(this,"analysisRFxBrowseLayerClick"),this.resetPreview=!0,this.usePanel=!0,this.validateOnPreview=!0,this.hasGlobalFunctionInRFT=!1,this.handlePreviewSelectionChange=e=>{this.editorComponent.rfxTemplate=e.detail,setTimeout((()=>{this.validateRFx()}),500)},this.handlePreviewHelpClick=e=>{const{referenceElement:t,helpSrcdoc:a,heading:i}=e.detail,n=this.portal?.isPortal,o=this.portal?.sourceJSON?.helpBase||r.a.learnMoreDocBaseURL,h=(0,s.f)(o,this.locale);let p;if(!0===n){const e=r.a.learnMoreDocDefaultEnterpriseHelpID,{restUrl:t}=this.portal;p=`${h}${(0,l.a)(e)}${r.a.learnMoreDocPreviewEnterpriseHelpID}`,p=(0,s.a)(p,t)}else{const e=`${r.a.learnMoreDocDefaultHelpID}${r.a.learnMoreDocPreviewHelpID}`;p=(0,l.f)(h,e)}this.analysisRFxHelpPopoverChange.emit({referenceElement:t,helpSrcdoc:a,heading:i,learnMoreUrl:p})}}async onRfxTemplateChange(){!0===this.resetPreview&&(this.hasGlobalFunctionInRFT=await(0,r.h)(this.rfxTemplate,this.locale),this.previewComponent?.clearPreviewLayers())}async onMapLayersChange(){this.resetPreview=!1,this.rfxTemplate=await this.getUpdatedRFTWithValues()??this.rfxTemplate,setTimeout((()=>{this.resetPreview=!0}),1)}onPortalChange(e){n.s.portal=e}async getUpdatedRFTWithValues(){return this.editorComponent?.getUpdatedRFTWithValues()}async validateRFx(){return await(this.editorComponent?.checkTemplateValidity())}async componentWillLoad(){const{locale:e,rtl:t}=(0,s.g)(this.hostElement);this.locale=e,this.dir=(0,s.b)(t),void 0!==this.portal&&this.onPortalChange(this.portal),void 0===this.rfxTemplate&&void 0!==this.functionName&&(this.rfxTemplate=await(0,r.g)(this.functionName)),void 0!==this.rfxTemplate&&void 0===this.rfxTemplate?.arguments&&this.analysisRFTLoadError.emit(),this.hasGlobalFunctionInRFT=await(0,r.h)(this.rfxTemplate,this.locale)}renderArgsEditor(){const{imageryLayers:e,featureLayers:t}=(0,o.g)(this.mapLayers);return(0,i.h)("rfx-args-editor",{ref:e=>this.editorComponent=e,rfxTemplate:this.rfxTemplate,imageryLayers:e,featureLayers:t,mapView:this.mapView,portal:this.portal,onRfxArgHelpClick:e=>{const{referenceElement:t,helpSrcdoc:a,heading:i}=e.detail;this.analysisRFxHelpPopoverChange.emit({referenceElement:t,helpSrcdoc:a,heading:i})},onRfxBrowseClick:e=>{this.analysisRFxBrowseLayerClick.emit(e.detail)},onRfxUnsupportedFunctionFound:e=>this.analysisUnsupportedFunction.emit(e.detail)})}renderPreviewElement(){return(0,i.h)("rfx-preview",{mapView:this.mapView,portal:this.portal,getTemplate:()=>this.getUpdatedRFTWithValues(),validateOnPreview:this.validateOnPreview,validateInputValues:()=>this.validateRFx(),onRfxPreviewSelection:this.handlePreviewSelectionChange,onPreviewHelpClick:this.handlePreviewHelpClick,ref:e=>this.previewComponent=e})}render(){return(0,i.h)(i.H,{key:"42dd501545213600e756782e990d97439948a222"},!0===this.usePanel?(0,i.h)("calcite-panel",{dir:this.dir,heading:this.rfxTemplate.name,closable:!0,onCalcitePanelClose:()=>this.analysisToolClose.emit()},this.renderArgsEditor()):(0,i.h)("div",null,this.renderArgsEditor(),!1===this.hasGlobalFunctionInRFT?this.renderPreviewElement():void 0))}get hostElement(){return(0,i.g)(this)}static get watchers(){return{rfxTemplate:["onRfxTemplateChange"],mapLayers:["onMapLayersChange"],portal:["onPortalChange"]}}}}}]);