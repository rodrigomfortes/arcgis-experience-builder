/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-a00194.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-a00194"],{16401:(e,t,s)=>{var a,i;s.d(t,{a:()=>i,g:()=>n,l:()=>a,s:()=>r}),function(e){e.ARCGIS_COMPONENT_NOTIFICATIONS="arcgisComponent_notifications"}(a||(a={})),function(e){e.FEATURE_REDUCTION_WARNING_DISMISSED="arcgis_feature_reduction_warning_dismissed",e.POPUP_WARNING_DISMISSED="arcgis_popup_warning_dismissed",e.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED="arcgis_symbol_styler_incompatible_vector_symbols_dismissed",e.EFFECTS_TIP_DISMISSED="arcgis_effects_tip_dismissed",e.LAYER_VIEW_DEFINITION_DISMISSED="arcgis_layer_view_definition_dismissed",e.LAYER_OVERRIDE_STATUS_TIP_DISMISSED="arcgis_layer_override_status_tip_dismissed",e.SMART_MAPPING_TIP1_DISMISSED="arcgis_smart_mapping_tip1_dismissed",e.SMART_MAPPING_TIP2_DISMISSED="arcgis_smart_mapping_tip2_dismissed",e.LAYER_VIEW_JOIN_TIP_DISMISSED="arcgis_layer_view_join_tip_dismissed",e.MULTIDIMENSIONAL_INFO_TIP_DISMISSED="arcgis_multidimensional_info_tip_dismissed"}(i||(i={}));const c=e=>{const t=(e=>localStorage.getItem(e))(e);return t?JSON.parse(t):{}},r=(e,t)=>{const s=c(e);s[t.key]=t.value,((e,t)=>{localStorage.setItem(e,t)})(e,JSON.stringify(s))},n=(e,t)=>{const s=c(e);return Object.getOwnPropertyDescriptor(s,t)?s[t]:null}},37494:(e,t,s)=>{s.r(t),s.d(t,{arcgis_map_config_effect:()=>S});var a=s(11254),i=s(17840),c=s(53127),r=s(73272),n=s(16401),l=s(14528),o=s(84260),f=s(69811);s(56612),s(10465);const h="panel",d="card",u="notice",p="hint",g="basemap-type",m="radio-buttons",E="switch",y="list",_="effect-thumb",v="effect-thumb-img",S=class{constructor(e){(0,a.r)(this,e),this.arcgisClose=(0,a.c)(this,"arcgisClose",7),this.arcgisChange=(0,a.c)(this,"arcgisChange",7),this.arcgisApplyLayerEffect=(0,a.c)(this,"arcgisApplyLayerEffect",7),this.manager=(0,l.u)(this),this.strings=(0,o.u)({blocking:!0}),this.popovers=new Map,this.afterCreatePanel=e=>{this.panelNode=e},this.onSwitchEffectType=async e=>{const{props:t,popovers:s}=this,a=t.layer,i=e.target;if(s.forEach((e=>e.open=!1)),"layer"===i.selectedItem.value)this.lastFeatureEffect=a.featureEffect||this.lastFeatureEffect,a.featureEffect=null,a.effect=this.lastLayerEffect,this.showFeatureEffects=!1;else{if(this.lastLayerEffect=a.effect,a.effect=null,this.lastFeatureEffect)a.featureEffect=this.lastFeatureEffect,t.featureEffectType=(0,r.p)(t);else{const{backgroundTheme:e}=t;await this.selectFeatureEffectType("light"===e?r.a[0]:r.b[0])}this.showFeatureEffects=!0;const e=await this.getPopover("featureEffect");e.open=!0,e.updateHeader(t.featureEffectType),setTimeout((()=>e.setFocus()),300)}this.reRender=!this.reRender},this.onRemoveEffect=()=>{const{props:e}=this,{layer:t}=e;t.effect=null,t.featureEffect=null,this.isUnsupported=!1},this.onSwitchChange=async e=>{const t=e.target,s=(0,i.q)(t,"calcite-list-item"),a=s.value;if(!t.checked){(await this.getPopover(a)).open=!1,s.selected=!1}this.arcgisApplyLayerEffect.emit({type:a,keepSwitch:!0})},this.onFeatureEffectEnabledSwitchChange=async e=>{const{props:t,lightListNode:s,darkListNode:a}=this,i=t.layer;if(e.target.checked){if(this.lastFeatureEffect)i.featureEffect=this.lastFeatureEffect,t.featureEffectType=(0,r.p)(t);else{const{backgroundTheme:e}=t;t.featureEffectType="light"===e?r.a[0]:r.b[0]}s?.querySelectorAll("calcite-list-item").forEach((e=>{e.value===t.featureEffectType&&(e.selected=!0)})),a?.querySelectorAll("calcite-list-item").forEach((e=>{e.value===t.featureEffectType&&(e.selected=!0)})),await this.selectFeatureEffectType(t.featureEffectType)}else{(await this.getPopover("featureEffect")).open=!1,s?.querySelectorAll("calcite-list-item").forEach((e=>e.selected=!1)),a?.querySelectorAll("calcite-list-item").forEach((e=>e.selected=!1)),this.lastFeatureEffect=i.featureEffect,i.featureEffect=null,this.arcgisChange.emit()}},this.openPopover=async e=>{const{popovers:t}=this,s=e.target,a=s.tagName.toLowerCase();let c;if("img"===a)c=(0,i.q)(s,"calcite-list-item");else if("calcite-switch"===a){if(!s.checked)return;c=(0,i.q)(s,"calcite-list-item")}else{if("calcite-list-item"!==a)return;c=s}c.selected=!0;const n=c.value;if(r.a.concat(r.b).includes(n))await this.selectFeatureEffectType(n,c);else{const e=c.querySelector("calcite-switch"),s=await this.getPopover(n);s.open?(s.open=!1,e.checked=!1,c.selected=!1,this.arcgisApplyLayerEffect.emit()):(e.checked||(e.checked=!0,this.arcgisApplyLayerEffect.emit()),t.forEach((e=>e.open=!1)),s.open=!0)}},this.view=void 0,this.layer=void 0,this.hideLayerTitle=!1,this.reRender=!1,this.isUnsupported=!1,this.showFeatureEffects=!1}async arcgisApplyLayerEffectHandler(e){const{props:t,listNode:s}=this,{layer:a}=t,i=e.detail?.type;if(i&&!e.detail?.keepSwitch){Array.from(s.querySelectorAll("calcite-list-item")).find((e=>e.value===i)).querySelector("calcite-switch").checked=!0}const c=await(0,r.c)(this.listNode,this.popovers,t);a.effect=c,this.arcgisChange.emit(),t.effectsJSON=(0,r.p)(t)}async setFocus(e){e&&"dismiss-button"!==e?this.listNode?.setFocus():this.panelNode?.setFocus()}async done(){const{popovers:e}=this;e.forEach((e=>e.open=!1)),document.body.querySelectorAll("arcgis-map-config-effect-popovers").forEach((e=>e.parentNode?.removeChild(e)))}async componentWillLoad(){const{view:e,layer:t,strings:s}=this,a=!t.featureReduction&&["feature","geojson","ogc-feature","wfs","csv","stream","oriented-imagery","knowledge-graph-sublayer","parquet"].includes(t.type);this.props={view:e,layer:t,strings:s,supportsFeatureEffects:a};const{props:i}=this,c=await(0,f.y)();i.backgroundTheme=e&&(await c.getBackgroundColorTheme(e)??void 0),i.modules={intl:await(0,f.z)(),FeatureEffect:await(0,f.A)(),effectsUtils:await(0,f.B)()};try{const e=t;e.effect&&e.featureEffect?this.isUnsupported=!0:e.effect?(i.effectsJSON=(0,r.p)(i),(0,r.s)(i)):e.featureEffect&&(i.featureEffectType=(0,r.p)(i))}catch(e){this.isUnsupported=!0}}componentDidLoad(){requestAnimationFrame((()=>this.setFocus())),this.createPopovers()}disconnectedCallback(){this.done()}render(){const{isUnsupported:e}=this;return(0,a.h)(a.H,{key:"0892aca7f87636a7a2b6b547cd419a9697f753aa",class:"calcite-match-height"},e?this.renderUnsupportedNotice():this.renderContent())}renderUnsupportedNotice(){const{props:e,hideLayerTitle:t}=this,{layer:s,strings:i}=e;return(0,a.h)("calcite-panel",{heading:i.general.effects,description:t?void 0:s.title??void 0,class:h,closable:!0,onCalcitePanelClose:()=>this.arcgisClose.emit(),ref:e=>this.panelNode=e},(0,a.h)("calcite-card",{class:d},(0,a.h)("div",{slot:"heading"},i.error.title),(0,a.h)("div",{slot:"description"},(0,a.h)("div",null,i.error.text1),(0,a.h)("div",null,i.error.text2))),(0,a.h)("calcite-fab",{class:"autofocus",slot:"fab",appearance:"outline-fill",kind:"neutral",scale:"s",textEnabled:!0,label:i.error.button,text:i.error.button,onClick:this.onRemoveEffect}))}renderContent(){const{props:e,hideLayerTitle:t,showFeatureEffects:s}=this,{layer:i,supportsFeatureEffects:c,strings:r}=e,n=c&&!!i.featureEffect;return(0,a.h)("calcite-panel",{heading:r.general.effects,description:t?void 0:i.title??void 0,class:h,closable:!0,onCalcitePanelClose:()=>{const{popovers:e}=this;e.forEach((e=>e.open=!1)),this.arcgisClose.emit()},ref:this.afterCreatePanel},this.renderTip(),c?(0,a.h)("div",{class:m},(0,a.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",scale:"s",width:"full",onCalciteSegmentedControlChange:this.onSwitchEffectType},(0,a.h)("calcite-segmented-control-item",{value:"layer",checked:!(n||s)},r.general.wholeLayer),(0,a.h)("calcite-segmented-control-item",{value:"feature",checked:n||s},r.general.featureSpecific))):null,n||s?this.renderFeatureEffectsContent():this.renderLayerEffectsContent())}renderTip(){const{props:e}=this,{strings:t}=e;return(0,n.g)(n.l.ARCGIS_COMPONENT_NOTIFICATIONS,n.a.EFFECTS_TIP_DISMISSED)?(0,a.h)("div",null):(0,a.h)("div",{class:u},(0,a.h)("calcite-notice",{scale:"s",width:"full",open:!0,closable:!0,onCalciteNoticeClose:()=>{(0,n.s)(n.l.ARCGIS_COMPONENT_NOTIFICATIONS,{key:n.a.EFFECTS_TIP_DISMISSED,value:"true"})}},(0,a.h)("div",{slot:"message"},t.general.notice)))}renderLayerEffectsContent(){const{strings:e}=this;return(0,a.h)("div",null,(0,a.h)("div",{class:p},(0,a.h)("calcite-label",{scale:"s"},e.general.dragToReorder)),(0,a.h)("calcite-list",{label:e.general.effects,class:y,dragEnabled:!0,onCalciteListOrderChange:()=>this.arcgisApplyLayerEffect.emit(),ref:e=>this.listNode=e},r.d.map((e=>this.renderLayerEffectItem(e)))))}renderLayerEffectItem(e){const{props:t}=this,{effectsJSON:s,strings:i}=t;let c=-1;return s&&Array.from(s)?.forEach(((t,s)=>{t.type===(0,r.f)(e)&&(c=s+1)})),(0,a.h)("calcite-list-item",{label:i.effectsTitle[e],description:i.effectsSummary[e],value:e,onClick:this.openPopover,onKeyDown:e=>{if("Enter"===e.key&&this.openPopover(e)," "===e.key){const t=e.composedPath()[0];"SPAN"===t.tagName&&t.classList.contains("handle")||this.openPopover(e)}}},(0,a.h)("div",{slot:"actions-start",class:_},(0,a.h)("img",{class:v,src:(0,a.g)(`./assets/effect-thumbs/${e}.png`),alt:""})),(0,a.h)("calcite-switch",{scale:"s",checked:c>0,slot:"actions-end",class:E,onCalciteSwitchChange:this.onSwitchChange}))}renderFeatureEffectsContent(){const{props:e,lastFeatureEffect:t,strings:s}=this,{layer:i,backgroundTheme:c}=e,n="light"===c,l=(0,a.h)("div",null,(0,a.h)("div",{class:g},(0,a.h)("calcite-label",{scale:"s"},s.general.lightBasemaps)),(0,a.h)("calcite-list",{label:s.general.effects,class:y,"data-value":"light",ref:e=>this.lightListNode=e},r.a.map((e=>this.renderFeatureEffectItem(e,"light"))))),o=(0,a.h)("div",null,(0,a.h)("div",{class:g},(0,a.h)("calcite-label",{scale:"s"},s.general.darkBasemaps)),(0,a.h)("calcite-list",{label:s.general.effects,class:y,"data-value":"dark",ref:e=>this.darkListNode=e},r.b.map((e=>this.renderFeatureEffectItem(e,"dark")))));return(0,a.h)("div",null,(0,a.h)("div",{class:p},(0,a.h)("calcite-label",{scale:"s"},s.general.emphasize),(0,a.h)("calcite-label",{scale:"s",layout:"inline-space-between"},s.general.enabled,(0,a.h)("calcite-switch",{scale:"s",checked:!(!i.featureEffect&&!t),onCalciteSwitchChange:this.onFeatureEffectEnabledSwitchChange,ref:e=>this.enabledSwitchNode=e}))),n?l:o,n?o:l)}renderFeatureEffectItem(e,t){const{props:s}=this,{featureEffectType:i,strings:c}=s,n=r.a.find((t=>e===t)),l=r.b.find((t=>e===t));return(0,a.h)("calcite-list-item",{label:c.featureEffectsTitle[e],description:c.featureEffectsSummary[e],value:e,selected:i===e,onClick:this.openPopover,onKeyDown:e=>{if("Enter"===e.key&&this.openPopover(e)," "===e.key){const t=e.composedPath()[0];"SPAN"===t.tagName&&t.classList.contains("handle")||this.openPopover(e)}}},(0,a.h)("div",{slot:"actions-start",class:_},(0,a.h)("img",{class:`${v} feature`,src:(0,a.g)(`./assets/effect-thumbs/${e}${n&&l?`_${t}`:""}.png`),alt:""})))}async createPopovers(){const{props:e}=this,{featureEffectType:t,supportsFeatureEffects:s}=e,{popovers:a,panelNode:i}=this;a&&this.done();const c=s?["featureEffect"].concat(r.d):r.d,n=async t=>await new Promise((s=>{const a=document.createElement("arcgis-map-config-effect-popovers");a.props=e,a.type=t,a.referenceElement=i,a.addEventListener("arcgisReady",(()=>s(a))),a.addEventListener("arcgisClose",(()=>this.arcgisPopoverCloseHandler())),a.addEventListener("arcgisFilterChange",(e=>this.arcgisFilterChangeHandler(e))),document.body.appendChild(a)}));for(const e of c)a.set(e,await n(e));if(t){const e=await this.getPopover("featureEffect");e.open=!0,e.updateHeader(t)}}async selectFeatureEffectType(e,t){const{popovers:s,props:a,lightListNode:i,darkListNode:c,defaultWhere:n,enabledSwitchNode:l}=this,{layer:o}=a;a.featureEffectType=e,i?.querySelectorAll("calcite-list-item").forEach((t=>{t.selected&&t.value!==e&&(t.selected=!1)})),c?.querySelectorAll("calcite-list-item").forEach((t=>{t.selected&&t.value!==e&&(t.selected=!1)})),o.featureEffect=(0,r.e)(e,o.featureEffect?.filter?.where||n,a),this.defaultWhere=void 0,this.arcgisChange.emit();const f=await this.getPopover("featureEffect");f.open?(f.updateHeader(e),t?.setFocus()):(s.forEach((e=>e.open=!1)),f.open=!0,f.updateHeader(e),setTimeout((()=>f.setFocus()),300)),l?l.checked=!0:this.reRender=!this.reRender}async getPopover(e){const{popovers:t}=this;let s=t.get(e);for(;!s;)await(0,c.t)(100),s=t.get(e);return s}arcgisPopoverCloseHandler(){const{listNode:e,lightListNode:t,darkListNode:s}=this;e?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&(e.selected=!1,setTimeout((()=>e.setFocus()),100))})),t?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&setTimeout((()=>e.setFocus()),100)})),s?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&setTimeout((()=>e.setFocus()),100)}))}arcgisFilterChangeHandler(e){const{props:t,el:s}=this,{layer:a}=t,i=e.detail,c=Array.from(s.shadowRoot.querySelectorAll("calcite-list-item")).find((e=>e.selected)),n=c?.value;if(n){if(r.d.find((e=>e===n)))return;a.featureEffect=(0,r.e)(n,i,t),this.arcgisChange.emit()}else this.defaultWhere=i}static get assetsDirs(){return["assets"]}get el(){return(0,a.a)(this)}};S.style=":host {\n  height: 100%;\n}\n\n.flow {\n  height: 100%;\n}\n\n.panel {\n  height: 100%;\n}\n\n.card {\n  margin: var(--calcite-spacing-lg);\n}\n\n.notice {\n  margin: var(--calcite-spacing-sm);\n}\n\n.radio-buttons {\n  padding: 0.5rem;\n  background-color: white;\n}\n\n.hint {\n  padding: 0.25rem 0.5rem;\n  background-color: white;\n}\n\n.basemap-type {\n  padding: 0.75rem 0.5rem 0.25rem 0.5rem;\n}\n\n.switch {\n  margin-right: 0.75rem;\n  margin-left: 0;\n  align-self: center;\n}\n\n.list {\n  flex-flow: column nowrap;\n  margin: 1px;\n}\n\n.effect-thumb {\n  display: flex;\n  align-items: center;\n  padding-left: 0.5rem;\n  cursor: pointer;\n}\n\n.effect-thumb-img {\n  margin-top: 0.25rem;\n  margin-bottom: 0.25rem;\n  height: 48px;\n  width: 48px;\n}\n\n:dir(rtl) {\n  .switch {\n    margin-left: 0.75rem;\n    margin-right: 0;\n  }\n  .effect-thumb {\n    padding-left: 0;\n    padding-right: 0.5rem;\n  }\n}\n"},53127:(e,t,s)=>{s.d(t,{a:()=>i,d:()=>a,t:()=>c});const a=(e,t)=>{let s,a="idle";const i=async(...i)=>await new Promise((c=>{switch(a){case"flushed":a="idle",s?(clearTimeout(s),c(e(...i))):c(null);break;case"invoked":clearTimeout(s),a="idle",c(e(...i));break;case"cancelled":clearTimeout(s),a="idle",c(null);break;default:s&&clearTimeout(s),a="pending",s=setTimeout((()=>{a="idle",c(e(...i))}),t)}}));return i.flush=async function(...e){return a="flushed",await i(...e)},i.invoke=async function(...e){return a="invoked",await i(...e)},i.cancel=async function(...e){return a="cancelled",await i(...e)},i.getStatus=function(){return a},i},i=(e,t)=>{let s;return async(...a)=>await new Promise((i=>{s||(s=setTimeout((()=>{clearTimeout(s),s=void 0,i(e(...a))}),t))}))};function c(e){return new Promise((t=>setTimeout(t,e)))}},84260:(e,t,s)=>{s.d(t,{u:()=>r});var a=s(11254),i=s(10465),c=s(14528);function r({propertyName:e="strings",name:t}){let s=(0,c.r)();const r=(0,i.g)(s.el),l=new i.D,o={_lang:r.lang,_t9nLocale:r.t9nLocale};s.manager.onLoad((()=>l.promise));const f=new WeakRef(s);function h(){const e=f.deref();return e||u?.(),e}s=void 0;const d=n((()=>h()?.el)),u=(0,i.s)(d,(()=>(0,a.g)("./assets")),(({t9nLocale:t,t9nStrings:s,lang:a})=>{const i=h();if(!i)return;i[e]={...s,_lang:a,_t9nLocale:t},l.resolve()}),t);return o}const n=e=>new Proxy({},{get(t,s){const a=e();if(!a)return;const i=Reflect.get(a,s,a);return"function"==typeof i?i.bind(a):i}})}}]);