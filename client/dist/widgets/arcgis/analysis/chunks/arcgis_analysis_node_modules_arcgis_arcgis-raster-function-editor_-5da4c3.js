"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-5da4c3"],{15026:(e,t,n)=>{n.d(t,{a:()=>C,c:()=>v,g:()=>h,l:()=>f});var a=n(588),r=n(71802),o=n(44345),i=n(32513),l=n(33752),s=n(36596),c=n(92991);const d="ConvertRasterFunctionTemplate",u="https://rasteranalysisdev.arcgis.com/arcgis/rest/services/Utilities/RasterUtilities/GPServer";async function m(e){return(await(0,o.default)(e,{query:{f:"json"}})).data}async function p(e){let t={format:"json",inputRasterFunction:JSON.stringify({itemId:e.id})};const n=function(e){const t=e.helperServices,n=t&&t.rasterUtilities;return`${n?n.url:u}`}(e.portal);let o;(0,c.i)(n)&&Promise.reject("rasterUtilities server missing");try{const e=`${n}/${d}`,i=await a.default.getCredential(e);void 0!==i?.token&&(t={...t,token:i.token});const l=await r.submitJob(e,t),s={interval:1500,statusCallback:e=>{console.log("status: ",e.jobStatus)}};await l.waitForJobCompletion(s);const c=(await l.fetchResultData("outputRasterFunction")).value;({url:o}=c)}catch{Promise.reject("json conversion failed")}return m(o)}async function f(e,t){if((0,c.i)(e))throw new Error("Invalid Portal Item Id");(0,c.i)(t)&&!(0,c.i)(c.s?.portal)&&(t=c.s.portal);let n=new l.default({id:e,portal:t});try{await n.load()}catch(a){const r=c.s?.portal??t;if(!0===r?.isPortal)try{if(n=await async function(e){const t=new i.default({url:"https://www.arcgis.com"});if(t.authMode="immediate",await t.load(),!(0,c.i)(t.loadError))throw t.loadError;const n=new l.default({id:e,portal:t});try{await n.load()}catch(e){console.error(e)}return n}(e),!n?.loaded)throw new Error("Unable to load selected portal item "+e)}catch(e){console.error(e)}else console.error(a)}return n}async function h(e,t){let n;const a=await f(e,t),{title:r,snippet:o,id:i}=a;try{const e=`${a.itemUrl}/data`;n=await m(e)}catch(e){if(console.log("Error loading portal item: ",e),e.message.includes("is not valid JSON"))try{n=await p(a)}catch{if(!n)return void console.log("Failed to convert RFT to JSON.")}}return{...n,name:r,description:o??n.description,sourceItemId:i,type:n.type??c.R}}function v(e){return new s.default(e)}function C(e){if((0,c.i)(e))return;return`${e.portal.url.replace("/sharing/rest/","")}/home/item.html?id=${e.id}`}},33797:(e,t,n)=>{n.d(t,{C:()=>r,U:()=>a,a:()=>o,u:()=>i});const a={Scale:"s",PopoverTimer:60},r={s:"s",m:"m",l:"l"},o={absolute:"absolute",fixed:"fixed"},i=e=>e===r.s?r.m:r.l},38124:(e,t,n)=>{n.d(t,{a:()=>m,b:()=>d,c:()=>g,d:()=>h,e:()=>f,f:()=>y,g:()=>s,h:()=>u,i:()=>c,j:()=>E,k:()=>v,l:()=>C,m:()=>i,n:()=>o,o:()=>l});var a=n(92991),r=n(33797);const o=({label:e,open:t})=>{const n=document.createElement("rfx-section");return n.label=e,n.open=t,n},i=({content:e,unsupportedWarningComponent:t,title:n,isFunctionChain:r})=>{const o=document.createElement("calcite-block");return o.open=!0,!0===r&&(o.heading=n,o.collapsible=!0,o.headingLevel=3),(0,a.i)(t)||o.appendChild(t),o.appendChild(e),o},l=({label:e,hideHelp:t=!1,onHelpActionClick:n})=>{const a=document.createElement("rfx-label");return a.label=e,a.hideHelp=t,a.addEventListener("rfxLabelHelpActionClick",n),a},s=({portal:e,portalItem:t,itemProps:n,onCancel:a,onSave:r})=>{const o=document.createElement("rfx-save-modal");return o.portal=e,o.portalItem=t,o.itemProps=n,o.addEventListener("cancelClick",a),o.addEventListener("saveClick",r),o},c=({portal:e,portalItem:t})=>{const n=document.createElement("rfx-share-modal");return n.portal=e,n.portalItem=t,n},d=({modalStrings:{header:e},portal:t,user:n,filter:a,hideFilters:r,selectionMode:o,cardMessageOverrides:i,onClose:l,onSelection:s})=>{const c=document.createElement("rfx-item-browser");return c.portal=t,c.user=n,c.header=e,c.filter=a,c.hideFilters=r,c.cardMessageOverrides=i,c.selectionMode=o??"single",c.addEventListener("rfxItemBrowserClose",l),c.addEventListener("rfxItemBrowserSelection",s),c},u=({templateProperties:e,portalItem:t,modalStrings:n,showPrimaryButton:r,onCancel:o,onSave:i})=>{const l=document.createElement("rfx-modal"),{header:s,secondary:c}=n;(0,a.i)(c)||(l.labels={secondary:c}),l.showPrimaryButton=r;const d=document.createElement("div");d.innerHTML=s,d.slot="header",l.appendChild(d);const u=document.createElement("rfx-template-editor");u.value=e,u.portalItem=t;const m=document.createElement("div");return m.slot="content",m.style.height="50vh",m.appendChild(u),l.appendChild(m),l.addEventListener("rfxModalSecondaryClick",o),l.addEventListener("rfxModalPrimaryClick",(()=>{i(u.value)})),l.addEventListener("rfxModalClose",o),l},m=(e,t,n)=>{const a=document.createElement(e);var r,o;return r=a,o=n,Object.keys(o).forEach((e=>{r.setAttribute(e,o[e])})),a.innerHTML=t,a},p={modal:{kind:"warning"},header:{slot:"header",style:"\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    "},headerIcon:{icon:"exclamation-mark-triangle-f",style:"\n      margin: 0 1rem;\n      --calcite-ui-icon-color: var(--calcite-color-status-warning);\n    "},content:{slot:"content"}},f=({modalStrings:{header:e,content:t}})=>{const n=m("rfx-modal","",p.modal);n.showPrimaryButton=!1;const a=m("div","",p.header),r=m("div",e,{}),o=m("calcite-icon","",p.headerIcon);a.appendChild(o),a.appendChild(r);const i=m("div","",p.content);return i.appendChild(m("p",t,{})),n.appendChild(a),n.appendChild(i),n.addEventListener("rfxModalSecondaryClick",(()=>{n.remove(),n.open=!1})),n.addEventListener("rfxModalClose",(()=>{n.remove(),n.open=!1})),n},h=({modalStrings:{content:e,linkUrl:t,linkText:n},autoClose:o=!0,onLinkClicked:i})=>{const l=m("calcite-alert",e,{kind:"success",scale:r.C.l,open:!0,label:"save success"});l.autoClose=o;const s=m("div",e,{slot:"message"});if(l.appendChild(s),!1===(0,a.i)(t)&&!1===(0,a.i)(n)){const e=m("calcite-link",n,{slot:"link",href:t,target:"_blank"});"function"==typeof i&&(e.onclick=i),l.appendChild(e)}return l},v=({modalStrings:{content:e,header:t,functionNames:n}})=>{const a=m("calcite-alert",e,{kind:"warning",scale:r.C.m,open:!0,label:"deprecate function"});a.autoClose=!0;const o=m("div",t,{slot:"title"}),i=m("div",e,{slot:"message"}),l=m("p",n,{});return i.appendChild(l),a.appendChild(i),a.appendChild(o),a},C=({modalStrings:{content:e,header:t,functionNames:n}})=>{const a=m("calcite-alert",e,{kind:"warning",scale:r.C.m,open:!0,label:"unsupported function"});a.autoClose=!0;const o=m("div",t,{slot:"title"}),i=m("div",e,{slot:"message"}),l=m("p",n,{});return i.appendChild(l),a.appendChild(i),a.appendChild(o),a},y=({modalStrings:{header:e,content:t}})=>{const n=m("calcite-alert",t,{kind:"danger",scale:r.C.m,open:!0,icon:"exclamation-mark-triangle",label:"error",autoClose:!0,autoCloseDuration:"medium"});n.autoClose=!1;const a=m("div",e,{slot:"title"}),o=m("div",t,{slot:"message"});return n.appendChild(o),n.appendChild(a),n},E=({heading:e,labels:t,showPrimaryButton:n,handlePanelClose:a,handlePanelOk:r,inputLayers:o,layerValue:i,createLayerBrowse:l})=>{let s;const c=m("rfx-modal","",{open:!0});c.labels=t,c.showPrimaryButton=n,c.addEventListener("rfxModalClose",a),c.setAttribute("style","--calcite-dialog-size-y: 32rem"),c.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await(s?.getRasterValue());r({rasterValue:e})})),c.addEventListener("rfxModalSecondaryClick",a);const d=m("div",e,{slot:"header"}),u=m("div","",{slot:"content"});return c.appendChild(d),s=document.createElement("rfx-select-layer-panel"),s.value=i?.value,s.inputLayers=o,c.addEventListener("rfxlayerSelectBrowseLayerClick",l),u.appendChild(s),c.appendChild(u),c},g=({modalStrings:{header:e,content:t}})=>{const n=m("calcite-alert",t,{kind:"info",scale:r.C.m,open:!0,label:"read only"});n.autoClose=!0;const a=m("div",e,{slot:"title"}),o=m("div",t,{slot:"message"});return n.appendChild(o),n.appendChild(a),n}},74670:(e,t,n)=>{n.d(t,{D:()=>s,J:()=>m,a:()=>d,b:()=>h,c:()=>A,d:()=>v,e:()=>C,f:()=>T,g:()=>w,h:()=>R,i:()=>c,j:()=>y,k:()=>u,l:()=>f,m:()=>l,n:()=>I,o:()=>b,p:()=>L,s:()=>k});var a=n(5294),r=(n(13661),n(18423),n(21255),n(35431),n(24360)),o=n(92991),i=(n(588),n(55448),n(2924),n(11840),n(52373),n(33752),n(440),n(66744),n(44345),n(48001));n(23795),n(17902),n(56451),n(71802),n(32513),n(36596);const l=[38,39,40,41,42,43,47,54,55,58,66,67,68,69,70,71,72,73,74,75,93,94],s="distanceLegacy",c=e=>{const t=e?.category;return!![s].includes(t)},d=e=>!0===e?.hidden,u={local:"LocalFunction"},m={RASTER_FUNCTION_TEMPLATE:"RasterFunctionTemplate",RASTER_FUNCTION_VARIABLE:"RasterFunctionVariable",ARGUMENT_ARRAY:"ArgumentArray",RECORD_SET:"RecordSet",ECD_FILE:"ECDFile"},p={MATCH_VARIABLE:"MatchVariable",UNION_DIMENSION:"UnionDimension"},f={name:"Raster",isDataset:!0,isPublic:!1,type:m.RASTER_FUNCTION_VARIABLE};function h(e){return null==e?"":e.name||e.datasetName&&e.datasetName.name}function v(e){return e.hasOwnProperty("EsriClassifierDefinitionFile")}function C(e){return e.type&&e.type.toLowerCase().indexOf(m.RECORD_SET.toLowerCase())>=0}function y(e,t){const n=t&&t.value;if(null==n)return;let a;return e.some((e=>{if(e.values&&e.values.indexOf(n)>-1)return a=e.inputArgs,!0})),a}function E(e,t){let n;if(!(0,o.i)(e)&&(n=e.rasterFunctionArguments,1===Object.keys(n).length&&!e.hasArgumentsObject))return!0;const a=t.arguments,r=a&&a.type;return!(!r||r!==m.RASTER_FUNCTION_TEMPLATE&&r!==m.RASTER_FUNCTION_VARIABLE)||void 0}function g(e,t,n){if((0,o.i)(t)||(0,o.i)(n))return;const a=e?.rasterFunctionArguments;return(0,o.i)(a)?void 0:(0,i.b)(t,a)}function R(e,t,n,a){if((0,o.i)(t)&&(0,o.i)(a))return!1;const i=g(e,a=a||t.key,n);if(!(0,o.i)(i)&&i.dataType===r.d.rasterArray)return!0;if(!t)return;const l=t.value;if(l&&l.elements){return l.elements.some((e=>e&&(e.isDataset||e.type===m.RASTER_FUNCTION_TEMPLATE||e.value&&e.value.type===m.RASTER_FUNCTION_TEMPLATE)))}l&&Array.isArray(l)&&l.some((e=>e&&e.name&&e.url))}function A(e,t,n){t.value||(t.value={elements:[],type:m.ARGUMENT_ARRAY});let a=t.value&&t.value.elements?t.value.elements:t.value;return a&&Array.isArray(a)?void 0!==n?a[n]=e:(a.push(e),n=a.length-1):(a=[e],n=0),t.value&&t.value.elements?t.value.elements=a:t.value=a,n}function w(e,t,n){let a,r;if("string"==typeof t?a=t:(a=t.key,r=t.index),(0,o.i)(a)||(0,o.i)(n))return;const i=n.arguments,l=i&&i.type,s=a&&a.toLowerCase();let c;if(E(e,n))return l!==m.RASTER_FUNCTION_TEMPLATE&&!i.isDataset||"raster"!==s?l===m.RASTER_FUNCTION_VARIABLE&&"rasters"===s&&(c=void 0!==r?function(e,t){if((0,o.i)(t)||void 0===e)return;const n=t.value&&t.value.elements?t.value.elements:t.value;return n&&n.length?n[e]:void 0}(r,i):i):c=i,c;if(c=i[a],void 0!==r&&R(e,c,n,a)){const e=c.value&&c.value.elements?c.value.elements:c.value;c=e&&e.length?e[r]:void 0}return c}function T(e,t){if((0,o.i)(t))return;const n=[],r=t.arguments,i=r&&r.type;if(E(e,t)){let e,t=a.clone(r);return e=i===m.RASTER_FUNCTION_TEMPLATE||t.isDataset?"Raster":"Rasters",(0,o.i)(t)?t={key:e}:t.key=e,n.push(t),n}return Object.keys(r).forEach((e=>{if(e===p.MATCH_VARIABLE||e===p.UNION_DIMENSION)return;let t=a.clone(r[e]);(0,o.a)(t)&&((0,o.i)(t)?t={key:e}:t.key=e,n.push(t))})),n}function k(e,t,n,a,r){if((0,o.i)(t)||(0,o.i)(n)||(0,o.i)(a))return;const i=t.arguments,l=R(e,i,t,a)&&void 0!==r;if(E(e,t))l?r=A(n,i,r):t.arguments=n;else{const e=i[a];l?r=A(n,e,r):i[a]=n}return n.value&&"Scalar"===n.value.type&&(0,o.i)(n.name)&&(n.name=l?t.function.type.toLowerCase()===u.local.toLowerCase()&&r>0?`InRaster${r+1}`:`Raster${r>0?r+1:""}`:g(e,a,t).displayName||a),{key:a,index:r}}function L(e){return e.dataType===r.d.raster||e.dataType===r.d.rfxtemplate}function b(e){return e.dataType===r.d.scalar}const I=(e,t,n)=>{let a=e;!function e(r){if(r>=t.length)return void n(a);const o=t[r];let i;if("shadowRoot"===o)i=a?.shadowRoot;else if(o.startsWith("children[")){const e=parseInt(o.match(/\d+/)[0],10);i=a.children[e]}i?(a=i,e(r+1)):requestAnimationFrame((()=>e(r)))}(0)}}}]);