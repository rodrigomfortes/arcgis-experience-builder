/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-859891.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-859891"],{183:(e,t,i)=>{i.r(t),i.d(t,{arcgis_table_column_info:()=>c,arcgis_table_editing_popover:()=>d,arcgis_table_field_selection:()=>h});var s=i(11254),l=i(10465),a=i(17840),n=i(14528),o=i(69811),r=i(38698);i(56612);const c=class{constructor(e){(0,s.r)(this,e),this.arcgisClose=(0,s.c)(this,"arcgisClose",7),this.arcgisSetupComplete=(0,s.c)(this,"arcgisSetupComplete",7),this.manager=(0,n.u)(this),this.props=void 0,this.fieldName=void 0,this.popoverReferenceElement=void 0,this.strings=void 0}async reposition(){this.popoverNode?.reposition()}async componentWillLoad(){const{layer:e}=this.props;this.fieldsMap=await(0,a.f)(e)}componentDidLoad(){this.closeButtonNode?.setFocus()}render(){const{strings:e,fieldName:t,fieldsMap:i,popoverReferenceElement:a}=this,n=i.get(t),o=(0,l.b)(this.el);return(0,s.h)(s.H,{key:"69652bf132c05e0805c5e5d76158b2495c651259",class:"js-app-flyout"},(0,s.h)("calcite-popover",{key:"3d24881b6919c5b14e5a172d9a08e4debc121ca6",dir:o,placement:"leading",referenceElement:a,offsetDistance:-30,offsetSkidding:0,open:!0,pointerDisabled:!0,overlayPositioning:"fixed",class:"popover",label:e.fieldInfo,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"134d2ab5a481ae66f438de728034dca31ee0f647",heading:n.alias||n.name,description:t,class:"panel"},this.renderCloseButton(),this.renderInfo())))}renderCloseButton(){const{strings:e}=this;return(0,s.h)("calcite-action",{slot:"header-actions-end",scale:"s",text:e.close,icon:"x",onClick:()=>this.arcgisClose.emit(),ref:e=>this.closeButtonNode=e})}renderInfo(){const{layer:e,view:t}=this.props,{fieldName:i}=this;return(0,s.h)("arcgis-field-info",{fieldName:i,layer:e,view:t,class:"info",ref:e=>{e?.addEventListener("arcgisComplete",(()=>{this.reposition(),this.arcgisSetupComplete.emit()}))}})}get el(){return(0,s.a)(this)}};c.style=".popover{--calcite-popover-z-index:100}.panel{max-height:400px;max-width:420px}.info{background-color:var(--calcite-color-foreground-1);max-height:400px;max-width:420px;min-width:240px;overflow-x:hidden}";const d=class{constructor(e){(0,s.r)(this,e),this.arcgisClose=(0,s.c)(this,"arcgisClose",7),this.manager=(0,n.u)(this),this.referenceElement=void 0,this.strings=void 0}async reposition(){this.popoverNode?.reposition()}async setFocus(){this.panelNode?.setFocus()}componentDidLoad(){this.panelNode?.setFocus()}render(){const{referenceElement:e,strings:t}=this;return(0,s.h)(s.H,{key:"5cd42cf056b2afec8fa46d647503a6dc770b22f8",class:"js-app-flyout arcgis-table-editing-popover"},(0,s.h)("calcite-popover",{key:"d03060e341bd925d9507258ec7e8602206c7d6fd",referenceElement:e,placement:"auto",open:!0,offsetSkidding:0,offsetDistance:-10,overlayPositioning:"fixed",label:"",class:"info-popover",ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"c167e1c7d7f1af374aab63e1b73f51a9ffad56ab",heading:t.layerEditing,closable:!0,ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisClose.emit(),setTimeout((()=>e.parentElement.focus()),300)}},(0,s.h)("div",{key:"7bd6ac103d02c4c7091f62e7b4211cce51eb304b",class:"info"},(0,s.h)("div",{key:"7df628a23af7c1a84f803602c919ea067f6eb5fd"},t.layerEditingMsg)))))}get el(){return(0,s.a)(this)}};d.style=".info{padding:10px 10px 15px 10px;background-color:var(--calcite-color-foreground-1)}.info-popover{max-width:250px}";const h=class{constructor(e){(0,s.r)(this,e),this.arcgisClose=(0,s.c)(this,"arcgisClose",7),this.arcgisSortByChange=(0,s.c)(this,"arcgisSortByChange",7),this.arcgisFieldColumnTemplatesVisibilityChange=(0,s.c)(this,"arcgisFieldColumnTemplatesVisibilityChange",7),this.arcgisAttachmentColumnTemplateVisibilityChange=(0,s.c)(this,"arcgisAttachmentColumnTemplateVisibilityChange",7),this.arcgisRelationshipsColumnTemplateVisibilityChange=(0,s.c)(this,"arcgisRelationshipsColumnTemplateVisibilityChange",7),this.manager=(0,n.u)(this),this.filterFields=void 0,this.changedFieldNames=[],this.listItemChangeHandle=void 0,this.strings=void 0,this.props=void 0,this.popoverReferenceElement=void 0,this.columnTemplates=void 0,this.fieldColumnOrder=void 0,this.sortBy=void 0,this.attachmentsEnabled=!1,this.relationshipsEnabled=!1,this.lastSortBy="display"}async reposition(){this.popoverNode?.reposition()}async componentWillLoad(){const{layer:e}=this.props;this.fieldsMap=await(0,a.f)(e),this.totalCounts=this.getTotalFieldTypeCount(),this.lastSortBy=this.sortBy||"default",this.FieldColumnTemplate=await(0,o.aO)()}componentDidLoad(){this.popoverNode?.setFocus()}render(){const{strings:e,popoverReferenceElement:t}=this,i=(0,l.b)(this.el);return(0,s.h)(s.H,{key:"fe44248879ecfeacb119291a51d8410b8950ee22",class:"js-app-flyout"},(0,s.h)("calcite-popover",{key:"3d147172c0db7002591c22185cf4bd13a8b1921d",dir:i,placement:"auto-start",referenceElement:t,open:!0,pointerDisabled:!0,offsetDistance:-32,offsetSkidding:0,overlayPositioning:"fixed",label:e.fieldVisibility,class:"popover",ref:e=>this.popoverNode=e},(0,s.h)("calcite-flow",{key:"e41f5231c9e42f9a9a51416222ab311c92dd7ee5",class:"flow",ref:e=>this.flowNode=e},(0,s.h)("calcite-flow-item",{key:"5f4b60bfd63e74a15cc13c294ca81dd199cac11c",heading:e.fieldVisibility,ref:e=>this.flowItemNode=e,closable:!0,onCalciteFlowItemClose:()=>this.arcgisClose.emit()},this.renderList(),this.renderDoneButton()))))}renderList(){const{strings:e}=this;return(0,s.h)("calcite-list",{label:e.selectFields,class:"content","drag-enabled":!1,selectionMode:"multiple",filterEnabled:!0,filterPlaceholder:e.filterFields,onCalciteListFilter:e=>{const t=e.currentTarget;this.filterFields=t.filteredItems,(0,s.f)(this.el)},ref:e=>this.listNode=e},this.renderSort(),this.renderSelection(),this.renderFieldColumnTemplateListItems(),this.renderAttachmentListItem(),this.renderRelationshipsListItem())}renderSort(){const{lastSortBy:e,totalCounts:t,strings:i}=this,l=t.number>0,a=t.string>0,n=t.date>0,o=!(!l||!a&&!n)||!(!a||!n);return(0,s.h)("calcite-dropdown",{slot:"filter-actions-end",placement:"bottom-end",overlayPositioning:"fixed"},(0,s.h)("calcite-action",{slot:"trigger",text:i.sortFields,title:i.sortFields},(0,s.h)("calcite-icon",{scale:"s",icon:"sortDescending",flipRtl:!0})),(0,s.h)("calcite-dropdown-group",{groupTitle:i.sortBy},(0,s.h)("calcite-dropdown-item",{selected:"default"===e,onClick:()=>{this.lastSortBy="default",this.arcgisSortByChange.emit(this.lastSortBy)},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy="default",this.arcgisSortByChange.emit(this.lastSortBy))}},i.default),(0,s.h)("calcite-dropdown-item",{selected:"display"===e,onClick:()=>{this.lastSortBy="display",this.arcgisSortByChange.emit(this.lastSortBy)},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy="display",this.arcgisSortByChange.emit(this.lastSortBy))}},i.sortByDisplayName),o?(0,s.h)("calcite-dropdown-item",{selected:"type"===e,onClick:()=>{this.lastSortBy="type",this.arcgisSortByChange.emit(this.lastSortBy)},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy="type",this.arcgisSortByChange.emit(this.lastSortBy))}},i.sortByType):null,(0,s.h)("calcite-dropdown-item",{selected:"field"===e,onClick:()=>{this.lastSortBy="field",this.arcgisSortByChange.emit(this.lastSortBy)},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy="field",this.arcgisSortByChange.emit(this.lastSortBy))}},i.sortByFieldName)))}renderSelection(){const{filterFields:e,strings:t}=this,i=this.filterContainsAll();return(0,s.h)("calcite-button",{key:`${e}`,class:"select-button",appearance:"transparent",scale:"s",width:"full",onClick:()=>this.handleSelectionAllClick(i),label:i?t.deselectAll:t.selectAll},i?t.deselectAll:t.selectAll)}renderFieldColumnTemplateListItems(){const{fieldColumnOrder:e,lastSortBy:t}=this;let i=this.cloneFieldTemplates();return e&&(i=i.sort(((t,i)=>e.indexOf(t.fieldName)-e.indexOf(i.fieldName)))),"display"===t?i=this.sortFieldsAlphabetically(i):"type"===t?i=this.sortFieldsByType(this.sortFieldsAlphabetically(i)):"field"===t&&i.sort(((e,t)=>e.fieldName.localeCompare(t.fieldName))),i.map((e=>this.renderFieldColumnTemplateListItem(e)))}renderFieldColumnTemplateListItem(e){const{strings:t}=this;return(0,s.h)("calcite-list-item",{key:e.fieldName,label:e.label,value:e.fieldName,selected:e.visible,onCalciteListItemSelect:e=>{const t=e.currentTarget;this.handleFieldColumnTemplateListItemChange(t)}},(0,s.h)("calcite-action",{slot:"actions-end",text:t.info,onClick:t=>{t.stopPropagation(),this.handleInfoClick(e,t.target)}},(0,s.h)("calcite-icon",{scale:"s",icon:"information"})))}renderAttachmentListItem(){const{strings:e,props:t}=this,{layer:i}=t;if(!(0,r.e)(i))return(0,s.h)(s.F,null);const l=this.columnTemplates.find((e=>"attachment"===e.type));return(0,s.h)("calcite-list-item",{key:"attachments",label:e.photosAndFiles,description:e.attachments,value:"__attachments",selected:l?.visible,hidden:!1,onCalciteListItemSelect:e=>{const t=e.currentTarget;this.handleAttachmentsItemChange(t)}})}renderRelationshipsListItem(){const{layer:e}=this.props,{strings:t}=this;if(!("relationships"in e)||!e.relationships?.length)return(0,s.h)(s.F,null);const i=this.columnTemplates.find((e=>"relationship"===e.type));return(0,s.h)("calcite-list-item",{key:"relationships",label:t.relatedRecords,value:"__relationships",selected:i?.visible,hidden:!1,onCalciteListItemSelect:e=>{const t=e.currentTarget;this.handleRelationshipsItemChange(t)}})}renderDoneButton(){const{strings:e}=this;return(0,s.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:"full",onClick:()=>this.arcgisClose.emit(),label:e.done},e.done)}getTotalFieldTypeCount(){const{columnTemplates:e,fieldsMap:t}=this,i={string:0,number:0,date:0};return e.forEach((e=>{if("field"===e.type){switch(t.get(e.fieldName).type){case"small-integer":case"big-integer":case"integer":case"single":case"double":case"long":case"oid":case"guid":i.number++;break;case"string":i.string++;break;case"date":case"date-only":case"time-only":case"timestamp-offset":i.date++}}})),i}cloneFieldTemplates(){return(this.columnTemplates.filter((e=>"field"===e.type))??[]).map((e=>new this.FieldColumnTemplate({fieldName:e.fieldName,label:e.label,visible:e.visible,menuConfig:e.menuConfig,format:e.format})))}handleSelectionAllClick(e){const{columnTemplates:t,filterFields:i}=this;t.forEach((t=>{i&&!i.some((e=>e.value===t.fieldName))||(t.visible=!e)})),this.listNode.querySelectorAll("calcite-list-item").forEach((t=>{i&&!i.some((e=>e.value===t.value))||t.selected!==e||(t.selected=!e,this.changedFieldNames.push(t.value),this.handleListItemChange(t))})),(0,s.f)(this.el)}filterContainsAll(){const{props:e,columnTemplates:t,filterFields:i,attachmentsEnabled:s,relationshipsEnabled:l}=this,{layer:a}=e;if(i){const e=i.filter((e=>"__attachments"!==e.value&&"__relationships"!==e.value)).map((e=>({value:e.value,selected:e.selected}))),a=t.filter((t=>e.some((e=>t.fieldName===e.value)))),n=!!i.find((e=>"__attachments"===e.value)),o=!!i.find((e=>"__relationships"===e.value));return e.every((e=>!a.some((t=>t.fieldName===e.value&&!t.visible))))&&(n&&s&&(o&&l||!o)||o&&l&&!n||!n&&!o)}{const e=(0,r.e)(a),i="relationships"in a&&a.relationships?.length;return t.every((e=>e.visible))&&(e&&s&&(i&&l||!i)||i&&l&&!e||!e&&!i)}}handleListItemChange(e){"__attachments"===e.value?this.handleAttachmentsItemChange(e):"__relationships"===e.value?this.handleRelationshipsItemChange(e):this.handleFieldColumnTemplateListItemChange(e)}handleFieldColumnTemplateListItemChange(e){const{columnTemplates:t}=this;t.forEach((t=>{t.fieldName===e.value&&t.visible!==e.selected&&(t.visible=e.selected,this.changedFieldNames.push(t.fieldName))})),this.listItemChangeHandle&&clearTimeout(this.listItemChangeHandle),this.listItemChangeHandle=setTimeout((()=>{this.listItemChangeHandle=void 0,this.arcgisFieldColumnTemplatesVisibilityChange.emit(new Set([...this.changedFieldNames])),this.changedFieldNames=[],(0,s.f)(this.el)}),100)}handleAttachmentsItemChange(e){const t=e.selected;this.arcgisAttachmentColumnTemplateVisibilityChange.emit(t),this.attachmentsEnabled=t,(0,s.f)(this.el)}handleRelationshipsItemChange(e){const t=e.selected;this.arcgisRelationshipsColumnTemplateVisibilityChange.emit(t),this.relationshipsEnabled=t,(0,s.f)(this.el)}handleInfoClick(e,t){const{layer:i,view:s}=this.props,{flowNode:l,flowItemNode:a}=this,n=a.getBoundingClientRect(),o=document.createElement("arcgis-field-info");o.fieldName=e.fieldName,o.layer=i,o.view=s,o.className="info";const r=document.createElement("calcite-flow-item");r.heading=e.label??e.fieldName,r.description=e.fieldName,r.style.height=`${n.height}px`,r.style.width=`${n.width}px`,r.appendChild(o),r.addEventListener("calciteFlowItemBack",(()=>{l.removeChild(r),this.flowItemNode.selected=!0,requestAnimationFrame((()=>t.setFocus()))})),l.appendChild(r),r.selected=!0,this.flowItemNode.selected=!1,setTimeout((()=>{r.setFocus(),this.reposition()}),200)}sortFieldsAlphabetically(e){return e.sort(((e,t)=>e.label.startsWith("_")?1:t.label.startsWith("_")?-1:e.label.localeCompare(t.label)))}sortFieldsByType(e){const{fieldsMap:t}=this;return e.filter((e=>["small-integer","big-integer","integer","single","double","long"].includes(t.get(e.fieldName).type))).map((e=>e)).concat(e.filter((e=>"string"===t.get(e.fieldName).type)).map((e=>e))).concat(e.filter((e=>["date","date-only","time-only","timestamp-offset"].includes(t.get(e.fieldName).type))).map((e=>e))).concat(e.filter((e=>"oid"===t.get(e.fieldName).type)).map((e=>e))).concat(e.filter((e=>"guid"===t.get(e.fieldName).type)).map((e=>e))).concat(e.filter((e=>!["small-integer","big-integer","integer","single","double","long","string","date","date-only","time-only","timestamp-offset","oid","guid"].includes(t.get(e.fieldName).type))).map((e=>e)))}get el(){return(0,s.a)(this)}};h.style=".popover{--calcite-popover-z-index:100}.flow{height:400px;width:280px}.content{max-height:80vh}.select-button{margin:4px 0}.info{background-color:var(--calcite-color-foreground-1)}"},10465:(e,t,i)=>{i.d(t,{D:()=>s,a:()=>h,b:()=>r,c:()=>o,g:()=>b,s:()=>v});class s{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}const l=(e,t,i)=>(0,n(t).subscribe)((t=>{const s=t.some((t=>((e,t)=>{let i=e;for(;i;){if(i===t)return!0;if(!i.parentNode)return!1;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(e,t.target)));s&&i()})),a={},n=e=>{const t=e.join(","),i=a[t];if(void 0!==i)return i;const s=new Set,l=new MutationObserver((e=>s.forEach((t=>t(e)))));globalThis.document&&l.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const n={subscribe:e=>(s.add(e),()=>{s.delete(e),0===s.size&&(l.disconnect(),a[t]=void 0)})};return a[t]=n,n},o=(e,t)=>{let i=e;for(;i;){const e=i.closest?.(t);if(e)return e;const s=i.getRootNode?.();if(s===globalThis.document)return null;i=s.host}return null},r=e=>c(e,"dir","ltr"),c=(e,t,i)=>{const s=o(e,`[${t}]`);return s?.getAttribute(t)??i},d=e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},h=()=>[d(2),d(1),d(1),d(1),d(3)].join("-"),p="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),m=new Set(p),f="en",u={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},g={},y=async(e,t)=>{const i=`${t}${e}.json`;try{const e=await fetch(i);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===f?{}:await y(f,t)},b=e=>{const t=c(e,"lang",globalThis.navigator?.language||f);return{lang:t,t9nLocale:C(t)}},C=e=>{const[t,i]=e.split("-"),s=t.toLowerCase();let l=s;return i&&(l=`${s}-${i.toUpperCase()}`),l=u[l]??l,m.has(l)?l:i?C(s):f},v=(e,t,i,s)=>{let a;const n=()=>N(e,t(),s).then((e=>{a?.lang===e.lang&&a.t9nLocale===e.t9nLocale&&a.t9nStrings===e.t9nStrings||i(e),a=e})).catch(console.error);return queueMicrotask(n),l(e,["lang"],n)},N=async(e,t,i=e.localName.split("-").slice(1).join("-"))=>{const{lang:s,t9nLocale:l}=b(e),a=`${t}/${i}/t9n`,n=null===i?{}:await(async(e,t,i="")=>{const s=`${t}/${i}`,l=`${s}${e}.json`;return g[l]??(g[l]=y(e,s)),await g[l]})(l,a,"messages.");return{lang:s,t9nLocale:l,t9nStrings:n}}},38698:(e,t,i)=>{var s;i.d(t,{S:()=>s,a:()=>o,e:()=>d,g:()=>c,i:()=>n,r:()=>r,s:()=>a}),function(e){e.SMALL="s",e.MEDIUM="m",e.LARGE="l"}(s||(s={}));const l=["feature","oriented-imagery","map-image","subtype-sublayer"],a=["feature","scene","geojson","csv","subtype-sublayer","oriented-imagery","catalog-footprint"];function n(e,t){for(;e;){if(e.nodeName===t.toUpperCase())return!0;e=e.parentElement}return!1}function o(e,t){const i=document.createElement("calcite-tooltip");i.className="table-tooltip",i.referenceElement=e,i.placement="trailing-start",i.open=!0;const s=document.createElement("div");s.className="tooltip",s.innerHTML=t,i.append(s),document.body.append(i)}function r(){document.querySelectorAll(".table-tooltip").forEach((e=>e.parentNode?.removeChild(e)))}function c(e){return[..."templates"in e&&Array.isArray(e.templates)?e.templates:[],..."types"in e&&Array.isArray(e.types)?e.types.flatMap((e=>e.templates)):[]]}function d(e){return(l.includes(e.type)||"sublayer"===e.type&&l.includes(e.layer.type))&&function(e){if(!e?.capabilities)return!1;const{capabilities:{data:{supportsAttachment:t},operations:{supportsQueryAttachments:i}}}=e;return t&&i}(e)}}}]);