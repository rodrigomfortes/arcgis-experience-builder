/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-02fe14.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-02fe14"],{10465:(e,t,i)=>{i.d(t,{D:()=>s,a:()=>m,b:()=>o,c:()=>r,g:()=>T,s:()=>v});class s{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}const n=(e,t,i)=>(0,l(t).subscribe)((t=>{const s=t.some((t=>((e,t)=>{let i=e;for(;i;){if(i===t)return!0;if(!i.parentNode)return!1;i=i.parentNode instanceof ShadowRoot?i.parentNode.host:i.parentNode}return!1})(e,t.target)));s&&i()})),a={},l=e=>{const t=e.join(","),i=a[t];if(void 0!==i)return i;const s=new Set,n=new MutationObserver((e=>s.forEach((t=>t(e)))));globalThis.document&&n.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const l={subscribe:e=>(s.add(e),()=>{s.delete(e),0===s.size&&(n.disconnect(),a[t]=void 0)})};return a[t]=l,l},r=(e,t)=>{let i=e;for(;i;){const e=i.closest?.(t);if(e)return e;const s=i.getRootNode?.();if(s===globalThis.document)return null;i=s.host}return null},o=e=>d(e,"dir","ltr"),d=(e,t,i)=>{const s=r(e,`[${t}]`);return s?.getAttribute(t)??i},c=e=>{let t="";for(let i=0;i<e;i++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},m=()=>[c(2),c(1),c(1),c(1),c(3)].join("-"),h="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),u=new Set(h),g="en",p={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},f={},b=async(e,t)=>{const i=`${t}${e}.json`;try{const e=await fetch(i);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===g?{}:await b(g,t)},T=e=>{const t=d(e,"lang",globalThis.navigator?.language||g);return{lang:t,t9nLocale:y(t)}},y=e=>{const[t,i]=e.split("-"),s=t.toLowerCase();let n=s;return i&&(n=`${s}-${i.toUpperCase()}`),n=p[n]??n,u.has(n)?n:i?y(s):g},v=(e,t,i,s)=>{let a;const l=()=>w(e,t(),s).then((e=>{a?.lang===e.lang&&a.t9nLocale===e.t9nLocale&&a.t9nStrings===e.t9nStrings||i(e),a=e})).catch(console.error);return queueMicrotask(l),n(e,["lang"],l)},w=async(e,t,i=e.localName.split("-").slice(1).join("-"))=>{const{lang:s,t9nLocale:n}=T(e),a=`${t}/${i}/t9n`,l=null===i?{}:await(async(e,t,i="")=>{const s=`${t}/${i}`,n=`${s}${e}.json`;return f[n]??(f[n]=b(e,s)),await f[n]})(n,a,"messages.");return{lang:s,t9nLocale:n,t9nStrings:l}}},62314:(e,t,i)=>{i.d(t,{a:()=>b,b:()=>w,c:()=>P,d:()=>d,e:()=>v,f:()=>u,g:()=>E,h:()=>h,i:()=>T,j:()=>g,k:()=>r,l:()=>y,m:()=>o,n:()=>f,o:()=>c,p:()=>p,t:()=>m,u:()=>x});var s=i(17840),n=i(10465),a=i(14528);const l=[{value:"centuries",appliesTo:["centuries"]},{value:"decades",appliesTo:["centuries","decades"]},{value:"years",appliesTo:["centuries","decades","years"]},{value:"months",appliesTo:["decades","years","months","months-hours"]},{value:"weeks",appliesTo:["years","months","weeks","months-hours"]},{value:"days",appliesTo:["months","weeks","days","months-hours"]},{value:"hours",appliesTo:["weeks","days","hours","months-hours"]},{value:"minutes",appliesTo:["days","hours","minutes","seconds"]},{value:"seconds",appliesTo:["hours","minutes","seconds"]}],r=10,o=6e4,d=2e3,c=9999;function m(e,t){const i=e?.start,s=e?.end,n=t?.start,a=t?.end,l=i&&n&&i?.getTime()===n?.getTime(),r=s&&a&&s?.getTime()===a?.getTime();return!(i&&n||!r)||(!(s&&a||!l)||l&&r)}function h(e,t){if(!e)return;const i=e?new Date(e.toLocaleString("en-US",{timeZone:"system"!==t&&"unknown"!==t?t:void 0})):new Date(Date.now()),s=i.getFullYear();let n=`${i.getMonth()+1}`,a=`${i.getDate()}`;return n.length<2&&(n=`0${n}`),a.length<2&&(a=`0${a}`),[s,n,a].join("-")}function u(e,t){if(!e)return;const i=e?e.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",timeZone:"system"!==t&&"unknown"!==t?t:void 0}):"00:00:00";return 0===e.getHours()||i.includes("24:")?i.replace("24:","00:"):i}function g(e,t,i){const s=function(e,t,i){if(i&&"system"!==i&&"unknown"!==i&&t){const s=new Date(t.toLocaleString("en-US",{timeZone:i})),n=s.getTime()-t.getTime(),a=e?e.split(":"):["00","00"],l=Number.parseInt(a[0]??0),r=Number.parseInt(a[1]??0),o=Number.parseInt(a[2]??0);return s.setHours(l),s.setMinutes(r),s.setSeconds(o),new Date(s.getTime()-n).toLocaleString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"})}return e}(t,e,i),n=s?.split(":")||["00","00","00"],a=n.length>0?Number.parseInt(n[0]):0,l=n.length>1?Number.parseInt(n[1]):0,r=n.length>2?Number.parseInt(n[2]):0;return e?new Date(e.getFullYear(),e.getMonth(),e.getDate(),a,l,r):void 0}function p(){return l.map((e=>e.value))}function f(e){if(!e?.start||!e.end){return S(1,36e5,"hours")}const t=r,i=(e.end.getTime()-e.start.getTime())/t,s=31104e8;if(i>s)return S(i,s,"centuries");const n=31104e7;if(i>n)return S(i,n,"decades");const a=31104e6;if(i>a)return S(i,a,"years");const l=2592e6;if(i>l)return S(i,l,"months");const o=6048e5;if(i>o)return S(i,o,"weeks");const d=864e5;if(i>d)return S(i,d,"days");const c=36e5;if(i>c)return S(i,c,"hours");if(i>6e4)return S(i,6e4,"minutes");return i>1e3?S(i,1e3,"seconds"):S(i,1,"minutes")}function b(e,t){if(e&&t){const i=e.interval&&t.interval,s=e.count&&t.count;return!(!i&&!s)&&(!(!i||e.interval.value!==t.interval.value||e.interval.unit!==t.interval.unit)||!(!s||e.count!==t.count))}return!1}function T(e,t){const i=!(!(y(e)&&e.useViewTime&&e?.timeInfo?.fullTimeExtent?.start&&!Number.isNaN(e.timeInfo.fullTimeExtent.start.getTime())&&e?.timeInfo?.fullTimeExtent?.end)||Number.isNaN(e.timeInfo.fullTimeExtent.end.getTime()));let s=!1;if(t){const t=e.renderer?.visualVariables?.some((e=>e.valueExpression?.includes("timeProperties"))),i=e.renderer?.valueExpression?.includes("timeProperties");s=t||i}return i||s}function y(e){return"useViewTime"in e&&"timeInfo"in e}function v(e){return w(e)&&(0,s.i)(e.visibilityTimeExtent?.start)&&(0,s.i)(e.visibilityTimeExtent?.end)&&!Number.isNaN(e?.visibilityTimeExtent?.start?.getTime())&&!Number.isNaN(e?.visibilityTimeExtent?.end?.getTime())}function w(e){return"visibilityTimeExtent"in e}function S(e,t,i){return{value:Math.round(e/t),unit:i}}function E(e){return!(0,s.i)(e.start)&&(0,s.i)(e.end)?"cumulative-from-start":e.start?.getTime()===e.end?.getTime()?"instant":"time-window"}function x(){const e=(0,a.r)(),t=e;e.manager.onLoad((()=>{t.timeSliderConfigState=function(e,t){const i=_.get(e);if(i)return i;const s=(0,n.c)(e,t);if(s&&"store"in s)return _.set(e,s.store),s.store;return null}(e.el,"arcgis-time-slider-config").state}))}const _=new WeakMap;function P(e){e.view=void 0,e.fullTimeExtent=void 0,e.timeDisplayMode="time-window",e.stops=void 0,e.timeSliderEnabled=!1,e.playRate=d}},76711:(e,t,i)=>{i.r(t),i.d(t,{arcgis_time_slider_config:()=>u});var s=i(11254),n=i(62314),a=i(10465),l=i(93345),r=i(17840),o=i(14528),d=i(84260),c=i(69811);i(56612);const m="base",h={base:m,tabs:`${m}__tabs`,infoMessage:`${m}__info-message`,enableTimeSlider:`${m}__enable-timeslider`,playbackPosition:`${m}__playback-position`},u=class{constructor(e){(0,s.r)(this,e),this.arcgisTimeDisplayModeChange=(0,s.c)(this,"arcgisTimeDisplayModeChange",7),this.arcgisFullTimeExtentChange=(0,s.c)(this,"arcgisFullTimeExtentChange",7),this.arcgisStopsChange=(0,s.c)(this,"arcgisStopsChange",7),this.arcgisPlaybackPositionChange=(0,s.c)(this,"arcgisPlaybackPositionChange",7),this.arcgisPlayRateChange=(0,s.c)(this,"arcgisPlayRateChange",7),this.arcgisNoTimeEnabledLayersFound=(0,s.c)(this,"arcgisNoTimeEnabledLayersFound",7),this.arcgisTimeSliderEnableToggled=(0,s.c)(this,"arcgisTimeSliderEnableToggled",7),this.manager=(0,o.u)(this),this.strings=(0,d.u)({blocking:!0}),this.timeSliderConfigState=(0,n.u)(),this._handleTimeDisplayModeChange=e=>{this._updateTimeDisplayMode(e.detail)},this._handleTimeSliderEnableToggled=e=>{const{timeSliderConfigState:t}=this,i=e?.target?.checked;i&&!this.timeSliderEnabled?(this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,this._loadPersistedTimeSliderPropertiesFromSceneView().then((()=>this.arcgisTimeSliderEnableToggled.emit(i)))):this.arcgisTimeSliderEnableToggled.emit(i),this.timeSliderEnabled=i,t.timeSliderEnabled=i},this._handleFullTimeExtentChange=async e=>{const{timeSliderConfigState:t}=this;if(!(0,n.t)(t.fullTimeExtent,e.detail)){const t=await this._validateFullTimeExtent(e.detail);this._updateFullTimeExtent(t)}},this._handleStopsChange=e=>{const{timeSliderConfigState:t}=this;(0,n.a)(t.stops,e.detail)||this._updateStops(e.detail)},this._handlePlayRateChange=e=>{const{timeSliderConfigState:t}=this;t.playRate!==e.detail&&this._updatePlayRate(e.detail)},this.view=void 0,this.timeSliderEnabled=!1,this.hideTimeSliderEnableToggle=!1,this.hideInstantMode=!1,this.allowArcadeTime=!1,this.playbackPosition={show:!1,useSavedPosition:!1},this.store=(0,l.c)({isRTL:!1}),this.fullTimeExtent=void 0,this.timeDisplayMode=void 0,this.stops=void 0,this.playRate=n.d,this.noTimeAwareLayersAvailable=!1,this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1}async viewChange(){this.noTimeAwareLayersAvailable=!1,this.fulltimeExtentFromLayersInitialized=!1,this.fullTimeExtentFromViewInitialized=!1,await this._loadPersistedTimeSliderPropertiesFromSceneView()}async fulltimeExtentFromViewsInitializedChanged(){this.fullTimeExtentFromViewInitialized&&this._watchForLayerLoadedAndProperties()}async componentWillLoad(){this._reactiveUtils=await(0,c.l)(),this._timeUtils=await(0,c.aw)(),await this._loadStore()}async componentDidLoad(){await this._loadPersistedTimeSliderPropertiesFromSceneView(),this.timeZoneHandle=this._reactiveUtils.watch((()=>this.view?.timeZone),(async()=>(0,s.f)(this.el)))}disconnectedCallback(){this._watchLayerLoadedHandle?.remove(),this._watchWidgetPropertiesHandle?.remove(),this.timeZoneHandle?.remove()}render(){const{timeSliderConfigState:e}=this;return this.noTimeAwareLayersAvailable?(0,s.h)("div",{class:`${h.base} ${h.infoMessage}`},(0,s.h)("calcite-notice",{open:!0,icon:"information"},(0,s.h)("div",{slot:"message"},e.strings.noTimeEnabledLayers))):(0,s.h)("div",{class:h.base},this.renderTabs())}renderTabs(){const{timeSliderConfigState:e,playbackPosition:t}=this;return(0,s.h)(s.F,null,this.renderTimeSliderToggle(),(0,s.h)("calcite-tabs",{class:h.tabs,layout:"center"},(0,s.h)("calcite-tab-nav",{slot:"title-group"},(0,s.h)("calcite-tab-title",{selected:!0,"data-testId":"arcgis-time-slider-config-tab-title-timeextent",disabled:!this.timeSliderEnabled},e.strings.startEndPoints.title),(0,s.h)("calcite-tab-title",{"data-testId":"arcgis-time-slider-config-tab-title-interval",disabled:!this.timeSliderEnabled},e.strings.timeInterval.title),t.show&&(0,s.h)("calcite-tab-title",{disabled:!this.timeSliderEnabled,"data-testId":"arcgis-time-slider-config-tab-title-playback-position"},e.strings?.playbackPosition?.title),(0,s.h)("calcite-tab-title",{disabled:!this.timeSliderEnabled,"data-testId":"arcgis-time-slider-config-tab-title-playback"},e.strings?.playback?.title)),(0,s.h)("calcite-tab",{selected:!0},this.renderTimeExtent()),(0,s.h)("calcite-tab",null,this.renderTimeInterval()),t.show&&(0,s.h)("calcite-tab",null,this.renderPlaybackPosition()),(0,s.h)("calcite-tab",null,this.renderPlayRate())))}renderTimeSliderToggle(){const{timeSliderConfigState:e,hideTimeSliderEnableToggle:t}=this;return t?(0,s.h)(s.F,null):(0,s.h)("calcite-label",{layout:"inline",class:h.enableTimeSlider,alignment:"start"},(0,s.h)("calcite-switch",{label:e.strings.enableTimeSlider,name:e.strings.enableTimeSlider,checked:this.timeSliderEnabled,onCalciteSwitchChange:this._handleTimeSliderEnableToggled,"data-testId":"arcgis-time-slider-config-enable-timeslider"}),e.strings.enableTimeSlider)}renderTimeExtent(){return(0,s.h)("arcgis-time-slider-config-time-extent",{timeDisplayMode:this.timeDisplayMode,hideInstantMode:this.hideInstantMode,start:this.fullTimeExtent?.start||void 0,end:this.fullTimeExtent?.end||void 0,timeZone:this.view?.timeZone,timeSliderEnabled:this.timeSliderEnabled,onArcgisTimeExtentTimeDisplayModeChange:this._handleTimeDisplayModeChange,onArcgisTimeExtentFullExtentChange:this._handleFullTimeExtentChange})}renderTimeInterval(){return(0,s.h)("arcgis-time-slider-config-time-interval",{stops:this.stops,fullTimeExtent:this.fullTimeExtent,timeSliderEnabled:this.timeSliderEnabled,onArcgisIntervalStopsChange:this._handleStopsChange})}renderPlaybackPosition(){const{timeSliderConfigState:e,playbackPosition:t}=this;return(0,s.h)("calcite-radio-button-group",{class:h.playbackPosition,name:"playback-position",onCalciteRadioButtonGroupChange:e=>this.arcgisPlaybackPositionChange.emit(e.currentTarget.selectedItem.value)},(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{disabled:"instant"===this.timeDisplayMode,value:"start-time",scale:"s",checked:!t.useSavedPosition,ref:e=>this.startPositionNode=e}),e.strings.playbackPosition.startTime),(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{disabled:"instant"===this.timeDisplayMode,value:"saved-time",scale:"s",checked:t.useSavedPosition,ref:e=>this.savedPositionNode=e}),e.strings.playbackPosition.savedTime))}renderPlayRate(){return(0,s.h)("arcgis-time-slider-config-time-playback",{playRate:this.playRate,timeSliderEnabled:this.timeSliderEnabled,onArcgisPlayRateSettingsChange:this._handlePlayRateChange})}_updateTimeDisplayMode(e){const{timeSliderConfigState:t}=this;t.timeDisplayMode=e,this.timeDisplayMode=t.timeDisplayMode,this.arcgisTimeDisplayModeChange.emit(e),"instant"===this.timeDisplayMode&&(this.playbackPosition.useSavedPosition=!0,this.arcgisPlaybackPositionChange.emit("saved-time")),this.startPositionNode&&(this.startPositionNode.disabled="instant"===this.timeDisplayMode),this.savedPositionNode&&(this.savedPositionNode.disabled="instant"===this.timeDisplayMode)}_updateFullTimeExtent(e){const{timeSliderConfigState:t}=this;t.fullTimeExtent=e,this.fullTimeExtent=t.fullTimeExtent,this.arcgisFullTimeExtentChange.emit(e)}async _validateFullTimeExtent(e){let t=e?.start?.getTime(),i=e?.end?.getTime();const s=t===i&&"instant"!==this.timeDisplayMode;return t=new Date(t||Date.now()).setSeconds(0,0),i=new Date(i?i+(s?6e4:0):Date.now()+(s?6e4:0)).setSeconds(0,0),e.start=new Date(t),e.end=new Date(i),e&&e.end&&e.start&&e.end.getTime()-e.start.getTime()<n.m&&this._fixFullTimeExtentForSmallTimeRanges(e),await(0,c.ax)({start:new Date(t),end:new Date(i)})}_updateStops(e){const{timeSliderConfigState:t}=this;t.stops=e,this.stops=t.stops,this.arcgisStopsChange.emit(t.stops)}_updatePlayRate(e){const{timeSliderConfigState:t}=this;t.playRate=e,this.playRate=t.playRate,this.arcgisPlayRateChange.emit(t.playRate)}async _loadStore(){const{timeSliderConfigState:e}=this;(0,n.c)(e),e.view=this.view,e.strings=this.strings,e.isRTL="rtl"===(0,a.b)(this.el)}async _loadPersistedTimeSliderPropertiesFromSceneView(){const e=this.view?.map;if(e){const t=this._getModeFromViewExtent();let i;const s=await this._timeUtils.getTimeSliderSettingsFromWebDocument(e);s&&(s.stops&&this._updateStops(s.stops),s.fullTimeExtent&&this._updateFullTimeExtent(s.fullTimeExtent),s.playRate&&this._updatePlayRate(s.playRate),s.mode&&(i=s.mode)),(t||i)&&this._updateTimeDisplayMode(t||i)}this.fullTimeExtentFromViewInitialized=!0}_watchForLayerLoadedAndProperties(){this._watchLayerLoadedHandle?.remove(),this._watchLayerLoadedHandle=this._reactiveUtils.watch((()=>this.view?Array.from((this.view.map?.allLayers?.toArray()??[]).filter((e=>(0,n.l)(e)||(0,n.b)(e))).map((e=>({loadStatus:e.loadStatus,userViewTime:e?.useViewTime,fullTimeExtent:e?.timeInfo?.fullTimeExtent,visibilityTimeExtentStart:e.visibilityTimeExtent?.start,visibilityTimeExtentEnd:e.visibilityTimeExtent?.end})))):[]),(async e=>{e.some((e=>"loading"===e.loadStatus))||await this._checkFullTimeExtentOfLayers()}),{initial:!0})}async _checkFullTimeExtentOfLayers(){const{timeSliderConfigState:e,allowArcadeTime:t}=this,i=this.view?this.view.map?.allLayers.filter((e=>(0,n.i)(e,t)))??[]:[],s=this.view?this.view.map?.allLayers.filter((e=>(0,n.e)(e)))??[]:[];if(!i?.length&&!s?.length)return this.arcgisNoTimeEnabledLayersFound.emit(),void(this.noTimeAwareLayersAvailable=!0);this.noTimeAwareLayersAvailable=!1;const a=await this._timeUtils.getTimeExtentFromLayers([...i,...s],void 0),l=(0,n.t)(e.fullTimeExtent,a);if(!(0,r.i)(e.fullTimeExtent?.start)&&!(0,r.i)(e.fullTimeExtent?.end)||!l){const e=await this._validateFullTimeExtent(a);(this.fulltimeExtentFromLayersInitialized||!this.fulltimeExtentFromLayersInitialized&&!(0,r.i)(this.fullTimeExtent))&&this._updateFullTimeExtent(e),this.fulltimeExtentFromLayersInitialized||(this.fulltimeExtentFromLayersInitialized=!0)}}_getModeFromViewExtent(){const e=this.view?.timeExtent;if((0,r.i)(e))return(0,n.g)(e)}_fixFullTimeExtentForSmallTimeRanges(e){e.end=e.start?new Date(e.start.getTime()+n.m):void 0}static get assetsDirs(){return["assets"]}get el(){return(0,s.a)(this)}static get watchers(){return{view:["viewChange"],fullTimeExtentFromViewInitialized:["fulltimeExtentFromViewsInitializedChanged"]}}};u.style="import :host{height:100%;width:100%;display:block}.base{height:100%}.base__tabs,.base__info-message,.base__enable-timeslider{padding:var(--calcite-spacing-xxs)}.base__enable-timeslider{--calcite-label-margin-bottom:0px;margin-top:var(--calcite-spacing-lg);margin-bottom:var(--calcite-spacing-sm);margin-inline-start:var(--calcite-spacing-sm);width:-moz-fit-content;width:fit-content}.base__playback-position{margin:0 var(--calcite-spacing-xxs);padding:var(--calcite-spacing-xxs)}"},84260:(e,t,i)=>{i.d(t,{u:()=>l});var s=i(11254),n=i(10465),a=i(14528);function l({propertyName:e="strings",name:t}){let i=(0,a.r)();const l=(0,n.g)(i.el),o=new n.D,d={_lang:l.lang,_t9nLocale:l.t9nLocale};i.manager.onLoad((()=>o.promise));const c=new WeakRef(i);function m(){const e=c.deref();return e||u?.(),e}i=void 0;const h=r((()=>m()?.el)),u=(0,n.s)(h,(()=>(0,s.g)("./assets")),(({t9nLocale:t,t9nStrings:i,lang:s})=>{const n=m();if(!n)return;n[e]={...i,_lang:s,_t9nLocale:t},o.resolve()}),t);return d}const r=e=>new Proxy({},{get(t,i){const s=e();if(!s)return;const n=Reflect.get(s,i,s);return"function"==typeof n?n.bind(s):n}})},93345:(e,t,i)=>{i.d(t,{c:()=>o});var s=i(11254);const n=e=>!("isConnected"in e)||e.isConnected,a=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...s)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(n))}),2e3),l=e=>"function"==typeof e?e():e,r=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},o=(e,t)=>{const i=((e,t=(e,t)=>e!==t)=>{const i=l(e);let s=new Map(Object.entries(i??{}));const n={dispose:[],get:[],set:[],reset:[]},a=()=>{s=new Map(Object.entries(l(e)??{})),n.reset.forEach((e=>e()))},o=e=>(n.get.forEach((t=>t(e))),s.get(e)),d=(e,i)=>{const a=s.get(e);t(i,a,e)&&(s.set(e,i),n.set.forEach((t=>t(e,i,a))))},c="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>o(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(d(t,i),!0)}),m=(e,t)=>(n[e].push(t),()=>{r(n[e],t)});return{state:c,get:o,set:d,on:m,onChange:(t,i)=>{const s=m("set",((e,s)=>{e===t&&i(s)})),n=m("reset",(()=>i(l(e)[t])));return()=>{s(),n()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(m("set",t.set)),t.get&&e.push(m("get",t.get)),t.reset&&e.push(m("reset",t.reset)),t.dispose&&e.push(m("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{n.dispose.forEach((e=>e())),a()},reset:a,forceUpdate:e=>{const t=s.get(e);n.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof s.d)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,s.d)();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(s.f)),a(e)},reset:()=>{e.forEach((e=>e.forEach(s.f))),a(e)}}})()),i}}}]);