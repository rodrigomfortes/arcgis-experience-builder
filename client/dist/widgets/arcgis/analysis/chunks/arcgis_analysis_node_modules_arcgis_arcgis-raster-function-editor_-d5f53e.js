"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-d5f53e"],{24852:(e,t,i)=>{i.d(t,{R:()=>y});var r=i(83628),s=i(5839),n=(i(5294),i(13661),i(18423),i(21255),i(35431),i(92991)),a=i(93442),p=i(33797),l=i(48001);i(23795),i(17902),i(56451),i(588),i(71802),i(44345),i(32513),i(33752),i(36596);const g="clippingGeometryOrRasterHelpClickHandler",h="useinputFeaturesHelpClickHandler",o="outputExtentHelpClickHandler",c="clippingRaster",u="clippingGeometry",d="currentExtent",y=class{constructor(e){(0,r.r)(this,e),this.rfxArgumentChange=(0,r.c)(this,"rfxArgumentChange"),this.rasterOrGeometryValueMapper={geometryValue:void 0,rasterValue:void 0},this.extentMapper={mapExtent:void 0,inputRasterExtent:void 0,clippingRasterGeometryExtent:void 0,clippingFeatureGeometryExtent:void 0,useInputFeatureGeometryExtent:void 0},this.helpActionClickEventHandlers=new Map,this.useInputFeatureGeometryRfxArgValue=!1,this.extentvalue=void 0,this.renderFlag=!1,this.inituseInputFeatureGeometry=e=>{this.useInputFeatureGeometryRfxArg=e;const{triggerArgs:t}=this.widgetArgs;t.UseInputFeatureGeometry.input=this.useInputFeatureGeometryRfxArg,this.useInputFeatureGeometryRfxArg?.addEventListener("calciteCheckboxChange",(e=>{const t=e.target.checked;this.useInputFeatureGeometryRfxArgValue=t,this.widgetArgs.triggerArgs.UseInputFeatureGeometry.value=t,this.widgetArgs.inputArgs.ClippingGeometry.value=this.useInputFeatureGeometryRfxArgValue?this.extentMapper.useInputFeatureGeometryExtent:this.extentMapper.clippingFeatureGeometryExtent}))},this.initExtent=e=>{this.extentWidget=e;const{inputArgs:t}=this.widgetArgs;t.Extent.input=this.extentWidget},this.handleClippingGeometryTypesChange=e=>{e.stopPropagation();const t=e.target;switch(this.clippingGeometryTypeSelected=t.value,this.clippingGeometryTypeSelected){case d:this.extentMapper.mapExtent=(0,a.m)(this.map?.extent),this.widgetArgs.inputArgs.ClippingRaster.value=void 0,this.widgetArgs.inputArgs.ClippingGeometry.value=void 0;break;case c:this.widgetArgs.inputArgs.ClippingGeometry.value=void 0;break;case u:this.widgetArgs.inputArgs.ClippingRaster.value=void 0}},this.setMapExtent=()=>{(0,n.i)(this.map)||(this.extentMapper.mapExtent=(0,a.m)(this.map?.extent),this.renderFlag=!this.renderFlag)},this.renderUpdateActiveMapExtentButton=()=>(0,r.h)("calcite-button",{alignment:"center",appearance:"outline",kind:"neutral",scale:p.U.Scale,type:"button",width:"full",onClick:this.setMapExtent},this.strings.currentMapExtent),this.handleClippingGeometryRasterChange=async({detail:{value:e}})=>{this.rasterOrGeometryValueMapper.rasterValue=e;const t=await(this.clippingGeometryRasterArg?.getSelectedLayer?.()),i=(0,a.l)(t);this.widgetArgs.inputArgs.ClippingRaster.value=(0,a.f)(t),this.extentMapper.clippingRasterGeometryExtent=i,this.renderFlag=!this.renderFlag},this.handleClippingGeometryFeatureChange=async({detail:{value:e}})=>{this.rasterOrGeometryValueMapper.geometryValue=e;const t=await(this.clippingGeometryFeatureArg?.getSelectedLayer?.()),i=(0,a.l)(t);this.extentMapper.clippingFeatureGeometryExtent=i;const r=await(0,a.n)(t);let s={};s="polygon"===t.geometryType?{rings:r?.map((e=>e?.toJSON().rings)).flat(1),spatialReference:r?.[0]?.toJSON().spatialReference}:"point"===t.geometryType?{geometries:r?.map((e=>{const t=e.toJSON();return{x:t.x,y:t.y}})),spatialReference:r?.[0]?.toJSON().spatialReference}:i,this.extentMapper.useInputFeatureGeometryExtent=s,this.widgetArgs.inputArgs.ClippingGeometry.value=this.useInputFeatureGeometryRfxArgValue?s:i,this.renderFlag=!this.renderFlag}}onWidgetArgsChange(e){this.processWidgetArgs(e)}connectedCallback(){this.processWidgetArgs(this.widgetArgs)}async componentWillLoad(){({strings:this.strings,dir:this.direction}=await(0,s.c)(this.hostElement,(0,r.a)("."))),await this.setInitialState(this.widgetArgs)}componentWillRender(){const e={1:()=>{switch(this.clippingGeometryTypeSelected){case d:return this.extentMapper.mapExtent;case c:return this.extentMapper.clippingRasterGeometryExtent;case u:return this.extentMapper.clippingFeatureGeometryExtent}},2:()=>this.extentMapper.inputRasterExtent}[this.clippingTypeRfxArgValue].bind(this)();this.extentvalue=e}componentDidLoad(){this.attachHelpClickEventHandlers()}processWidgetArgs({browseProperties:e,triggerArgs:t}){this.map=e.map,((0,n.i)(t)||(0,n.i)(t.Raster)||(0,n.i)(t.ClippingType)||(0,n.i)(t.UseInputFeatureGeometry))&&console.error("Invalid Schema: TriggerArgs is incorrect!");const i=t.Raster;this.rasterArg=i,i.input?.addEventListener("rfxArgumentChange",this.handleRasterChange.bind(this));const r=t.ClippingType;this.clippingTypeRfxArg=r,r.input?.addEventListener("rfxArgumentChange",(({detail:{value:e}})=>{this.clippingTypeRfxArgValue=e}))}attachHelpClickEventHandlers(){const e=this.widgetArgs.onHelpActionClick({heading:this.widgetArgs.inputArgs.ClippingGeometry.displayName,referenceElement:this.clippingGeometryOrRasterContainer,helpTextID:this.widgetArgs.helpTextIDs?.clip_clippinggeometryorraster}),t=this.widgetArgs.onHelpActionClick({heading:this.widgetArgs.inputArgs.Extent.displayName,referenceElement:this.extentContainer,helpTextID:this.widgetArgs.helpTextIDs?.clip_outputextent});this.helpActionClickEventHandlers.set(g,e),this.helpActionClickEventHandlers.set(o,t)}async setInitialState({inputArgs:e,triggerArgs:t}){const i=t.Raster,r=i?.input,s=await(r?.getSelectedLayer?.());this.extentMapper.inputRasterExtent=(0,a.l)(s);const p=t.ClippingType;this.clippingTypeRfxArgValue=p.value;const g=t.UseInputFeatureGeometry;this.useInputFeatureGeometryRfxArgValue=!!g.value;const h=e.Extent;this.extentvalue=h.value,this.extentMapper.mapExtent=(0,a.m)(this.map?.extent);const o=!(0,n.i)(e.ClippingRaster?.value||(0,l.p)(e.ClippingRaster)),y=!(0,n.i)(e.ClippingGeometry?.value||(0,l.p)(e.ClippingGeometry)),m=!o&&!y,x=1===this.clippingTypeRfxArgValue;o&&x&&(this.extentMapper.clippingRasterGeometryExtent=this.extentvalue),y&&x&&(this.extentMapper.clippingFeatureGeometryExtent=this.extentvalue),this.clippingGeometryTypeSelected=m?d:o?c:u}async handleRasterChange(){const e=this.rasterArg?.input,t=await(e?.getSelectedLayer?.()),i=(0,a.l)(t);this.extentMapper.inputRasterExtent=i}renderClippingGeometryTypes(){const e=[{key:d,label:this.strings.activeMapViewExtent},{key:c,label:this.strings.chooseRaster},{key:u,label:this.strings.chooseGeometry}];return(0,r.h)("rfx-dtex-common-select",{mode:this.widgetArgs.mode,options:e,value:this.clippingGeometryTypeSelected,onRfxArgumentChange:this.handleClippingGeometryTypesChange})}renderClippingGeometryRaster(){const{inputLayers:e}=this.widgetArgs;return(0,r.h)("rfx-dte-raster-input",{mode:this.widgetArgs.mode,ref:e=>this.clippingGeometryRasterArg=e,inputLayers:e,value:this.rasterOrGeometryValueMapper.rasterValue,onRfxArgumentChange:this.handleClippingGeometryRasterChange,rfxBrowseLayerClick:this.widgetArgs.onRfxBrowseLayerClick,rfxVariable:this.widgetArgs.inputArgs.ClippingRaster,portal:this.widgetArgs.portal})}renderClippingGeometryFeature(){const{featureLayers:e}=this.widgetArgs;return(0,r.h)("rfx-dte-feature-select",{mode:this.widgetArgs.mode,ref:e=>this.clippingGeometryFeatureArg=e,inputLayers:e,value:this.rasterOrGeometryValueMapper.geometryValue,onRfxArgumentChange:this.handleClippingGeometryFeatureChange,rfxBrowseLayerClick:this.widgetArgs.onRfxBrowseLayerClick})}render(){return(0,r.h)("div",{key:"b24cbdf5af3566348b4e37b7cb09d23092452cb4"},(0,r.h)("calcite-label",{key:"d2e66a7c649515aa1498ac385f60a4f39cc5356c",alignment:"start",scale:p.U.Scale,layout:"default",ref:e=>{this.clippingGeometryOrRasterContainer=e}},(0,r.h)("rfx-label",{key:"747d5a9ef198ce85985dd8b1069fda3ffee79e72",label:this.widgetArgs.inputArgs.ClippingGeometry.displayName,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(g)()}),this.renderClippingGeometryTypes(),this.clippingGeometryTypeSelected===d?this.renderUpdateActiveMapExtentButton():null,this.clippingGeometryTypeSelected===c?this.renderClippingGeometryRaster():null,this.clippingGeometryTypeSelected===u?this.renderClippingGeometryFeature():null),this.clippingGeometryTypeSelected===u?(0,r.h)("calcite-label",{alignment:"start",scale:p.U.Scale,layout:"inline-space-between",ref:e=>{this.useInputFeatureGeometryContainer=e;const t=this.widgetArgs.onHelpActionClick({heading:this.widgetArgs.triggerArgs.UseInputFeatureGeometry.displayName,referenceElement:this.useInputFeatureGeometryContainer,helpTextID:this.widgetArgs.helpTextIDs?.clip_useinputfeaturesforclippinggeometry});this.helpActionClickEventHandlers.set(h,t)}},(0,r.h)("calcite-checkbox",{checked:this.useInputFeatureGeometryRfxArgValue,ref:this.inituseInputFeatureGeometry}),(0,r.h)("rfx-label",{label:this.widgetArgs.triggerArgs.UseInputFeatureGeometry.displayName,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(h)()})):null,(0,r.h)("calcite-label",{key:"68daae7731c3ed410e6f60c320aa40f083b66cee",alignment:"start",scale:p.U.Scale,layout:"default",ref:e=>{this.extentContainer=e}},(0,r.h)("rfx-label",{key:"aa09c0b95563453cc21c71c3e8994a740ae41fea",label:this.widgetArgs.inputArgs.Extent.displayName,onRfxLabelHelpActionClick:()=>this.helpActionClickEventHandlers?.get(o)()}),(0,r.h)("rfx-dte-extent",{key:"88e810525d98db9a12df29031c6e3b7fab1e5d7c",ref:this.initExtent,value:this.extentvalue})))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}static get watchers(){return{widgetArgs:["onWidgetArgsChange"]}}}}}]);