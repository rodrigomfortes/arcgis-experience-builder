/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f44b7b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f44b7b"],{931:(e,t,i)=>{i.d(t,{l:()=>s});var n=i(93814);const s=async(e,t)=>(await n.e.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},3826:(e,t,i)=>{i.d(t,{a:()=>s,b:()=>a,c:()=>r,d:()=>n});const n=(0,i(37762).c)({typeKeywords:[],customParameters:[],analyzedLocationTypes:[],allowStoredAuth:!0,isSecured:null,checkAuth:!1}),s=n.state,a=n.state,r=n.state},4429:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>u,c:()=>a,d:()=>c,e:()=>s,f:()=>n,g:()=>v,i:()=>h,m:()=>r,t:()=>o,u:()=>d});const n=(e,t)=>{let i,n="idle";const s=(...s)=>new Promise((a=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),a(e(...s))):a(null);break;case"invoked":clearTimeout(i),n="idle",a(e(...s));break;case"cancelled":clearTimeout(i),n="idle",a(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout((()=>(n="idle",a(e(...s)))),t)}}));return s.flush=function(...e){return n="flushed",s(...e)},s.invoke=function(...e){return n="invoked",s(...e)},s.cancel=function(...e){return n="cancelled",s(...e)},s.getStatus=function(){return n},s};function s(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(e){return null!=e}async function r(e,t){return await Promise.all([e,o(t)]),e}function o(e){return new Promise((t=>setTimeout(t,e)))}const l=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:n}=t(e);return[i,n]}))),c=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function d(e,t){const i=[],n={};return e.forEach((e=>{const s=t(e);null==n[s]&&(n[s]=e,i.push(e))})),i}function u(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const v=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,n)=>e.slice(t*n,t+t*n))),h=(e,t)=>e.includes(t)},19574:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_feature_layer_from_custom_data_provider:()=>l});var n=i(87849),s=i(3826),a=i(95878),r=i(68065),o=i(59317);i(37762),i(50637),i(931),i(93814),i(87744);const l=class{constructor(e){(0,n.r)(this,e),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.handleSelectChange=e=>{this.selectedCustomProvider=e,this.serviceParametersObject={},this.inputValidity={}},this.customDataProviders=null,this.selectedCustomProvider=void 0,this.serviceParametersObject={},this.inputValidity={}}async componentWillLoad(){const{hostingServer:e}=o.c;this.i18n=a.u.i18n.featureLayerFromCustomDataProvider,this.customDataProviders=await(0,r.g)(e);const t=Object.keys(this.customDataProviders);if(t.length>0){const{serviceInfo:e}=s.a;this.selectedCustomProvider=e?t.find((t=>this.customDataProviders[t][0].name===e.jsonProperties.customDataProviderInfo.dataProviderName)):t[0],e&&(this.serviceParametersObject=e.jsonProperties.customDataProviderInfo.serviceParameters)}}async handleNext(){if(this.validateInputFields())return;const e=this.customDataProviders[this.selectedCustomProvider][0];s.a.serviceInfo={jsonProperties:{customDataProviderInfo:{forwardUserIdentity:!1,dataProviderName:e.name,dataProviderHost:this.serviceParametersObject.host||"",dataProviderId:this.serviceParametersObject.id||"",serviceParameters:this.serviceParametersObject}},provider:"CUSTOMDATA"},this.newItemUpdatePage.emit("itemProperties")}handleInputChange(e,t){this.serviceParametersObject[t]=e.target.value}validateInputFields(){let e=!1;const t=this.customDataProviders[this.selectedCustomProvider][0].properties.serviceParameters,i=Object.assign({},this.inputValidity);return t.forEach((({key:t})=>{this.serviceParametersObject[t]?i[t]=!1:(i[t]=!0,e=!0)})),this.inputValidity=i,e}renderSelectOptions(){return Object.entries(this.customDataProviders).map((([e,t],i)=>(0,n.h)("calcite-option",{value:e,key:i},t[0].name)))}renderInputFields(){return Object.keys(this.customDataProviders).flatMap((e=>{const{serviceParameters:t}=this.customDataProviders[e][0].properties;return this.selectedCustomProvider!==e?[]:t.map((({label:e,description:t,key:i})=>(0,n.h)("div",{key:this.selectedCustomProvider+i},(0,n.h)("calcite-label",{layout:"inline"},e,(0,n.h)("calcite-icon",{icon:"information",scale:"s",id:`${this.selectedCustomProvider} ${t}`}),(0,n.h)("calcite-tooltip",{"reference-element":`${this.selectedCustomProvider} ${t}`},(0,n.h)("span",null,t))),(0,n.h)("calcite-input",{onCalciteInputInput:e=>this.handleInputChange(e,i),scale:"l",status:this.inputValidity[i]?"invalid":"idle",value:this.serviceParametersObject[i]||""}),(0,n.h)("calcite-input-message",{icon:!0,status:"invalid",hidden:!this.inputValidity[i]},this.i18n.missingValue.replace("${missingValue}",e)))))}))}render(){const{i18n:e}=this;return(0,n.h)(n.H,{key:"0d1351a01ee6b6ac8db1620ec4c001eea1cc5299"},(0,n.h)("calcite-label",{key:"aa267cdc60b1b653e9f4b949bc1f29d43e653b7c",class:"label"},(0,n.h)("arcgis-new-item-description",{key:"06930e8cf5be0025aa33cc0e2af1d41da96be382",header:e.header}),(0,n.h)("calcite-select",{key:"a629768ed478a5b655ab10da2f73fe01005489bb",label:e.header,onCalciteSelectChange:e=>this.handleSelectChange(e.currentTarget.value),value:this.selectedCustomProvider},this.renderSelectOptions()),this.customDataProviders&&this.renderInputFields()))}get el(){return(0,n.a)(this)}};l.style=".label{margin-top:1.5rem}.hide{display:none}"},50637:(e,t,i)=>{i.d(t,{a:()=>f,b:()=>y,c:()=>v,d:()=>m,f:()=>d,g:()=>h,i:()=>u,p:()=>b,r:()=>g});var n=i(59317),s=i(4429),a=i(931),r=i(87744);const o={},l={},c={};async function d(e,t,i,n){var s,a,r,d;const u=null===(a=null===(s=c[t])||void 0===s?void 0:s[i])||void 0===a?void 0:a.expireAt,v=!!u&&(new Date).getTime()>u;if((null===(r=o[t])||void 0===r?void 0:r[i])&&!v)return o[t][i];l[t]||(l[t]={}),l[t][i]&&!v||(l[t][i]=e());const h=await l[t][i];if(o[t]||(o[t]={}),c[t]||(c[t]={}),o[t][i]=h,n){const{expireAfter:e,getExpireAfterFromResult:s}=n,a=s||e?(new Date).getTime()+(null!==(d=null==s?void 0:s(h))&&void 0!==d?d:e):null;c[t][i]=Object.assign(Object.assign({},c[t][i]),{expireAt:a})}return h}function u(e,t){var i;return null===(i=null==o?void 0:o[e])||void 0===i?void 0:i[t]}const v=(e,t)=>{var i,n;t?(null===(i=o[e])||void 0===i||delete i[t],null===(n=l[e])||void 0===n||delete n[t]):(delete o[e],delete l[e])};function h(e){var t,i,s,a;return null!=e||(e=null===n.c||void 0===n.c?void 0:n.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(s=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===s?void 0:s.token)||(null===(a=null==e?void 0:e.portalUser)||void 0===a?void 0:a.token)||""}function m(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}function p(e){var t;const{config:i}=n.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}async function f(e,t,i={},s){const[r]=await(0,a.l)(["esri/request"]),{api:o}=n.c;e.includes("f=")||t.append("f","json");const l=h();return l&&!t.has("token")&&t.append("token",l),new Promise(((n,a)=>{if(3===o){const o={url:!1===i.addSSL?e:p(e),form:t,timeout:i.timeout||0},l="post"===s?Object.assign({usePost:!0},i):i;r(o,l).then(n,a)}else r(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:s||"auto"})).then((e=>{n(e.data)})).catch((e=>a(e)))}))}async function g(e,t={},i={},s,r){const[o]=await(0,a.l)(["esri/request"]),{api:l,portal:c}=n.c,{customToken:d,addTokenManually:u,addSSL:v,useProxy:h}=i,m=Object.assign({},t);if(e.includes("f=")||!0===(null==r?void 0:r.excludeJson)||(m.f="json"),d)m.token=d;else if(!1!==u){const e=await y(c,l);e&&(m.token=e)}const f=!1===v?e:p(e);if(3===l){const e=Object.assign({url:f,content:m,timeout:i.timeout||0},null==r?void 0:r.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return o(e,"post"===s?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:m,method:s||"auto"},i),{timeout:i.timeout||0,useProxy:h}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await o(f,e)).data}}const P=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const b=async(e,t,i)=>{var n,a;const r=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],o=null!==(a=null==t?void 0:t.successStatuses)&&void 0!==a?a:["completed","Completed","COMPLETED"];let l=0;const c=async()=>{const n=await g(e,null==t?void 0:t.requestParams,{},i),a=n.status||n.jobStatus;if(r.includes(a))return await(0,s.t)((d=l++,1e3*P[d>-1&&d<P.length-1?d:P.length-1])),c();if(o.includes(a)||"failed"===a)return n;throw n;var d};try{return c()}catch(e){throw console.error(e),e}},y=async(e,t)=>{var i;if(!(null==e?void 0:e.isPortal)||!(0,r.i)(e))return h(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,r.i)(e))return;const{token:s}=await d((()=>w(e,null!=t?t:null===n.c||void 0===n.c?void 0:n.c.api)),"platformSelf",null!==(i=m(e.user))&&void 0!==i?i:e.id,{getExpireAfterFromResult:e=>e.expires_in});return s},w=async(e,t)=>{const i=await(async(e,t)=>{var i,n,s;const o=3===t,[l]=o?await(0,a.l)(["esri/IdentityManager"]):await(0,a.l)(["esri/identity/IdentityManager"]),c=await d((()=>l.getCredential((0,r.g)(e),{oAuthPopupConfirmation:!1})),"credential",m(e.user));return null!==(s=o?null===(i=c._oAuthCred)||void 0===i?void 0:i.appId:null===(n=c.oAuthState)||void 0===n?void 0:n.appId)&&void 0!==s?s:"arcgisonline"})(e,t),n={"X-Esri-Auth-Client-Id":i,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return g(`${(0,r.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:4===t?n:void 0,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:n}})}},68065:(e,t,i)=>{i.d(t,{c:()=>a,g:()=>s});var n=i(50637);async function s(e){var t;const i=` ${null===(t=e[0])||void 0===t?void 0:t.url}/admin/services/types/customdataproviders`;try{return await(0,n.r)(i,"post")}catch(e){console.warn(e)}}async function a(e){var t;const i=` ${null===(t=e[0])||void 0===t?void 0:t.url}/admin/services/types/customdataproviders/checkcdf`;try{return await(0,n.r)(i,"post")}catch(e){return e}}},95878:(e,t,i)=>{i.d(t,{a:()=>n,u:()=>s});const n=(0,i(37762).c)({nextText:"next",cancelText:"cancel",workflow:"content",scale:"m",disableScroll:!1,onlyHosted:!1,featureFlags:{}}),s=n.state}}]);