/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-b25396.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-b25396"],{10465:(e,l,t)=>{t.d(l,{D:()=>a,a:()=>d,b:()=>r,c:()=>o,g:()=>m,s:()=>C});class a{constructor(){this.promise=new Promise(((e,l)=>{this.resolve=e,this.reject=l}))}}const s=(e,l,t)=>(0,n(l).subscribe)((l=>{const a=l.some((l=>((e,l)=>{let t=e;for(;t;){if(t===l)return!0;if(!t.parentNode)return!1;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1})(e,l.target)));a&&t()})),i={},n=e=>{const l=e.join(","),t=i[l];if(void 0!==t)return t;const a=new Set,s=new MutationObserver((e=>a.forEach((l=>l(e)))));globalThis.document&&s.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const n={subscribe:e=>(a.add(e),()=>{a.delete(e),0===a.size&&(s.disconnect(),i[l]=void 0)})};return i[l]=n,n},o=(e,l)=>{let t=e;for(;t;){const e=t.closest?.(l);if(e)return e;const a=t.getRootNode?.();if(a===globalThis.document)return null;t=a.host}return null},r=e=>c(e,"dir","ltr"),c=(e,l,t)=>{const a=o(e,`[${l}]`);return a?.getAttribute(l)??t},h=e=>{let l="";for(let t=0;t<e;t++)l+=(65536*(1+Math.random())|0).toString(16).substring(1);return l},d=()=>[h(2),h(1),h(1),h(1),h(3)].join("-"),b="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),p=new Set(b),u="en",f={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},g={},y=async(e,l)=>{const t=`${l}${e}.json`;try{const e=await fetch(t);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===u?{}:await y(u,l)},m=e=>{const l=c(e,"lang",globalThis.navigator?.language||u);return{lang:l,t9nLocale:w(l)}},w=e=>{const[l,t]=e.split("-"),a=l.toLowerCase();let s=a;return t&&(s=`${a}-${t.toUpperCase()}`),s=f[s]??s,p.has(s)?s:t?w(a):u},C=(e,l,t,a)=>{let i;const n=()=>L(e,l(),a).then((e=>{i?.lang===e.lang&&i.t9nLocale===e.t9nLocale&&i.t9nStrings===e.t9nStrings||t(e),i=e})).catch(console.error);return queueMicrotask(n),s(e,["lang"],n)},L=async(e,l,t=e.localName.split("-").slice(1).join("-"))=>{const{lang:a,t9nLocale:s}=m(e),i=`${l}/${t}/t9n`,n=null===t?{}:await(async(e,l,t="")=>{const a=`${l}/${t}`,s=`${a}${e}.json`;return g[s]??(g[s]=y(e,a)),await g[s]})(s,i,"messages.");return{lang:a,t9nLocale:s,t9nStrings:n}}},45523:(e,l,t)=>{t.r(l),t.d(l,{arcgis_label:()=>h});var a=t(11254),s=t(69811),i=t(10465),n=t(56612),o=t(17840),r=t(14528),c=t(84260);const h=class{constructor(e){(0,a.r)(this,e),this.arcgisChange=(0,a.c)(this,"arcgisChange",7),this.labelUpdated=(0,a.c)(this,"labelUpdated",7),this.arcgisClose=(0,a.c)(this,"arcgisClose",7),this.arcgisLabelDismissedChange=(0,a.c)(this,"arcgisLabelDismissedChange",7),this.manager=(0,r.u)(this),this.strings=(0,c.u)({blocking:!0}),this.mapView=void 0,this.layer=void 0,this.portal=void 0,this.layerDisplayType=n.l.feature,this.calciteFlowProps=void 0,this.dismissible=!1,this.hideLayerTitle=!1,this.labelClasses=[]}async done(){this.handleCloseLabelContentPopovers()}async setFocus(){this.flowItemNode?this.flowItemNode.setFocus():this.switchNode?.focus()}async componentWillLoad(){console.warn("%cmap-config-components","background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;",'[arcgis-label] component in @arcgis/map-config-components is deprecated and will be removed soon. Use "arcgis-map-config-label" instead.');const{layer:e,layerDisplayType:l,calciteFlowProps:t}=this;await this.loadAllModules(),this.serviceType=(0,o.a)(e),this.layerGeometryType=await(0,o.b)(e),this.labelingInfo=l===n.l.feature?e.labelingInfo:e.featureReduction.labelingInfo,l===n.l.feature?e.labelsVisible=e.labelsVisible||!1:this.layerDisplayType===n.l.cluster&&(e.featureReduction.labelsVisible=e.featureReduction.labelsVisible||!1),t?.calciteFab&&!this.layerLabelsVisible()&&(t.calciteFab.hidden=!0)}componentDidLoad(){const{strings:e}=this;if(Array.isArray(this.labelingInfo)&&this.labelingInfo.forEach((e=>this.addLabelClass(e,1===this.labelingInfo.length))),this.calciteFlowProps&&!this.calciteFlowProps.calciteFab){const l=document.createElement("calcite-fab");l.icon="plus",l.slot="fab",l.scale="s",l.appearance="outline-fill",l.kind="neutral",l.label=e.addLabel,l.text=e.addLabel,l.textEnabled=!0,this.layerLabelsVisible()||(l.hidden=!0),this.calciteFlowProps.calciteFab=l,this.calciteFlowProps.calciteFlowItem.appendChild(l)}this.calciteFab=this.calciteFlowProps?.calciteFab??this.internalFabNode,this.calciteFab.addEventListener("click",(async e=>{e.stopPropagation(),this.handleCloseLabelContentPopovers();const l=await this.getLabelClass();this.labelingInfo?this.labelingInfo.push(l):this.labelingInfo=[l],this.addLabelClass(l,!0),this.focusLastLabelClass()})),this.flowItemNode?.setFocus()}componentDidUpdate(){this.handleInternalLabelUpdate()}disconnectedCallback(){this.calciteFab?.parentElement?.removeChild(this.calciteFab),this.calciteFab=void 0}render(){const{strings:e,layer:l,calciteFlowProps:t,hideLayerTitle:s,dismissible:i}=this;return(0,a.h)(a.H,{key:"ef99dae158ce091917fb6ec3d618988eaf170af0",class:"calcite-match-height"},t?(0,a.h)("div",null,this.renderSwitch(),this.renderLabelClasses()):(0,a.h)("calcite-flow",null,(0,a.h)("calcite-flow-item",{heading:e.labelFeatures,description:s?void 0:l.title??void 0,closable:i,onCalciteFlowItemClose:e=>{e.stopPropagation(),this.handleCloseLabelContentPopovers(),this.arcgisClose.emit(),this.arcgisLabelDismissedChange.emit()},ref:e=>this.flowItemNode=e},this.renderSwitch(),this.renderLabelClasses(),this.renderFab())))}renderSwitch(){const{strings:e,layer:l,layerDisplayType:t}=this;return(0,a.h)("calcite-label",{class:"enable-label",alignment:"start",layout:"inline-space-between"},e.enableLabels,(0,a.h)("calcite-switch",{ref:e=>this.switchNode=e,scale:"s",class:"label-switch",checked:this.layerLabelsVisible(),onCalciteSwitchChange:e=>{const a=e.target.checked;switch(t){case n.l.feature:l.labelsVisible=a;break;case n.l.cluster:l.featureReduction.labelsVisible=a;break;default:l.labelsVisible=a}this.enableLabel(a),this.handleInternalLabelUpdate(!0)}}))}renderLabelClasses(){return(0,a.h)("div",{class:"label-classes-wrapper",hidden:!this.layerLabelsVisible(),ref:e=>this.labelWrapperNode=e},this.labelClasses)}renderLabelClass(e,l){const{strings:t,mapView:s,layer:n,portal:o,calciteFlowProps:r,layerDisplayType:c,serviceType:h}=this;return(0,a.h)("arcgis-label-content",{key:(0,i.a)(),labelClass:e,blockOpen:l,strings:t,mapView:s,layer:n,portal:o,calciteFlowItem:r?.calciteFlowItem??this.flowItemNode,layerDisplayType:c,serviceType:h,onArcgisDisablePanel:e=>{e.stopPropagation();(this.calciteFlowProps?.calciteFlowItem??this.flowItemNode).disabled=e.detail},onArcgisDelete:e=>{this.handleCloseLabelContentPopovers();const l=this.el.shadowRoot.querySelectorAll("arcgis-label-content"),t=e.target,s=Array.from(l).indexOf(t);this.labelingInfo.splice(s,1),this.labelClasses.splice(s,1),this.calciteFab?.setFocus(),(0,a.f)(this.el)},onArcgisDuplicate:e=>{this.handleCloseLabelContentPopovers();const l=this.el.shadowRoot.querySelectorAll("arcgis-label-content"),t=e.target,s=Array.from(l).indexOf(t),i=this.labelingInfo[s].clone();this.labelingInfo.push(i),this.addLabelClass(i,!0),this.focusLastLabelClass(),(0,a.f)(this.el)},onArcgisChange:e=>{e.stopPropagation(),this.handleInternalLabelUpdate()}})}renderFab(){const{strings:e}=this;return(0,a.h)("calcite-fab",{hidden:!this.layerLabelsVisible(),icon:"plus",slot:"fab",scale:"s",appearance:"outline-fill",kind:"neutral",label:e.addLabel,text:e.addLabel,textEnabled:!0,ref:e=>this.internalFabNode=e})}async loadAllModules(){const[e,l,t,a]=await Promise.all([(0,s.L)(),(0,s.y)(),(0,s.c)(),(0,s.d)()]);this.modules={LabelClass:e,colorUtils:l,clusterLabelCreator:t,binLabelCreator:a}}layerLabelsVisible(){const{layerDisplayType:e}=this;switch(e){case n.l.feature:return this.layer.labelsVisible;case n.l.cluster:return this.layer.featureReduction.labelsVisible;default:return this.layer.labelsVisible}}enableLabel(e){this.labelWrapperNode.style.display=e?"block":"none",this.calciteFab.style.display=e?"block":"none",this.handleCloseLabelContentPopovers()}async getLabelClass(){const{mapView:e,modules:l,layer:t,layerDisplayType:a}=this;if(a===n.l.feature){const t=this.getDefaultSymbolProps(await l.colorUtils.getBackgroundColor(e),await l.colorUtils.getBackgroundColorTheme(e));return new l.LabelClass(this.getDefaultLabelProps(t))}return"binning"===t.featureReduction?.type?(await l.binLabelCreator.getLabelSchemes({layer:t}))?.primaryScheme?.labelingInfo[0]??void 0:(await l.clusterLabelCreator.getLabelSchemes({layer:t,renderer:t?.renderer,view:e}))?.primaryScheme?.labelingInfo[0]??void 0}getDefaultLabelProps(e){const{layer:l,layerDisplayType:t,serviceType:a}=this,s=this.getDefaultFieldName(),i=l.fields.find((e=>e.name===s)),o="coded-value"===i?.domain?.type;return{labelExpression:a===n.s.mapImage?`[${s}]`:null,labelExpressionInfo:t===n.l.cluster?{expression:`$feature["${s}"]`}:a!==n.s.mapImage?{expression:s?o?`$feature["${s}"]\nDomainName($feature, "${s}")`:`$feature["${s}"]`:null}:null,labelPlacement:this.getDefaultPlacement(),minScale:l.minScale||0,maxScale:l.maxScale||0,symbol:{color:e.fontColor,haloColor:e.haloColor,haloSize:e.haloSize,font:{family:e.fontFamily,size:e.fontSize},type:"text"}}}getDefaultSymbolProps(e,l){return"light"===l?{fontFamily:"Arial",fontSize:9.75,fontColor:"#262626",haloColor:"#f7f7f7",haloSize:.75}:"dark"===l?{fontFamily:"Arial",fontSize:9.75,fontColor:"#f7f7f7",haloColor:"#262626",haloSize:.75}:{fontFamily:"Arial",fontSize:9.75,fontColor:e.toHex()||"#262626",haloColor:"#f7f7f7",haloSize:.75}}getDefaultFieldName(){const{layer:e,layerDisplayType:l}=this;let t=null;if(l===n.l.cluster)t=e.featureReduction.fields[0].name;else if("displayField"in e&&"fieldsIndex"in e&&e.displayField&&e.fieldsIndex.get(e.displayField))t=e.displayField;else{const l=e.fields.find((e=>"string"===e.type));l&&(t=l.name)}return t??e.fields[0].name}getDefaultPlacement(){const{layer:e,layerDisplayType:l,layerGeometryType:t}=this;return l===n.l.cluster&&"binning"===e.featureReduction?.type?"always-horizontal":"point"===t||"multipoint"===t?"above-center":"polyline"===t?"center-along":"polygon"===t?"always-horizontal":void 0}addLabelClass(e,l=!1){this.labelClasses=[...this.labelClasses,this.renderLabelClass(e,l)]}focusLastLabelClass(){setTimeout((()=>{const e=this.el.shadowRoot.querySelectorAll("arcgis-label-content");e?.length&&e[e.length-1].setFocus()}),200)}handleInternalLabelUpdate(e){const{layerDisplayType:l}=this;this.labelingInfo&&!e&&(l===n.l.feature?this.layer.labelingInfo=[...this.labelingInfo]:this.layer.featureReduction.labelingInfo=[...this.labelingInfo]),this.arcgisChange.emit(),this.labelUpdated.emit()}handleCloseLabelContentPopovers(){this.el.shadowRoot.querySelectorAll("arcgis-label-content").forEach((e=>e.closeAllPopovers()))}static get assetsDirs(){return["assets"]}get el(){return(0,a.a)(this)}};h.style=".enable-label{background-color:var(--calcite-color-foreground-1);border-bottom:solid 1px var(--calcite-color-foreground-3);display:flex;padding:var(--calcite-spacing-lg) var(--calcite-spacing-sm) var(--calcite-spacing-xxs)}.label-switch{flex:0 0 0%;margin:0;justify-self:flex-end}.label-classes-wrapper{margin:0 0 var(--calcite-spacing-lg);padding:0}"},84260:(e,l,t)=>{t.d(l,{u:()=>n});var a=t(11254),s=t(10465),i=t(14528);function n({propertyName:e="strings",name:l}){let t=(0,i.r)();const n=(0,s.g)(t.el),r=new s.D,c={_lang:n.lang,_t9nLocale:n.t9nLocale};t.manager.onLoad((()=>r.promise));const h=new WeakRef(t);function d(){const e=h.deref();return e||p?.(),e}t=void 0;const b=o((()=>d()?.el)),p=(0,s.s)(b,(()=>(0,a.g)("./assets")),(({t9nLocale:l,t9nStrings:t,lang:a})=>{const s=d();if(!s)return;s[e]={...t,_lang:a,_t9nLocale:l},r.resolve()}),l);return c}const o=e=>new Proxy({},{get(l,t){const a=e();if(!a)return;const s=Reflect.get(a,t,a);return"function"==typeof s?s.bind(a):s}})}}]);