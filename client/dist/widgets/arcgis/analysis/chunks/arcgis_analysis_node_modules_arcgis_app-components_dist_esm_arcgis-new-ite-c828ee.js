/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-c828ee.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-c828ee"],{87257:(t,e,a)=>{a.r(e),a.d(e,{arcgis_new_item_pages_data_store_browser:()=>d});var i=a(87849),s=a(62296),r=a(3826),n=a(95878),o=a(5152),l=a(28748),c=a(46227);a(87744),a(59317),a(37762),a(68194),a(50637),a(931),a(93814),a(32710),a(83929),a(76246),a(63054),a(15912),a(24869),a(72257),a(86562),a(15332),a(50020),a(50822),a(75294),a(38295),a(51102),a(56175),a(43555);const d=class{constructor(t){(0,i.r)(this,t),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.dataStoreContentType="tile-layer",this.ALLOWED_DATATYPES=[],this.renderCheckboxGroup=()=>{const{i18n:t,displayDatasets:e}=this,a=e.some((t=>this.ALLOWED_DATATYPES.includes(t.type)));return(0,i.h)("ul",{class:"item-list"},a&&(0,i.h)("calcite-label",{layout:"inline",class:"data-set__item"},(0,i.h)("calcite-checkbox",{class:"dataset",onCalciteCheckboxChange:t=>this.handleSelectAll(t,this.ALLOWED_DATATYPES)}),t.selectAllDatasets),e.length>0?e.map((t=>{var e;const{name:s,type:r}=t,n="folder"===r;return(0,i.h)("li",{key:(0,c.g)(),class:"data-set__item "+(a?"select-all":""),onClick:()=>{n&&this.exploreFolder(t.path,"folder")}},(0,i.h)("calcite-label",{layout:"inline",class:"description"},n?(0,i.h)("calcite-icon",{icon:"folder",scale:"s",class:"blue-calcite-icon"}):(0,i.h)("calcite-checkbox",{class:"dataset",value:t,checked:!!(null===(e=this.selectedDatasets)||void 0===e?void 0:e.find((e=>e.path===t.path))),onCalciteCheckboxChange:t=>this.handleSelectDataset(t)}),s),(0,i.h)("p",{class:"item--title"},this.getDatasetDisplayType(r)))})):(0,i.h)("li",{class:"data-set__item"},(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),t.emptyFolder)))},this.renderRadioButtonGroup=()=>{const{i18n:t,displayDatasets:e,pathHistories:a}=this;return(0,i.h)("calcite-radio-button-group",{name:"file-group",onCalciteRadioButtonGroupChange:t=>{this.selectedDataset=t.currentTarget.selectedItem.value},layout:"vertical"},(0,i.h)("div",{class:"item-list"},e.length>0?e.map((t=>{var e;const{name:s,path:r,type:n}=t,o="folder"===n;return(0,i.h)("li",{key:(0,c.g)(),class:"data-set__item",onClick:()=>{o&&this.exploreFolder(t.path,"folder")}},(0,i.h)("calcite-label",{layout:"inline",class:"description"},o?(0,i.h)("calcite-icon",{icon:"folder",scale:"s",class:"blue-calcite-icon"}):(0,i.h)("div",{class:"dataset"},(0,i.h)("calcite-radio-button",{value:t,checked:r===(null===(e=this.selectedDataset)||void 0===e?void 0:e.path)}),"3DTilesDataset"===n&&(0,i.h)("calcite-icon",{icon:"tiled-imagery-layer",scale:"s",class:"blue-calcite-icon tiles3D-dataset"})),"3DTilesDataset"===n?a[a.length-1]:s),(0,i.h)("p",{class:"item--title"},this.getDatasetDisplayType(n)))})):(0,i.h)("li",{class:"data-set__item"},(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),t.emptyFolder))))},this.selectedDataset=null,this.selectedDatasets=[],this.datastoreContents=void 0,this.originalDatasets=void 0,this.sortedDatasets=void 0,this.displayDatasets=void 0,this.pathHistories=[],this.cachedData={},this.error=null,this.loading=void 0,this.sortCriteria={direction:null,criteria:null},this.userTileLayerTypeSelection=void 0,this.itemsPerPage=void 0,this.totalItems=void 0,this.paginationData=void 0}async componentWillLoad(){var t;if(this.dataStoreContentType="tileLayer"===r.a.newItemMode?"tile-layer":"scene-layer",this.dataStoreName=r.a.dataStoreName,this.i18n=n.u.i18n.dataStore,this.pathHistories=["/"],this.datastoreContents=r.a.datastoreContents,this.datastoreContents.path.length>1){const t=this.datastoreContents.path.split("/").filter((t=>t));this.pathHistories=this.pathHistories.concat(t)}this.originalDatasets=[...r.a.datastoreContents.children],this.sortedDatasets=[...this.originalDatasets],this.cachedData=r.a.dataStoreCachedData,this.serverId=r.a.serverId,"UPC"===r.a.addPointCloudOption?(this.selectedDatasets=(null===(t=r.a.datasets)||void 0===t?void 0:t.length)>0?r.a.datasets:[],this.ALLOWED_DATATYPES=["LASDataset","LIDARExchangeFile"]):this.selectedDataset=r.a.dataset}toggleSort(t){const{sortCriteria:e}=this,a=null==t?null:e.criteria!==t?"desc":"desc"===e.direction?"asc":null;if(null===t||null===a)return this.sortCriteria={criteria:null,direction:null},void(this.sortedDatasets=this.originalDatasets);this.sortCriteria={criteria:t,direction:a};const i="asc"===a?1:-1;this.sortedDatasets=[...this.sortedDatasets].sort((function(e,a){const s=e[t].toLowerCase(),r=a[t].toLowerCase();return s.localeCompare(r)*i}))}async exploreFolder(t,e){var a;this.loading=!0;if(!(null!=this.cachedData[t])){const i=await(0,s.g)(r.a.dataStoreId,t,e,this.serverId);if("failToListDataStoreContents"===(null===(a=i.error)||void 0===a?void 0:a.code))return this.loading=!1,void(this.error="failToListDataStoreContents");this.cachedData=Object.assign(Object.assign({},this.cachedData),{[t]:i.result})}const i=this.cachedData[t];this.pathHistories="/"===t?["/"]:t.split("/"),this.datastoreContents=this.filterContentsByUserSelection(i),this.originalDatasets=[...this.datastoreContents.children],this.loading=!1}filterContentsByUserSelection(t){const e=this.dataStoreContentType;return t.children?(0,l.h)(t,!!r.a.addPointCloudOption,e,r.a.tileLayerPublishType):Object.assign(Object.assign({},t),{children:[]})}renderErrorItem(){const{i18n:t,error:e,loading:a}=this;let s="",r="";if(e){const a=t.error;"failToListDataStoreContents"===e?(s=a.listing.heading,r=a.listing.description):(s=a.noDatasetErrorHeading,r=a.noDatasetErrorDescription)}return(0,i.h)("arcgis-new-item-alert",{heading:s,description:r,active:null!==e&&!a,onAlertDismiss:()=>{this.error=null}})}renderHeaderItem(t){const{i18n:e,sortCriteria:a}=this,{criteria:s,direction:r}=a;return(0,i.h)("div",{onClick:()=>this.toggleSort(t),class:{"data-set__header":!0,"data-set__header--selected":s===t&&null!=r}},"name"===t&&(0,i.h)("calcite-icon",{scale:"s",icon:"circle",class:"hidden-icon header-icon"}),"name"===t?e.fileName:e.fileType,(0,i.h)("calcite-icon",{class:{"blue-calcite-icon sort-icon":!0,"hidden-icon":s!==t||!r},scale:"s",icon:"asc"===r?"caret-up":"caret-down"}))}onDatastoreContentsChange(){this.toggleSort(null)}onSortedDataSetsChange(){this.calculatePagination(1)}calculatePagination(t){const{sortedDatasets:e}=this,a=e.length;this.totalItems=a;const i=Math.min(a,5),s=t-1,r=Math.min(s+i,a)-1;this.itemsPerPage=i,this.displayDatasets=e.slice(s,r+1),this.paginationData={startIndex:s,endIndex:r}}handleNext(){if("UPC"===r.a.addPointCloudOption){const t=this.selectedDatasets;if(0===t.length)return void(this.error="noDataSetSelected");r.a.datasets=t}else{const t=this.selectedDataset;if(!t)return void(this.error="noDataSetSelected");let e;switch(r.a.dataset=t,r.a.initialTitle=t.name.split(".")[0],t.type){case"vectorCacheDataset":e="Vector Tile Service";break;case"i3sRestCache":case"extractedScenePackage":e="Scene Service";break;case"cacheDataset":e="Map Service";break;case"3DTilesDataset":e="3DTiles Service",r.a.initialTitle=(0,o.g)(r.a.dataset.path)}r.a.type=e}r.a.dataStoreCachedId=r.a.dataStoreId,r.a.serverId=this.serverId,r.a.datastoreContents=this.datastoreContents,r.a.dataStoreCachedData=this.cachedData,"UPC"===r.a.addPointCloudOption?this.newItemUpdatePage.emit("pointCloudDataSummary"):this.newItemUpdatePage.emit("serverList")}handleSelectDataset(t){if(t.target.checked)this.selectedDatasets.push(t.currentTarget.value);else{const e=t.currentTarget.value.path;this.selectedDatasets=this.selectedDatasets.filter((t=>t.path!==e))}}handleSelectAll(t,e){if(t.target.checked){const t=this.datastoreContents.children;this.selectedDatasets=null==t?void 0:t.filter((t=>e.includes(t.type)))}else this.selectedDatasets=[]}getDatasetDisplayType(t){return"LASDataset"===t?"LAS":"LIDARExchangeFile"===t?"LAZ":t}render(){const{i18n:t,loading:e,displayDatasets:a,originalDatasets:s,pathHistories:n,paginationData:o,dataStoreName:l}=this,c="UPC"===r.a.addPointCloudOption;return(0,i.h)(i.H,{key:"b2a946d94f127639a4bcc83f86f0e9a55d8ac6d8"},(0,i.h)("div",{key:"050984d4fa59dbc09960bd99433b4934f1ef98d1",class:"inner-container"},e?(0,i.h)("calcite-loader",{label:"datastore-loader",text:t.processing}):(0,i.h)(i.F,null,(0,i.h)("div",{class:"content-wrapper"},(0,i.h)("div",{class:"header-text"},t.header),(0,i.h)("div",{class:"breadcrumb-container"},n.map(((t,e)=>{const a=e===n.length-1,s=0===e,r=s?"/":n.slice(0,e+1).join("/");return(0,i.h)("div",{class:"breadcrumb__item",key:`${t}_${e}`},(0,i.h)("span",{onClick:a?void 0:()=>this.exploreFolder(r,"folder")},(0,i.h)("span",{class:{"breadcrumb--inactive":!a}},s?l:t)),!a&&(0,i.h)("calcite-icon",{icon:"chevron-right",scale:"s"}))}))),(0,i.h)("div",{class:"pagination-text"},a.length>0&&t.paginationRange.replace("${start}",`${o.startIndex+1}`).replace("${end}",`${o.endIndex+1}`).replace("${total}",`${s.length}`)),(0,i.h)("div",{class:"data-set-container"},(0,i.h)("div",{class:"data-set__item"},this.renderHeaderItem("name"),this.renderHeaderItem("type")),c?this.renderCheckboxGroup():this.renderRadioButtonGroup())),this.itemsPerPage>0&&(0,i.h)("div",{class:"pagination-wrapper"},(0,i.h)("calcite-pagination",{startItem:o.startIndex+1,totalItems:this.totalItems,pageSize:this.itemsPerPage,onCalcitePaginationChange:t=>{const e=t.target;this.calculatePagination(e.startItem)}})))),this.renderErrorItem())}get el(){return(0,i.a)(this)}static get watchers(){return{originalDatasets:["onDatastoreContentsChange"],sortedDatasets:["onSortedDataSetsChange"]}}};d.style=":host{padding:0px}.inner-container{display:flex;flex-direction:column;padding:1.5rem;height:calc(100% - 65px)}.content-wrapper{flex-grow:1}.breadcrumb-container{margin-top:1rem;margin-bottom:1rem;font-weight:500;display:flex}.breadcrumb__item{display:flex;align-items:center;font-size:0.875rem;color:var(--calcite-color-text-2);margin-right:0.5rem}.breadcrumb--inactive{cursor:pointer;margin-right:0.5rem;color:#00619b}.pagination-text{font-size:0.75rem;font-weight:500;margin-top:1rem;margin-bottom:1rem;color:#757575}.data-set-container{background-color:var(--calcite-color-foreground-1)}.data-set__header{border-width:0px;border-bottom-width:2px;border-style:solid;font-size:0.875rem;padding:0px;border-color:transparent;width:-moz-fit-content;width:fit-content}.data-set__header:hover{cursor:pointer}.data-set__header--selected{border-color:#0079c1}.header-icon{margin-right:0.5rem}.item-list{margin-left:0px;margin-inline-start:0px;margin-top:0.75rem;margin-bottom:0.75rem;padding-inline-start:0px}.data-set__item{display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));padding-left:0.75rem;padding-right:0.75rem;padding-top:0.5rem;padding-bottom:0.5rem}.data-set__item:hover{cursor:pointer}.data-set__item>.item--title{font-size:0.875rem;margin-top:0px;margin-bottom:0px}.select-all{margin-inline-start:1rem}.blue-calcite-icon{--calcite-ui-icon-color:var(--calcite-color-brand)}.sort-icon{margin-left:6rem}.hidden-icon{visibility:hidden}.pagination-wrapper{display:flex;justify-content:center;margin-top:auto;padding-left:0.5rem;padding-right:0.5rem}.header-text{font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.dataset{display:flex}.tiles3D-dataset{margin-left:0.5rem}"}}]);