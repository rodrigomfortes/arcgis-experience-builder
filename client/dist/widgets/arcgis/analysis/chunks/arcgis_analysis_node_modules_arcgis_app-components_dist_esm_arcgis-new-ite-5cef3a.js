/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-5cef3a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-5cef3a"],{37374:(e,a,i)=>{i.r(a),i.d(a,{arcgis_new_item_pages_data_store_snowflake_credentials:()=>h});var t=i(87849),s=i(59317),c=i(24869),l=i(62296),n=i(47172),r=i(3826),d=i(95878),o=i(28748);i(37762),i(15912),i(87744),i(68194),i(50637),i(931),i(93814),i(32710),i(83929),i(76246),i(63054),i(72257),i(86562),i(15332),i(50020),i(50822),i(75294),i(38295),i(51102),i(56175),i(43555);const h=class{constructor(e){(0,t.r)(this,e),this.newItemUpdatePage=(0,t.c)(this,"newItemUpdatePage",7),this.allowedAuthenticationTypes=["keyPair","user"],this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.handleAuthenticationTypeChange=e=>{const a=e.target.selectedOption.value;this.authenticationType!==a&&("keyPair"===this.authenticationType?(this.passcode=void 0,this.keyFile=void 0,this.keyFileName=void 0):"user"===this.authenticationType&&(this.password=void 0),this.authenticationType=a)},this.authenticationType="keyPair",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.keyFile=void 0,this.passcode=void 0,this.validKeyFileFormat=!0,this.error=void 0}async handleNext(){r.a.authenticationType=this.authenticationType,r.a.snowflakeServer=this.server,r.a.snowflakeUsername=this.user,r.a.role=this.role,r.a.database=this.database,r.a.schema=this.schema,r.a.warehouse=this.warehouse,"keyPair"===this.authenticationType?(r.a.snowflakeKeyFileName=this.keyFileName,r.a.snowflakeKeyFile=this.keyFile,r.a.passcode=this.passcode):r.a.snowflakePassword=this.password,this.checkValidFields()?await this.validateConnection():this.handleError({code:"unhandledError"})}async componentWillLoad(){this.i18n=d.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{authenticationType:e,server:a,database:i,schema:t,warehouse:s,role:c,user:l,password:n,keyFileName:r}=this,d=[a,i,t,s,c,l,..."keyPair"===e?[r]:[n]];return this.emptyFieldsExist=d.some((e=>!e)),!this.emptyFieldsExist}populateFields(){var e;this.server=r.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=r.a.authenticationType),this.user=r.a.snowflakeUsername,this.role=r.a.role,this.database=r.a.database,this.schema=r.a.schema,this.warehouse=r.a.warehouse,"keyPair"===this.authenticationType?(this.keyFileName=r.a.snowflakeKeyFileName,this.keyFile=r.a.snowflakeKeyFile,this.passcode=r.a.passcode):this.password=r.a.snowflakePassword}async validateConnection(){const{user:e,password:a,database:i,role:t,server:c,warehouse:d,schema:h,keyFile:u,passcode:p,authenticationType:f}=this,{orgId:y}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const b=(0,o.k)({authenticationType:f,user:e,database:i,role:t,server:c,warehouse:d,schema:h,password:a,keyFile:u,passcode:p}),{result:k,error:m}=await(0,l.v)(y,s.c.portal,b);"success"===(null==k?void 0:k.status)?(r.a.jdbcConnection=Object.assign({},b.info.JDBCConnection),r.a.typeKeywords=[...r.a.typeKeywords,"CDW","snowflake"],r.a.initialTitle=(0,n.f)("snowflake",i),this.newItemUpdatePage.emit("itemProperties")):this.handleError(m)}processFile(e){if(!e)return;const{extension:a,fileName:i}=(0,c.s)(e);if(this.keyFileName=i,"p8"!==a)return this.validKeyFileFormat=!1,void(this.keyFile=void 0);this.validKeyFileFormat=!0;const t=new FileReader;t.onload=e=>{this.keyFile=String(e.target.result)},t.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let a=this.i18n.errors.validationFailedTitle,i=this.i18n.errors.invalidConnection;switch(e.code){case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidKeyFile":case"invalidCredentials":i=this.i18n.errors[e.code]}this.error={title:a,description:i,details:e.details}}render(){const{i18n:e,authenticationType:a,server:i,role:s,database:c,schema:l,warehouse:n,error:r,invalidLogin:d,validKeyFileFormat:o}=this;return(0,t.h)("div",{key:"8ec434c1f54986a7ed529a383be74993b7b7cf08"},(0,t.h)("arcgis-new-item-loader",{key:"55b7aafa9e86693e1adb6599c5ebd75b4fdcec62",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,t.h)("arcgis-new-item-description",{key:"55d0afb84cf79ccc24478f1edf7042cea987f358",header:e.dataStoreConnection,content:e.snowflake}),(0,t.h)("div",{key:"f7d1639b110f380939f6aea043e09bfc93e99185",class:"configure-form"},(0,t.h)("calcite-label",{key:"05cbd03b454f6e297fa36116dca169dc18a37124"},e.server,(0,t.h)("calcite-input",{key:"c18ae6bcded1e7bcf355a6cb469bde896dce0ed1",placeholder:"server_name.com",value:i,onCalciteInputInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"459bfa3f1de801a5b7cf39465ca77d44e99b8572",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noServer)),(0,t.h)("calcite-label",{key:"1308592f536b6bdf0f9ba2a73cd29b3359e339e1"},e.authenticationType,(0,t.h)("calcite-select",{key:"6770ab6d86737193ee3b9603a9489d357bdc8493",value:a,label:e.authenticationType,onCalciteSelectChange:this.handleAuthenticationTypeChange},this.allowedAuthenticationTypes.map((a=>(0,t.h)("calcite-option",{value:a,key:a},e[a]))))),(0,t.h)("div",{key:"23362083aed88d85c6d8161363e540df772bd492",class:"fill-credentials"},(0,t.h)("calcite-label",{key:"cbab82dd48e5909333f8f19477dac2b6daa867ef",class:"credentials"},(0,t.h)("div",{key:"769305d0982a63947a3eea68808fe11515beac54"},e.username," ",(!this.user&&this.emptyFieldsExist||d)&&(0,t.h)("span",{key:"2534453c198e56c5928445d30f03c8b8fa497458",class:"asterisk"},"*")),(0,t.h)("calcite-input",{key:"a4deeb0421cf3fe5dd59a2de1323ac4d246c1280",onCalciteInputInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||d)&&(0,t.h)("calcite-input-message",{key:"a3e9820af6c11feaf844b5ae69dedf15ac255ab1",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.incorrectLogin)),"keyPair"!==this.authenticationType&&(0,t.h)("calcite-label",{key:"e4fd62298612a5b4323eb24a83cf765de0ce8c07",class:"credentials"},(0,t.h)("div",{key:"87c9f3d3d5f2983b2db7f8aae322ddf2ac137c34",class:"password"},e.password," ",(!this.password&&this.emptyFieldsExist||d)&&(0,t.h)("span",{key:"c52049dd4995eb64297779f8fc2ca34e45489c46",class:"asterisk"},"*")),(0,t.h)("calcite-input",{key:"1b077a8ed2f52edffb3d5faafdffa8d288b5d460",class:"credentials password",type:"password",onCalciteInputInput:e=>this.password=this.trimInput(e.target.value),required:!0}))),"keyPair"===this.authenticationType&&(0,t.h)("div",{key:"473fbbc803f32d5373b5ccfba6dc0139f398e22c"},(0,t.h)("calcite-label",{key:"1a4c6b0709981509ba1b51047117a9a3d18ac8fe"},e.keyFile,(0,t.h)("calcite-input",{key:"25c315ddca432126231690db9b6710227c49c42c",status:!o||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid",readOnly:!0,value:this.keyFileName,required:!0},(0,t.h)("calcite-button",{key:"fc08d82e79514dbd236089825e81f9beec3778a2",iconStart:"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},e.selectKeyFile)),(0,t.h)("input",{key:"2ba5af6175606ea1d0b36adfa8c205d6031cdde3",class:"hide",type:"file",accept:".p8",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,t.h)("calcite-input-message",{key:"ec30aa5f543123084010c5987b2c4980472b5e92",icon:!o||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!o||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?e.errors.noKeyFile:o?e.p8Only:e.notP8)),(0,t.h)("calcite-label",{key:"5fad5143850fb51ea0dfc48bc55a42ed0fbf452a"},e.passcode,(0,t.h)("calcite-input",{key:"4dc4cc0d5685613ff51cd0a19cc19c6593239743",type:"password",onCalciteInputInput:e=>this.passcode=this.trimInput(e.target.value)}),(0,t.h)("calcite-input-message",{key:"ca3b7a9435b959399fdf8033b7bacf850d94001f",icon:"information",status:"idle"},e.passcodeInformation))),(0,t.h)("calcite-label",{key:"c249439a6fc143c001bad6d203e78b3cad1d87f7"},e.database,(0,t.h)("calcite-input",{key:"126ed4a1e2dad485d5c55eac5bf79e85a8a99d59",value:c,onCalciteInputInput:e=>this.database=this.trimInput(e.target.value),required:!0}),!this.database&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"41ed3f67463356bb439d3738bec18ab1e8753259",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noDatabase)),(0,t.h)("calcite-label",{key:"ee99ce49da66ab5ac380e7d50adaa25242f55459"},e.schema,(0,t.h)("calcite-input",{key:"c89c89d18bddcd7d298d9d1093c701a48c02e822",value:l,onCalciteInputInput:e=>this.schema=this.trimInput(e.target.value),required:!0}),!this.schema&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"77a35bde192906329e0db81aa362176df24ae0d9",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noSchema)),(0,t.h)("calcite-label",{key:"22a626d5ad362c150e6b59c0f4e30386c8c9ec41"},e.warehouse,(0,t.h)("calcite-input",{key:"44f302c7c2a27bcb0d5ea97a5b18bf8927bf68a4",value:n,onCalciteInputInput:e=>this.warehouse=this.trimInput(e.target.value),required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"6acd64af39248b36d2a1ff0182d4754e0da28f8f",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noWarehouse)),(0,t.h)("calcite-label",{key:"048c992f7b3a0efe09a6f42642ca50f8da4837e4"},e.role,(0,t.h)("calcite-input",{key:"b990eedb4ff24d77f99a7a02d2b7736c0dcfc75f",value:s,onCalciteInputInput:e=>this.role=this.trimInput(e.target.value),required:!0}),!this.role&&this.emptyFieldsExist&&(0,t.h)("calcite-input-message",{key:"3a21e80b74e594ebcbd07e55ca630d872964b39b",icon:"exclamation-mark-triangle",status:"invalid"},e.errors.noRole))),(0,t.h)("arcgis-new-item-alert",{key:"c5522f4fa9e625d26b0ac267fe7c332a7b150d95",heading:null==r?void 0:r.title,description:null==r?void 0:r.description,details:null==r?void 0:r.details,detailsPopoverLabel:e.errorDetails,active:!!r,onAlertDismiss:()=>this.error=null}))}};h.style=".configure-form{margin-top:1.5rem}.hide{display:none}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},47172:(e,a,i)=>{i.d(a,{f:()=>t});const t=(e,a)=>{let i;const t=null!=a?a:"";switch(e){case"amazon":i=`AmazonS3_${t}`;break;case"azure":i=`Microsoft_Azure_Storage_${t}`;break;case"bigquery":i=`BigQuery_${t}`;break;case"databricks":i=t?`Databricks_${t}`:"Databricks";break;case"snowflake":i=`Snowflake_${t}`}return i.replace(/ /g,"_").replace(/-/g,"_")}}}]);