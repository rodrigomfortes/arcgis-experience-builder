/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-116bc3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-116bc3"],{73959:(e,i,n)=>{n.d(i,{a:()=>d,b:()=>T,c:()=>u,d:()=>B,e:()=>V,f:()=>k,g:()=>v,h:()=>S,i:()=>F,j:()=>c,k:()=>h,l:()=>E,m:()=>I,n:()=>m,o:()=>f,p:()=>r,q:()=>g,r:()=>y,s:()=>b,t:()=>z});n(56612);var s=n(76744),a=n(39715),l=n(17840),o=n(68474),t=n(1664);function r(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===e?.tagName)return!0;{let i=e?.parentElement;for(;i;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===i.tagName)return!0;i=i.parentElement}}return!1}async function d(e,i){const{layer:n,useFeatureReduction:a,mapImageSublayer:o,mapView:t,supportsArcade:r,modules:d}=e,f=n;if(o&&!r||"subtype-sublayer"===f.type)return await async function(e,i){const{layer:n,useFeatureReduction:a,mapImageSublayer:o,mapView:t,modules:r}=e,d=n;i=i||{};const f=(0,s.at)(e,(0,s.g)(e)),u=i.fieldInfos?.[0];return await r.SizeCreator.createClassBreaksRenderer({layer:d,view:t,field:u?.field,valueExpression:u?.expression,valueExpressionTitle:u?.expressionTitle,normalizationField:void 0,classificationMethod:i.classificationMethod?i.classificationMethod:"natural-breaks",standardDeviationInterval:"standard-deviation"===i.classificationMethod?i.standardDeviationInterval?i.standardDeviationInterval:1:void 0,numClasses:i.numClasses?i.numClasses:4,outlineOptimizationEnabled:!o&&"subtype-sublayer"!==d.type&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,s.e)(e)),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:"featureReduction"in d&&"binning"===d.featureReduction?.type&&a}).then((e=>((0,s.au)(f,e.renderer),e)))}(e,i);const u=(0,s.g)(e),c=u.authoringInfo,m=(0,s.d)(u,"reference-size"),b=(0,s.d)(u,"spike"),z=(0,s.k)(e);i=i||{};const g=(0,s.at)(e,(0,s.g)(e)),y=i.fieldInfos?.[0],I=i.theme?i.theme:m?"reference-size":b?"spike":void 0,h={layer:f,view:t,field:y?.field,theme:I,valueExpression:y?.expression,valueExpressionTitle:y?.expressionTitle,normalizationField:i.normalizationField,outlineOptimizationEnabled:!o&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,s.e)(e)),sizeOptimizationEnabled:!o&&(!(0,l.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===f.featureReduction?.type&&a,referenceSizeOptions:i.theme&&"reference-size"!==i.theme||!y?.field?void 0:(0,l.i)(i.referenceSizeOptions)?i.referenceSizeOptions:m?{symbolStyle:m.referenceSizeSymbolStyle}:void 0,spikeOptions:i.theme&&"spike"!==i.theme||!y?.field?void 0:(0,l.i)(i.spikeOptions)?i.spikeOptions:b?{symbolStyle:b.spikeSymbolStyle}:void 0};return await d.SizeCreator.createContinuousRenderer(h).then((n=>{const a=(0,s.d)(n.renderer,"reference-size"),o=(0,s.d)(n.renderer,"spike");if(o){const e=n.renderer.classBreakInfos[0].symbol,i=(0,s.ao)(e);i?.color?.[3]&&(i.color[3]=255)}if(!i.noReuse&&p(e,i)&&["size","color-size","type-size","relationship-size"].includes(z)&&c&&"above-and-below"!==c.univariateTheme&&!(0,l.i)(a)&&!(0,l.i)(m)&&!(0,l.i)(o)&&!(0,l.i)(b)){const i=(0,s.g)(e).clone(),a=(0,s.b)(i,"size"),l=(0,s.d)(i,"size"),o=(0,s.b)(i,"size","outline");n.renderer.visualVariables=[a],o&&n.renderer.visualVariables.push(o),l&&(n.renderer.authoringInfo.visualVariables=[l]),(0,s.aE)(e,n.renderer)}return(0,s.au)(g,n.renderer),n}))}async function f(e,i){const{layer:n,mapImageSublayer:a,mapView:o,modules:t}=e,r=n,d=(0,s.g)(e).authoringInfo,f=(0,s.k)(e);i=i||{};const u=(0,s.at)(e,(0,s.g)(e)),c=i.fieldInfos?.[0],m=i.theme?i.theme:"high-to-low",b={layer:r,view:o,startTime:c?.field,endTime:new Date,theme:m,unit:void 0,outlineOptimizationEnabled:!a&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,s.e)(e)),sizeOptimizationEnabled:!0,legendOptions:i.legendOptions,defaultSymbolEnabled:!1};return await t.SizeCreator.createAgeRenderer(b).then((n=>{if(p(e,i)&&["size-age","color-size-age","type-size-age"].includes(f)&&d&&"above-and-below"!==d?.univariateTheme){const i=(0,s.g)(e).clone(),a=(0,s.b)(i,"size"),l=(0,s.d)(i,"size"),o=(0,s.b)(i,"size","outline");n.renderer.visualVariables=[a],o&&n.renderer.visualVariables.push(o),l&&(n.renderer.authoringInfo.visualVariables=[l]),(0,s.aE)(e,n.renderer)}return(0,s.au)(u,n.renderer),n}))}async function u(e,i){const{layer:n,useFeatureReduction:a,mapImageSublayer:o,mapView:t,supportsArcade:r,modules:d}=e,f=n;if(o&&!r)return await m(e,i);i=i||{};const u=(0,s.g)(e),c=u.authoringInfo||{},p=(0,s.k)(e),b=(0,s.b)(u,"size"),z=(0,s.d)(u,"size"),g=(0,s.d)(u,"reference-size"),y=(0,s.d)(u,"spike"),I=(0,s.at)(e,u);let h;if(["type-size","relationship-size"].includes(p)){const i=(0,s.g)(e);h=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,s.f)(e,p)}else h=u.classBreakInfos?.length?u.classBreakInfos[u.classBreakInfos.length-1].symbol:(0,s.f)(e,p);const S=u.defaultSymbol,v=u.defaultLabel,k=u.backgroundFillSymbol,V=(0,l.i)(i.referenceSizeOptions)?"reference-size":(0,l.i)(i.spikeOptions)?"spike":i.theme?i.theme:!z||g||y?g?"reference-size":y?"spike":"high-to-low":z.theme;let x=!1;if(b)V===b.theme&&(x=b.minSize.stops?b.minSize.stops[0].size>b.maxSize.stops[0].size:b.minSize>b.maxSize);else if(!g&&!y){const i=u.classBreakInfos[0].symbol,n=u.classBreakInfos[u.classBreakInfos.length-1].symbol,a=(0,s.af)(e,i),l=(0,s.af)(e,n);x=a>l}if(i.fieldInfos?.[0]&&b&&i.fieldInfos?.[0].field===b.field&&i.fieldInfos?.[0].expression===b.valueExpression&&i.normalizationField===b.normalizationField&&(delete i.fieldInfos,(0,s.aw)(i))){const e=u.clone();return e.visualVariables=(0,s.a)(u,"color"),{renderer:e}}const w=i.fieldInfos?.[0]?i.fieldInfos[0]:b?{field:b.field,expression:b.valueExpression,expressionTitle:b.valueExpressionTitle,simpleFieldType:s.w.NUMBER}:g?{field:g.field,simpleFieldType:s.w.NUMBER}:y?{field:y.field,simpleFieldType:s.w.NUMBER}:{field:u.field,expression:u.valueExpression,expressionTitle:u.valueExpressionTitle,simpleFieldType:s.w.NUMBER},O=null===i.normalizationField?void 0:i.normalizationField?i.normalizationField:b?b.normalizationField:g?g.normalizationField:y?y.normalizationField:u.normalizationField;let E=!1;(null===i.normalizationField||i.normalizationField||i.fieldInfos?.[0]||"manual"===c.classificationMethod&&!i.theme||"equal-interval"===c.classificationMethod)&&(E=!0);const F=i.discardMinMax?void 0:(0,l.i)(i.min)?i.min:E?void 0:b?z?.minSliderValue:g?g.minSliderValue:y?y.minSliderValue:u.classBreakInfos[0].minValue,B=i.discardMinMax?void 0:(0,l.i)(i.max)?i.max:E?void 0:b?z?.maxSliderValue:g?g.maxSliderValue:y?y.maxSliderValue:u.classBreakInfos[u.classBreakInfos.length-1].maxValue,T={layer:f,view:t,theme:V,field:w.field,valueExpression:w.expression,valueExpressionTitle:w.expressionTitle,normalizationField:O,minValue:F,maxValue:B,outlineOptimizationEnabled:!o&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!I.sizeOutlineVisVar),sizeOptimizationEnabled:!o&&(!b||((0,l.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:"object"==typeof b?.minSize)),legendOptions:i.legendOptions?.toJSON()||b?.legendOptions?.toJSON()||u.legendOptions?.toJSON(),defaultSymbolEnabled:(0,l.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!u.defaultSymbol,forBinning:"binning"===f.featureReduction?.type&&a,referenceSizeOptions:i.theme&&"reference-size"!==i.theme?void 0:(0,l.i)(i.referenceSizeOptions)?i.referenceSizeOptions:g?{symbolStyle:g.referenceSizeSymbolStyle}:void 0,spikeOptions:i.theme&&"spike"!==i.theme?void 0:(0,l.i)(i.spikeOptions)?i.spikeOptions:y?{symbolStyle:y.spikeSymbolStyle}:void 0};return await d.SizeCreator.createContinuousRenderer(T).then((n=>{const a=(0,s.d)(n.renderer,"reference-size");if(a){const i=a.sizeStops?.map((e=>e.size));if(!i||i[1]<i[0]||1===Math.round(i[1])){const{strings:i}=e;return Promise.reject({message:i.themeButton.errors.invalidReferenceSizeStops,type:"warning"})}}const l=(0,s.d)(n.renderer,"spike");if(!y&&l){const e=n.renderer.classBreakInfos[0].symbol,i=(0,s.ao)(e);i?.color?.[3]&&(i.color[3]=255)}const o=g?.referenceSizeSymbolStyle!==a?.referenceSizeSymbolStyle,t=y?.spikeSymbolStyle!==l?.spikeSymbolStyle;if(i.referenceSizeOptions||g||(n.renderer.authoringInfo.visualVariables=(0,s.c)(n.renderer,"reference-size")||[]),i.spikeOptions||y||(n.renderer.authoringInfo.visualVariables=(0,s.c)(n.renderer,"spike")||[]),i.discardMinMax&&!g&&!a&&!y&&!l){const e=(0,s.b)(u,"size"),i=(0,s.b)(n.renderer,"size");e.minDataValue=i.minDataValue,e.maxDataValue=i.maxDataValue}if(!i.fieldInfos&&void 0===i.normalizationField&&b&&!a&&!l&&V===b?.theme){const e=(0,s.b)(n.renderer,"size");e.minDataValue=b.minDataValue,e.maxDataValue=b.maxDataValue}if(!g&&a&&(n.renderer.defaultLabel=void 0,n.renderer.defaultSymbol=void 0,n.renderer.backgroundFillSymbol=void 0),["color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size","predominance-size"].includes(p)){if(o||t)return n;u.visualVariables=(0,s.a)(u,"size")||[],u.visualVariables=(0,s.a)(u,"size","outline")||[],u.authoringInfo.visualVariables=(0,s.c)(u,"size")||[],u.authoringInfo.visualVariables=(0,s.c)(u,"reference-size")||[];const i=(0,s.b)(n.renderer,"size");i&&u.visualVariables.push(i);const a=(0,s.b)(n.renderer,"size","outline");a&&u.visualVariables.push(a);const l=(0,s.d)(n.renderer,"size");return l&&u.authoringInfo.visualVariables.push(l),(0,s.aE)(e,u),n.renderer=u.clone(),n}if((0,s.au)(I,n.renderer),o||!h||!n.renderer.classBreakInfos?.length||l||y||(n.renderer.classBreakInfos[0].symbol=h),o&&h&&n.renderer.classBreakInfos?.length){const i=(0,s.h)(e,h);(0,s.j)(e,n.renderer.classBreakInfos[0].symbol,i)}if(!S||a&&!g||(n.renderer.defaultSymbol=S,n.renderer.defaultLabel=v),!k||a&&!g||(n.renderer.backgroundFillSymbol=k),x){const e=(0,s.b)(n.renderer,"size");if(e){const i=e.minSize;e.minSize=e.maxSize,e.maxSize=i}}return n}))}async function c(e,i){const{layer:n,mapImageSublayer:a,mapView:o,modules:t}=e,r=n;i=i||{};const d=(0,s.g)(e),f=(0,s.k)(e),u=(0,s.b)(d,"size"),c=(0,s.d)(d,"size"),m=(0,s.at)(e,d),p=i.startTime?i.startTime:c.startTime,b=i.endTime?i.endTime:c.endTime;let z;if(["type-size-age"].includes(f)){const i=(0,s.g)(e);z=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,s.f)(e,f)}else z=d.classBreakInfos?.length?d.classBreakInfos[0].symbol:(0,s.f)(e,f);const g=d.defaultSymbol,y=d.defaultLabel,I=d.backgroundFillSymbol;let h=!1;if(u)h=u.minSize.stops?u.minSize.stops[0].size>u.maxSize.stops[0].size:u.minSize>u.maxSize,"below"===c.theme&&(h=!h);else{const i=d.classBreakInfos[0].symbol,n=d.classBreakInfos[d.classBreakInfos.length-1].symbol,a=(0,s.af)(e,i),l=(0,s.af)(e,n);h=a>l}if(i.fieldInfos?.[0]&&u&&i.fieldInfos[0].field===u.field&&(delete i.fieldInfos,(0,s.aw)(i))){const e=d.clone();return e.visualVariables=(0,s.a)(d,"color"),{renderer:e}}let S=!1;(i.startTime||i.endTime||i.units||i.fieldInfo||i.theme)&&(S=!0);const v=i.discardMinMax?void 0:(0,l.i)(i.min)?i.min:S?void 0:c?c.minSliderValue:d.classBreakInfos[0].minValue,k=i.discardMinMax?void 0:(0,l.i)(i.max)?i.max:S?void 0:c?c.maxSliderValue:d.classBreakInfos[d.classBreakInfos.length-1].maxValue,V={layer:r,view:o,theme:i.theme?i.theme:c?c.theme:"high-to-low",startTime:p,endTime:b,unit:i.units?i.units:c.units,minValue:v,maxValue:k,outlineOptimizationEnabled:!a&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!m.sizeOutlineVisVar),sizeOptimizationEnabled:!a&&(!u||((0,l.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:"object"==typeof u.minSize)),legendOptions:i.legendOptions?.toJSON()||u?.legendOptions?.toJSON()||d.legendOptions?.toJSON(),defaultSymbolEnabled:(0,l.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!d.defaultSymbol};return await t.SizeCreator.createAgeRenderer(V).then((n=>{if(i.discardMinMax){const e=(0,s.b)(d,"size"),i=(0,s.b)(n.renderer,"size");e.minDataValue=i.minDataValue,e.maxDataValue=i.maxDataValue}if((0,s.d)(n.renderer,"size").field=c.field,!S){const e=(0,s.b)(n.renderer,"size");e.minDataValue=u.minDataValue,e.maxDataValue=u.maxDataValue}if(["color-size-age"].includes(f)){d.visualVariables=(0,s.a)(d,"size")||[],d.visualVariables=(0,s.a)(d,"size","outline")||[],d.authoringInfo.visualVariables=(0,s.c)(d,"size")||[];const i=(0,s.b)(n.renderer,"size");d.visualVariables.push(i);const a=(0,s.d)(n.renderer,"size");d.authoringInfo.visualVariables.push(a);const l=(0,s.b)(n.renderer,"size","outline");return l&&d.visualVariables.push(l),(0,s.aE)(e,d),n.renderer=d.clone(),n}if((0,s.au)(m,n.renderer),z&&n.renderer.classBreakInfos?.length&&(n.renderer.classBreakInfos[0].symbol=z),g&&(n.renderer.defaultSymbol=g,n.renderer.defaultLabel=y),I&&(n.renderer.backgroundFillSymbol=I),h){const e=(0,s.b)(n.renderer,"size"),i=e.minSize;e.minSize=e.maxSize,e.maxSize=i}return n}))}async function m(e,i){const{layer:n,useFeatureReduction:a,mapImageSublayer:o,mapView:t,modules:r}=e,d=n;i=i||{};const f=(0,s.g)(e),u=(0,s.k)(e),c=f.authoringInfo,m=(0,s.b)(f,"size"),p=(0,s.d)(f,"size"),b=(0,s.at)(e,f),z={field:f.field,expression:f.valueExpression,expressionTitle:f.valueExpressionTitle,simpleFieldType:s.w.NUMBER},g=i.fieldInfos?i.fieldInfos[0]:m?{field:m.field,expression:m.valueExpression,expressionTitle:m.valueExpressionTitle,simpleFieldType:s.w.NUMBER}:z,y=void 0!==i.normalizationField?i.normalizationField:m?m.normalizationField:f.normalizationField;let I;if(["type-size"].includes(u)){const i=(0,s.g)(e);I=i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,s.f)(e,u)}else I=f.classBreakInfos?.length?f.classBreakInfos[0].symbol:(0,s.f)(e,u);const h=f.defaultSymbol,S=f.defaultLabel,v=f.backgroundFillSymbol;let k=!1;if(f.classBreakInfos.length>1){const i=f.classBreakInfos[0].symbol,n=f.classBreakInfos[1].symbol,a=(0,s.af)(e,i)||0,l=(0,s.af)(e,n)||0;k=a>l}if(!m&&c&&(0,s.D)(g,z)&&y===f.normalizationField&&(delete i.fieldInfos,(0,s.aw)(i))){const e=f.clone();return e.visualVariables=(0,s.a)(f,"color"),{renderer:e}}const V=i.classificationMethod?i.classificationMethod:c?.classificationMethod&&"manual"!==c.classificationMethod?c.classificationMethod:"equal-interval",x="standard-deviation"===V?i.standardDeviationInterval?i.standardDeviationInterval:c?.standardDeviationInterval?c.standardDeviationInterval:1:void 0;let w=!0;!i.classificationMethod||i.classificationMethod===c?.classificationMethod||"standard-deviation"!==i.classificationMethod&&"standard-deviation"!==c?.classificationMethod||(w=!1);let O=!1;(void 0!==i.normalizationField||!(0,s.D)(g,z)||"equal-interval"!==V||p?.minSliderValue||p?.maxSliderValue)&&(O=!0);const E=(0,l.i)(i.min)?i.min:O?void 0:p?p.minSliderValue:f.classBreakInfos[0].minValue,F=(0,l.i)(i.max)?i.max:O?void 0:p?p.maxSliderValue:f.classBreakInfos[f.classBreakInfos.length-1].maxValue;return await r.SizeCreator.createClassBreaksRenderer({layer:d,view:t,field:g.field,valueExpression:g.expression,valueExpressionTitle:g.expressionTitle,normalizationField:y,classificationMethod:V,standardDeviationInterval:x,numClasses:(0,l.i)(i.numClasses)?i.numClasses:m||!w?4:f.classBreakInfos.length,minValue:E,maxValue:F,outlineOptimizationEnabled:!o&&((0,l.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!b.sizeOutlineVisVar),legendOptions:i.legendOptions||f.legendOptions,defaultSymbolEnabled:(0,l.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!f.defaultSymbol,forBinning:"binning"===d.featureReduction?.type&&a}).then((i=>{if((0,s.au)(b,i.renderer),I&&i.renderer.classBreakInfos&&i.renderer.classBreakInfos.forEach((i=>{const n=I.clone();(0,s.ag)(e,n,(0,s.af)(e,i.symbol)),i.symbol=n})),h&&(i.renderer.defaultSymbol=h,i.renderer.defaultLabel=S),v&&(i.renderer.backgroundFillSymbol=v),k){const e=(0,s.b)(i.renderer,"size"),n=e.minSize;e.minSize=e.maxSize,e.maxSize=n}return i}))}function p(e,i){const n=(0,s.g)(e).clone(),a=(0,s.k)(e);if(["size","size-age","color-size","color-size-age","color-age-size","type-size","type-size-age","relationship-size"].includes(a)&&void 0===i.normalizationField){let e;const l=(0,s.b)(n,"size");if(l)if(["size-age","color-size-age","type-size-age"].includes(a)){e={field:(0,s.d)(n,"size").field}}else e={field:l.field,expression:l.valueExpression,expressionTitle:l.valueExpressionTitle};else e={field:n.field,expression:n.valueExpression,expressionTitle:n.valueExpressionTitle};if((0,s.D)(i.fieldInfos?.[0],e))return!0}return!1}function b(e){const{mapView:i,modules:n}=e,a=(0,s.g)(e),l=(0,s.b)(a,"size"),t=(0,s.d)(a,"reference-size"),r=(0,s.d)(a,"spike"),d=i.scale;let f;if(l?.stops)f=n.esriLang.clone(l.stops);else if(t?.sizeStops)t.referenceSizeScale&&(0,o.s)(e),f=n.esriLang.clone(t.sizeStops);else if(r?.sizeStops)f=n.esriLang.clone(r.sizeStops);else{const{minSize:e,maxSize:i,minDataValue:s,maxDataValue:a}=l;let o,t;if("number"==typeof e)o=e,t=i;else{const n=e.stops.length-1;d>e.stops[n].value?(o=e.stops[n].size,t=i.stops[n].size):e.stops.forEach(((e,n)=>{d<=e.value&&(o=e.size,t=i.stops[n].size)}))}f=[new n.SizeStop({value:s,size:o}),new n.SizeStop({value:a,size:t})]}return f}function z(e){return(0,s.g)(e).classBreakInfos.map((i=>{const n=i.symbol;return{min:i.minValue,max:i.maxValue,size:(0,s.af)(e,n)}}))}async function g(e,i){const{layer:n,modules:a,useFeatureReduction:o,mapView:t}=e,r=(0,s.g)(e),d=(0,s.d)(r,"reference-size");i=i||{};const f={layer:n,view:t,renderer:r.clone(),field:d.field,normalizationField:d.normalizationField,sizeStops:i.sizeStops??a.esriLang.clone(d.sizeStops),forBinning:"binning"===n.featureReduction?.type&&o,sizeOptimizationEnabled:(0,l.i)(d.referenceSizeScale),referenceSizeOptions:i.referenceSizeOptions??{symbolStyle:d.referenceSizeSymbolStyle}};return await a.SizeCreator.updateRendererWithReferenceSize(f).then((e=>e))}async function y(e,i){const{layer:n,modules:a,useFeatureReduction:l,mapView:o}=e,t=(0,s.g)(e),r=(0,s.d)(t,"spike");i=i||{};const d={layer:n,view:o,renderer:t.clone(),field:r.field,normalizationField:r.normalizationField,sizeStops:i.sizeStops??a.esriLang.clone(r.sizeStops),forBinning:"binning"===n.featureReduction?.type&&l,spikeOptions:i.spikeOptions??{symbolStyle:r.spikeSymbolStyle}};return await a.SizeCreator.updateRendererWithSpike(d).then((i=>{const n=(0,s.A)(e,i),a=(0,s.d)(i,"spike"),l=r.spikeSymbolStyle,o=a.spikeSymbolStyle;if("triangle-gradient-fill-open"===l&&"triangle-gradient-fill-open-outline"===o||"triangle-solid-fill-open"===l&&["triangle-solid-fill-open-outline","triangle-solid-fill-closed-outline"].includes(o)){if(["type-size","relationship-size"].includes(n)){i.uniqueValueInfos.forEach((e=>{const i=e.symbol;(0,s.ao)(i).color=[255,255,255,255]}))}else{const e=i.classBreakInfos[0].symbol;(0,s.ao)(e).color=[255,255,255,255]}}return i}))}async function I(e,i){const n=(0,s.g)(e),a=n.authoringInfo,l=(0,s.k)(e),o=(i=i||{}).fieldInfos.length>1?i.fieldInfos[1]:i.fieldInfos[0];if(p(e,{fieldInfos:[o]})&&["color-size","color-age-size","type-size"].includes(l)&&a&&"above-and-below"!==a?.univariateTheme){if((0,s.b)((0,s.g)(e),"size"))return await x(e,(0,s.g)(e),i)}const t=(0,s.d)(n,"spike");return t?.spikeSymbolStyle?.includes("gradient")&&(i.spikeOptions={...i.spikeOptions,symbolStyle:"triangle-solid-fill-open-outline"}),await d(e,{...i,fieldInfos:[o]}).then((async n=>await x(e,n.renderer,i)))}async function h(e,i){const n=(0,s.g)(e).authoringInfo,a=(0,s.k)(e),l=(i=i||{}).fieldInfos.length>1?i.fieldInfos[1]:i.fieldInfos[0];if(p(e,{fieldInfos:[l]})&&["color-size","color-age-size","type-size"].includes(a)&&n&&"above-and-below"!==n?.univariateTheme){if((0,s.b)((0,s.g)(e),"size"))return await w(e,(0,s.g)(e),i)}return await d(e,{...i,fieldInfos:[l]}).then((async n=>await w(e,n.renderer,i)))}async function S(e,i){const n=(0,s.g)(e).authoringInfo,a=(0,s.k)(e),l=(i=i||{}).fieldInfos.length>1?i.fieldInfos[1]:i.fieldInfos[0];if(p(e,{fieldInfos:[l]})&&["color-size-age","type-size-age"].includes(a)&&n&&"above-and-below"!==n?.univariateTheme){if((0,s.b)((0,s.g)(e),"size"))return await x(e,(0,s.g)(e),i)}return await f(e,{...i,fieldInfos:[l]}).then((async n=>await x(e,n.renderer,i)))}async function v(e,i,n){return i=i||{},await u(e,{...i,fieldInfos:i.fieldInfos?i.fieldInfos.length>1?[i.fieldInfos[1]]:[i.fieldInfos[0]]:null}).then((async l=>await(0,a.b)(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[0]]:null}).then((i=>(O(e,i.renderer,l.renderer),i.backgroundFillSymbol=(0,s.g)(e).backgroundFillSymbol,"size"===n&&(i.statistics=l.statistics),i)))))}async function k(e,i,n){return i=i||{},await u(e,{...i,fieldInfos:i.fieldInfos?i.fieldInfos.length>1?[i.fieldInfos[1]]:[i.fieldInfos[0]]:null}).then((async l=>await(0,a.c)(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[0]]:null}).then((i=>(O(e,i.renderer,l.renderer),i.backgroundFillSymbol=(0,s.g)(e).backgroundFillSymbol,"size"===n&&(i.statistics=l.statistics),i)))))}async function V(e,i,n){return i=i||{},await c(e,{...i,fieldInfos:i.fieldInfos?i.fieldInfos.length>1?[i.fieldInfos[1]]:[i.fieldInfos[0]]:null}).then((async l=>await(0,a.b)(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[0]]:null}).then((i=>(O(e,i.renderer,l.renderer),i.backgroundFillSymbol=(0,s.g)(e).backgroundFillSymbol,"size"===n&&(i.statistics=l.statistics),i)))))}async function x(e,i,n){const l=(0,s.g)(e),o=l.authoringInfo,t=(0,s.k)(e),r=(0,s.d)(l,"color");if((0,s.b)(l,"color")&&(0,a.s)(e,n)&&["color","color-size","color-size-age"].includes(t)&&o&&"above-and-below"!==o?.univariateTheme&&!["centered-on","extremes"].includes(r.theme)){const a=(0,s.g)(e).clone();if(O(e,a,i),2===n.fieldInfos.length){const e=a.authoringInfo;e.type=void 0,e.univariateTheme=void 0,e.univariateSymbolStyle=void 0}return{renderer:a}}return await(0,a.d)(e,{...n,fieldInfos:[n.fieldInfos[0]]}).then((n=>(O(e,n.renderer,i),n)))}async function w(e,i,n){const l=(0,s.g)(e).authoringInfo,o=(0,s.k)(e);if((0,a.s)(e,n)&&["color-age","color-age-size"].includes(o)&&l&&"above-and-below"!==l?.univariateTheme){const n=(0,s.g)(e).clone();return O(e,n,i),{renderer:n}}return await(0,a.e)(e,{...n,fieldInfos:[n.fieldInfos[0]]}).then((n=>(O(e,n.renderer,i),n)))}function O(e,i,n){if(!i.authoringInfo)return;i.visualVariables=(0,s.a)(i,"size")||[],i.visualVariables=(0,s.a)(i,"size","auto")||[];const a=(0,s.b)(n,"size"),l=(0,s.d)(n,"reference-size"),o=(0,s.d)(n,"spike");l||o||i.visualVariables.push(a),i.authoringInfo.visualVariables=(0,s.c)(i,"size")||[];const t=(0,s.d)(n,"size");i.authoringInfo.visualVariables.push(t);const r=n.classBreakInfos?.length?n.classBreakInfos:n.uniqueValueInfos;let d=r?.length?r[0].symbol:(0,s.f)(e,"color-size");if("picture-marker"===d.type&&(d=(0,s.f)(e,"color-size")),(0,s.e)(e)||o){i.classBreakInfos.forEach((i=>{const n=(0,s.h)(e,i.symbol);i.symbol=d.clone(),(0,s.j)(e,i.symbol,n)})),i.backgroundFillSymbol=n.backgroundFillSymbol;const a=(0,s.b)(n,"size","outline");a&&i.visualVariables.push(a)}!function(e,i){const{modules:n}=e;"simple-line"===i.type?(i.color=[0,0,0,.5],i.width=1):"cim"===i.type?((0,s.j)(e,i,new n.EsriColor([0,0,0,.5])),(0,s.ag)(e,i,4)):(i.color=null,i.outline.color=[0,0,0,.5],(0,s.ag)(e,i,4))}(e,d)}async function E(e,i){const n=(0,s.k)(e),a=(i=i||{}).fieldInfos.length>1?i.fieldInfos[1]:i.fieldInfos[0];if(p(e,{fieldInfos:[a]})&&["color-size","type-size"].includes(n)){if((0,s.b)((0,s.g)(e),"size")&&(0,s.g)(e).authoringInfo)return await M(e,(0,s.g)(e),i)}return await d(e,{...i,fieldInfos:[i.fieldInfos[1]]}).then((async n=>await M(e,n.renderer,i)))}async function F(e,i){const n=(0,s.k)(e),a=(i=i||{}).fieldInfos.length>1?i.fieldInfos[1]:i.fieldInfos[0];if(p(e,{fieldInfos:[a]})&&["color-size-age","type-size-age"].includes(n)){if((0,s.b)((0,s.g)(e),"size")&&(0,s.g)(e).authoringInfo)return await M(e,(0,s.g)(e),i)}return await f(e,{...i,fieldInfos:[i.fieldInfos[1]]}).then((async n=>await M(e,n.renderer,i)))}async function B(e,i,n){return i=i||{},await u(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[1]]:null}).then((async a=>await(0,t.f)(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[0]]:null}).then((i=>(R(e,i.renderer,a.renderer),i.backgroundFillSymbol=(0,s.g)(e).backgroundFillSymbol,"size"===n&&(i.statistics=a.statistics),i)))))}async function T(e,i,n){const{modules:a}=e;return i=i||{},await c(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[1]]:null}).then((async l=>{if(delete i.units,delete i.startTime,delete i.endTime,(0,s.aw)(i)){const i=(0,s.g)(e).clone();i.visualVariables=(0,s.a)(i,"size")||[];const n=(0,s.b)(l.renderer,"size");i.visualVariables.push(n),i.authoringInfo=i.authoringInfo||new a.AuthoringInfo({}),i.authoringInfo.visualVariables=(0,s.c)(i,"size")||[];const o=(0,s.d)(l.renderer,"size");return i.authoringInfo.visualVariables.push(o),{renderer:i}}return await(0,t.f)(e,{...i,fieldInfos:i.fieldInfos?[i.fieldInfos[0]]:null}).then((i=>(R(e,i.renderer,l.renderer),i.backgroundFillSymbol=(0,s.g)(e).backgroundFillSymbol,"size"===n&&(i.statistics=l.statistics),i)))}))}async function M(e,i,n){const a=(0,s.k)(e);if((0,t.s)(e,n)&&["type","type-size","type-size-age"].includes(a)){const n=(0,s.g)(e).clone();return R(e,n,i),{renderer:n}}return await(0,t.g)(e,{...n,fieldInfos:[n.fieldInfos[0]]}).then((n=>(R(e,n.renderer,i),n)))}function R(e,i,n){const{modules:a}=e;i.visualVariables=(0,s.a)(i,"size")||[],i.visualVariables=(0,s.a)(i,"size","auto")||[];const l=(0,s.b)(n,"size");i.visualVariables.push(l),i.authoringInfo=i.authoringInfo||new a.AuthoringInfo({}),i.authoringInfo.visualVariables=(0,s.c)(i,"size")||[];const o=(0,s.d)(n,"size");i.authoringInfo.visualVariables.push(o);const t=(0,s.d)(n,"spike");if((0,s.e)(e)||t){const a=n.classBreakInfos?.length?n.classBreakInfos[0].symbol:n.uniqueValueInfos?.length?n.uniqueValueInfos[0].symbol:(0,s.f)(e,"type-size"),l=i.uniqueValueInfos.slice();l.forEach((i=>{const n=(0,s.h)(e,i.symbol);i.symbol=a.clone(),(0,s.j)(e,i.symbol,n)})),i.uniqueValueInfos=l,i.backgroundFillSymbol=n.backgroundFillSymbol;const o=(0,s.b)(n,"size","outline");o&&i.visualVariables.push(o)}}}}]);