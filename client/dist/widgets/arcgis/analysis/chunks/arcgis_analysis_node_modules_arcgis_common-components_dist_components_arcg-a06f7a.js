/*! For license information please see arcgis_analysis_node_modules_arcgis_common-components_dist_components_arcg-a06f7a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_common-components_dist_components_arcg-a06f7a"],{10117:(i,t,e)=>{e.r(t),e.d(t,{ArcgisCommonSqlExpressionConfigExpression:()=>C});var s=e(6364),o=e(85282),n=e(61833),c=e(70757),r=e(91021),a=e(80666),d=(e(52797),e(5294),e(24186));e(34031),e(43284);const l=e(55088).AH`.expression-block{margin:0 var(--calcite-spacing-sm);border:var(--calcite-border-width-sm) solid var(--calcite-color-border-3)}.content{padding-bottom:var(--calcite-spacing-xs)}.match-type-text{display:flex;justify-content:flex-start;margin:var(--calcite-spacing-xs) var(--calcite-spacing-sm) 0 var(--calcite-spacing-sm)}:dir(rtl){.match-type-text{justify-content:flex-end}}.match-type-text-empty{margin:var(--calcite-spacing-sm-plus) 0 0 0}.match-condition{border-bottom:1px solid var(--calcite-color-border-3);padding-bottom:18px}.match-condition-dropdown{width:100%}.add-condition-button{display:flex}`,h="expression-block",p="add-condition-button",u="content",m="match-type-text",g="match-type-text-empty",$="match-condition",v="match-condition-dropdown";class C extends n.WF{constructor(){super(...arguments),this.menuNode=(0,c._)(),this.hideRemove=!1,this.hideDuplicate=!1,this.showAddConditionButton=!1,this.arcgisDisablePanel=(0,n.lh)(),this.arcgisExpressionChanged=(0,n.lh)()}static{this.properties={props:0,uid:1,conditions:0,logicalOperatorForConditions:[0,{attribute:"operator"}],hideRemove:5,hideDuplicate:5,showAddConditionButton:5}}static{this.styles=l}async onEdits(){this.el.shadowRoot?.querySelectorAll("arcgis-common-sql-expression-config-condition").forEach((i=>i.onEdits()))}load(){this.conditions=this.conditions||[]}onAddCondition(){const{props:i,conditions:t}=this,e=(0,d.p)(i),s=(0,d.q)(i,e),o=(0,d.r)(i,e,s),n={fieldName:e.layerField.name,operator:(0,d.q)(i,e),...o,hasFocus:!0};t.forEach((i=>i.hasFocus=!1)),this.conditions=[...t,n],i.expressions=i.expressions.map((i=>i.uid===this.uid?{...i,conditions:this.conditions}:{...i})),this.fixUIDsForExpression(),this.menuNode.value.open=!1,this.emitChangeEvent()}onRemoveCondition(i){const{props:t,conditions:e}=this;e.forEach((i=>i.hasFocus=!1));let s=0;this.conditions=e.filter(((t,e)=>!t||e!==i||(s=e,!1))),this.conditions[Math.max(0,s-1)].hasFocus=!0,t.expressions=t.expressions.map((i=>i.uid===this.uid?{...i,conditions:this.conditions}:{...i})),this.fixUIDsForExpression(),this.emitChangeEvent()}onMatchSelect(i){const t=i.target.selectedOption.value;this.logicalOperatorForConditions=t,this.emitChangeEvent()}onCopyExpression(){const{uid:i,conditions:t,logicalOperatorForConditions:e}=this,s={uid:i,conditions:t,logicalOperatorForConditions:e};this.menuNode.value.open=!1,this.arcgisExpressionChanged.emit({type:"copy",uid:this.uid,expression:s})}onRemoveExpression(){this.arcgisExpressionChanged.emit({type:"delete",uid:this.uid})}fixUIDsForExpression(){const{props:i}=this;i.expressions=(0,a.f)(i.expressions),this.conditions=i.expressions.find((i=>i.uid===this.uid)).conditions}emitChangeEvent(){const{uid:i,conditions:t,logicalOperatorForConditions:e}=this,s={uid:i,conditions:t,logicalOperatorForConditions:e};this.arcgisExpressionChanged.emit({type:"replace",expression:s})}render(){const{props:i,conditions:t}=this,{_messages:e}=i,s=(0,r.O)(this.el);return(0,n.Bq)(this.el,"dir",s),o.qy`<calcite-block .heading=${1===t.length?e.condition:e.conditionSet} open class=${(0,n.CP)(h)}>${this.renderMenu()}${this.renderMatchCondition()}${this.renderConditions()}${this.renderAddConditionButton()}</calcite-block>`}renderMenu(){const{props:i,hideDuplicate:t,hideRemove:e,conditions:s}=this,{_messages:n}=i;return o.qy`<calcite-action-menu slot=control placement=bottom-end overlay-positioning=fixed .label=${n.accessibility.moreOptions} @calcitePopoverClose=${i=>i.stopPropagation()} ${(0,c.K)(this.menuNode)}>${!e&&o.qy`<calcite-action .text=${1===s.length?n.deleteExpression:n.deleteSet} text-enabled data-value=remove @click=${this.onRemoveExpression}></calcite-action>`||""}${!t&&o.qy`<calcite-action .text=${n.duplicate} text-enabled data-value=copy @click=${this.onCopyExpression}></calcite-action>`||""}<calcite-action .text=${n.addCondition} text-enabled data-value=add @click=${this.onAddCondition}></calcite-action></calcite-action-menu>`}renderMatchCondition(){const{conditions:i,logicalOperatorForConditions:t,props:e}=this,{_messages:s}=e;if(!i?.length||1===i.length)return;const c=t!==a.l.OR;return o.qy`<div class=${(0,n.CP)($)}><calcite-select width=full scale=m .label=${s.accessibility.matchType} class=${(0,n.CP)(v)} @calciteSelectChange=${this.onMatchSelect}><calcite-option .value=${a.l.AND} .label=${s.matchAll} .selected=${c}></calcite-option><calcite-option .value=${a.l.OR} .label=${s.matchAtLeastOne} .selected=${!c}></calcite-option></calcite-select></div>`}renderConditions(){const{conditions:i}=this;return o.qy`<div class=${(0,n.CP)(u)}>${i.map(((i,t)=>this.renderCondition(i,t)))}</div>`}renderCondition(i,t){const{conditions:e,props:s}=this;return o.qy`<div>${this.renderConditionHeader(t)}<arcgis-common-sql-expression-config-condition .props=${s} .showDelete=${e.length>1} .uid=${i.uid} .operator=${i.operator} .fieldName=${i.fieldName} .value=${i.value} .value2=${i.value2} .values=${i.values} .uniqueValuesSortBy=${i.uniqueValuesSortBy} .unit=${i.unit} .histogramClosed=${i.histogramClosed} .hasFocus=${i.hasFocus} .invalidValue=${i.invalidValue} @arcgisDeleted=${()=>this.onRemoveCondition(t)} @arcgisChanged=${i=>{const{conditions:t}=this,{detail:e}=i;this.conditions=t.map((i=>i.uid===e.uid?e:i)),this.emitChangeEvent()}} @arcgisDisablePanel=${i=>{i.stopPropagation();const t=i.detail;this.arcgisDisablePanel.emit(t)}}></arcgis-common-sql-expression-config-condition></div>`}renderAddConditionButton(){return this.showAddConditionButton&&o.qy`<calcite-button alignment=center appearance=transparent class=${(0,n.CP)(p)} icon-start=plus scale=s @click=${this.onAddCondition}>${this.props._messages.addCondition}</calcite-button>`||""}renderConditionHeader(i){const{props:t,logicalOperatorForConditions:e,conditions:s}=this,{_messages:c}=t;if(s.length<2)return;const r=e!==a.l.OR;return o.qy`<div>${i>0?o.qy`<span class=${(0,n.CP)(m)}>${r?c.and:c.or}</span>`:s.length>1?o.qy`<div class=${(0,n.CP)(g)}></div>`:null}</div>`}}(0,s.c)("arcgis-common-sql-expression-config-expression",C)},70757:(i,t,e)=>{e.d(t,{_:()=>u,K:()=>$});var s=e(85282),o=e(42466),n=e(34670);const c=(i,t)=>{const e=i._$AN;if(void 0===e)return!1;for(const i of e)i._$AO?.(t,!1),c(i,t);return!0},r=i=>{let t,e;do{if(void 0===(t=i._$AM))break;e=t._$AN,e.delete(i),i=t}while(0===e?.size)},a=i=>{for(let t;t=i._$AM;i=t){let e=t._$AN;if(void 0===e)t._$AN=e=new Set;else if(e.has(i))break;e.add(i),h(t)}};function d(i){void 0!==this._$AN?(r(this),this._$AM=i,a(this)):this._$AM=i}function l(i,t=!1,e=0){const s=this._$AH,o=this._$AN;if(void 0!==o&&0!==o.size)if(t)if(Array.isArray(s))for(let i=e;i<s.length;i++)c(s[i],!1),r(s[i]);else null!=s&&(c(s,!1),r(s));else c(this,i)}const h=i=>{i.type==n.OA.CHILD&&(i._$AP??=l,i._$AQ??=d)};class p extends n.WL{constructor(){super(...arguments),this._$AN=void 0}_$AT(i,t,e){super._$AT(i,t,e),a(this),this.isConnected=i._$AU}_$AO(i,t=!0){i!==this.isConnected&&(this.isConnected=i,i?this.reconnected?.():this.disconnected?.()),t&&(c(this,i),r(this))}setValue(i){if((0,o.Rt)(this._$Ct))this._$Ct._$AI(i,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=i,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}const u=()=>new m;class m{}const g=new WeakMap,$=(0,n.u$)(class extends p{render(i){return s.s6}update(i,[t]){const e=t!==this.G;return e&&void 0!==this.G&&this.rt(void 0),(e||this.lt!==this.ct)&&(this.G=t,this.ht=i.options?.host,this.rt(this.ct=i.element)),s.s6}rt(i){if(this.isConnected||(i=void 0),"function"==typeof this.G){const t=this.ht??globalThis;let e=g.get(t);void 0===e&&(e=new WeakMap,g.set(t,e)),void 0!==e.get(this.G)&&this.G.call(this.ht,void 0),e.set(this.G,i),void 0!==i&&this.G.call(this.ht,i)}else this.G.value=i}get lt(){return"function"==typeof this.G?g.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}})},80666:(i,t,e)=>{e.d(t,{a:()=>d,b:()=>n,c:()=>l,d:()=>c,f:()=>h,i:()=>a,l:()=>s,s:()=>o,t:()=>r});var s=(i=>(i.AND="and",i.OR="or",i))(s||{}),o=(i=>(i.NUMBER="number",i.STRING="string",i.DATE="date",i.DATE_ONLY="date-only",i.TIME_ONLY="time-only",i.OID="oid",i.GUID="guid",i.DOMAIN="domain",i))(o||{}),n=(i=>(i.MISSING="missing",i.IN_PROGRESS="inProgress",i.SUCCESS="success",i.FAILED="failed",i))(n||{}),c=(i=>(i.MINUTE="minute",i.HOUR="hour",i.DAY="day",i.WEEK="week",i.MONTH="month",i.YEAR="year",i))(c||{}),r=(i=>(i[i.MINUTE=6e4]="MINUTE",i[i.HOUR=36e5]="HOUR",i[i.DAY=864e5]="DAY",i[i.WEEK=6048e5]="WEEK",i[i.MONTH=2592e6]="MONTH",i[i.YEAR=31104e6]="YEAR",i))(r||{});function a(i){return null!=i}function d(i){if(!i?.filter)return!0;const t=i.filter;return!(t.geometry||t.objectIds||t.timeExtent||t.where)}function l(i){const{layer:t,mapImageSublayer:e,mode:s}=i,o="url"in t?t.url:void 0;if(i.supportsStandardizedQuery="version"in t&&null!=t.version&&t.version>=10.2&&!!t.capabilities?.query?.supportsStandardizedQueriesOnly,i.supportedSqlParserVersion="feature"===t.type&&i.supportsStandardizedQuery&&t.sourceJSON.sqlParserVersion&&"ES_10.6.1"!==t.sourceJSON.sqlParserVersion,"layer-view"===s&&"capabilities"in t&&null!=t.capabilities&&"query"in t.capabilities&&(i.supportsCurrentUser=t.capabilities?.query?.supportsCurrentUser),!o||e)return void(i.isHosted=!1);const n=o.includes(".arcgis.com/"),c=o.includes("//services")||o.includes("//tiles")||o.includes("//features")||o.includes("//locationservices")||o.includes("//us-iot")||o.includes("//eu-iot");i.isHosted=n&&c||!n&&!1}function h(i){return i?.length?i.map(((i,t)=>i.uid===`expression-${t}`?{...i,conditions:i.conditions.map(((i,e)=>{const s=`condition-${t}-${e}`;return i.uid===s?i:{...i,uid:s}}))}:{...i,uid:`expression-${t}`,expressionIndex:t,conditions:i.conditions.map(((i,e)=>{const s=`condition-${t}-${e}`;return i.uid===s?i:{...i,uid:s}}))})):i}}}]);