/*! For license information please see arcgis_analysis_node_modules_arcgis_common-components_dist_compone-8a5be0.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_common-components_dist_compone-8a5be0"],{23037:(e,t,s)=>{s.r(t),s.d(t,{ArcgisCommonSqlExpressionConfigUniqueList:()=>_});var i=s(6364),o=s(85282),n=s(59836),r=s(61833),a=s(47640),l=s(70757),c=s(52797),u=s(91021),h=s(80666),d=s(53550),p=(s(5294),s(28927),s(588),s(44345),s(34031),s(43284),s(45138)),g=s(55088);const m="container",v="popover-unique-list",y="unique-values-content-list-msg",f="count",$="unique-values-done",b=g.AH`:host{width:100%}.container{min-height:30px}.popover-unique-list{width:100%;overflow-y:auto}.unique-values-content-list-msg{font-size:75%;margin:5px}.count{padding:0 6px;font-size:smaller;white-space:nowrap}.unique-values-done{padding:.5rem}`;class _ extends r.WF{constructor(){super(...arguments),this.dropdownNode=(0,l._)(),this._messages=(0,p.u)({blocking:!0,name:"common-sql-expression-config"}),this._propWatcherTask=new a.YZ(this,{task:async([e])=>{if(!(0,h.i)(e?.layer)||!(0,h.i)(e?.fields))throw console.error("Required properties are missing."),new Error;await this.processProps()},args:()=>[this.props]}),this.initialRender=!0,this.uid=(0,u.DA)(),this.uniqueValues=[],this.multiple=!1,this.partialUniqueValues=!1,this.arcgisChanged=(0,r.lh)(),this.arcgisDone=(0,r.lh)(),this.arcgisSortByChanged=(0,r.lh)()}static{this.properties={initialRender:16,uid:1,props:0,uniqueValues:0,selectedValues:0,fieldDomains:0,layerFieldType:1,sortBy:1,multiple:5,partialUniqueValues:5,maxHeight:9}}static{this.styles=b}async setFocus(){this.listNode?.setFocus()}loaded(){this.props?.layer&&this.props?.fields&&(setTimeout((()=>this.initialRender=!1),800),this.listNode?.setFocus())}async processProps(){const{props:e}=this;e._messages||(e._messages=this._messages),setTimeout((()=>{this.initialRender=!1,this.listNode?.setFocus()}),800)}_setListRef(e){const{maxHeight:t}=this;this.listNode=e,t&&e?.setAttribute("style",`max-height: ${t||400}px`)}getDecodedValue(e){const{fieldDomains:t}=this,s=t;if(s){let t="";for(let i=0;i<s.length;i++){const o=s[i];o.code==e&&(t+=(t.length?" | ":"")+o.name)}return t.length||(t=`${e}`),t}return e}onSortMenuSelect(e){const t=e.currentTarget.selectedItems?.[0].getAttribute("data-value");this.sortBy=t||void 0,this.arcgisSortByChanged.emit({uid:this.uid,sortBy:t||void 0})}done(){this.arcgisDone.emit(this.uid)}isSameLists(e,t){if(!e&&!t)return!0;if(!e||!t||e?.length!==t?.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}render(){const{uid:e,uniqueValues:t,selectedValues:s,layerFieldType:i,fieldDomains:n,sortBy:a,multiple:c,partialUniqueValues:u,props:h,initialRender:p}=this;return this._propWatcherTask.render({complete:()=>{const{_messages:g}=h,f=["small-integer","big-integer","integer","single","double","long"].includes(i),$=["date","date-only","time-only"].includes(i);(e=>{const t=n?.length;e.sort(((e,s)=>{if(!t&&f)return("string"==typeof e.value?Number.parseFloat(e.value):e.value)-("string"==typeof s.value?Number.parseFloat(s.value):s.value);{const i=t?this.getDecodedValue(e.value):e.value,o=t?this.getDecodedValue(s.value):s.value;return`${i}`.startsWith("_")?1:`${o}`.startsWith("_")?-1:`${i}`.localeCompare(`${o}`)}}))})(t),a&&"count"!==a?"selected"===a&&((e,t)=>{e.sort(((e,s)=>{const i=t?.indexOf(e.value)??-1,o=t?.indexOf(s.value)??-1;return i===o||i>-1&&o>-1?0:i>o?-1:1}))})(t,s):t.sort(((e,t)=>e.count<=t.count?1:-1));const b=t.map((e=>this.renderUniqueValue(e)));let _;return u&&!p&&(_=o.qy`<div class=${(0,r.CP)(y)}>${g.errors.tooManyUniqueValues}</div>`),o.qy`<div class=${(0,r.CP)(m)}><calcite-list .label=${g.values} class=${(0,r.CP)(v)} .filterEnabled=${t.length>10} .selectionMode=${c?"multiple":"single"} .filterPlaceholder=${g.searchValues} @calciteListChange=${t=>{let s=t.target.selectedItems.map((e=>e.value));n||"date-only"!==i?n||"time-only"!==i?["date","oid","guid","small-integer","big-integer","integer","long"].includes(i)?s=s?.map((e=>Number.parseInt(e))):["single","double"].includes(i)&&(s=s?.map((e=>Number.parseFloat(e)))):s=s?.map((e=>(0,d.t)(e))):s=s?.map((e=>(0,d.d)(e))),!this.isSameLists(s,this.selectedValues)&&(this.selectedValues=s,this.arcgisChanged.emit({uid:e,multiple:c,selectedValues:s,sortBy:a}))}} @calciteListFilter=${()=>{this.dropdownNode.value&&(this.dropdownNode.value.disabled=this.listNode.filteredItems.length<4)}} ${(0,l.K)(this._setListRef)}>${t.length>10&&!p?this.renderSort(f,$):null}${b}</calcite-list>${_}${this.renderDone()}</div>`}})}renderSort(e,t){const{sortBy:s,props:i}=this,{_messages:n}=i;return o.qy`<calcite-dropdown slot=filter-actions-end placement=bottom-end overlay-positioning=fixed @calciteDropdownSelect=${this.onSortMenuSelect} ${(0,l.K)(this.dropdownNode)}><calcite-action slot=trigger .label=${n.sortValues} text><calcite-icon scale=s icon=sortDescending flip-rtl></calcite-icon></calcite-action><calcite-dropdown-group><calcite-dropdown-item .selected=${"count"===s||!(0,h.i)(s)} data-value=count>${n.sortByCount}</calcite-dropdown-item><calcite-dropdown-item .selected=${"name"===s} data-value=name>${e||t?n.sortAscending:n.sortAlphabetical}</calcite-dropdown-item><calcite-dropdown-item .selected=${"selected"===s} data-value=selected>${n.sortSelected}</calcite-dropdown-item></calcite-dropdown-group></calcite-dropdown>`}renderUniqueValue(e){const{selectedValues:t,fieldDomains:s,layerFieldType:i,uniqueValues:a,initialRender:l,props:u}=this,{view:p}=u,g=p?.timeZone||"system",m=s?.length?this.getDecodedValue(e.value):i===h.s.DATE?(0,d.g)(e.value,g):i===h.s.DATE_ONLY?(0,d.b)(e.value):i===h.s.TIME_ONLY?(0,d.c)(e.value):"number"==typeof e.value?(0,c.formatNumber)(e.value):e.value,v=!!t&&(i===h.s.DATE_ONLY?t.includes((0,d.d)(e.value)):i===h.s.TIME_ONLY?t.includes((0,d.t)(e.value)):t.includes(e.value));return(0,n.D)(`list-item_${e.value}`,o.qy`<calcite-list-item .label=${`${m}`} .value=${`${e.value}`} .selected=${v}>${(0,h.i)(e.count)&&(a.length>200&&!l||a.length<=200)?o.qy`<div class=${(0,r.CP)(f)} slot=actions-end>${`${e.count}`}</div>`:null}</calcite-list-item>`)}renderDone(){const{multiple:e,props:t}=this,{_messages:s}=t;return e?o.qy`<div class=${(0,r.CP)($)}><calcite-button appearance=outline-fill width=full @click=${this.done} .label=${s.done}>${s.done}</calcite-button></div>`:null}}(0,i.c)("arcgis-common-sql-expression-config-unique-list",_)},45138:(e,t,s)=>{s.d(t,{u:()=>d});var i=s(50217);const o=(e,{host:t,key:s,isReactive:o},n)=>{const r=t,a=r[s]!==e.exports,l=r[s]!==n,c=n!==e.exports;a&&!l&&c&&(r[s]=e.exports);if(t===e.component){if(o){const t=e.component.manager;l&&t.W(e,r[s]),e.onUpdate((i=>{if(i.has(s)){const i=r[s];i!==e.exports&&t.W(e,i)}}))}e.O=o?void 0:s}const u=e.component.constructor.elementProperties.get(s)?.readOnly;e.watchExports((()=>{r[s]!==e.exports&&(u?(0,i.h)((()=>{r[s]=e.exports})):r[s]=e.exports)}))};s(4395);var n=s(91021);const r=e=>l(void 0,e);class a extends i.C{constructor(e,t){super(e);const s=this.exports;try{(0,i.s)(this.component);const e=t(this.component,this),o=this.exports!==s;if((0,i.i)(e)){o||this.setProvisionalExports(e);const t=e.then((e=>{this.exports=e,super.catchUpLifecycle()})).catch((e=>{this.P.reject(e),console.error(e)}));this.onLoad((async()=>await t))}else o&&void 0===e||(this.exports=e),queueMicrotask((()=>super.catchUpLifecycle()))}catch(e){this.P.reject(e),console.error(e)}}catchUpLifecycle(){}}const l=(c=a,(...e)=>{const t=(0,i.e)(),s=new c(...e),n=s.exports;(0,i.d)(t.at(-1));const r=s.component.manager;r.W(s,n),s.watchExports(r.W.bind(r,s)),(0,i.o)(s);const a=[s.component,...t].reverse();return(0,i.t)(a,(e=>void 0===e?void 0:o(s,e,n)),n)});var c;i.C;const u=(e,t)=>{if(!t)return e;const s={...e};return Object.entries(t).forEach((([t,i])=>{s[t]="object"==typeof i?u(e[t],i):i??e[t]})),s};var h=s(6364);const d=(p=h.g,(e={})=>r(((t,s)=>{const i=(0,n.kn)(t.el),o={_lang:i.lang,_t9nLocale:i.t9nLocale,_loading:!0},r=t;s.onLifecycle((()=>(0,n.hd)(t.el,(()=>p("./assets")),(({t9nLocale:e,t9nStrings:i,lang:o})=>{const n={...i,_lang:o,_t9nLocale:e,_loading:!1};s.exports=n;const l=i.componentLabel;"string"==typeof l&&"label"in t&&null==t.label&&(t.label??=l),a(r.messageOverrides)}),e.name)));const a=e=>{const t=s.exports,i=t._original??t,o=u(i,e);e&&(o._original=i),s.exports=o};return"messageOverrides"in r&&s.onUpdate((e=>{e.has("messageOverrides")&&a(r.messageOverrides)})),e.blocking?(s.setProvisionalExports(o,!1),s.ready):o})));var p},47640:(e,t,s)=>{s.d(t,{YZ:()=>n});var i=s(50738);const o=Symbol();class n{get taskComplete(){return this.t||(1===this.i?this.t=new Promise(((e,t)=>{this.o=e,this.h=t})):3===this.i?this.t=Promise.reject(this.l):this.t=Promise.resolve(this.u)),this.t}constructor(e,t,s){this.p=0,this.i=0,(this._=e).addController(this);const i="object"==typeof t?t:{task:t,args:s};this.v=i.task,this.j=i.args,this.m=i.argsEqual??r,this.k=i.onComplete,this.A=i.onError,this.autoRun=i.autoRun??!0,"initialValue"in i&&(this.u=i.initialValue,this.i=2,this.O=this.T?.())}hostUpdate(){!0===this.autoRun&&this.S()}hostUpdated(){"afterUpdate"===this.autoRun&&this.S()}T(){if(void 0===this.j)return;const e=this.j();if(!Array.isArray(e))throw Error("The args function must return an array");return e}async S(){const e=this.T(),t=this.O;this.O=e,e===t||void 0===e||void 0!==t&&this.m(t,e)||await this.run(e)}async run(e){let t,s;e??=this.T(),this.O=e,1===this.i?this.q?.abort():(this.t=void 0,this.o=void 0,this.h=void 0),this.i=1,"afterUpdate"===this.autoRun?queueMicrotask((()=>this._.requestUpdate())):this._.requestUpdate();const i=++this.p;this.q=new AbortController;let n=!1;try{t=await this.v(e,{signal:this.q.signal})}catch(e){n=!0,s=e}if(this.p===i){if(t===o)this.i=0;else{if(!1===n){try{this.k?.(t)}catch{}this.i=2,this.o?.(t)}else{try{this.A?.(s)}catch{}this.i=3,this.h?.(s)}this.u=t,this.l=s}this._.requestUpdate()}}abort(e){1===this.i&&this.q?.abort(e)}get value(){return this.u}get error(){return this.l}get status(){return this.i}render(e){switch(this.i){case 0:return e.initial?.();case 1:return e.pending?.();case 2:return e.complete?.(this.value);case 3:return e.error?.(this.error);default:throw Error("Unexpected status: "+this.i)}}}const r=(e,t)=>e===t||e.length===t.length&&e.every(((e,s)=>!(0,i.Ec)(e,t[s])))},59836:(e,t,s)=>{s.d(t,{D:()=>r});var i=s(85282),o=s(34670),n=s(42466);const r=(0,o.u$)(class extends o.WL{constructor(){super(...arguments),this.key=i.s6}render(e,t){return this.key=e,t}update(e,[t,s]){return t!==this.key&&((0,n.mY)(e),this.key=t),s}})}}]);