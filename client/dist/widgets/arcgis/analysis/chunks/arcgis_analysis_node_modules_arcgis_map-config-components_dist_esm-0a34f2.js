/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-0a34f2.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-0a34f2"],{19398:(e,t,o)=>{function i(e,t){const o="CALCITE-INPUT"===e.tagName,i=o?e.shadowRoot.querySelector("input"):e.shadowRoot.querySelector("textarea"),s=i.selectionStart,r=[e.value.slice(0,s),`{${t}}`,e.value.slice(s)].join("");e.value=r;const n=s+2+t.length;setTimeout((()=>{o?e.setFocus():(i?.setSelectionRange(n,n),i?.focus()),i?.setSelectionRange(n,n)}),1)}function s(e){const{mapView:t,layer:o,portal:i}=e,{map:s}=t,{portalHostname:n}=i;if(!s)return!1;const{utilityNetworks:a}=s;if(!a)return!1;const l=i.isPortal,c="1"===window.localStorage.getItem("utility-networks-agol")&&("devext.arcgis.com"===n||"qaext.arcgis.com"===n);if(!l&&!c)return!1;const h=r(o),d=a.find((e=>e.sourceJSON?.serviceItemId===h));if(!d)return!1;return d.isUtilityLayer(o)}function r(e){return"subtype-sublayer"===e.type?e.parent.serviceItemId:e.serviceItemId}o.d(t,{a:()=>n,b:()=>a,c:()=>i,g:()=>r,i:()=>s});const n=["attachment","connectivity","container","content","structure"];var a;!function(e){e.title="title",e.description="description",e.displayCount="displayCount"}(a||(a={}))},28903:(e,t,o)=>{o.d(t,{a:()=>r,d:()=>i,t:()=>s});const i=["short-date","long-month-day-year","day-short-month-year","long-date","long-month-year","short-month-year","year"],s=["short-time","long-time","short-time-24","long-time-24"],r=new Map;r.set("short-date",{dateFormat:i[0],timeFormat:""}),r.set("short-date-short-time",{dateFormat:i[0],timeFormat:s[0]}),r.set("short-date-long-time",{dateFormat:i[0],timeFormat:s[1]}),r.set("short-date-short-time-24",{dateFormat:i[0],timeFormat:s[2]}),r.set("short-date-long-time-24",{dateFormat:i[0],timeFormat:s[3]}),r.set("long-month-day-year",{dateFormat:i[1],timeFormat:""}),r.set("long-month-day-year-short-time",{dateFormat:i[1],timeFormat:s[0]}),r.set("long-month-day-year-long-time",{dateFormat:i[1],timeFormat:s[1]}),r.set("long-month-day-year-short-time-24",{dateFormat:i[1],timeFormat:s[2]}),r.set("long-month-day-year-long-time-24",{dateFormat:i[1],timeFormat:s[3]}),r.set("day-short-month-year",{dateFormat:i[2],timeFormat:""}),r.set("day-short-month-year-short-time",{dateFormat:i[2],timeFormat:s[0]}),r.set("day-short-month-year-long-time",{dateFormat:i[2],timeFormat:s[1]}),r.set("day-short-month-year-short-time-24",{dateFormat:i[2],timeFormat:s[2]}),r.set("day-short-month-year-long-time-24",{dateFormat:i[2],timeFormat:s[3]}),r.set("long-date",{dateFormat:i[3],timeFormat:""}),r.set("long-date-short-time",{dateFormat:i[3],timeFormat:s[0]}),r.set("long-date-long-time",{dateFormat:i[3],timeFormat:s[1]}),r.set("long-date-short-time-24",{dateFormat:i[3],timeFormat:s[2]}),r.set("long-date-long-time-24",{dateFormat:i[3],timeFormat:s[3]}),r.set("long-month-year",{dateFormat:i[4],timeFormat:null}),r.set("short-month-year",{dateFormat:i[5],timeFormat:null}),r.set("year",{dateFormat:i[6],timeFormat:null}),r.set("default",{dateFormat:i[0],timeFormat:s[2]})},53960:(e,t,o)=>{var i,s,r,n;o.d(t,{A:()=>s,C:()=>i,I:()=>n,P:()=>r}),function(e){e.ATTRIBUTES="attributes",e.ATTACHMENTS="attachments",e.CHARTS="charts",e.IMAGES="images",e.RICH_TEXT="richText",e.ARCADE="arcade",e.RELATIONSHIP="relationship",e.ASSOCIATIONS="associations",e.EDIT_INFO_SUMMARY="editInfoSummary"}(i||(i={})),function(e){e.PREVIEW="preview",e.LIST="list",e.AUTO="auto"}(s||(s={})),function(e){e.IMAGE="image",e.BAR_CHART="bar-chart",e.COLUMN_CHART="column-chart",e.LINE_CHART="line-chart",e.PIE_CHART="pie-chart"}(r||(r={})),function(e){e.SOURCE_URL="sourceUrl",e.TITLE="title",e.CAPTION="caption",e.LINK_URL="linkUrl",e.ALT_TEXT="altText"}(n||(n={}))},81529:(e,t,o)=>{o.r(t),o.d(t,{arcgis_map_config_block_options:()=>C,arcgis_map_config_fields_formatting:()=>v,arcgis_map_config_popup_add_content_popover:()=>k,arcgis_map_config_popup_association_config_popover:()=>I,arcgis_map_config_popup_chart:()=>w,arcgis_map_config_popup_color_button:()=>x,arcgis_map_config_popup_color_popover:()=>M,arcgis_map_config_popup_image:()=>F,arcgis_map_config_popup_styler_popover:()=>L,arcgis_map_config_symbol_styler:()=>ee});var i=o(11254),s=o(14528),r=o(84260),n=o(69811),a=o(56612),l=o(17840),c=o(28903),h=o(84947),d=o(53960),p=o(53127),m=o(19398),u=o(10465),g=o(39020),y=o(57464),b=o(10588),f=o(89731);o(84661);const C=class{constructor(e){(0,i.r)(this,e),this.arcgisDelete=(0,i.c)(this,"arcgisDelete",7),this.arcgisDuplicate=(0,i.c)(this,"arcgisDuplicate",7),this.arcgisRename=(0,i.c)(this,"arcgisRename",7),this.manager=(0,s.u)(this),this.strings=(0,r.u)({blocking:!0}),this.options={disableDuplicate:!1,hasDelete:!0,hasDuplicate:!0,hasRename:!0}}async setFocus(){this.dropdownActionNode?.setFocus()}async closeDropdown(){this.dropdownNode?.open&&(this.dropdownNode.open=!1)}render(){const{options:e,strings:t}=this,{hasDelete:o,hasDuplicate:s,hasRename:r}=e;return(0,i.h)(i.H,{key:"754aa4ca04940f8d944480870041d953bbeb2bbf",title:t.options},(0,i.h)("calcite-dropdown",{key:"33e1056ee354adccca781ce4aaecf80cbda1864e",scale:"s",overlayPositioning:"fixed",placement:"bottom-end",ref:e=>this.dropdownNode=e},(0,i.h)("calcite-action",{key:"1caa539dd84a7a425e73d7d0b8f8d53104e6a6f7",ref:e=>this.dropdownActionNode=e,slot:"trigger",text:t.options},(0,i.h)("calcite-icon",{key:"960d8ed87dd93fc12d948452032d72821900ccdb",scale:"s",icon:"ellipsis"})),(0,i.h)("calcite-dropdown-group",{key:"eedf54c751a5eac6e1b4a4f9ac775c3f3ddee9da"},o?this.renderDelete():(0,i.h)(i.F,null),s?this.renderDuplicate():(0,i.h)(i.F,null),r?this.renderRename():(0,i.h)(i.F,null))))}renderDelete(){const{strings:e}=this;return(0,i.h)("calcite-dropdown-item",{onClick:e=>{e.stopPropagation(),this.arcgisDelete.emit()},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||this.arcgisDelete.emit()}},e.delete)}renderDuplicate(){const{strings:e}=this;return(0,i.h)("calcite-dropdown-item",{disabled:this.options.disableDuplicate,onClick:e=>{e.stopPropagation(),this.arcgisDuplicate.emit()},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||this.arcgisDuplicate.emit()}},e.duplicate)}renderRename(){const{strings:e}=this;return(0,i.h)("calcite-dropdown-item",{onClick:e=>{e.stopPropagation(),this.arcgisRename.emit()},onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||this.arcgisRename.emit()}},e.rename)}static get assetsDirs(){return["assets"]}get el(){return(0,i.a)(this)}};C.style=":host{display:flex;height:100%;justify-content:stretch}calcite-action{height:100%}";const S=new Date("December 31, 1969 18:00:00"),v=class{constructor(e){(0,i.r)(this,e),this.arcgisChange=(0,i.c)(this,"arcgisChange",7),this.arcgisClose=(0,i.c)(this,"arcgisClose",7),this.arcgisFieldsDeleted=(0,i.c)(this,"arcgisFieldsDeleted",7),this.manager=(0,s.u)(this),this.layerFieldsMap=new Map,this.arcadeExpMap=new Map,this.selectedFieldInfosMap=new Map,this.hasCommonDataTypes=!0,this.fieldsAreDeletable=!1,this.mapView=void 0,this.layer=void 0,this.config=void 0,this.strings=void 0,this.popupTemplate=void 0,this.popoverProps=void 0,this.selectedFields=void 0,this.deleteFieldEnabled=!1}async reposition(){this.popoverNode?.reposition()}async setFocus(){this.panelNode?.setFocus()}async componentWillLoad(){const{layer:e,mapView:t,popupTemplate:o,selectedFields:i,deleteFieldEnabled:s}=this;if(this.intl=await(0,n.z)(),this.layerFieldsMap=await(0,l.f)(e),this.arcadeExpMap=(0,l.m)(o),i.forEach((e=>{const t=o.fieldInfos.find((t=>t.fieldName===e));t&&this.selectedFieldInfosMap.set(e,{index:o.fieldInfos.indexOf(t),fieldType:(0,l.n)(e,this.layerFieldsMap,this.arcadeExpMap),fieldInfo:t})})),this.firstSelectedFieldInfo=this.selectedFieldInfosMap.get(i[0]).fieldInfo,this.firstSelectedFieldType=this.selectedFieldInfosMap.get(i[0]).fieldType,this.hasCommonDataTypes=this.checkCommonDataTypes(this.firstSelectedFieldType),!this.firstSelectedFieldInfo.format&&this.hasCommonDataTypes&&await this.setUpDefaultFormat(this.firstSelectedFieldInfo,this.firstSelectedFieldType),s&&("feature"===e.type||"oriented-imagery"===e.type)&&e.portalItem&&(1===i?.length||i?.length>1&&this.enableMultipleDeletion(e.portalItem))){const o=e.fields.filter((e=>i.includes(e.name)));if(i.some((t=>!e.fields.find((e=>e.name===t)))))this.fieldsAreDeletable=!1;else{const i=await Promise.all(o.map((async o=>await(0,h.a)(t,e,o))));this.fieldsAreDeletable=!i.some((e=>!e))}}}componentDidLoad(){this.panelNode?.setFocus()}render(){const{strings:e,popoverProps:t,hasCommonDataTypes:o,selectedFields:s}=this;return(0,i.h)(i.H,{key:"fbdc0dc4245b51f0bac385c763d8c98001e953ef",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"55882e02fcc134f3dc60396e35b0fde5a24676f6",class:"popover",placement:"leading-start",open:!0,pointerDisabled:!0,referenceElement:t.refElement,offsetDistance:0,offsetSkidding:45,label:e.attributesFormatting.formattingOptions,ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"8b98e31fb395ec4a01ab553ffb2a6f5da2afa571",closable:!0,style:{width:`${t.refElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>this.arcgisClose.emit(),ref:e=>this.panelNode=e},(0,i.h)("div",{key:"057df74bc5796cd2a9911daa7eb8356e04f17b6f",slot:"header-content"},e.attributesFormatting.manageField),(0,i.h)("div",{key:"a7d02de6559c6b9158fc6a6973d5b34dcc009eba",class:"formatting-div"},1===s.length?this.renderDisplayName():(0,i.h)("h3",null,e.attributesFormatting.multipleSelection.replace("${number}",`${s.length}`)),o?this.renderFormattingOptions():(0,i.h)("h3",null,e.attributesFormatting.selectCommon)),this.renderDeleteButton(),this.renderDoneButton())))}renderDisplayName(){const{strings:e,arcadeExpMap:t,firstSelectedFieldInfo:o}=this;return(0,i.h)("calcite-label",null,e.attributesFormatting.displayName,(0,i.h)("calcite-input",{type:"text",ref:e=>this.displayNameNode=e,value:(t.has(o.fieldName)?t.get(o.fieldName).title:o.label)??void 0,onCalciteInputInput:()=>this.handleDisplayNameChange()}))}renderFormattingOptions(){const{firstSelectedFieldInfo:e,firstSelectedFieldType:t}=this;if(e.format){if(t===a.a.integer||t===a.a.smallInteger||t===a.a.bigInteger)return this.renderThousandSeparator();if(t===a.a.single||t===a.a.double||t===a.a.long||t===a.a.number)return(0,i.h)("div",null,this.renderSignificantDigits(),this.renderThousandSeparator());if(t!==a.a.date&&t!==a.a.dateOnly&&t!==a.a.timeOnly&&t!==a.a.timestampOffset||!this.dateFormattingAvailable())return(0,i.h)(i.F,null);{const o=c.a.has(e.format.dateFormat)?c.a.get(e.format.dateFormat):t===a.a.dateOnly?c.a.get("short-date"):c.a.get("short-date-short-time");return(0,i.h)("div",null,t!==a.a.timeOnly&&this.renderDateFormat(o.dateFormat),t!==a.a.timeOnly&&t!==a.a.dateOnly&&this.renderShowTime(o.timeFormat),t!==a.a.dateOnly&&this.renderTimeFormat(o.timeFormat))}}return(0,i.h)(i.F,null)}renderThousandSeparator(){const{strings:e,firstSelectedFieldInfo:t}=this;return(0,i.h)("section",{class:"single-line-label-switch-section"},(0,i.h)("calcite-label",{class:"single-line-label-switch-label"},e.attributesFormatting.showThousandsSeparator),(0,i.h)("calcite-switch",{scale:"s",class:"single-line-label-switch-switch",checked:!!t.format.digitSeparator,onCalciteSwitchChange:e=>{e.stopPropagation(),this.handleCalciteSwitchChange()},ref:e=>this.thousandSeparatorSwitchNode=e}))}renderSignificantDigits(){const{strings:e,firstSelectedFieldInfo:t}=this;return(0,i.h)("section",null,(0,i.h)("calcite-label",null,e.attributesFormatting.significantDigits,(0,i.h)("calcite-select",{label:e.attributesFormatting.significantDigits,onCalciteSelectChange:e=>{const o=e.target;t.format.places=Number(o.selectedOption.value)||0,this.saveFieldInfo()}},[0,1,2,3,4,5,6,7,8].map((o=>(0,i.h)("calcite-option",{value:o.toString(),selected:t.format.places===o},`${o} ${e.attributesFormatting.decimalPlaces}`))))))}renderDateFormat(e){const{strings:t,intl:o}=this;return(0,i.h)("section",null,(0,i.h)("calcite-label",null,t.attributesFormatting.dateFormat,(0,i.h)("calcite-select",{label:t.attributesFormatting.dateFormat,onCalciteSelectChange:()=>this.changeDateTimeFormat(),ref:e=>this.dateFormatSelectNode=e},c.d.map((t=>(0,i.h)("calcite-option",{value:t,selected:e===t},o.formatDate(S,o.convertDateFormatToIntlOptions(t))))))))}renderShowTime(e){const{strings:t}=this;return(0,i.h)("section",{class:"single-line-label-switch-section",ref:e=>this.showTimeSectionNode=e},(0,i.h)("calcite-label",{class:"single-line-label-switch-label"},t.attributesFormatting.showTime),(0,i.h)("calcite-switch",{scale:"s",class:"single-line-label-switch-switch",checked:!!e,onCalciteSwitchChange:e=>{e.stopPropagation(),this.handleCalciteSwitchChange()},ref:e=>this.showTimeSwitchNode=e}))}renderTimeFormat(e){const{strings:t}=this;return(0,i.h)("section",{ref:e=>this.timeFormatSectionNode=e},(0,i.h)("calcite-label",null,t.attributesFormatting.timeFormat,(0,i.h)("calcite-select",{label:t.attributesFormatting.timeFormat,onCalciteSelectChange:()=>this.changeDateTimeFormat(),ref:e=>this.timeFormatSelectNode=e},c.t.map((t=>(0,i.h)("calcite-option",{value:t,selected:e===t},this.getTimeFormatString(t)))))))}renderDeleteButton(){const{layer:e,mapView:t,config:o,selectedFields:s,strings:r,fieldsAreDeletable:n}=this;return n?(0,i.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:"half",kind:"danger",onClick:i=>{const r=i.target;r.disabled=!0;const n=document.createElement("arcgis-portal-field-delete");n.layer=e,n.mapView=t,n.config=o,n.fieldNames=s,n.addEventListener("arcgisFieldsDeleted",(()=>{n.parentElement?.removeChild(n),this.arcgisFieldsDeleted.emit(s)})),n.addEventListener("arcgisClose",(e=>{n.parentElement?.removeChild(n),e.stopPropagation(),r.disabled=!1})),document.body.append(n)}},1===s.length?r.attributesFormatting.deleteField:r.attributesFormatting.deleteFields):(0,i.h)(i.F,null)}renderDoneButton(){const{strings:e,fieldsAreDeletable:t}=this;return(0,i.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:t?"half":"full",onClick:()=>this.arcgisClose.emit()},e.attributesFormatting.done)}enableMultipleDeletion(e){return"devext.arcgis.com"===e.portal?.portalHostname&&"1"===window.localStorage.getItem("allow-bulk-field-deletion-agol-mv")}checkCommonDataTypes(e){const{selectedFields:t,selectedFieldInfosMap:o}=this;for(let i=1;i<t.length;i++){const s=o.get(t[i]).fieldType;if(e===a.a.integer||e===a.a.smallInteger||e===a.a.bigInteger){if(![a.a.integer,a.a.smallInteger,a.a.bigInteger].includes(s))return!1}else if(e===a.a.single||e===a.a.double||e===a.a.long||e===a.a.number){if(![a.a.single,a.a.double,a.a.long,a.a.number].includes(s))return!1}else if(e===a.a.date||e===a.a.timestampOffset){if(![a.a.date,a.a.timestampOffset].includes(s))return!1}else if(e===a.a.dateOnly){if(![a.a.dateOnly].includes(s))return!1}else if(e===a.a.timeOnly&&![a.a.timeOnly].includes(s))return!1}return!0}async setUpDefaultFormat(e,t){const o=await(0,n.at)();t===a.a.integer||t===a.a.smallInteger||t===a.a.bigInteger?(e.format=new o({digitSeparator:!1}),this.saveFieldInfo()):t===a.a.single||t===a.a.double||t===a.a.long||t===a.a.number?(e.format=new o({digitSeparator:!1,places:2}),this.saveFieldInfo()):t!==a.a.date&&t!==a.a.dateOnly&&t!==a.a.timeOnly&&t!==a.a.timestampOffset||!this.dateFormattingAvailable()||(t===a.a.dateOnly?e.format=new o({dateFormat:"short-date"}):e.format=new o({dateFormat:"short-date-short-time"}),this.saveFieldInfo())}setUpDateTimeDisplay(){const{firstSelectedFieldInfo:e,firstSelectedFieldType:t,hasCommonDataTypes:o}=this;if((t===a.a.date||t===a.a.timeOnly||t===a.a.timestampOffset)&&e.format?.dateFormat&&o){const o=c.a.get(e.format.dateFormat);t===a.a.date||t===a.a.timestampOffset?""===o.timeFormat?(this.showTimeSwitchNode.checked=!1,this.showTimeSectionNode.style.display="flex",this.timeFormatSectionNode.style.display="none"):null===o.timeFormat?(this.showTimeSwitchNode.checked=!1,this.showTimeSectionNode.style.display="none",this.timeFormatSectionNode.style.display="none"):(this.showTimeSwitchNode.checked=!0,this.showTimeSectionNode.style.display="flex",this.timeFormatSectionNode.style.display="block"):t===a.a.timeOnly&&(this.timeFormatSectionNode.style.display="block")}}dateFormattingAvailable(){const{layer:e}=this;return(0,l.a)(e)!==a.s.scene||null!==e.associatedLayer}handleDisplayNameChange(){const{firstSelectedFieldInfo:e}=this;(0,l.i)(this.displayNameNode.value)||(this.displayNameNode.value=e.fieldName),this.arcadeExpMap.has(e.fieldName)?this.arcadeExpMap.get(e.fieldName).title=this.displayNameNode.value:e.label=this.displayNameNode.value,this.saveFieldInfo()}handleCalciteSwitchChange(){const{firstSelectedFieldInfo:e,firstSelectedFieldType:t}=this;e.format&&(t===a.a.date||t===a.a.timestampOffset?this.changeDateTimeFormat():(e.format.digitSeparator=!!this.thousandSeparatorSwitchNode?.checked,this.saveFieldInfo()))}changeDateTimeFormat(){const{firstSelectedFieldInfo:e,firstSelectedFieldType:t}=this,o=this.dateFormatSelectNode?.selectedOption?.value,i=this.timeFormatSelectNode?.selectedOption?.value;if(t===a.a.date||t===a.a.timestampOffset){const t=c.a.get(o);""===t.timeFormat?e.format.dateFormat=this.showTimeSwitchNode.checked?`${o}-${i}`:`${o}`:null===t.timeFormat&&(e.format.dateFormat=`${o}`)}else t===a.a.dateOnly?e.format.dateFormat=`${o}`:t===a.a.timeOnly&&(e.format.dateFormat=`short-date-${i}`);this.saveFieldInfo(),this.setUpDateTimeDisplay(),this.popoverNode?.reposition()}getTimeFormatString(e){const{strings:t}=this;return e===c.t[0]?t.attributesFormatting.shortTime:e===c.t[1]?t.attributesFormatting.longTime:e===c.t[2]?t.attributesFormatting.shortTime24:e===c.t[3]?t.attributesFormatting.longTime24:t.attributesFormatting.shortTime24}saveFieldInfo(){const{arcadeExpMap:e,selectedFieldInfosMap:t,selectedFields:o,firstSelectedFieldInfo:i,hasCommonDataTypes:s}=this;s&&(t.forEach((e=>{e.fieldInfo.fieldName===i.fieldName?e.fieldInfo=i.clone():e.fieldInfo.format=i.format.clone()})),1===o.length&&e.has(i.fieldName)&&this.popupTemplate.expressionInfos?.forEach(((t,o)=>{`${a.f.expression}${t.name}`!==i.fieldName||(this.popupTemplate.expressionInfos[o]=e.get(i.fieldName).clone())})),t.forEach((e=>{this.popupTemplate.fieldInfos[e.index]=e.fieldInfo.clone()})),Array.isArray(this.popupTemplate.content)&&this.popupTemplate.content.forEach((e=>{"fields"===e.type&&e.fieldInfos&&e.fieldInfos.forEach(((o,i)=>{if(t.has(o.fieldName)){const s=t.get(o.fieldName).fieldInfo.clone();s.visible=!0,e.fieldInfos[i]=s}}))})),this.arcgisChange.emit(this.popupTemplate.clone()))}get el(){return(0,i.a)(this)}};v.style=".popover {\n  --calcite-popover-z-index: 100;\n}\n\n.formatting-div {\n  padding: var(--calcite-spacing-md);\n  max-height: 60vh;\n}\n\n.single-line-label-switch-section {\n  display: flex;\n  margin: 0px;\n  padding: var(--calcite-spacing-sm) 0px;\n}\n\n.single-line-label-switch-label {\n  display: flex;\n  flex-flow: column nowrap;\n  flex: 1 0 0%;\n  overflow: hidden;\n}\n\n.single-line-label-switch-switch {\n  flex: 0 0 0%;\n  justify-self: flex-end;\n  margin: 0px;\n\n  input {\n    display: none;\n  }\n}\n";const k=class{constructor(e){(0,i.r)(this,e),this.arcgisAddPopoverContent=(0,i.c)(this,"arcgisAddPopoverContent",7),this.arcgisAddMultimediaContent=(0,i.c)(this,"arcgisAddMultimediaContent",7),this.closePopupPopovers=(0,i.c)(this,"closePopupPopovers",7),this.manager=(0,s.u)(this),this.referenceElement=void 0,this.popoverPanelWidth=void 0,this.popupHasAttachmentInfo=void 0,this.isMultimediaContent=!1,this.popupState=void 0}async reposition(){this.popoverNode?.reposition()}componentDidLoad(){this.panelNode?.setFocus()}render(){const{popupState:e,isMultimediaContent:t}=this,{strings:o}=e,s=(0,l.q)(this.referenceElement,"calcite-flow-item"),r=s?.getBoundingClientRect().top??56,n=s?.getBoundingClientRect().bottom??0,a=this.referenceElement.getBoundingClientRect().top,c=a-r<n-(a+25)?0:a-r-50-10,h={maxHeight:c>0?`${c}px`:"60vh"};return(0,i.h)(i.H,{key:"79cc43ba0c0811ef3f905c730bdb5e5cbe71f5d8",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"fa3783fc8dc09f699220e922f7715b9fc1b1fc5b",referenceElement:this.referenceElement,open:!0,placement:"bottom",class:"popover",label:t?o.addMedia:o.addContent,triggerDisabled:!0,ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"56c246165cefff40608d2f94424186ae19010730",closable:!0,style:{width:`${this.popoverPanelWidth}px`},onCalcitePanelClose:()=>this.closePopupPopovers.emit(),ref:e=>this.panelNode=e},(0,i.h)("div",{key:"8f37568a581c40ae9947e91e28d01213c4f07d6b",slot:"header-content"},t?o.addMedia:o.content),t?(0,i.h)("div",{style:h},this.renderCharts(),this.renderImages()):(0,i.h)("div",{style:h},this.renderAttributes(),this.renderAttachments(),this.renderCharts(),this.renderImages(),this.renderText(),this.renderArcade(),this.renderRelatedRecords(),this.renderAssociations(),this.renderLastEditedSummary()))))}renderAttributes(){const{popupState:e}=this,{strings:t,layerHasAttributes:o}=e;return o?(0,i.h)("calcite-action",{label:t.fieldsList,text:t.fieldsList,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.ATTRIBUTES)},(0,i.h)("calcite-icon",{scale:"s",icon:"feature-details"})):(0,i.h)(i.F,null)}renderAttachments(){const{popupState:e}=this,{strings:t,layerSupportsAttachments:o}=e;return o?(0,i.h)("calcite-action",{label:t.attachments,text:t.attachments,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.ATTACHMENTS),disabled:!!this.popupHasAttachmentInfo},(0,i.h)("calcite-icon",{scale:"s",icon:"attachment"})):(0,i.h)(i.F,null)}renderCharts(){const{popupState:e}=this,{strings:t,layerHasCharts:o}=e;return o?(0,i.h)("calcite-action",{label:t.chart,text:t.chart,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.CHARTS)},(0,i.h)("calcite-icon",{scale:"s",icon:"graph-bar"})):(0,i.h)(i.F,null)}renderImages(){const{popupState:e}=this,{strings:t,layerHasImages:o}=e;return o?(0,i.h)("calcite-action",{label:t.image,text:t.image,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.IMAGES)},(0,i.h)("calcite-icon",{scale:"s",icon:"image"})):(0,i.h)(i.F,null)}renderText(){const{popupState:e}=this,{strings:t,layerHasText:o}=e;return o?(0,i.h)("calcite-action",{label:t.text,text:t.text,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.RICH_TEXT)},(0,i.h)("calcite-icon",{scale:"s",icon:"text"})):(0,i.h)(i.F,null)}renderArcade(){const{popupState:e}=this,{strings:t,layerSupportsArcade:o}=e;return o?(0,i.h)("calcite-action",{disabled:e.blockFeatureReductionArcade,label:t.arcade,text:t.arcade,icon:"code",textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.ARCADE)}):(0,i.h)(i.F,null)}renderRelatedRecords(){const{popupState:e}=this,{strings:t,layerHasRelatedRecords:o}=e;return o?(0,i.h)("calcite-action",{label:t.relatedRecords,text:t.relatedRecords,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.RELATIONSHIP)},(0,i.h)("calcite-icon",{scale:"s",icon:"link"})):(0,i.h)(i.F,null)}renderAssociations(){const{popupState:e}=this,{strings:t,layerIsUNLayer:o}=e;return o?(0,i.h)("calcite-action",{label:t.associations.associationsList,text:t.associations.associationsList,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.ASSOCIATIONS)},(0,i.h)("calcite-icon",{scale:"s",icon:"view-associations"})):(0,i.h)(i.F,null)}renderLastEditedSummary(){const{popupState:e}=this,{strings:t,popupTemplate:o,layerHasEditInfo:s}=e;return s?(0,i.h)("calcite-action",{label:t.editInfoSummaryHeading,text:t.editInfoSummaryHeading,textEnabled:!0,onClick:()=>this.initiateAddContent(d.C.EDIT_INFO_SUMMARY),disabled:!!o.lastEditInfoEnabled},(0,i.h)("calcite-icon",{scale:"s",icon:"user"})):(0,i.h)(i.F,null)}initiateAddContent(e){const{isMultimediaContent:t}=this;t?this.arcgisAddMultimediaContent.emit(e):this.arcgisAddPopoverContent.emit(e)}get el(){return(0,i.a)(this)}};k.style=".popover{--calcite-popover-z-index:100}";const I=class{constructor(e){(0,i.r)(this,e),this.arcgisChange=(0,i.c)(this,"arcgisChange",7),this.closePopupPopovers=(0,i.c)(this,"closePopupPopovers",7),this.manager=(0,s.u)(this),this.sourceUtilityNetworkLayerList=[],this.utilityNetworkLayerIdMap=new Map,this.referenceElement=void 0,this.associationsContent=void 0,this.associationType=void 0,this.popupState=void 0}async reposition(){this.popoverNode?.reposition()}async componentWillLoad(){const{popupState:e}=this;this.allUtilityNetworkLayersAndTables=await this.getAllUtilityNetworkLayersAndTables();const{mapView:t,layer:o}=e,{map:s}=t,{utilityNetworks:r}=s,a=(0,m.g)(o);this.currentUtilityNetwork=r.find((e=>e.sourceJSON?.serviceItemId===a)),this.syncUtilityNetworkLayerIdMap();const l=await(0,n.l)();this.layerListHandle=l.watch((()=>s?.allLayers.filter((e=>(0,m.g)(e)===a)).length),(()=>{this.syncUtilityNetworkLayerIdMap(),(0,i.f)(this.el)})),this.tableListHandle=l.watch((()=>s?.allTables.filter((e=>(0,m.g)(e)===a)).length),(()=>{this.syncUtilityNetworkLayerIdMap(),(0,i.f)(this.el)}))}componentDidLoad(){this.arcgisChange.emit(),this.panelNode?.setFocus()}componentDidUpdate(){this.arcgisChange.emit()}disconnectedCallback(){this.layerListHandle?.remove(),this.tableListHandle?.remove()}render(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"c1d4902d145e827e961a4b8434af8be81a05724e",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"a0a234aa55f6328ad539cb7cd5ce199fe3ec7afa",referenceElement:this.referenceElement,open:!0,class:"popover",label:t.associations.configureType,placement:"leading-start",pointerDisabled:!0,triggerDisabled:!0,offsetDistance:-Math.round(this.referenceElement.getBoundingClientRect().width),offsetSkidding:50,ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"d9da652bf0eacc361fd223570dc0aaa50f1aebbc",closable:!0,style:{width:`${this.referenceElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>this.closePopupPopovers.emit(),ref:e=>this.panelNode=e},(0,i.h)("div",{key:"73a6c5b5947c1daeaaee5aa7de3905f799174cfc",slot:"header-content"},t.associations.configureType),this.renderDoneButton(),(0,i.h)("div",{key:"5aae469087b71c86b5086d99c404673ff48ed07f",class:"associations-div"},this.renderAssociationsTypeSelection(),this.renderAssociationsFilterForLayerSelection(),this.renderAssociationsDisplayOptions()))))}renderAssociationsTypeSelection(){const{popupState:e}=this,{strings:t}=e,{associationsContent:o,associationType:s}=this,r=o.associationTypes.map((e=>e.type)),n=m.a.filter((e=>s.type===e||!r.includes(e))).map((e=>{const t=this.getAssociationTypeString(e);return(0,i.h)("calcite-combobox-item",{value:e,heading:t,selected:e===s.type})}));return(0,i.h)("calcite-label",null,t.associations.type,(0,i.h)("calcite-combobox",{label:t.associations.type,scale:"s",selectionMode:"single-persist",clearDisabled:!0,onCalciteComboboxChange:e=>{e.preventDefault(),e.stopPropagation(),this.changeAssociationProperties()},ref:e=>this.typeComboboxNode=e,overlayPositioning:"fixed"},n))}renderAssociationsFilterForLayerSelection(){const{popupState:e}=this,{strings:t}=e;return this.syncUtilityNetworkLayerIdMap(),this.setSourceLayerList(),(0,i.h)("calcite-label",null,t.associations.layer,(0,i.h)("calcite-combobox",{label:t.associations.layer,scale:"s",selectionMode:"single-persist",placeholder:t.associations.optionalLayerSelection,onCalciteComboboxChange:e=>{e.preventDefault(),e.stopPropagation(),this.changeAssociationProperties()},ref:e=>this.layerComboboxNode=e,overlayPositioning:"fixed"},this.sourceUtilityNetworkLayerList))}renderAssociationsDisplayOptions(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-block-section",{open:!0,text:t.options},(0,i.h)("div",{class:"options-block"},this.renderTitle(),this.renderDescription()))}renderTitle(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-label",{scale:"s"},t.title,(0,i.h)("calcite-input",{type:"text",ref:e=>this.titleNode=e,value:this.associationType.title,placeholder:t.enterTitle,onCalciteInputInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeAssociationProperties()}),300)}))}renderDescription(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-label",{scale:"s"},t.desc,(0,i.h)("calcite-input",{type:"text",ref:e=>this.descriptionNode=e,value:this.associationType.description,placeholder:t.enterDescription,onCalciteInputInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeAssociationProperties()}),300)}))}renderDoneButton(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:"full",onClick:()=>this.closePopupPopovers.emit()},t.done)}async getAllUtilityNetworkLayersAndTables(){const{popupState:e}=this,{layer:t}=e,o="url"in t&&t.url||"portalItem"in t&&t.portalItem?.url;try{const e=await(0,n.p)(),t=await e(o,{responseType:"json",method:"auto",query:{f:"json"}}),i=[...t?.data?.layers||[],...t?.data?.tables||[]];return Promise.resolve(i)}catch(e){return await Promise.resolve([])}}syncUtilityNetworkLayerIdMap(){const{popupState:e}=this,{mapView:t,layer:o}=e,{map:i}=t,{allUtilityNetworkLayersAndTables:s,currentUtilityNetwork:r}=this;this.utilityNetworkLayerIdMap.clear();const n=(0,m.g)(o),a=i?.allLayers.flatten((e=>"sublayers"in e?e.sublayers:null))??[],l=[...a,...i?.allTables.flatten((e=>"sublayers"in e?e.sublayers:null))??[]].filter((e=>(0,m.g)(e)===n));l.forEach((e=>{const t="subtype-sublayer"===e.type?e.parent.layerId:e.layerId,o=s.find((e=>e.id===t)).name;this.utilityNetworkLayerIdMap.set(t,o)}));const c=this.associationType.associatedNetworkSourceId,h=r.getLayerIdBySourceId(c);this.utilityNetworkLayerIdMap.has(h)||(this.associationType.associatedNetworkSourceId=null)}setSourceLayerList(){const{allUtilityNetworkLayersAndTables:e,currentUtilityNetwork:t,associationType:o}=this;this.sourceUtilityNetworkLayerList=e.filter((e=>(0,l.i)(this.utilityNetworkLayerIdMap.get(e.id))&&(0,l.i)(t.getSourceIdByLayerId(e.id)))).map((e=>{const s=this.utilityNetworkLayerIdMap.get(e.id),r=t.getSourceIdByLayerId(e.id);return(0,i.h)("calcite-combobox-item",{value:r,heading:s,selected:o.associatedNetworkSourceId===r})}))}changeAssociationProperties(){this.associationType.title=this.titleNode.value,this.associationType.description=this.descriptionNode.value,this.associationType.type=this.typeComboboxNode.selectedItems[0]?.value,this.associationType.associatedNetworkSourceId=this.layerComboboxNode.selectedItems[0]?.value??null,(0,i.f)(this.el)}getAssociationTypeString(e){const{popupState:t}=this,{strings:o}=t;switch(e){case"attachment":return o.associations.attachment;case"connectivity":return o.associations.connectivity;case"container":return o.associations.container;case"content":return o.associations.content;case"structure":return o.associations.structure}}get el(){return(0,i.a)(this)}};I.style=".popover{--calcite-popover-z-index:100}.associations-div{background-color:var(--calcite-color-foreground-1);padding:var(--calcite-spacing-sm);max-height:calc(60vh - 102px);}.options-block{margin-top:var(--calcite-spacing-sm)}";const P=10,w=class{constructor(e){(0,i.r)(this,e),this.arcgisMultimediaChange=(0,i.c)(this,"arcgisMultimediaChange",7),this.closePopupPopovers=(0,i.c)(this,"closePopupPopovers",7),this.manager=(0,s.u)(this),this.arcadeExpMap=new Map,this.listItemNodes=[],this.colorIconNodes=[],this.lastColors={},this.referenceElement=void 0,this.mediaContent=void 0,this.chartMediaInfo=void 0,this.mediaIndexPosition=void 0,this.popupState=void 0}arcadeChangeNotificationHandler(){(0,i.f)(this.el)}closePopupPopoversHandler(){this.removePopovers()}async reposition(){this.popoverNode?.reposition()}async componentWillLoad(){const{popupState:e}=this,{layer:t,layerDisplayType:o}=e;if(await this.loadAllModules(),this.chartMediaInfo.title=this.chartMediaInfo.title||"",this.chartMediaInfo.altText=this.chartMediaInfo.altText||"",this.chartMediaInfo.caption=this.chartMediaInfo.caption||"","renderer"in t){const e=o===a.l.cluster?t.featureReduction.renderer:t.renderer;["class-breaks","dot-density","heatmap","pie-chart","simple","unique-value"].includes(e?.type)&&(this.rendererColors=await this.modules.rendererUtils.getColorsFromRenderer(e))}this.colors=this.modules.esriLang.clone(this.chartMediaInfo?.value.colors)||[],this.setColors()}componentDidLoad(){this.panelNode?.setFocus()}async componentWillRender(){const{popupState:e,modules:t}=this,{popupTemplate:o}=e;this.fieldInfoMap=new Map(o.fieldInfos.map((e=>[e.fieldName,e]))),this.arcadeExpMap=(0,l.m)(o),this.listItemNodes=[],this.chartMediaInfo.value.fields.forEach(((e,o)=>{if(this.fieldInfoMap.has(e)){const t=this.fieldInfoMap.get(e);this.listItemNodes.push(this.renderListItem(t,o))}else if(this.chartMediaInfo.value.fields.splice(o,1),this.chartMediaInfo.type!==d.P.LINE_CHART)if(this.chartMediaInfo.value.colors?.length)this.chartMediaInfo.value.colors.splice(o,1),this.colors.splice(o,1);else{const e=this.getDefaultColorScheme();this.colors=this.chartMediaInfo?.value.fields.map(((o,i)=>this.rendererColors?.get(o)?t.esriLang.clone(this.rendererColors.get(o)[0]):this.colors?.[i]||new t.EsriColor(e.colors[i%P])||new t.EsriColor([0,0,0,1])))}}))}componentDidUpdate(){this.arcgisMultimediaChange.emit(this.mediaIndexPosition),this.popoverNode?.reposition()}disconnectedCallback(){this.removePopovers()}render(){const{popupState:e}=this,{strings:t}=e,o=!!this.chartMediaInfo.value.fields?.length;return(0,i.h)(i.H,{key:"c7ed3e862f880c5ec1027a57bb807790241edf98",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"63d85d6ee8b2735c272dbcb6026251d92b46578a",class:"popover",placement:"leading-start",open:!0,pointerDisabled:!0,referenceElement:this.referenceElement,offsetDistance:-Math.round(this.referenceElement.getBoundingClientRect().width),offsetSkidding:50,label:t.configureChart,triggerDisabled:!0,ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"e61330bf15dbe151c6474270d12e1324bffdb54d",class:"panel",closable:!0,style:{width:`${this.referenceElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>this.closePopupPopovers.emit(),ref:e=>this.panelNode=e},(0,i.h)("div",{key:"8c32fd4c25b6d848be9959a2d75cf0c47eb1ef12",slot:"header-content"},t.configureChart),(0,i.h)("div",{key:"2c046b7cbfb6ea7234895a5ae4405c1fa825760f",class:"content"},this.renderChartTypeSelection(),this.renderChartFormInput("title"),this.renderChartFormInput("caption"),this.renderChartFormInput("altText"),o&&this.renderColorButton(),o&&this.renderResetToDefaultColorsButton(),this.renderFieldList(),this.renderHorizontalOrientationSwitch(),this.renderNormalizationSwitch()),this.renderDoneButton())))}renderChartTypeSelection(){const{popupState:e,modules:t}=this,{strings:o}=e;return(0,i.h)("calcite-segmented-control",{class:"segmented-control",width:"full",scale:"s",onCalciteSegmentedControlChange:async e=>{this.colorButtonNode?.closePopover(),this.closeColorPopover();const o=e.target.selectedItem;if(this.chartMediaInfo.type===d.P.LINE_CHART&&o.value!==d.P.LINE_CHART||this.chartMediaInfo.type!==d.P.LINE_CHART&&o.value===d.P.LINE_CHART){const e=this.chartMediaInfo.value.colors;this.chartMediaInfo.type===d.P.LINE_CHART?(this.lastColors.lineColors=e?t.esriLang.clone(e):void 0,this.colors=void 0,this.chartMediaInfo.value.colors=void 0):(this.lastColors.rampColors=e?t.esriLang.clone(e):void 0,o.value===d.P.LINE_CHART&&(this.colors=void 0,this.chartMediaInfo.value.colors=void 0))}o.value!==this.chartMediaInfo.type&&(o.value===d.P.COLUMN_CHART&&this.chartMediaInfo.type===d.P.BAR_CHART||await this.handleChartSelection(o.value)),this.setColors()}},(0,i.h)("calcite-segmented-control-item",{value:d.P.COLUMN_CHART,iconStart:"graph-bar",checked:this.chartMediaInfo.type===d.P.COLUMN_CHART||this.chartMediaInfo.type===d.P.BAR_CHART},o.bar),(0,i.h)("calcite-segmented-control-item",{value:d.P.LINE_CHART,iconStart:"graph-time-series",checked:this.chartMediaInfo.type===d.P.LINE_CHART},o.line),(0,i.h)("calcite-segmented-control-item",{value:d.P.PIE_CHART,iconStart:"pie-chart",checked:this.chartMediaInfo.type===d.P.PIE_CHART},o.pie))}renderChartFormInput(e){const{popupState:t}=this,{strings:o,popupTemplate:s}=t,r=this.getChartInputDescription(e),n=this.getChartInputValue(e),a=this.getChartInputPlaceholder(e);return(0,i.h)("calcite-label",{scale:"s"},r,(0,i.h)("div",{class:"form-input-button"},"caption"!==e?(0,i.h)("calcite-input",{class:"input",autofocus:!0,ref:t=>"title"===e?this.chartTitleNode=t:this.chartAltTextNode=t,value:n,placeholder:a,onCalciteInputInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeChartProperties()}),300)}):(0,i.h)("calcite-text-area",{resize:"vertical",autofocus:!0,value:n,placeholder:a,onCalciteTextAreaInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeChartProperties()}),300),ref:e=>this.chartCaptionNode=e}),s.fieldInfos?.length&&(0,i.h)("calcite-action",{text:o.attributes,scale:"s",icon:"brackets-curly",onClick:()=>{const{popupState:t}=this;this.removePopovers(),this.colorButtonNode?.closePopover(),this.closeColorPopover(),this.chartFormInputPickListNode||(this.chartFormInputPickListNode=document.createElement("arcgis-map-config-popup-field-pick-list"),this.chartFormInputPickListNode.popoverProps={refElement:this.panelNode},this.chartFormInputPickListNode.multiple=!1,this.chartFormInputPickListNode.heading=o.addField,this.chartFormInputPickListNode.popupState=t,this.chartFormInputPickListNode.addEventListener("arcgisChange",(t=>{t.stopPropagation();const o=t.detail.selectedFields[0];this.handleChartFormInputPickListNodeChange(o,e)})),this.chartFormInputPickListNode.addEventListener("arcgisClose",(e=>{e.stopPropagation(),this.removePopovers()})),document.body.appendChild(this.chartFormInputPickListNode),this.panelNode.disabled=!0)}})))}renderColorButton(){const{popupState:e}=this;return(0,i.h)("arcgis-map-config-popup-color-button",{referenceElement:this.panelNode,chartMediaInfo:this.chartMediaInfo,colors:this.colors,popupState:e,onArcgisPopupColorButtonBeforeOpen:()=>this.closeColorPopover(),onArcgisPopupColorButtonChange:(0,p.d)((({detail:e})=>{this.colors=e,this.chartMediaInfo.value.colors=this.modules.esriLang.clone(e),(0,i.f)(this.el)}),300),ref:e=>this.colorButtonNode=e})}renderResetToDefaultColorsButton(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-label",{class:"reset-to-default-colors-button",layout:"inline-space-between"},t.resetColors,(0,i.h)("calcite-action",{appearance:"transparent",text:t.resetColors,disabled:!this.chartMediaInfo.value.colors?.length,onClick:()=>{this.colorButtonNode?.closePopover(),this.closeColorPopover(),this.chartMediaInfo.value.colors=null,this.colors=[],this.chartMediaInfo.type===d.P.LINE_CHART?this.lastColors.lineColors=void 0:this.lastColors.rampColors=void 0,this.setColors(),(0,i.f)(this.el)}},(0,i.h)("calcite-icon",{scale:"s",icon:"reset"})))}renderFieldList(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("div",{class:"fields-div"},(0,i.h)("calcite-button",{class:"select-fields-button",appearance:"transparent",width:"full",onClick:e=>{e.stopPropagation(),this.removePopovers(),this.colorButtonNode?.closePopover(),this.closeColorPopover();const{popupState:o}=this;this.fieldPickListNode||(this.fieldPickListNode=document.createElement("arcgis-map-config-popup-field-pick-list"),this.fieldPickListNode.popoverProps={refElement:this.panelNode},this.fieldPickListNode.selectedFields=this.chartMediaInfo?.value?.fields||[],this.fieldPickListNode.hideCancel=!0,this.fieldPickListNode.multiple=!0,this.fieldPickListNode.heading=t.selectFields,this.fieldPickListNode.okBtnText=t.done,this.fieldPickListNode.numbersOnly=!0,this.fieldPickListNode.popupState=o,this.fieldPickListNode.addEventListener("arcgisChange",(e=>{e.stopPropagation();const t=e.detail.selectedFields;this.handleChartFieldPickListChange(t)})),this.fieldPickListNode.addEventListener("arcgisClose",(e=>{e.stopPropagation(),this.removePopovers()})),document.body.appendChild(this.fieldPickListNode),this.panelNode.disabled=!0)}},t.selectAttributes),(0,i.h)("calcite-list",{label:t.attributes,dragEnabled:!0,onCalciteListOrderChange:e=>{e.stopPropagation();const t=e.target.querySelectorAll("calcite-list-item"),o=[];if(t.forEach((e=>{this.chartMediaInfo.value.fields.forEach(((t,i)=>{e.value===t&&o.push(i)}))})),this.chartMediaInfo.type===d.P.LINE_CHART)this.chartMediaInfo.value.fields=Array.from(t).map((e=>e.value));else{this.chartMediaInfo.value.colors?.length||(this.chartMediaInfo.value.colors=this.modules.esriLang.clone(this.colors));const e=[],t=[];o.forEach((o=>{e.push(this.chartMediaInfo.value.fields[o]),t.push(this.modules.esriLang.clone(this.chartMediaInfo.value.colors[o]))})),this.chartMediaInfo.value.fields=e,this.colors=t,this.chartMediaInfo.value.colors=this.modules.esriLang.clone(t)}if(this.lastColors.rampColors?.length){const e=[];o.forEach((t=>{e.push(this.lastColors.rampColors[t])})),this.lastColors.rampColors=e}(0,i.f)(this.el)}},this.listItemNodes))}renderListItem(e,t){const{popupState:o}=this,{strings:s}=o;return(0,i.h)("calcite-list-item",{key:e.fieldName,label:(0,l.o)(e,this.arcadeExpMap),value:e.fieldName},this.renderColorIcon(t),(0,i.h)("calcite-action",{slot:"actions-end",appearance:"transparent",text:s.remove,onClick:()=>{this.removePopovers(),this.colorButtonNode?.closePopover(),this.closeColorPopover(),this.chartMediaInfo.value.colors?.length?this.chartMediaInfo.value.fields.forEach(((t,o)=>{t===e.fieldName&&(this.chartMediaInfo.value.fields.splice(o,1),this.chartMediaInfo.type!==d.P.LINE_CHART&&(this.chartMediaInfo.value.colors.splice(o,1),this.colors.splice(o,1),this.colorButtonNode&&(0,i.f)(this.colorButtonNode)),this.lastColors.rampColors?.length&&this.lastColors.rampColors.splice(o,1))})):(this.chartMediaInfo.value.fields.forEach(((t,o)=>{t===e.fieldName&&this.chartMediaInfo.value.fields.splice(o,1)})),this.colors=[],this.setColors()),(0,i.f)(this.el)}},(0,i.h)("calcite-icon",{scale:"s",icon:"x"})))}renderColorIcon(e){const{colors:t}=this;return this.chartMediaInfo.type===d.P.LINE_CHART?(0,i.h)(i.F,null):(0,i.h)("div",{class:"color-icon",style:{backgroundColor:t[e].toHex()},slot:"content-start",onClick:()=>this.openColorPopover(e),role:"button",tabIndex:0,onKeyUp:t=>{" "!==t.key&&"Enter"!==t.key||this.openColorPopover(e)},ref:t=>this.colorIconNodes[e]=t})}renderHorizontalOrientationSwitch(){const{popupState:e}=this,{strings:t}=e;return this.chartMediaInfo.type!==d.P.BAR_CHART&&this.chartMediaInfo.type!==d.P.COLUMN_CHART?(0,i.h)(i.F,null):(0,i.h)("calcite-label",{layout:"inline-space-between"},t.horizontalOrientation,(0,i.h)("calcite-switch",{scale:"s",checked:this.chartMediaInfo.type===d.P.BAR_CHART,onCalciteSwitchChange:(0,p.d)((async()=>await this.handleChartSelection(this.orientationSwitchNode.checked?d.P.BAR_CHART:d.P.COLUMN_CHART)),300),ref:e=>this.orientationSwitchNode=e}))}renderNormalizationSwitch(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-block-section",{text:t.normalize,toggleDisplay:"switch",open:!!this.chartMediaInfo.value.normalizeField,onCalciteBlockSectionToggle:()=>{this.normalizationBlockSectionNode.open?this.chartMediaInfo.value.normalizeField=this.tempNormalizedField:(this.tempNormalizedField=this.chartMediaInfo.value.normalizeField,this.chartMediaInfo.value.normalizeField=""),(0,i.f)(this.el)},ref:e=>this.normalizationBlockSectionNode=e},(0,i.h)("calcite-button",{class:"normalize-by-button",alignment:"icon-end-space-between",iconEnd:"pencil",appearance:"outline-fill",kind:"neutral",width:"full",title:t.normalizeBy,onClick:e=>{e.stopPropagation(),this.removePopovers(),this.colorButtonNode?.closePopover(),this.closeColorPopover();const{popupState:t}=this;this.normalizationFieldPickListNode||(this.normalizationFieldPickListNode=document.createElement("arcgis-map-config-popup-field-pick-list"),this.normalizationFieldPickListNode.popoverProps={refElement:this.panelNode},this.normalizationFieldPickListNode.selectedFields=this.chartMediaInfo.value.normalizeField?[this.chartMediaInfo.value.normalizeField]:[],this.normalizationFieldPickListNode.numbersOnly=!0,this.normalizationFieldPickListNode.popupState=t,this.normalizationFieldPickListNode.addEventListener("arcgisChange",(e=>{e.stopPropagation();const t=e.detail.selectedFields[0];this.handleNormalizationFieldPickListNodeChange(t)})),this.normalizationFieldPickListNode.addEventListener("arcgisClose",(e=>{e.stopPropagation(),this.normalizationFieldPickListNode?.parentElement?.removeChild(this.normalizationFieldPickListNode),this.normalizationFieldPickListNode=void 0,this.panelNode.disabled=!1})),document.body.appendChild(this.normalizationFieldPickListNode),this.panelNode.disabled=!0)},ref:e=>this.normalizationButtonNode=e},this.fieldInfoMap.has(this.chartMediaInfo.value.normalizeField)?(0,l.o)(this.fieldInfoMap.get(this.chartMediaInfo.value.normalizeField),this.arcadeExpMap):t.normalizeBy))}renderDoneButton(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:"full",onClick:()=>this.closePopupPopovers.emit()},t.done)}async loadAllModules(){const[e,t,o,i]=await Promise.all([(0,n.o)(),(0,n.ab)(),(0,n.aT)(),(0,n.aU)()]);this.modules={esriLang:e,EsriColor:t,pieChartSchemes:o,rendererUtils:i}}async handleChartSelection(e){const[t,o,s,r]=await Promise.all([(0,n.aV)(),(0,n.Y)(),(0,n.aW)(),(0,n.aX)()]);let a=null;e===d.P.BAR_CHART&&(a=new t({title:this.chartMediaInfo.title,caption:this.chartMediaInfo.caption,value:this.chartMediaInfo.value,altText:this.chartMediaInfo.altText})),e===d.P.COLUMN_CHART&&(a=new o({title:this.chartMediaInfo.title,caption:this.chartMediaInfo.caption,value:this.chartMediaInfo.value,altText:this.chartMediaInfo.altText})),e===d.P.LINE_CHART&&(a=new s({title:this.chartMediaInfo.title,caption:this.chartMediaInfo.caption,value:this.chartMediaInfo.value,altText:this.chartMediaInfo.altText})),e===d.P.PIE_CHART&&(a=new r({title:this.chartMediaInfo.title,caption:this.chartMediaInfo.caption,value:this.chartMediaInfo.value,altText:this.chartMediaInfo.altText})),this.chartMediaInfo=a.clone(),this.mediaContent.mediaInfos[this.mediaIndexPosition]=this.chartMediaInfo,(0,i.f)(this.el)}getChartInputDescription(e){const{popupState:t}=this,{strings:o}=t;return"title"===e?o.title:"caption"===e?o.caption:o.description}getChartInputValue(e){return"title"===e?this.chartMediaInfo.title:"caption"===e?this.chartMediaInfo.caption:this.chartMediaInfo.altText}getChartInputPlaceholder(e){const{popupState:t}=this,{strings:o}=t;return"title"===e?o.imageTitlePlaceHolder:"caption"===e?o.imageCaptionPlaceHolder:o.describeChart}changeChartProperties(){this.chartMediaInfo.title=this.chartTitleNode.value,this.chartMediaInfo.caption=this.chartCaptionNode.value,this.chartMediaInfo.altText=this.chartAltTextNode.value,(0,i.f)(this.el)}handleChartFormInputPickListNodeChange(e,t){"title"===t?((0,m.c)(this.chartTitleNode,e),this.chartMediaInfo.title=this.chartTitleNode.value):"caption"===t?((0,m.c)(this.chartCaptionNode,e),this.chartMediaInfo.caption=this.chartCaptionNode.value):"altText"===t&&((0,m.c)(this.chartAltTextNode,e),this.chartMediaInfo.altText=this.chartAltTextNode.value),this.removePopovers(),(0,i.f)(this.el)}setColors(){const{modules:e,lastColors:t,rendererColors:o}=this;if(this.chartMediaInfo.type===d.P.LINE_CHART)if(!this.colors?.length&&t.lineColors&&(this.colors=t.lineColors,this.chartMediaInfo.value.colors=e.esriLang.clone(this.colors)),this.colors?.length)this.colors.length>1&&(this.colors=[this.colors[0]]);else{const e=this.getDefaultColorScheme();this.colors=[e.colors[0]]}else if(!this.colors?.length&&t.rampColors&&(this.colors=e.esriLang.clone(t.rampColors),this.chartMediaInfo.value.colors=e.esriLang.clone(this.colors)),!this.colors?.length||this.colors.length!==this.chartMediaInfo?.value.fields.length){const t=this.getDefaultColorScheme();this.colors=this.chartMediaInfo?.value.fields.map(((i,s)=>o?.get(i)?.[0]?e.esriLang.clone(o.get(i)[0]):(0,l.i)(this.colors?.[s])?this.colors[s]:(0,l.i)(t.colors[s%P])?new e.EsriColor(t.colors[s%P]):new e.EsriColor([0,0,0,1])))}}getDefaultColorScheme(){const{popupState:e,modules:t}=this,{mapView:o}=e,i=t.pieChartSchemes.getSchemes({basemap:o.map?.basemap??"topo",geometryType:"polygon",numColors:Math.min(P,this.chartMediaInfo.value.fields.length)});return[i.primaryScheme].concat(i.secondarySchemes).find((e=>"Olympic Sunset"===e.name))||i.primaryScheme}handleChartFieldPickListChange(e){const{modules:t,rendererColors:o}=this,s=this.chartMediaInfo.value.fields;if(this.chartMediaInfo.value.fields=e,this.chartMediaInfo.type===d.P.LINE_CHART){if(this.chartMediaInfo.value.fields?.length&&!this.chartMediaInfo.value.colors?.length){const e=this.getDefaultColorScheme();this.colors=[e.colors[0]],this.chartMediaInfo.value.colors=t.esriLang.clone(this.colors),(0,i.f)(this.el)}else!this.chartMediaInfo.value.fields?.length&&this.chartMediaInfo.value.colors?.length&&(this.colors=void 0,this.chartMediaInfo.value.colors=void 0,(0,i.f)(this.el));if(this.lastColors.rampColors?.length){const e=this.getDefaultColorScheme();this.lastColors.rampColors=this.chartMediaInfo?.value.fields.map(((o,i)=>{const r=s.indexOf(o);return r>-1&&this.lastColors.rampColors?.[r]||new t.EsriColor(e.colors[i%P])||new t.EsriColor([0,0,0,1])}))}}else if(this.chartMediaInfo.value.fields?.length){const e=this.getDefaultColorScheme();this.colors=this.chartMediaInfo?.value.fields.map(((i,r)=>{const n=s.indexOf(i);return n>-1&&this.colors?.[n]||(o?.get(i)?.[0]?t.esriLang.clone(o.get(i)[0]):new t.EsriColor(e.colors[r%P]))})),this.chartMediaInfo.value.colors?.length?this.chartMediaInfo.value.colors=t.esriLang.clone(this.colors):(this.colors=[],this.setColors(),(0,i.f)(this.el)),s?.length?this.colorButtonNode&&(0,i.f)(this.colorButtonNode):(0,i.f)(this.el)}else this.colors=void 0,this.chartMediaInfo.value.colors=void 0,(0,i.f)(this.el);(0,i.f)(this.el)}handleNormalizationFieldPickListNodeChange(e){e&&(this.chartMediaInfo.value.normalizeField=e,(0,i.f)(this.el)),this.removePopovers(),this.normalizationButtonNode.focus()}openColorPopover(e){const{colors:t,modules:o}=this;this.colorButtonNode?.closePopover(),this.closeColorPopover();const s=document.createElement("arcgis-map-config-popup-color-popover");s.hexColor=t[e].toHex(),s.popoverProps={placement:"leading-start",offsetDistance:1,offsetSkidding:52,popoverWidth:315,refElement:this.panelNode},s.popupState=this.popupState,s.addEventListener("arcgisPopupColorPopoverChange",(({detail:s})=>{t[e]=new o.EsriColor(s),this.chartMediaInfo.value.colors=o.esriLang.clone(t),(0,i.f)(this.el),(0,i.f)(this.colorButtonNode)})),s.addEventListener("arcgisPopupColorPopoverClose",(()=>this.colorPopoverNode=void 0)),document.body.appendChild(s),s.setOpen(!0),this.colorPopoverNode=s}closeColorPopover(){this.colorPopoverNode?.parentElement?.removeChild(this.colorPopoverNode),this.colorPopoverNode=void 0}removePopovers(){this.chartFormInputPickListNode&&(document.body.removeChild(this.chartFormInputPickListNode),this.chartFormInputPickListNode=void 0),this.fieldPickListNode&&(document.body.removeChild(this.fieldPickListNode),this.fieldPickListNode=void 0),this.normalizationFieldPickListNode&&(document.body.removeChild(this.normalizationFieldPickListNode),this.normalizationFieldPickListNode=void 0),this.colorPopoverNode&&(document.body.removeChild(this.colorPopoverNode),this.colorPopoverNode=void 0),this.panelNode.disabled=!1}get el(){return(0,i.a)(this)}};w.style=".popover{--calcite-popover-z-index:100}.panel{--calcite-panel-background-color:var(--calcite-color-foreground-1)}.content{padding:var(--calcite-spacing-lg) var(--calcite-spacing-sm);max-height:60vh}.segmented-control{margin-bottom:var(--calcite-spacing-sm)}.form-input-button{display:flex}.input{width:100%}calcite-text-area{width:100%;--calcite-text-area-min-width:0;--calcite-text-area-min-height:42px}.reset-to-default-colors-button{--calcite-label-margin-bottom:0}.select-fields-button{margin-bottom:var(--calcite-spacing-sm)}.color-icon{width:18px;height:18px;border-radius:90%}.fields-div{margin-bottom:var(--calcite-spacing-sm)}.normalize-by-button{margin-top:var(--calcite-spacing-sm)}";const x=class{constructor(e){(0,i.r)(this,e),this.arcgisPopupColorButtonBeforeOpen=(0,i.c)(this,"arcgisPopupColorButtonBeforeOpen",7),this.arcgisPopupColorButtonChange=(0,i.c)(this,"arcgisPopupColorButtonChange",7),this.manager=(0,s.u)(this),this.resizeObserver=new ResizeObserver((()=>(0,i.f)(this.el))),this.referenceElement=void 0,this.chartMediaInfo=void 0,this.colors=void 0,this.popupState=void 0,this.selected=!1}async setFocus(){this.popoverButtonNode?.focus()}async closePopover(){this.closeColorPopover()}async componentWillLoad(){await this.loadAllModules()}async componentDidLoad(){(0,i.f)(this.el),this.resizeObserver.observe(this.popoverButtonNode)}disconnectedCallback(){this.resizeObserver.unobserve(this.popoverButtonNode)}render(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"61a2447f62c1024069286f86af5ce6560095ccf4"},(0,i.h)("calcite-label",{key:"9eb9437d5111232a122603438c75589bfe766aab",scale:"s"},t.color,this.renderColorButton()))}renderColorButton(){const{colors:e,selected:t}=this,o=e?.length?e.filter(((e,t)=>t<10)).map(((t,o)=>(0,i.h)("div",{key:`color-button-icon-${o}`,class:"color-icon-section",style:{width:95/Math.min(10,Math.min(10,e.length))+"%",backgroundColor:t?.toHex()??"#ffffff"}}))):null,s={"color-selector":!0,selected:t};return(0,i.h)("div",{class:s,role:"button",tabIndex:0,onClick:()=>this.openColorPopover(),onKeyUp:e=>{" "!==e.key&&"Enter"!==e.key||this.openColorPopover()},ref:e=>this.popoverButtonNode=e},(0,i.h)("div",{class:"color-icon"},o),(0,i.h)("div",{class:"color-edit-button"},(0,i.h)("calcite-icon",{scale:"s",icon:"pencil"})))}async loadAllModules(){const[e,t,o,i]=await Promise.all([(0,n.o)(),(0,n.ab)(),(0,n.aT)(),(0,n.aI)()]);this.modules={esriLang:e,esriColor:t,pieChartSchemes:o,SimpleFillSymbol:i}}async openColorPopover(){const{modules:e,popoverNode:t,popoverButtonNode:o,colors:s}=this,r=(0,g.f)(this.el,"calcite-panel");if(t)this.closeColorPopover();else if(1===s.length){this.arcgisPopupColorButtonBeforeOpen.emit(),this.selected=!0;const t=document.createElement("arcgis-map-config-popup-color-popover");t.hexColor=s[0].toHex(),t.popoverProps={placement:"leading-start",offsetDistance:1,offsetSkidding:52,popoverWidth:315,refElement:r},t.popupState=this.popupState,t.addEventListener("arcgisPopupColorPopoverChange",(({detail:t})=>{this.colors[0]=new e.esriColor(t),this.chartMediaInfo.value.colors=e.esriLang.clone(this.colors),this.arcgisPopupColorButtonChange.emit(e.esriLang.clone(this.colors)),(0,i.f)(this.el)})),t.addEventListener("arcgisPopupColorPopoverClose",(()=>this.popoverNode=void 0)),document.body.appendChild(t),t.setOpen(!0),this.popoverNode=t}else{this.arcgisPopupColorButtonBeforeOpen.emit(),this.selected=!0;document.createElement("div").className="symbol-styler-div",this.popoverNode=this.createSymbolStylerPopover({referenceElement:r}),this.popoverNode.addEventListener("arcgisClose",(e=>{e.stopPropagation(),this.closeColorPopover(),setTimeout((()=>o?.focus()),300)})),this.popoverNode.addEventListener("arcgisDisconnected",(e=>{e.stopPropagation(),this.closeColorPopover()})),this.symbolStylerWatchScaleHandle=await this.buildSymbolStylerForRamp({popoverNode:this.popoverNode,onChange:()=>{(this.chartMediaInfo?.value).colors=e.esriLang.clone(this.colors),this.arcgisPopupColorButtonChange.emit(e.esriLang.clone(this.colors))}})}}createSymbolStylerPopover(e){const{popupState:t}=this,{referenceElement:o}=e,i=document.createElement("arcgis-map-config-popup-styler-popover");return i.referenceElement=o,i.popupState=t,document.body.appendChild(i),i.open=!0,setTimeout((()=>i.open=!0),300),i.reposition(),i}closeColorPopover(){1===this.colors.length?this.popoverNode&&document.body.removeChild(this.popoverNode):(this.symbolStylerWatchScaleHandle?.remove(),this.popoverNode&&this.closeSymbolStylerPopover()),this.selected=!1,this.popoverNode=void 0}closeSymbolStylerPopover(){this.popoverNode?.parentElement?.removeChild(this.popoverNode),this.popoverNode=void 0}async buildSymbolStylerForRamp(e){const{modules:t,popupState:o}=this,{mapView:s,portal:r,strings:n}=o,{colors:a}=this,{popoverNode:l}=e,c=t.esriLang.clone(a.filter(((e,t)=>t<10))),h=t.pieChartSchemes.getSchemes({basemap:s.map?.basemap??"topo",geometryType:"polygon",numColors:Math.min(10,a.length)}),d=this.getColorRampsWithSchemes(h).map((e=>({stops:e.colors.reverse(),tags:e.scheme.tags,name:e.scheme.name}))),p=await this.createSymbolStylerElement(l),m=p.edit(new t.SimpleFillSymbol,{portal:r,sections:{marker:{parts:{preview:!1,rotation:!1,size:!1}},fill:{type:"color-ramp",style:"discrete",open:!0,colorRampsOpen:!0,colorRamps:d,parts:{transparency:!1}}},fill:{color:c.reverse()}});p.stringOverrides={fillColor:n.color},p.addEventListener("arcgisEdit",(({detail:{info:{fill:e}}})=>{const o=t.esriLang.clone(e.color).reverse();if(o.length<this.colors.length){for(let e=o.length;e<this.colors.length;e++)o.push(t.esriLang.clone(o[e%10]))}(this.chartMediaInfo?.value).colors=o,this.colors=o,(0,i.f)(this.el),this.arcgisPopupColorButtonChange.emit(t.esriLang.clone(this.colors))})),l.addStyler(p),await m}getColorRampsWithSchemes(e){const t=[e.primaryScheme].concat(e.secondarySchemes),o=[];return t.forEach((e=>{o.push({colors:e.colors,scheme:e})})),o}async createSymbolStylerElement(e){const t=document.createElement("arcgis-map-config-symbol-styler");return t.style="max-height: max(calc(100vh - 200px), 300px)",t.popoverProps={placement:"bottom-end",offsetDistance:10,offsetSkidding:"rtl"===(0,u.b)(this.el)?3:-3,refElement:await e.getPopoverRefElement()||this.popoverButtonNode},t}get el(){return(0,i.a)(this)}};x.style=".color-selector{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.color-selector:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.color-selector:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.color-selector:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.color-selector.selected{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.color-icon-section{height:16px;display:inline-block}.color-icon{width:100%;height:16px;overflow:hidden;border-radius:0}.color-icon.transparent{height:15px;width:100%}.color-icon.transparent svg{height:15px;width:95%;stroke:#e0e0e0;stroke-width:1px}.color-edit-button{padding:1px;height:18px;width:18px;border:none;cursor:pointer;color:var(--calcite-ui-icon-color)}.color-edit-button:focus{outline:none}";const M=class{constructor(e){(0,i.r)(this,e),this.arcgisPopupColorPopoverChange=(0,i.c)(this,"arcgisPopupColorPopoverChange",7),this.arcgisPopupColorPopoverClose=(0,i.c)(this,"arcgisPopupColorPopoverClose",7),this.manager=(0,s.u)(this),this.closedWithEvent=!1,this.popoverProps=void 0,this.hexColor=void 0,this.disabled=!1,this.popupState=void 0,this.open=!1}disabledChanged(e){e&&this.open&&this.close()}async setFocus(){this.panelNode?.setFocus()}async setOpen(e){this.open=e}async close(){this.open=!1,this.arcgisPopupColorPopoverClose.emit(),this.closedWithEvent=!0}disconnectedCallback(){this.closedWithEvent||this.arcgisPopupColorPopoverClose.emit()}render(){const{popoverProps:e,popupState:t}=this,{strings:o}=t;return(0,i.h)(i.H,{key:"1c2411acd18dc39874564b722d47c55184991a0f",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"ea6d35315609666ad99f9ae20b8df61131650e6a",referenceElement:e.refElement,open:this.open,pointerDisabled:!0,label:o.selectColor,offsetDistance:e?.offsetDistance??0,offsetSkidding:e?.offsetSkidding??0,flipDisabled:e?.flipDisabled??!1,overlayPositioning:e?.overlayPositioning??"fixed",placement:e?.placement||"bottom",triggerDisabled:!0,onCalcitePopoverOpen:e=>{e.stopPropagation(),this.open&&(e.composedPath().includes(this.el)||(this.open=!1))},onCalcitePopoverClose:e=>{e.stopPropagation(),this.arcgisPopupColorPopoverClose.emit(),this.closedWithEvent=!0},onKeyUp:e=>{"Escape"===e.key&&this.close()}},(0,i.h)("calcite-panel",{key:"a34a3c1a709557857e82ba54904a9993862bd040",closable:!0,onCalcitePanelClose:e=>{const t=e.currentTarget;t.closed&&(this.close(),t.closed=!1),e.stopPropagation()},heading:o.selectColor,style:e?.maxHeight?{maxHeight:e.maxHeight}:{},ref:e=>this.panelNode=e},(0,i.h)("calcite-color-picker",{key:"e94a581ed120e1cc011d4b710599a86af56eecae",clearable:!1,onCalciteColorPickerInput:e=>{e.stopPropagation();const t=e.target.value;this.arcgisPopupColorPopoverChange.emit(t)},value:this.hexColor,storageId:"arcgis-symbol-styler-storage-colors"}),(0,i.h)("calcite-button",{key:"a6930e8d5d0ab69ce01e5f3212c438735a46e7f9",appearance:"solid",slot:"footer",width:"full",label:o.done,onClick:()=>this.close()},o.done))))}get el(){return(0,i.a)(this)}static get watchers(){return{disabled:["disabledChanged"]}}},F=class{constructor(e){(0,i.r)(this,e),this.arcgisMultimediaChange=(0,i.c)(this,"arcgisMultimediaChange",7),this.closePopupPopovers=(0,i.c)(this,"closePopupPopovers",7),this.manager=(0,s.u)(this),this.referenceElement=void 0,this.imageMediaInfo=void 0,this.mediaIndexPosition=void 0,this.popupState=void 0}closePopupPopoversHandler(){this.removeAttributesSelectionPopover()}async reposition(){this.popoverNode?.reposition()}componentWillLoad(){this.imageMediaInfo.title=this.imageMediaInfo.title||"",this.imageMediaInfo.altText=this.imageMediaInfo.altText||"",this.imageMediaInfo.caption=this.imageMediaInfo.caption||"",this.imageMediaInfo.value.sourceURL=this.imageMediaInfo.value.sourceURL||"",this.imageMediaInfo.value.linkURL=this.imageMediaInfo.value.linkURL||""}componentDidLoad(){this.sourceUrlNode.value=this.imageMediaInfo.value.sourceURL,this.imageTitleNode.value=this.imageMediaInfo.title,this.refreshIntervalNode.value=this.imageMediaInfo.refreshInterval?`${this.imageMediaInfo.refreshInterval}`:"0",this.imageCaptionNode.value=this.imageMediaInfo.caption,this.imageLinkNode.value=this.imageMediaInfo.value.linkURL,this.imageAltTextNode.value=this.imageMediaInfo.altText,this.panelNode?.setFocus()}componentDidUpdate(){this.arcgisMultimediaChange.emit(this.mediaIndexPosition)}disconnectedCallback(){this.pickListNode&&document.body.removeChild(this.pickListNode)}render(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"7c74892594afd13a2dc2be03f5bb286a6c8f20ec",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"616f151ca8b48416a5aed78c06f9793730e33afd",class:"popover",placement:"leading-start",open:!0,pointerDisabled:!0,referenceElement:this.referenceElement,offsetDistance:-Math.round(this.referenceElement.getBoundingClientRect().width),offsetSkidding:50,label:t.configureImage,triggerDisabled:!0,ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"cd458dc5d7b1567bfed841ab6d21e350daf59e94",closable:!0,style:{width:`${this.referenceElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>this.closePopupPopovers.emit(),ref:e=>this.panelNode=e},(0,i.h)("div",{key:"7d5f2a8f671f701489c7fa2bd309d44a9c3f9bd3",slot:"header-content"},t.configureImage),(0,i.h)("div",{key:"e8ea72f28b7fb92f980487ada24b732d6a92f0a4",class:"popover-image-div"},this.renderImageConfigOptions()),this.renderDoneButton())))}renderImageConfigOptions(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("div",null,this.renderFormInput(d.I.SOURCE_URL),(0,i.h)("calcite-block-section",{open:!0,text:t.options},this.renderFormInput(d.I.TITLE),this.renderFormInput(d.I.CAPTION),this.renderFormInput(d.I.ALT_TEXT),this.renderFormInput(d.I.LINK_URL),this.renderRefreshInterval()))}renderFormInput(e){const{popupState:t}=this,{strings:o,popupTemplate:s}=t,r=this.getImageInputObject(e);return(0,i.h)("calcite-label",{scale:"s"},r.inputLabel,(0,i.h)("div",{id:r.popoverId,class:"form-input-button"},e!==d.I.CAPTION?(0,i.h)("calcite-input",{class:"input",type:"text",autofocus:!0,value:r.inputValue,placeholder:r.placeHolder,onCalciteInputInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeImageProperties()}),300),ref:r.referenceElement}):(0,i.h)("calcite-text-area",{resize:"vertical",autofocus:!0,value:r.inputValue,placeholder:r.placeHolder,onCalciteTextAreaInput:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.changeImageProperties()}),300),ref:r.referenceElement}),s.fieldInfos?.length&&(0,i.h)("calcite-action",{text:o.attributes,"text-display":"hidden",onClick:()=>this.openAttributesList(r.imageInput),scale:"s",icon:"brackets-curly"})))}renderRefreshInterval(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-block-section",{text:t.refreshInterval,toggleDisplay:"switch",open:!!this.imageMediaInfo.refreshInterval,onCalciteBlockSectionToggle:(0,p.d)((e=>{e.preventDefault(),e.stopPropagation(),this.refreshIntervalNode.value="0",this.changeImageProperties()}),300)},(0,i.h)("calcite-label",{class:"refresh-interval-label",scale:"s",layout:"inline"},(0,i.h)("calcite-input-number",{class:"refresh-image-input",min:0,max:1440,ref:e=>this.refreshIntervalNode=e,value:this.imageMediaInfo.refreshInterval?`${this.imageMediaInfo.refreshInterval}`:"0",onCalciteInputNumberInput:(0,p.d)((()=>{if(this.refreshIntervalNode.value){const e=Number.parseInt(this.refreshIntervalNode.value);e<0?this.refreshIntervalNode.value="0":e>1440&&(this.refreshIntervalNode.value="1440")}this.changeImageProperties()}),300)}),t.minutes))}renderDoneButton(){const{popupState:e}=this,{strings:t}=e;return(0,i.h)("calcite-button",{appearance:"outline-fill",slot:"footer",width:"full",onClick:()=>this.closePopupPopovers.emit()},t.done)}getImageInputObject(e){const{popupState:t}=this,{strings:o}=t,i={};return i.imageInput=e,i.popoverId=`popoverId_${i.imageInput}`,e===d.I.SOURCE_URL?(i.inputLabel=o.url,i.referenceElement=e=>{this.sourceUrlNode=e},i.inputValue=this.imageMediaInfo.value.sourceURL,i.placeHolder=o.imageUrlPlaceHolder):e===d.I.TITLE?(i.inputLabel=o.title,i.referenceElement=e=>{this.imageTitleNode=e},i.inputValue=this.imageMediaInfo.title,i.placeHolder=o.imageTitlePlaceHolder):e===d.I.CAPTION?(i.inputLabel=o.caption,i.referenceElement=e=>{this.imageCaptionNode=e},i.inputValue=this.imageMediaInfo.caption,i.placeHolder=o.imageCaptionPlaceHolder):e===d.I.ALT_TEXT?(i.inputLabel=o.description,i.referenceElement=e=>{this.imageAltTextNode=e},i.inputValue=this.imageMediaInfo.altText,i.placeHolder=o.describeImage):e===d.I.LINK_URL&&(i.inputLabel=o.link,i.referenceElement=e=>{this.imageLinkNode=e},i.inputValue=this.imageMediaInfo.value.linkURL,i.placeHolder=o.imageLinkUrlPlaceHolder),i}openAttributesList(e){const{popupState:t}=this,{strings:o}=t;this.pickListNode||(this.pickListNode=document.createElement("arcgis-map-config-popup-field-pick-list"),this.pickListNode.popoverProps={refElement:this.panelNode},this.pickListNode.multiple=!1,this.pickListNode.heading=o.addField,this.pickListNode.popupState=t,this.pickListNode.addEventListener("arcgisChange",(t=>{t.stopPropagation();const o=t.detail.selectedFields[0];this.handleFieldPickListChange(o,e)})),this.pickListNode.addEventListener("arcgisClose",(e=>{e.stopPropagation(),this.removeAttributesSelectionPopover()})),document.body.appendChild(this.pickListNode),this.panelNode.disabled=!0)}handleFieldPickListChange(e,t){switch(t){case d.I.SOURCE_URL:(0,m.c)(this.sourceUrlNode,e);break;case d.I.TITLE:(0,m.c)(this.imageTitleNode,e);break;case d.I.CAPTION:(0,m.c)(this.imageCaptionNode,e);break;case d.I.LINK_URL:(0,m.c)(this.imageLinkNode,e);break;case d.I.ALT_TEXT:(0,m.c)(this.imageAltTextNode,e)}this.changeImageProperties()}changeImageProperties(){this.imageMediaInfo.value.sourceURL=this.sourceUrlNode.value,this.imageMediaInfo.title=this.imageTitleNode.value,this.imageMediaInfo.caption=this.imageCaptionNode.value,this.imageMediaInfo.altText=this.imageAltTextNode.value,this.imageMediaInfo.value.linkURL=this.imageLinkNode.value,this.imageMediaInfo.refreshInterval=Number.isNaN(Number.parseInt(this.refreshIntervalNode.value))?0:Number.parseInt(this.refreshIntervalNode.value),(0,i.f)(this.el)}removeAttributesSelectionPopover(){this.pickListNode&&(document.body.removeChild(this.pickListNode),this.pickListNode=void 0),this.panelNode.disabled=!1}get el(){return(0,i.a)(this)}};F.style=".popover{--calcite-popover-z-index:100}.popover-image-div{background-color:var(--calcite-color-foreground-1);padding:var(--calcite-spacing-sm);max-height:calc(60vh - 102px);}.form-input-button{display:flex}.input{width:100%}calcite-text-area{width:100%;--calcite-text-area-min-width:0;--calcite-text-area-min-height:42px}.refresh-interval-label{margin-top:var(--calcite-spacing-sm)}.refresh-image-input{width:5rem}";const L=class{constructor(e){(0,i.r)(this,e),this.arcgisClose=(0,i.c)(this,"arcgisClose",7),this.arcgisDisconnected=(0,i.c)(this,"arcgisDisconnected",7),this.manager=(0,s.u)(this),this.referenceElement=void 0,this.open=!1,this.popupState=void 0}async getPopoverRefElement(){return this.closeActionNode?this.closeActionNode:await new Promise((e=>{setTimeout((()=>{e(this.closeActionNode)}),300)}))}async addStyler(e){this.contentNode?.appendChild(e)}async setOpen(e){this.popoverNode&&(this.popoverNode.open=e,e&&(this.panelNode?.setFocus(),this.popoverNode.reposition()))}async reposition(){this.popoverNode?.reposition()}async setFocus(){this.closeActionNode?.setFocus()}componentDidLoad(){this.closeActionNode?.setFocus()}disconnectedCallback(){this.arcgisDisconnected.emit()}render(){const{popupState:e,referenceElement:t,open:o}=this,{strings:s}=e;return(0,i.h)(i.H,{key:"1582fa611be9813a16fa234f961bf80242994d1a",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"b690e3f714e50ac51617393e470c1bdbaf6d1180",referenceElement:t,open:o,pointerDisabled:!0,triggerDisabled:!0,placement:"leading-start",offsetDistance:0,offsetSkidding:45,label:s.chartStyle,onCalcitePopoverOpen:()=>this.closeActionNode?.setFocus(),ref:e=>this.popoverNode=e},(0,i.h)("calcite-panel",{key:"ace088dda51dcf5b1be53055d8f2779b1b05b606",closable:!1,heading:s.chartStyle,class:"styler-panel",ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisClose.emit(),setTimeout((()=>t.parentElement.focus()),300)}},(0,i.h)("calcite-action",{key:"3ac68cc0e7834c24b0bdf5cf3da5eac76fe4fb90",slot:"header-actions-end",scale:"s",icon:"x",text:s.close,onClick:()=>this.arcgisClose.emit(),ref:e=>this.closeActionNode=e}),(0,i.h)("div",{key:"d8ba409f4948229b59ef233caa68356b38eb9dd1",class:"styler-div",ref:e=>this.contentNode=e}))))}get el(){return(0,i.a)(this)}};function N(e,t,o=!1,i=!0){if(!e||!t)return!1;const s=e.every(((e,i)=>{const s=t[i];return e.r===s.r&&e.g===s.g&&e.b===s.b&&(!o||e.a===s.a)}));return i?s||N(e.slice().reverse(),t,o,!1):s}function A(e,t){return T(e,t)}function T(e,t){if(Array.isArray(e)){for(let o=0;o<e.length;o++){const i=T(e[o],t);if(void 0!==i)return i}return}const o=t(e);return void 0!==o?o:"cim"===e?.type?T(e.data.symbol,t):"CIMSymbolReference"===e?.type||"CIMMarkerGraphic"===e?.type?T(e.symbol,t):"CIMPointSymbol"===e?.type||"CIMPolygonSymbol"===e?.type||"CIMLineSymbol"===e?.type?T(e.symbolLayers,t):"CIMHatchFill"===e?.type?T(e.lineSymbol,t):"CIMVectorMarker"===e?.type?T(e.markerGraphics,t):void 0}function R(e,t,o){const i=t.toJSON();A(e,(e=>{"fill"===o&&("CIMSolidFill"===e?.type&&(e.color=i),"CIMPictureFill"!==e?.type&&"CIMPictureMarker"!==e?.type||(e.tintColor=i)),"stroke"===o&&("CIMSolidStroke"===e?.type&&(e.color=i),"CIMPictureStroke"===e?.type&&(e.tintColor=i))}))}function E(e){if(e.animations?.length)return e;return A(e,(e=>{if(e.animations?.length)return e}))}function O(e,t){const o=A(e,(e=>{if("fill"===t){if("CIMSolidFill"===e?.type)return e.color;if("CIMPictureFill"===e?.type||"CIMPictureMarker"===e?.type)return e.tintColor}if("stroke"===t){if("CIMSolidStroke"===e?.type)return e.color;if("CIMPictureStroke"===e?.type)return e.tintColor}}));return b.e.EsriColor.fromJSON(o)}function z(){return{min:y.m,max:y.a}}function D(e,t){return 0===e.a&&(t.a=1),t}function _(e){return(0,b.b)(e)&&(X(e)||function(e){return!!b.e.cimSymbolUtils.getCIMSymbolColor(e)}(e))||(0,b.d)(e)&&!H(e)||(0,b.f)(e)}function B(e){return(0,b.b)(e)&&X(e)||(0,b.d)(e)||(0,b.h)(e)||(0,b.f)(e)}function H(e){return!("simple-marker"!==e?.type||"x"!==e.style&&"cross"!==e.style)}function U(e,t=e.size){return{...e,size:void 0!==t?$((0,f.p)(t)):0}}function V(e){const t=Number.isInteger(e)?0:2;return Number(e.toFixed(t))}function j(e){const t=Number.isInteger(e)?0:2;return Number(e.toFixed(t))}function $(e){const t=Number.isInteger(e)?0:3;return Number(e.toFixed(t))}function W(e,t){return Number.isNaN(e)?t:V((0,f.a)(e))}function G(e){return e&&"simple-line"!==e.type&&"simple-fill"!==e.type?(0,b.b)(e)?b.e.cimSymbolUtils.getCIMSymbolRotation(e,!0):e.angle??0:0}function J(e){return"CIMTextSymbol"===e.type}function X(e){if(J(e.data.symbol))return!1;const{symbolLayers:t}=e.data.symbol;if(1===t?.length){const[e]=t;if("CIMVectorMarker"!==e.type||e.colorLocked)return!1;const{markerGraphics:o}=e;return 1===o.length&&!J(o[0].symbol)&&Y(o[0].symbol.symbolLayers)}if(2===t?.length){const[e,o]=t;if("CIMVectorMarker"!==e.type||"CIMVectorMarker"!==o.type||e.colorLocked||e.size>o.size)return!1;const i=e.markerGraphics,s=o.markerGraphics;if(1!==i.length||1!==s.length)return!1;const[{symbol:r}]=i,[{symbol:n}]=s;return r&&n&&!J(r)&&!J(n)&&Y(r.symbolLayers)&&function(e){return function(e){return!!e?.find((({type:e})=>"CIMSolidFill"===e))}(e)&&K(e)}(n.symbolLayers)}return!1}function Y(e){return function(e){return!!function(e){return e?.find((({type:e,colorLocked:t})=>"CIMSolidFill"===e&&!t))}(e)}(e)&&K(e)}function K(e){return!!function(e){return e?.find((({type:e})=>"CIMSolidStroke"===e))}(e)}function q(e){return e&&function(e){return y.s.includes(e?.placement)&&"arrow"===e?.style}(e)?e.placement:"none"}function Q(e){if("none"!==e)return{style:"arrow",placement:e}}function Z(e,t){if(e&&t&&function(e){return"color-ramp"===e?.type&&"2d"===e.style}(e)){const o=function(e,t){const o=t.map((e=>e.stops)),i=4;let s=e.map((e=>e.clone())),r=0,n=!1;for(let e=0;e<i;e++){if(o.some((e=>N(s,e,!0,!1)))){n=!0;break}s=(0,y.f)(s,!0),r++}return n?(i-r)%i:null}(t.color,e.colorRamps);if(null!==o&&o>0)return e.colorRamps.map((e=>{const t={...e};for(let e=0;e<o;e++)t.stops=(0,y.f)(t.stops,!0);return t}))}return e?.colorRamps}L.style=".styler-panel{width:328px;min-height:300px}.styler-div{width:100%}";const ee=class{constructor(e){(0,i.r)(this,e),this.arcgisEdit=(0,i.c)(this,"arcgisEdit",7),this.arcgisMarkerChange=(0,i.c)(this,"arcgisMarkerChange",7),this.arcgisFillChange=(0,i.c)(this,"arcgisFillChange",7),this.arcgisFillEnabledChange=(0,i.c)(this,"arcgisFillEnabledChange",7),this.arcgisStrokeChange=(0,i.c)(this,"arcgisStrokeChange",7),this.arcgisStrokeEnabledChange=(0,i.c)(this,"arcgisStrokeEnabledChange",7),this.arcgisSourceIdChange=(0,i.c)(this,"arcgisSourceIdChange",7),this.manager=(0,s.u)(this),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();t&&(this.narrow=t.contentRect.width<=275)})),this.windowResizeObserver=new ResizeObserver((()=>this.checkPopoverMaxHeight())),this.autoOpenFirstBlock=!1,this.autoCalcHeight=!1,this.colorInputEl=[],this.manualBlockOpen=!1,this.updatePreviewSymbol=(0,p.a)((()=>{const e=this.symbol.clone();this.syncSymbolProps(e,{symbolState:{marker:this.marker,fill:this.fill,stroke:this.stroke}}),this.previewSymbol=e}),150),this.setRampInputRef=e=>{this.rampInputEl=e},this.setColorInputRef=e=>{e&&this.colorInputEl?.push(e)},this.onColorRampFillTransparencyChange=e=>{const t=(0,l.t)(e),o=this.fill,i={color:o.color?.map((e=>(0,y.c)({...e,a:t})))};this.fill=i,this.arcgisFillChange.emit(i),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0)},this.onFillColorRampCategoryChange=e=>{const t=e.target.selectedOption.value,o=this.sections?.fill;this.sections={...this.sections,fill:{...o,activeCategory:t}},e.stopPropagation()},this.onColorFillTransparencyChange=e=>{const t=(0,l.t)(e),{fill:o}=this,i={color:(0,y.c)({...o?.color,a:t})};this.fill=i,this.arcgisFillChange.emit(i),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0)},this.onStrokeColorRampCategoryChange=e=>{const t=e.target.selectedOption.value,o=this.sections?.stroke;this.sections={...this.sections,stroke:{...o,activeCategory:t}},e.stopPropagation()},this.onColorStrokeTransparencyChange=e=>{const{stroke:t}=this,o=(0,l.t)(e),i={...t,color:(0,y.c)({...t?.color,a:o})};this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0)},this.onColorRampStrokeTransparencyChange=e=>{const t=(0,l.t)(e),o=this.stroke,i={...o,color:o.color?.map((e=>(0,y.c)({...e,a:t})))};this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0)},this.onStrokeStyleChange=e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-style"),{stroke:o}=this,i={...o,style:t};this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},this.onStrokeArrowChange=e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-arrow"),{stroke:o}=this,i={...o,marker:Q(t)};this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},this.onStrokeWidthChange=e=>this.setStrokeWidth(e),this.onAutoAdjustStrokeChange=e=>{const t=e.currentTarget.checked,{stroke:o}=this,i={...o,autoAdjusted:t};this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.emitEdit(this.symbol),e.stopPropagation()},this.syncSymbolProps=(e,t)=>{const o=t?.symbolState||{marker:this.marker,fill:this.fill,stroke:this.stroke},i=t?.cimChangeContext,s=(0,b.g)(e);return"point"===s?this.syncPointSymbolProps(e,o,i):"line"===s?this.syncLineSymbolProps(e,o,i):this.syncPolygonSymbolProps(e,o,i)},this.syncPointSymbolProps=(e,{fill:t,marker:o,stroke:i},s)=>{const{sections:r}=this,n=void 0!==o?.size?$((0,f.p)(o?.size)):0;if((0,b.d)(e)){const o=H(e);o||(this.isFillColorRamp()?e.color=this.getSampleFillColorRampColor():e.color=r?.fill?.enabled&&t?.color?t.color:(0,y.c)(null)),e.outline&&(this.isStrokeColorRamp()?e.outline.color=this.getSampleStrokeColorRampColor():o&&this.isFillColorRamp()?e.outline.color=this.getSampleFillColorRampColor():e.outline.color=r?.stroke?.enabled&&i?.color?i.color:(0,y.c)(null),e.outline.marker=i?.marker,e.outline.style=i?.style,e.outline.width=void 0!==i?.size?$((0,f.p)(i.size)):0),e.size=n}else(0,b.j)(e)&&(e.height=Math.round(e.height/e.width*n*100)/100,e.width=n);const a=o?.angle?Math.abs(o.angle):0;return(0,b.b)(e)?(s&&["root","original-root"].includes(s)?(b.e.cimSymbolUtils.applyCIMSymbolRotation(e,a,!0),b.e.cimSymbolUtils.scaleCIMSymbolTo(e,n)):e.data.symbol.angle=a,this.isFillColorRamp()?b.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleFillColorRampColor(),{layersToColor:"fill"}):this.isStrokeColorRamp()&&b.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor(),{layersToColor:"outline"})):e.angle=a,e},this.syncLineSymbolProps=(e,{stroke:t},o)=>{const{sections:i}=this,s=void 0!==t?.size?$((0,f.p)(t?.size)):0;return(0,b.h)(e)?(this.isStrokeColorRamp()?e.color=this.getSampleStrokeColorRampColor():e.color=i?.stroke?.enabled&&t?.color?t.color:(0,y.c)(null),"original-root"!==o&&(e.marker=t?.marker,e.style=t?.style,e.width=s)):(0,b.b)(e)&&("root"===o&&b.e.cimSymbolUtils.scaleCIMSymbolTo(e,s),this.isStrokeColorRamp()&&b.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor())),e},this.syncPolygonSymbolProps=(e,{fill:t,stroke:o},i)=>{const{sections:s}=this,r=void 0!==o?.size?$((0,f.p)(o?.size)):0;return(0,b.f)(e)?(this.isFillColorRamp()?e.color=this.getSampleFillColorRampColor():e.color=s?.fill?.enabled&&t?.color?t.color:(0,y.c)(null),this.isStrokeColorRamp()?e.outline.color=this.getSampleStrokeColorRampColor():e.outline.color=s?.stroke?.enabled&&o?.color?o.color:(0,y.c)(null),"original-root"!==i&&(e.outline.width=r,e.outline.style=o?.style)):(0,b.b)(e)&&(this.isFillColorRamp()?b.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleFillColorRampColor(),{layersToColor:"fill"}):this.isStrokeColorRamp()&&b.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor(),{layersToColor:"outline"}),"root"===i&&((0,b.i)(e)?function(e,t){e.data.symbol?.symbolLayers?.forEach((e=>{["CIMSolidStroke","CIMPictureStroke"].includes(e.type)&&(e.width=t)}))}(e,r):b.e.cimSymbolUtils.scaleCIMSymbolTo(e,r))),e},this.onStrokeEnabledChange=e=>{const{sections:t}=this,o=H(this.activeSymbol);this.sections={...t,stroke:{...t?.stroke,enabled:!!o||e}},o||(this.arcgisStrokeEnabledChange.emit({enabled:e,stroke:U(this.stroke)}),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0))},this.onFillEnabledChange=e=>{const{fill:t,sections:o}=this,i=H(this.activeSymbol);this.sections={...o,fill:{...o?.fill,enabled:!i&&e}},i||(this.arcgisFillEnabledChange.emit({enabled:e,fill:t}),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0))},this.onAutoAdjustSizeChange=e=>{const t=e.currentTarget.checked,{marker:o}=this,i={...o,autoAdjusted:t};this.marker=i,this.arcgisMarkerChange.emit(U(i)),this.emitEdit(this.symbol),e.stopPropagation()},this.onSymbolSizeChange=e=>this.setSymbolSize(e),this.onSymbolRotationChange=e=>{const{marker:t,fill:o,stroke:i}=this,s={...t,angle:e,symbol:this.syncSymbolProps(this.symbol,{cimChangeContext:"root",symbolState:{marker:{...t,angle:e},fill:o,stroke:i}})};this.marker=s,this.setInternalSymbol(s.symbol,!0),this.arcgisMarkerChange.emit(U(s))},this.handleAngleAlignmentChange=e=>{const{symbol:t}=this;t.data.symbol.angleAlignment=e,this.setInternalSymbol(t,!0)},this.onSymbolSelect=e=>{const{fill:t,marker:o,sections:i,stroke:s}=this,r="picture-marker"===this.activeSymbol?.type&&"simple-marker"===e.type,n=H(this.activeSymbol),a=H(e),l=n&&!a,c=!n&&a;this.autoOpenFirstBlock=!0;const h=_(e),d=B(e),p={},m=(0,b.b)(this.activeSymbol)&&!(0,b.b)(e);if(m){if((0,b.d)(e)||(0,b.f)(e)){if(h&&"color"===i?.fill?.type&&(p.fill={...t,color:e.color.clone()}),d&&"color"===i?.stroke?.type){const t=e.outline.color.clone();c&&(t.a=1),p.stroke={...s,color:t},(0,b.f)(e)&&(p.stroke.size=e.outline.width,p.stroke.style=e.outline.style)}}else if((0,b.h)(e)&&d&&"color"===i?.stroke?.type){const t=e;p.stroke={...s,size:t.width,color:t.color.clone()}}}else if((0,b.b)(e)){const o=b.e.cimSymbolUtils.getCIMSymbolColor(e);"color"===i?.fill?.type&&(p.fill={...t,color:o}),p.stroke={...s},"line"===this.editGeometry&&(p.stroke.size=$(b.e.cimSymbolUtils.getCIMSymbolSize(e))),"color"===i?.stroke?.type&&(p.stroke.color=o),this.cimStrokeWidthBounds=z()}else if("color-ramp"===i?.fill?.type&&"color"===i?.stroke?.type)a?(this.tempStrokeColorRampStateActiveCategory=i.fill.activeCategory,this.tempStrokeColorRampStateStops=t?.color,this.tempStrokePreviousColorBeforeColorRampSwitch=s?.color,p.stroke={...s,color:this.tempStrokeColorRampStateStops}):l&&(p.fill={...t,color:this.tempStrokeColorRampStateStops},p.stroke={...s,color:this.tempStrokePreviousColorBeforeColorRampSwitch},this.tempStrokeColorRampStateActiveCategory=void 0,this.tempStrokeColorRampStateStops=void 0);else if("color"===i?.fill?.type&&"color-ramp"===i?.stroke?.type){if(c){const e=s?.color?.map((e=>(e.a=1,e)));p.stroke={...s,color:e}}}else if("color"===i?.fill?.type&&"color"===i?.stroke?.type&&c){const e=s?.color?.clone();c&&e&&(e.a=1),p.stroke={...s,color:e}}this.sections={...i,fill:{...i?.fill,open:!a&&i?.fill?.open,enabled:h&&(!a||(0,b.b)(e)||l||r||i?.fill?.enabled)},stroke:{...i?.stroke,enabled:d&&((0,b.b)(e)||c||m&&!a||r||i?.stroke?.enabled)}};const u=p.fill||t,g=p.stroke||s,y={...o,symbol:this.syncSymbolProps(e,{cimChangeContext:"original-root",symbolState:{marker:o,fill:u,stroke:g}})};this.fill=u,this.stroke=g,this.marker=y,this.activeSymbol=e,this.setInternalSymbol(y.symbol,!0,!0),this.arcgisMarkerChange.emit(U(y))},this.addStyles=async()=>{const{portal:e,portalOrInterceptor:t,dir:o,editGeometry:i,mergedStrings:s}=this;if(document.querySelector("arcgis-map-config-symbol-styler-browse-styles"))return;const r=await(0,n.ac)(),a=document.createElement("arcgis-map-config-symbol-styler-browse-styles");a.editGeometry=i,a.dir=o??"rtl",a.portal=t?.portal||t||e||r.getDefault(),a.strings=s,a.excludeItemIds=await(this.symbolPickerElement?.getStyleItemIds())||[],document.body.appendChild(a),a.addEventListener("arcgisSymbolStylerBrowseStylesClose",(e=>{document.body.removeChild(a),e.detail?.length&&(this.activeSourceId=e.detail[0],this.pickerReRenderFlag=!this.pickerReRenderFlag)}))},this.emitEdit=(0,p.d)((async(e,t)=>{const o=e.clone(),i={},{editGeometry:s}=this,r="point"===s,n=!H(e)&&"point"===s||"polygon"===s;r&&(i.marker={...U(this.marker),symbol:o}),n&&(i.fill={...this.fill}),i.stroke={...U(this.stroke)},this.arcgisEdit.emit({symbol:o,info:i,symbolSwitch:t})}),300),this.flipFillColorRamps=()=>{const e=this.sections?.fill,t=this.fill,o="2d"===e.style,i={color:(0,y.f)(t.color,o)};this.sections={...this.sections,fill:{...e,colorRamps:e.colorRamps.map((({stops:e,tags:t,name:i})=>({stops:(0,y.f)(e,o),tags:t,name:i})))}},this.fill=i,this.arcgisFillChange.emit(i),this.emitEdit(this.symbol)},this.renderBlock=e=>(0,i.h)("calcite-block",{collapsible:!0,disabled:e.disabled??!1,heading:e.heading,key:e.key,onCalciteBlockOpen:this.onBlockToggle,onCalciteBlockClose:this.onBlockToggle},e.icon,e.content),this.onBlockToggle=e=>{this.manualBlockOpen?this.manualBlockOpen=!1:(this.rampInputEl?.close(),this.colorInputEl?.forEach((async e=>await(e?.close()))))},this.renderSection=({disabled:e,embedded:t=!1,key:o,sectionContent:s})=>(0,i.h)("arcgis-map-config-symbol-styler-section",{disabled:e,key:o,embedded:t},s.map((({content:e})=>e))),this.flipStrokeColorRamps=()=>{const e=this.sections?.stroke,t=this.stroke,o="2d"===e.style,i={...t,color:(0,y.f)(t.color,o)};this.sections={...this.sections,stroke:{...e,colorRamps:e.colorRamps.map((({stops:e,tags:t,name:i})=>({stops:(0,y.f)(e,o),tags:t.slice(),name:i})))}},this.stroke=i,this.arcgisStrokeChange.emit(U(i)),this.emitEdit(this.symbol)},this.config={},this.popoverProps=void 0,this.initialSourceId=void 0,this.portal=void 0,this.stringOverrides=void 0,this.mode="default",this.cimStrokeWidthBounds=void 0,this.stylerProps=void 0,this.editGeometry=void 0,this.fill=void 0,this.marker=void 0,this.narrow=!1,this.preppingEdit=!0,this.previewSymbol=void 0,this.sections=void 0,this.builtInStrings=(0,r.u)({blocking:!0,propertyName:"builtInStrings"}),this.mergedStrings=(0,r.u)({blocking:!0,propertyName:"mergedStrings"}),this.stroke=void 0,this.symbol=void 0,this.tempStrokeColorRampStateActiveCategory="all",this.pickerReRenderFlag=!1,this.activeSymbol=void 0,this.activeSymbolItem=void 0,this.activeSourceId=void 0,this.state="editing"}connectedCallback(){this.resizeObserver.observe(this.el),this.windowResizeObserver.observe(document.body)}disconnectedCallback(){this.resizeObserver.unobserve(this.el),this.windowResizeObserver.unobserve(document.body)}async componentWillLoad(){await b.e.load(),this.dir=(0,u.b)(this.el);const e=new Intl.NumberFormat(b.e.intl.getLocale(),{style:"percent"}).format(0);this.percentLabelFlip="rtl"===this.dir?e.endsWith("%"):e.startsWith("%"),this.mergedStrings={...this.builtInStrings,...this.stringOverrides}}componentShouldUpdate(e,t,o){return"preppingEdit"!==o||!e}componentDidRender(){if(this.autoOpenFirstBlock&&!this.preppingEdit){const e=this.el.shadowRoot?.querySelector("calcite-block");e&&(this.autoOpenFirstBlock=!1,this.manualBlockOpen=!0,e.open=!0)}}handleStringChanges(){this.mergedStrings={...this.builtInStrings,...this.stringOverrides}}onPanelBack(e){e.stopPropagation()}async edit(e,t){if(!b.e.loaded)return void await new Promise((o=>{setTimeout((()=>{o(this.edit(e,t))}),300)}));const o=function(e){return e?"text"===e.type||"picture-fill"===e.type?`editing symbol of type ${e.type} is not supported`:null:"missing symbol to edit"}(e);if(o)throw new Error(`[symbol-styler] ${o}`);e=await this.checkLineOnlySymbol(e,t);const i=await(0,n.ac)();this.portalOrInterceptor=t.portal||this.portal||i.getDefault(),this.preppingEdit=!0,this.autoOpenFirstBlock=!0;const s=t.sections?.marker,r=t.sections?.fill,a=t.sections?.stroke;this.symbolFilter=t.symbolFilter||("all"===s?.markerType?void 0:s?.markerType),this.editGeometry=(0,b.g)(e);const l=_(e=e.clone()),c=B(e);((0,b.d)(e)||(0,b.f)(e))&&(e.outline?e.outline.color||(e.outline.color=(0,y.c)(null)):e.outline={type:"simple-line",color:(0,y.c)(null)});const h={autoAdjusted:!1,...t.stroke,size:void 0!==t.stroke?.size?W(t.stroke.size,2):2,style:y.A.includes(t.stroke?.style)?t.stroke?.style:"solid"};t.stroke?.marker&&(h.marker=t.stroke.marker),this.sections={marker:{backgroundStyle:"light",optional:!1,enabled:!1,open:s?.open||!1,symbolsOpen:s&&(!("symbolsOpen"in s)||s.symbolsOpen)||!1,sizeOpen:s&&(!("sizeOpen"in s)||s.sizeOpen)||!1,rotationOpen:s&&(!("rotationOpen"in s)||s.rotationOpen)||!1,keepChoice:s?.keepChoice||!1,parts:{...y.B,...s?.parts}},fill:{activeCategory:"all",open:r?.open||!1,optional:r?.optional||!1,enabled:l&&(t.fillEnabled??!0)&&!(0,b.b)(e)&&"color"===r?.type&&!!this.toColorPickerValue(t.fill?.color),type:r?.type,style:r?.style,suggestedColorsOpen:r?.suggestedColorsOpen||!1,customColorOpen:r?.customColorOpen||!1,colorRampsOpen:r?.colorRampsOpen||!1,colorRamps:Z(r,t.fill),transparencyOpen:r?.transparencyOpen||!1,parts:{...y.D,...y.E,...r?.parts}},stroke:{activeCategory:"all",optional:a?.optional||!1,open:a?.open||!1,enabled:c&&(t.strokeEnabled??!0)&&!(0,b.b)(e)&&"color"===a?.type&&!!this.toColorPickerValue(t.stroke?.color),type:a?.type,style:a?.style,suggestedColorsOpen:a?.suggestedColorsOpen||!1,customColorOpen:a?.customColorOpen||!1,colorRampsOpen:a?.colorRampsOpen||!1,colorRamps:Z(a,t.stroke),transparencyOpen:a?.transparencyOpen||!1,extraOpen:a?.extraOpen||!1,extraParts:{...y.F,...a?.extraParts},parts:{...y.D,...y.E,...y.G,...a?.parts}}},this.marker={...t.marker,size:t.marker?.size?W(t.marker.size,0):0,angle:G(e),autoAdjusted:t.marker?.autoAdjusted||!1,symbol:e},this.fill={...t.fill},this.stroke=h,this.activeSymbol=e,this.activeSourceId=s?.keepChoice?this.activeSourceId:void 0,this.activeSymbolItem=s?.keepChoice?this.activeSymbolItem:void 0,this.stylerProps=t,(0,b.b)(e)&&(this.isFillColorRamp()||this.isStrokeColorRamp())&&this.syncSymbolProps(e,{cimChangeContext:"root"}),(0,b.b)(e)&&(this.cimStrokeWidthBounds=z()),this.setInternalSymbol(e,!1),this.preppingEdit=!1}async checkLineOnlySymbol(e,t){if(H(e)){return e=new(await(0,n.az)()),t.fill?.color&&(Array.isArray(t.fill.color)?e.color=t.fill.color[t.fill.color.length-1]:e.color=t.fill.color),t.stroke?.color&&(t.stroke.color=e.outline.color.clone()),(t.stroke?.size||0===t.stroke?.size)&&(t.stroke.size=e.outline.width),t.marker?.size&&(e.size=t.marker.size),this.marker={...t.marker,size:t.marker?.size?W(t.marker.size,0):0,angle:G(e),autoAdjusted:t.marker?.autoAdjusted||!1,symbol:e},this.emitEdit(e),await Promise.resolve(e)}return await Promise.resolve(e)}async setSize(e,t){"stroke"===e&&this.setStrokeWidth(j((0,f.a)(t)),!1),"marker"===e&&this.setSymbolSize(j((0,f.a)(t)),!1)}getLinePatternStyle(e){return{backgroundImage:`url(${(0,i.g)(`./assets/line-patterns/${e}.png`)})`}}getSelectedArrowPatternStyle(){return{backgroundImage:`url(${(0,i.g)("./assets/arrow-pattern-spritesheet.png")})`}}getArrowPatternOptionStyle(){return{backgroundImage:`url(${(0,i.g)("./assets/arrow-pattern-options-spritesheet.png")})`}}hasActiveLineOnlySimpleMarkerSymbol(){const{marker:e,symbol:t}=this;return!!e&&H(t)}hasActivePictureMarkerSymbol(){return"picture-marker"===this.symbol?.type||"picture-marker"===this.activeSymbol?.type}setStrokeWidth(e,t=!0){const{stroke:o}=this,i={...o,size:e<0?0:j(e)};this.stroke=i,t&&this.arcgisStrokeChange.emit(U(i,e)),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),t)}isFillColorRamp(){return"color-ramp"===this.stylerProps?.sections?.fill?.type}isStrokeColorRamp(){return"color-ramp"===this.stylerProps?.sections?.stroke?.type}getSampleFillColorRampColor(){const e=this.sections?.fill,t=this.fill;return this.getSampleColorRampColor(e,t.color)}getSampleStrokeColorRampColor(){const e=this.sections?.stroke,t=this.stroke;return this.getSampleColorRampColor(e,t.color)}getSampleColorRampColor(e,t){const o=t.length;return"2d"===e.style||"discrete"===e.style?t[o-1]:t[Math.floor(o/2)]}setSymbolSize(e,t=!0){const{marker:o,fill:i,stroke:s,symbol:r}=this,n={...o,symbol:this.syncSymbolProps(r,{cimChangeContext:"root",symbolState:{marker:{...o,size:e},fill:i,stroke:s}}),size:e};this.marker=n,this.setInternalSymbol(n.symbol,t),t&&this.arcgisMarkerChange.emit(U(n,e))}render(){if(this.preppingEdit)return(0,i.h)(i.H,null);const e=(0,u.b)(this.el),{sections:t}=this.stylerProps,o=(0,b.b)(this.activeSymbol);return(0,i.h)(i.H,null,(0,i.h)("calcite-flow",{ref:e=>{this.flowEl=e,this.checkPopoverMaxHeight()}},(0,i.h)("calcite-flow-item",{dir:e,key:"main",selected:"editing"===this.state},(0,i.h)("div",{class:"content"},[!1!==t?.marker?.parts?.rotation||!1!==t?.marker?.parts?.preview||!1!==t?.marker?.parts?.size||!1!==t?.marker?.parts?.alignment||!1!==t?.marker?.parts?.baseWidth||"minimal"===this.mode||this.config.displaySymbolsSelectionOnly?this.renderSymbolBlock():null,o||!t?.fill||this.config.displaySymbolsSelectionOnly?null:this.renderFillBlock(),o||!t?.stroke||this.config.displaySymbolsSelectionOnly?null:this.renderStrokeBlock()])),"choosing-symbol"===this.state?this.renderSymbolSelectionPanel():(0,i.h)(i.F,null),"animation"===this.state?this.renderAnimationPanel():(0,i.h)(i.F,null)))}renderSymbolBlock(){const{marker:e,stroke:t}=this.sections,{parts:o}=e,{editGeometry:s,symbol:r}=this,n=(0,b.b)(r),a=[];if((o.preview||this.config.displaySymbolsSelectionOnly)&&a.push({content:this.renderSymbolsSelection()}),this.config.displaySymbolsSelectionOnly)return this.renderSection({key:"marker-symbols",sectionContent:a});if(n&&(this.isFillColorRamp()?a.push({content:this.renderColorRampFillBlock(!0)}):this.isStrokeColorRamp()&&a.push({content:this.renderColorRampStrokeBlock(!0)})),"minimal"===this.mode&&(o.color&&a.push({content:this.renderRootCIMSymbolColorContent()}),o.transparency&&a.push({content:this.renderRootCIMSymbolTransparencyContent()})),"point"===s){if(o.size&&a.push({content:n?this.renderRootCIMSymbolSizeContent():this.renderSymbolSizeContent()}),o.rotation&&a.push({content:this.renderSymbolRotationContent()}),o.alignment&&n){const e=r.data.symbol;a.push({content:this.renderAngleAlignmentContent(e.angleAlignment??"Display")})}if(o.baseWidth&&n){const e=r.data.symbol;a.push({content:this.renderBaseWidthContent(e)})}}else n&&t?.extraParts?.width&&(!(0,b.i)(r)||(0,b.i)(r)&&function(e){const t=e.data.symbol?.symbolLayers?.find((({type:e})=>["CIMSolidStroke","CIMPictureStroke"].includes(e)));return!!t}(r))&&a.push({content:this.renderRootCIMSymbolWidthContent()});if(n){const e=r.data.symbol;"CIMPointSymbol"===e.type&&e.animations&&a.push({content:this.renderCIMAnimationEntryPoint(e,"root-symbol","point")}),a.push({content:this.renderRootCIMSymbolContent(r)})}return a.length?this.renderSection({key:"marker-symbols",sectionContent:a}):(0,i.h)(i.F,null)}renderRootCIMSymbolContent(e){const t=this.renderCIMSymbolLayersContent(e.data.symbol,"root-symbol");return t.length>y.b?[...t.slice(0,y.b),(0,i.h)("div",{class:y.C.message},this.mergedStrings.additionalSymbolLayersNotShown.replace("${count}",y.b.toString()))]:t}renderCIMSymbolLayersContent({symbolLayers:e},t,o=!1,s){return e.filter((({type:e})=>this.isSupportedSymbolLayerType(e))).map(((e,r)=>{const n=`${t}__symbol-layers__symbol-layer__${r.toString()}`;return"CIMVectorMarker"===e.type?this.renderCIMVectorMarkerSymbolLayerBlocks(e,n):"CIMPictureMarker"===e.type?(0,i.h)(i.F,null,this.renderCIMPictureMarkerSymbolLayerBlock(e,n,o),(e.animatedSymbolProperties||e.animations)&&this.renderCIMAnimationEntryPoint(e,n,"picture-marker")):"CIMSolidStroke"===e.type?this.renderCIMSolidStrokeSymbolLayerBlock(e,n,o,s):"CIMPictureStroke"===e.type?this.renderCIMPictureStrokeSymbolLayerBlock(e,n,o):"CIMGradientStroke"===e.type?this.renderCIMGradientSymbolLayerBlock(e,n,o,"stroke"):"CIMSolidFill"===e.type?this.renderCIMSolidFillSymbolLayerBlock(e,n,o):"CIMHatchFill"===e.type?this.renderCIMHatchFillSymbolLayerBlocks(e,n):"CIMPictureFill"===e.type?this.renderCIMPictureFillSymbolLayerBlock(e,n,o):"CIMGradientFill"===e.type?this.renderCIMGradientSymbolLayerBlock(e,n,o,"fill"):(0,i.h)(i.F,null)})).filter(Boolean).flat()}renderSymbolsSelection(){const e=this.previewSymbol,t=e?b.e.previewSymbol2D.getContrastingBackgroundTheme(e,245):"light",o="rtl"===(0,u.b)(this.el),s=1===this.filteredSources?.length&&1===this.activeSymbolItems?.length;return(0,i.h)("calcite-label",{style:{"--symbol-styler-inline-input-trigger-background-color":"dark"===t?"#f3f3f3":""}},this.mergedStrings.currentSymbol,(0,i.h)("button",{class:y.C.changeSymbolTrigger,disabled:s,onClick:()=>this.state="choosing-symbol",type:"button"},(0,i.h)("div",{class:y.C.container,tabIndex:0},(0,i.h)("div",{class:y.C.symbol},(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{symbol:e,options:"point"===this.editGeometry?y.p:"line"===this.editGeometry?y.l:void 0})),(0,i.h)("div",{class:y.C.label},function(e,t){if(!e)return null;if("picture-marker"===e.type||"simple-marker"===e.type)return t.basicPoint;if("simple-line"===e.type)return t.basicLine;if("simple-fill"===e.type)return t.basicPolygon;if("CIMPointSymbol"===e.data.symbol?.type)return t.vectorPoint;if("CIMLineSymbol"===e.data.symbol?.type)return t.vectorLine;if("CIMPolygonSymbol"===e.data.symbol?.type)return t.vectorPolygon;throw new Error("unsupported symbol provided")}(e,this.mergedStrings))),(0,i.h)("calcite-icon",{icon:s?void 0:"chevron-"+(o?"left":"right"),scale:"s"})))}renderAnimationPanel(){const{mergedStrings:e,currentAnimationSymbolLayer:t}=this,o=t,s="CIMPictureMarker"===o.type?o.animations??[{animatedSymbolProperties:o.animatedSymbolProperties,type:"default"}]:o.animations;return(0,i.h)("calcite-flow-item",{class:"animation-panel",heading:e.animation,selected:"animation"===this.state,beforeBack:async()=>{this.state="editing"}},s.map(((t,o)=>{const s=this.getAnimationBlockHeadingInfo(t.type),r=t.animatedSymbolProperties;return(0,i.h)("calcite-block",{iconStart:s.icon,class:"animation-block",heading:s.heading,collapsible:!0,open:0===o},this.renderAnimationSpecificProperty(t),(0,i.h)("div",{class:"animation-checkbox-container"},(0,i.h)("calcite-checkbox",{checked:r.playAnimation,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;r.playAnimation=t,this.setInternalSymbol(this.symbol,!0)}}),(0,i.h)("div",{class:"animation-checkbox-container-text"},e.playAnimation)),(0,i.h)("div",{class:"animation-checkbox-container"},(0,i.h)("calcite-checkbox",{checked:r.reverseAnimation,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;r.reverseAnimation=t,this.setInternalSymbol(this.symbol,!0)}}),(0,i.h)("div",{class:"animation-checkbox-container-text"},e.reverseAnimation)),(0,i.h)("calcite-label",null,e.startTimeOffset,(0,i.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;r.randomizeStartTime="random"===t,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-segmented-control-item",{value:"random",checked:r.randomizeStartTime},e.randomized),(0,i.h)("calcite-segmented-control-item",{value:"manual",checked:!r.randomizeStartTime},e.manualOffset))),(0,i.h)("calcite-label",null,e.manualOffset,(0,i.h)("arcgis-slider-input",{disabled:r.randomizeStartTime,max:y.d,min:y.e,onArcgisValueChange:e=>{const t=e.detail;r.startTimeOffset=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.startTimeOffset??0,withSteppers:!this.narrow,label:e.manualOffset})),(0,i.h)("calcite-label",null,e.duration,(0,i.h)("arcgis-slider-input",{max:y.d,min:y.e,onArcgisValueChange:e=>{const t=e.detail;r.duration=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.duration??0,withSteppers:!this.narrow,label:e.duration})),(0,i.h)("calcite-label",null,e.repeatType,(0,i.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;r.repeatType=t,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-segmented-control-item",{value:"None",checked:"None"===r.repeatType},e.none),(0,i.h)("calcite-segmented-control-item",{value:"Loop",checked:"Loop"===r.repeatType},e.loop),(0,i.h)("calcite-segmented-control-item",{value:"Oscillate",checked:"Oscillate"===r.repeatType},e.oscillate))),(0,i.h)("calcite-label",null,e.repeatDelay,(0,i.h)("arcgis-slider-input",{max:y.d,min:y.e,onArcgisValueChange:e=>{const t=e.detail;r.repeatDelay=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.repeatDelay??0,withSteppers:!this.narrow,label:e.repeatDelay})),r.easing?(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,e.animations.easingType),(0,i.h)("calcite-combobox",{selectionMode:"single-persist",clearDisabled:!0,label:e.animations.easingType,onCalciteComboboxChange:e=>{const t=e.currentTarget.value;r.easing=t,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-combobox-item",{value:"Linear",heading:e.animations.linear,selected:"Linear"===r.easing}),(0,i.h)("calcite-combobox-item",{value:"EaseIn",heading:e.animations.easeIn,selected:"EaseIn"===r.easing}),(0,i.h)("calcite-combobox-item",{value:"EaseOut",heading:e.animations.easeOut,selected:"EaseOut"===r.easing}),(0,i.h)("calcite-combobox-item",{value:"EaseInOut",heading:e.animations.easeInOut,selected:"EaseInOut"===r.easing}))):(0,i.h)(i.F,null))})),(0,i.h)("calcite-button",{width:"full",slot:"footer",onClick:async()=>await(this.flowEl?.back())},e.done))}renderAnimationSpecificProperty(e){const{mergedStrings:t}=this;switch(e.type){case"CIMSymbolAnimationColor":{const o=new b.e.EsriColor(e.toColor),s={...this.popoverProps,offsetDistance:(this.popoverProps?.offsetDistance??10)+50};return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,t.animations.toColor),(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(o),clearable:!1,onArcgisChange:t=>{const o=t.currentTarget.color,i=(0,y.c)(o),s=new b.e.EsriColor(i).toRgb();e.toColor=[...s,255],this.setInternalSymbol(this.symbol,!0)},popoverProps:s,storageId:y.g,ref:this.setColorInputRef}))}case"CIMSymbolAnimationSize":return(0,i.h)("calcite-label",null,t.animations.size,(0,i.h)("arcgis-slider-input",{disabled:!1,min:1,max:150,step:1,unitsLabel:t.px,value:j((0,f.a)(e.toSize)),onArcgisValueChange:t=>{const o=(0,f.p)(t.detail);e.toSize=o,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:t.animations.size}));case"CIMSymbolAnimationRotation":return(0,i.h)(i.F,null,(0,i.h)("div",{class:"animation-checkbox-container"},(0,i.h)("calcite-checkbox",{checked:!!e.rotateClockwise,onCalciteCheckboxChange:t=>{const{checked:o}=t.currentTarget;e.rotateClockwise=o,e.toRotation&&(e.toRotation=360-e.toRotation),this.setInternalSymbol(this.symbol,!0)}}),(0,i.h)("div",{class:"animation-checkbox-container-text"},t.animations.rotateClockwise)),(0,i.h)("calcite-label",null,t.rotation,(0,i.h)("arcgis-slider-input",{min:0,max:360,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:e.toRotation?e.rotateClockwise?360-e.toRotation:e.toRotation:0,onArcgisValueChange:t=>{const o=e.rotateClockwise?360-t.detail:t.detail;e.toRotation=o,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:t.rotation})));case"CIMSymbolAnimationOffset":return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,t.animations.offset),(0,i.h)("div",{class:"offset-div"},(0,i.h)("arcgis-map-config-xy-slider",{x:Math.round((0,f.a)(e.offsetX)),y:-Math.round((0,f.a)(e.offsetY)),minX:-20,minY:-20,maxX:20,maxY:20,step:1,snappable:!0,onArcgisInput:t=>{t.stopPropagation();const o=t.currentTarget;e.offsetX=(0,f.p)(o.x),e.offsetY=-(0,f.p)(o.y),this.setInternalSymbol(this.symbol,!0)}}),(0,i.h)("div",null,(0,i.h)("calcite-label",{scale:"s"},t.animations.xOffset,(0,i.h)("calcite-input-number",{scale:"s",placeholder:t.animations.xOffset,value:`${Math.round((0,f.a)(e.offsetX))}`,inputMode:"decimal",min:-20,max:20,onCalciteInputNumberInput:t=>{const o=t.currentTarget;this.waitOnUser(t,(()=>{e.offsetX=(0,f.p)(Number.parseInt(o.value)),this.setInternalSymbol(this.symbol,!0)}),0)}})),(0,i.h)("calcite-label",{scale:"s"},t.animations.yOffset,(0,i.h)("calcite-input-number",{scale:"s",placeholder:t.animations.yOffset,value:`${Math.round((0,f.a)(e.offsetY))}`,inputMode:"decimal",min:-20,max:20,onCalciteInputNumberInput:t=>{const o=t.currentTarget;this.waitOnUser(t,(()=>{e.offsetY=(0,f.p)(Number.parseInt(o.value)),this.setInternalSymbol(this.symbol,!0)}),0)}})))));case"CIMSymbolAnimationScale":return(0,i.h)("div",{class:"scale-animation-wrapper"},(0,i.h)("calcite-label",null,t.animations.scaleFactor),(0,i.h)("calcite-slider",{min:0,max:3.5,step:.01,minLabel:t.animations.small,maxLabel:t.animations.large,value:e.scaleFactor,onCalciteSliderInput:t=>{const o=t.target.value;e.scaleFactor=o,this.setInternalSymbol(this.symbol,!0)}}),(0,i.h)("div",{class:"scale-animation-slider-labels","aria-hidden":"true"},(0,i.h)("calcite-label",null,t.animations.small),(0,i.h)("calcite-label",null,t.animations.large)));case"CIMSymbolAnimationTransparency":return(0,i.h)("calcite-label",null,t.transparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round(e.toTransparency),onArcgisValueChange:t=>{e.toTransparency=t.detail,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,disabled:!1,label:t.transparency}));default:return(0,i.h)(i.F,null)}}renderSymbolSelectionPanel(){const{dir:e,mergedStrings:t}=this,o=!this.config.hideAddStyles&&window.customElements?.get("arcgis-item-browser");return(0,i.h)("calcite-flow-item",{class:"symbol-selection-panel",dir:e,heading:t.changeSymbol,key:"symbol-selection",selected:"choosing-symbol"===this.state,beforeBack:async()=>{this.state="editing"}},o&&(0,i.h)(i.F,null,(0,i.h)("calcite-action",{id:"add-styles",slot:"header-actions-end",text:t.addStyles,icon:"plus",onClick:async()=>await this.addStyles()}),(0,i.h)("calcite-tooltip",{"reference-element":"add-styles"},t.addStyles)),(0,i.h)("arcgis-map-config-symbol-picker",{hideSvgUploadSymbols:this.config.hideSvgUploadSymbols,hideClassicSymbols:this.config.hideClassicSymbols,onArcgisActiveSymbolChange:e=>{const{detail:t}=e;this.onSymbolSelect(t),e.stopPropagation()},onArcgisActiveSourceIdChange:({detail:e})=>{this.activeSourceId=e,this.arcgisSourceIdChange.emit(e)},onArcgisActiveSymbolItemChange:({detail:e})=>{this.activeSymbolItem=e},onArcgisSymbolSourcesChange:({detail:e})=>this.filteredSources=e,onArcgisActiveSourceItemsChange:({detail:e})=>this.activeSymbolItems=e,activeSymbolItem:this.activeSymbolItem,activeSourceId:this.activeSourceId||this.initialSourceId,portal:this.portalOrInterceptor,style:{"--scroller-max-height":"var(--symbol-scroller-max-height)"},symbolFilter:this.symbolFilter,symbol:this.activeSymbol,key:`${this.pickerReRenderFlag}`,ref:e=>this.symbolPickerElement=e}),(0,i.h)("calcite-button",{width:"full",slot:"footer",onClick:async()=>await(this.flowEl?.back())},t.done))}setInternalSymbol(e,t,o){if(this.symbol=e,"animation"===this.state){let e=this.symbol.data.symbol;if("root-symbol"===this.currentAnimationInfo.symbolLayerKey)this.currentAnimationSymbolLayer=e;else{const t=this.currentAnimationInfo.symbolLayerKey.split("__");for(let o=0;o<t.length;o++)if("symbol-layers"===t[o])e=e.symbolLayers;else if("symbol-layer"===t[o]){const i=t[o+1];e=e[Number.parseInt(i)],o++}"picture-marker"===this.currentAnimationInfo.symbolLayerType?this.currentAnimationSymbolLayer=e:this.currentAnimationSymbolLayer=E(e)}}this.updatePreviewSymbol(),t&&this.emitEdit(e,o)}renderRootCIMSymbolColorContent(){const e=b.e.cimSymbolUtils.getCIMSymbolColor(this.symbol);return(0,l.i)(e)?(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,this.mergedStrings.color),(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(e),clearable:!0,onArcgisChange:t=>{const o=t.currentTarget.color,i=(0,y.c)(o);(0,y.i)(i)||(0,y.i)(e)||(i.a=e.a),b.e.cimSymbolUtils.applyCIMSymbolColor(this.symbol,i),this.setInternalSymbol(this.syncSymbolProps(this.symbol.clone(),{cimChangeContext:"point"===this.editGeometry?"root":"original-root"}),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef})):(0,i.h)(i.F,null)}renderRootCIMSymbolTransparencyContent(){const e=b.e.cimSymbolUtils.getCIMSymbolColor(this.symbol);return(0,l.i)(e)?(0,i.h)("calcite-label",null,this.mergedStrings.transparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,l.p)(e.a??1)),onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o);e.a=i,b.e.cimSymbolUtils.applyCIMSymbolColor(this.symbol,e),this.setInternalSymbol(this.syncSymbolProps(this.symbol.clone(),{cimChangeContext:"point"===this.editGeometry?"root":"original-root"}),!0),t.stopPropagation()},withSteppers:!this.narrow,disabled:!1,label:this.mergedStrings.transparency})):(0,i.h)(i.F,null)}renderRootCIMSymbolSizeContent(){const{sections:e,marker:t}=this,o=e?.marker?.parts?.size,s="object"==typeof o&&o?.autoSizeAdjust,r=b.e.cimSymbolUtils.getCIMSymbolSize(this.symbol);return(0,i.h)("div",{class:y.C.contentGroup},(0,i.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:s&&"editable"!==s&&t?.autoAdjusted,min:1,max:150,step:1,unitsLabel:this.mergedStrings.px,value:j((0,f.a)(r)),onArcgisValueChange:e=>this.onSymbolSizeChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})),s?this.renderAutoAdjust((0,u.b)(this.el),this.marker?.autoAdjusted||!1,this.mergedStrings.autoAdjustSize,this.onAutoAdjustSizeChange):null)}renderRootCIMSymbolWidthContent(){const e=this.symbol,{sections:t,stroke:o}=this,s=t?.stroke?.extraParts?.autoStrokeAdjust,r=(0,u.b)(this.el),n=(0,b.i)(e)?function(e){const t=e.data.symbol?.symbolLayers?.find((e=>["CIMSolidStroke","CIMPictureStroke"].includes(e.type)));return t.width??0}(e):b.e.cimSymbolUtils.getCIMSymbolSize(this.symbol);let a=this.getStrokeString("width"),l=this.cimStrokeWidthBounds?.min,c=this.cimStrokeWidthBounds?.max;if((0,b.a)(e)){const t=e?.data?.symbol?.symbolLayers?.some((e=>["CIMVectorMarker","CIMPictureMarker"].includes(e.type)));t&&(a=this.mergedStrings.symbolSize,l=y.k,c=y.n)}return(0,i.h)("div",{class:y.C.contentGroup},(0,i.h)("calcite-label",{dir:r},a,(0,i.h)("arcgis-slider-input",{disabled:s&&"editable"!==s&&o?.autoAdjusted,min:l,max:c,step:1,unitsLabel:this.mergedStrings.px,value:j((0,f.a)(n)),onArcgisValueChange:e=>this.onStrokeWidthChange(e.detail),withSteppers:!this.narrow,label:a})),s?this.renderAutoAdjust(r,this.stroke?.autoAdjusted||!1,this.mergedStrings.autoAdjustStroke,this.onAutoAdjustStrokeChange):null)}renderSymbolSizeContent(){const{sections:e,marker:t}=this,o=e?.marker?.parts?.size,s=(0,u.b)(this.el),r="object"==typeof o&&o?.autoSizeAdjust;return(0,i.h)("div",{class:y.C.contentGroup},(0,i.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:r&&"editable"!==r&&t?.autoAdjusted,min:1,max:150,step:1,unitsLabel:this.mergedStrings.px,value:t?.size,onArcgisValueChange:e=>this.onSymbolSizeChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})),r?this.renderAutoAdjust(s,t?.autoAdjusted??!1,this.mergedStrings.autoAdjustSize,this.onAutoAdjustSizeChange):null)}renderAutoAdjust(e,t,o,s){return(0,i.h)("calcite-label",{class:y.C.autoAdjustLabel,dir:e,layout:"inline",key:"auto-adjust"},(0,i.h)("calcite-checkbox",{checked:t,class:y.C.autoAdjustCheckbox,onCalciteCheckboxChange:s}),o)}renderSymbolRotationContent(){const{marker:e,mergedStrings:t}=this;return(0,i.h)("calcite-label",null,t.rotation,(0,i.h)("arcgis-slider-input",{min:0,max:360,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:e?.angle,onArcgisValueChange:e=>this.onSymbolRotationChange(e.detail),withSteppers:!this.narrow,label:t.rotation}))}renderAngleAlignmentContent(e){const{mergedStrings:t}=this;return(0,i.h)("calcite-label",null,t.alignment,(0,i.h)("calcite-radio-button-group",{name:"angle-alignment",layout:"horizontal",onCalciteRadioButtonGroupChange:e=>{const t=e.currentTarget.selectedItem.value;this.handleAngleAlignmentChange(t)}},(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-radio-button",{value:"Display",checked:"Display"===e}),t.display),(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-radio-button",{value:"Map",checked:"Map"===e}),t.map)))}renderBaseWidthContent(e){const{mergedStrings:t}=this,o=e.effects?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type));return(0,i.h)("calcite-label",null,t.baseWidth,(0,i.h)("arcgis-slider-input",{min:1,max:10,step:.1,unitsLabel:t.px,flipLabels:this.percentLabelFlip,value:o?.fromWidth??10,onArcgisValueChange:e=>{const t=e.detail;o.fromWidth=t,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:t.baseWidth}))}renderFillBlock(){if(!this.stylerProps?.sections)return(0,i.h)("div",null,";");const{sections:e}=this.stylerProps,{fill:t}=e;return"color"===t?.type?this.renderColorFillBlock():this.renderColorRampFillBlock()}renderColorFillBlock(){const e=this.sections?.fill,{parts:t}=e,o=[];return(t.suggestedColors||t.customColor)&&o.push({content:this.renderFillColorContent()}),t.transparency&&o.push({content:(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:!e.enabled},this.renderColorFillTransparencyContent(this.mergedStrings.fillTransparency,!e.enabled))}),this.renderSection({key:"color-fill",disabled:"non-editable"===e.optional||this.hasActivePictureMarkerSymbol()||this.hasActiveLineOnlySimpleMarkerSymbol(),sectionContent:o})}toColorPickerValue(e,t){if(e&&!(0,y.i)(e)){if(t){const t=(0,l.i)(e.toRgba()[3])?(255*e.toRgba()[3]).toString(16).padStart(2,"0"):"";return`${e.toHex()}${t}`}return e.toHex()}}renderFillColorContent(){const e=this.sections?.fill,t=e?.enabled?this.toColorPickerValue(this.fill?.color):void 0;return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,this.mergedStrings.fillColor),(0,i.h)("arcgis-color-input",{color:t,clearable:!1!==e?.optional,onArcgisChange:t=>{const o=t.currentTarget.color;if(!o)return void this.onFillEnabledChange(!1);e?.enabled||this.onFillEnabledChange(!0);const i=(0,y.c)(o),{color:s}=this.fill,r=D(s,{...s,...i,a:s.a}),n={color:(0,y.c)(r)};this.fill=n,this.arcgisFillChange.emit(n),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))}getStrokeString(e){return this.mergedStrings["line"===this.editGeometry?e:`stroke${t=e,t.charAt(0).toUpperCase()+t.slice(1)}`];var t}isSupportedSymbolLayerType(e){return"CIMVectorMarker"===e||"CIMSolidFill"===e||"CIMSolidStroke"===e||"CIMHatchFill"===e||"CIMPictureFill"===e||"CIMPictureStroke"===e||"CIMPictureMarker"===e||"CIMGradientFill"===e||"CIMGradientStroke"===e}getSymbolLayerPreviewSymbol(e,t){const o={data:{type:"CIMSymbolReference",symbol:{type:"point"===t?"CIMPointSymbol":"line"===t?"CIMLineSymbol":"CIMPolygonSymbol",symbolLayers:[e]}}};return"CIMVectorMarker"===e.type&&((o.data?.symbol).angle=e.rotation??0),new b.e.CIMSymbol(o)}renderCIMVectorMarkerSymbolLayerBlocks(e,t){if("minimal"===this.mode)return(0,i.h)(i.F,null);const{sections:o,marker:s,mergedStrings:r}=this,n=o?.marker?.parts.size,a=o?.marker?.parts.rotation,c=o?.stroke?.extraParts?.autoStrokeAdjust,h="object"==typeof n&&n?.autoSizeAdjust,d=this.getSymbolLayerPreviewSymbol(e,"point"),p=E(e),m=b.e.cimSymbolUtils.getCIMSymbolSize(d),u=b.e.cimSymbolUtils.getCIMSymbolRotation(d,!0),g=function(e){const t=new Set;let o=A(e,(e=>{if("CIMSolidFill"===e?.type||"CIMHatchFill"===e?.type||"CIMPictureFill"===e?.type||"CIMPictureMarker"===e?.type)return"fill"}));return o&&t.add(o),o=A(e,(e=>{if("CIMSolidStroke"===e?.type||"CIMPictureStroke"===e?.type)return"stroke"})),o&&t.add(o),Array.from(t).filter(Boolean)}(e),C=[];if(g.includes("fill")&&(!this.isFillColorRamp()||e.colorLocked)){const t=O(e,"fill"),o=[(0,i.h)(i.F,null,(0,i.h)("calcite-label",{key:"fill-color"},1===g.length?r.color:r.fillColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(t),clearable:!0,onArcgisChange:o=>{const i=(0,y.c)(o.currentTarget.color);(0,y.i)(i)||(0,y.i)(t)||(i.a=t.a),R(e,i,"fill"),this.setInternalSymbol(this.symbol,!0),o.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))),(0,i.h)("calcite-label",{key:"fill-transparency"},1===g.length?r.transparency:r.fillTransparency,(0,i.h)("arcgis-slider-input",{min:y.o,max:y.h,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,l.p)(t.a)),onArcgisValueChange:o=>{const i=o.detail,s=(0,l.t)(i),r=t.clone();r.a=s,R(e,r,"fill"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===g.length?r.transparency:r.fillTransparency}))];C.push(o)}if(g.includes("stroke")){const t=O(e,"stroke"),o=function(e,t){let o=0;return A(e,(e=>{"fill"===t&&("CIMVectorMarker"!==e?.type&&"CIMPictureMarker"!==e?.type||void 0!==e.size&&e.size>o&&(o=e.size)),"stroke"===t&&("CIMSolidStroke"!==e?.type&&"CIMPictureStroke"!==e?.type||void 0!==e.width&&e.width>o&&(o=e.width))})),o}(e,"stroke"),s=[(0,i.h)(i.F,null,(0,i.h)("calcite-label",{key:"stroke-color"},1===g.length?r.color:r.strokeColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(t),clearable:!0,onArcgisChange:o=>{const i=(0,y.c)(o.currentTarget.color);(0,y.i)(i)||(0,y.i)(t)||(i.a=t.a),R(e,i,"stroke"),this.setInternalSymbol(this.symbol,!0),o.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))),(0,i.h)("calcite-label",{key:"stroke-transparency"},1===g.length?r.transparency:r.strokeTransparency,(0,i.h)("arcgis-slider-input",{min:y.o,max:y.h,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,l.p)(t.a)),onArcgisValueChange:o=>{const i=o.detail,s=(0,l.t)(i),r=t.clone();r.a=s,R(e,r,"stroke"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===g.length?r.transparency:r.strokeTransparency})),(0,i.h)("calcite-label",{key:"stroke-width"},1===g.length?r.width:r.strokeWidth,(0,i.h)("arcgis-slider-input",{disabled:c&&"editable"!==c&&this.stroke?.autoAdjusted,min:this.cimStrokeWidthBounds?.min,max:this.cimStrokeWidthBounds?.max,step:1,unitsLabel:r.px,value:j((0,f.a)(o)),onArcgisValueChange:t=>{const o=t.detail;!function(e,t,o){A(e,(e=>{"fill"===o&&("CIMVectorMarker"!==e?.type&&"CIMPictureMarker"!==e?.type||(e.size=t)),"stroke"===o&&("CIMSolidStroke"!==e?.type&&"CIMPictureStroke"!==e?.type||(e.width=t))}))}(e,$((0,f.p)(o)),"stroke"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===g.length?r.width:r.strokeWidth}))];C.push(s)}const S=(0,i.h)("div",{class:y.C.contentGroup,key:`${t}__vector-marker-symbol-layer`},[...C],n&&(0,i.h)("calcite-label",null,r.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:h&&"editable"!==h&&s?.autoAdjusted,min:y.k,max:y.n,step:1,unitsLabel:r.px,value:j((0,f.a)(m)),onArcgisValueChange:e=>{const t=e.detail;this.setMarkerSymbolLayerSize(d,t),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:r.symbolSize})),a&&(0,i.h)("calcite-label",null,r.rotation,(0,i.h)("arcgis-slider-input",{min:y.r,max:y.j,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:V(u),onArcgisValueChange:e=>{const t=e.detail;b.e.cimSymbolUtils.applyCIMSymbolRotation(d,V(t),!0),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:r.rotation})),this.renderCIMMarkerPlacementSection(e),this.renderCIMAnimationEntryPoint(p,t,"vector-marker")),v=this.getSymbolLayerPreviewSymbol(this.sanitizePointPreviewSymbolLayer(e),"point");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__symbol-layer-preview`,symbol:v,options:y.p,slot:"icon"}),key:`${t}__symbol-layer`,heading:r.vectorMarker,content:S})}setMarkerSymbolLayerSize(e,t){(0,b.c)(this.activeSymbol)?(e.data.symbol?.symbolLayers?.[0]).size=$((0,f.p)(t)):b.e.cimSymbolUtils.scaleCIMSymbolTo(e,$((0,f.p)(t)))}renderCIMSolidFillSymbolLayerBlock(e,t,o=!1){if("minimal"===this.mode)return(0,i.h)(i.F,null);const s=(0,y.c)(e.color,!0),r=(0,y.i)(s);let n=null,a=null;this.isFillColorRamp()&&!e.colorLocked||(n=(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,this.mergedStrings.fillColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const o=(0,y.c)(t.currentTarget.color);(0,y.i)(o)||r||(o.a=s.a),e.color=o.toJSON();const i=this.sections?.stroke?.extraParts?.hideColor;if(i){const e=this.symbol.data.symbol.symbolLayers?.find((e=>"CIMSolidStroke"===e.type));e&&(e.color=[o.r,o.g,o.b,255])}this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))),a=(0,i.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:y.o,max:y.h,step:1,unitsLabel:"%",value:Math.round((0,l.p)(s.a)),disabled:r,onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o),r=s.clone();r.a=i,e.color=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})));const c=n||a?(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__solid-fill-symbol-layer-content`},n,(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:r},a)):(0,i.h)("calcite-label",null,this.mergedStrings.emptySymbolLayerMsg);if(o)return c;const h=this.getSymbolLayerPreviewSymbol(e,"polygon");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-fill-symbol-layer-preview`,symbol:h,slot:"icon"}),heading:this.mergedStrings.solidFill,key:`${t}__solid-fill-symbol-layer`,content:c})}renderCIMSolidStrokeSymbolLayerBlock(e,t,o=!1,s){if("minimal"===this.mode)return(0,i.h)(i.F,null);const r=(0,y.c)(e.color,!0),n="CIMHatchFill"===s?.type,a=n&&this.isFillColorRamp(),c=this.sections?.stroke?.extraParts.autoStrokeAdjust,h=(0,y.i)(r),d=this.sections?.stroke?.extraParts?.hideColor,p=this.sections?.stroke?.extraParts?.hideTransparency;let m=null,u=null;this.isStrokeColorRamp()&&!e.colorLocked||(m=(0,i.h)(i.F,null,(0,i.h)("calcite-label",{key:"stroke-color"},o?this.mergedStrings.strokeColor:this.mergedStrings.color),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(r),clearable:!0,onArcgisChange:t=>{const o=(0,y.c)(t.currentTarget.color);(0,y.i)(o)||h||(o.a=r.a),e.color=o.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))),u=(0,i.h)("calcite-label",{key:"stroke-transparency"},o?this.mergedStrings.strokeTransparency:this.mergedStrings.transparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:y.o,max:y.h,step:1,unitsLabel:"%",value:Math.round((0,l.p)(r.a)),disabled:h,onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o),s=r.clone();s.a=i,e.color=s.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:o?this.mergedStrings.strokeTransparency:this.mergedStrings.transparency})));const g=(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__solid-stroke-symbol-layer-content`},a||d?null:m,(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:h},a||p?null:u,(0,i.h)("calcite-label",null,o?this.mergedStrings.strokeWidth:this.mergedStrings.width,(0,i.h)("arcgis-slider-input",{disabled:h||c&&"editable"!==c&&this.stroke?.autoAdjusted,min:this.cimStrokeWidthBounds?.min,max:this.cimStrokeWidthBounds?.max,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.width?j((0,f.a)(e.width)):0,onArcgisValueChange:t=>{const o=t.detail;e.width=$((0,f.p)(o)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:o?this.mergedStrings.strokeWidth:this.mergedStrings.width}))),n?this.renderCIMHatchFillPatternSection(s):null);if(o)return g;const b=n?this.getSymbolLayerPreviewSymbol({...s,lineSymbol:{type:"CIMLineSymbol",symbolLayers:[e]}},"polygon"):this.getSymbolLayerPreviewSymbol(e,"line");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-stroke-symbol-layer-preview`,symbol:b,slot:"icon"}),heading:n?this.mergedStrings.hatchFill:this.mergedStrings.solidStroke,key:`${t}__solid-stroke-symbol-layer`,content:g})}renderCIMHatchFillSymbolLayerBlocks(e,t){return this.renderCIMSymbolLayersContent(e.lineSymbol,`${t}__hatch-symbol-fill-symbol-layers`,!1,e).flat()}renderCIMHatchFillPatternSection(e){const{mergedStrings:t}=this,o=e.offsetX??0;return(0,i.h)("calcite-block-section",{key:"hatch-fill-pattern",text:t.pattern},(0,i.h)("calcite-label",null,t.rotation,(0,i.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:y.j,min:y.r,onArcgisValueChange:t=>{const o=t.detail;e.rotation=Math.abs(o),this.setInternalSymbol(this.symbol,!0)},step:1,unitsLabel:"\xba",value:e.rotation??0,withSteppers:!this.narrow,label:t.rotation})),(0,i.h)("calcite-label",null,t.separation,(0,i.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:y.u,min:y.v,onArcgisValueChange:t=>{const o=t.detail;e.separation=o,this.setInternalSymbol(this.symbol,!0)},step:1,value:e.separation??0,unitsLabel:t.px,withSteppers:!this.narrow,label:t.separation})),(0,i.h)("calcite-label",null,t.offset,(0,i.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:y.q,min:y.t,onArcgisValueChange:t=>{const o=t.detail;e.offsetX=o,e.offsetY=o,this.setInternalSymbol(this.symbol,!0)},step:1,value:o,unitsLabel:t.px,withSteppers:!this.narrow,label:t.offset})))}renderCIMPictureMarkerSymbolLayerBlock(e,t,o=!1){if("minimal"===this.mode)return(0,i.h)(i.F,null);const s=(0,y.c)(e.tintColor,!0),{sections:r,marker:n}=this,a=r?.marker?.parts.size,c="object"==typeof a&&a?.autoSizeAdjust,h=this.getSymbolLayerPreviewSymbol(e,"point"),d=(0,y.i)(s),p=(0,i.h)("div",{key:`${t}__picture-marker-symbol-layer`},(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__picture-marker-symbol-layer-content`},(0,i.h)("calcite-label",null,this.mergedStrings.fillColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const o=(0,y.c)(t.currentTarget.color);(0,y.i)(o)||d||(o.a=s.a),e.tintColor=o.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef})),(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:d},(0,i.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:y.o,max:y.h,step:1,unitsLabel:"%",value:Math.round((0,l.p)(s.a)),disabled:d,onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o),r=s.clone();r.a=i,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,i.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:d||c&&"editable"!==c&&n?.autoAdjusted,min:y.k,max:y.n,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.size?j((0,f.a)(e.size)):0,onArcgisValueChange:e=>{const t=e.detail;this.setMarkerSymbolLayerSize(h,t),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})))),this.renderCIMMarkerPlacementSection(e));if(o)return p;const m=this.getSymbolLayerPreviewSymbol(this.sanitizePointPreviewSymbolLayer(e),"point");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-fill-symbol-layer-preview`,symbol:m,options:y.p,slot:"icon"}),heading:this.mergedStrings.pictureMarker,key:`${t}__picture-marker-symbol-layer`,content:p})}sanitizePointPreviewSymbolLayer(e){return{...e,markerPlacement:void 0}}renderCIMPictureStrokeSymbolLayerBlock(e,t,o=!1){if("minimal"===this.mode)return(0,i.h)(i.F,null);const s=(0,y.c)(e.tintColor,!0),{sections:r,marker:n}=this,a=r?.marker?.parts.size,c="object"==typeof a&&a?.autoSizeAdjust,h=(0,y.i)(s),d=(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__picture-stroke-symbol-layer-content`},(0,i.h)("calcite-label",null,this.mergedStrings.fillColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const o=(0,y.c)(t.currentTarget.color);(0,y.i)(o)||h||(o.a=s.a),e.tintColor=o.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef})),(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:h},(0,i.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:y.o,max:y.h,step:1,unitsLabel:"%",value:Math.round((0,l.p)(s.a)),disabled:h,onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o),r=s.clone();r.a=i,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,i.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:h||c&&"editable"!==c&&n?.autoAdjusted,min:y.k,max:y.n,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.width?j((0,f.a)(e.width)):0,onArcgisValueChange:t=>{const o=t.detail;e.width=$((0,f.p)(o)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize}))));if(o)return d;const p=this.getSymbolLayerPreviewSymbol(e,"line");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__picture-stroke-symbol-layer-preview`,symbol:p,slot:"icon"}),heading:this.mergedStrings.pictureStroke,key:`${t}__picture-stroke-symbol-layer`,content:d})}renderCIMPictureFillSymbolLayerBlock(e,t,o=!1){if("minimal"===this.mode)return(0,i.h)(i.F,null);const s=(0,y.c)(e.tintColor,!0),{sections:r,marker:n}=this,a=r?.marker?.parts.size,c="object"==typeof a&&a?.autoSizeAdjust,h=(0,y.i)(s),d=(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__picture-fill-symbol-layer-content`},(0,i.h)("calcite-label",null,this.mergedStrings.fillColor),(0,i.h)("div",{class:"input-color"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const o=(0,y.c)(t.currentTarget.color);(0,y.i)(o)||h||(o.a=s.a),e.tintColor=o.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef})),(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:h},(0,i.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:y.o,max:y.h,step:1,unitsLabel:"%",value:Math.round((0,l.p)(s.a)),disabled:h,onArcgisValueChange:t=>{const o=t.detail,i=(0,l.t)(o),r=s.clone();r.a=i,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,i.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,i.h)("arcgis-slider-input",{disabled:h||c&&"editable"!==c&&n?.autoAdjusted,min:y.k,max:y.n,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.height?j((0,f.a)(e.height)):0,onArcgisValueChange:t=>{const o=t.detail;e.height=$((0,f.p)(o)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize}))));if(o)return d;const p=this.getSymbolLayerPreviewSymbol(e,"polygon");return this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__picture-fill-symbol-layer-preview`,symbol:p,slot:"icon"}),heading:this.mergedStrings.pictureFill,key:`${t}__picture-fill-symbol-layer`,content:d})}renderCIMGradientSymbolLayerBlock(e,t,o=!1,s){const{mergedStrings:r,sections:n,stroke:a}=this;if("minimal"===this.mode)return(0,i.h)(i.F,null);const l="rtl"===(0,u.b)(this.el),c=this.getSymbolLayerPreviewSymbol(e,"fill"===s?"polygon":"line"),h=n?.stroke?.extraParts?.autoStrokeAdjust,d=this.cimStrokeWidthBounds?.min,p=this.cimStrokeWidthBounds?.max,m="fill"===s&&n?.fill?.parts?.hideColorRamp||"stroke"===s&&n?.stroke?.parts?.hideColorRamp,g=(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,key:`${t}__gradient-${s}-symbol-layer-content`},!m&&(0,i.h)("calcite-block",{collapsible:!1,open:!0},this.renderGradientColorRampsContent(e,s)),(0,i.h)("calcite-block",{heading:r.gradient.pattern,collapsible:!0,open:!0,class:"no-top-margin"},"fill"===s&&(0,i.h)("div",{class:"gradient-margin"},(0,i.h)("calcite-label",null,r.gradient.direction),(0,i.h)("calcite-combobox",{selectionMode:"single-persist",clearDisabled:!0,label:r.gradient.direction,onCalciteComboboxChange:t=>{const o=t.currentTarget.value;e.gradientMethod=o,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-combobox-item",{value:"Linear",heading:r.gradient.linear,selected:"Linear"===e.gradientMethod}),(0,i.h)("calcite-combobox-item",{value:"Rectangular",heading:r.gradient.rectangular,selected:"Rectangular"===e.gradientMethod}),(0,i.h)("calcite-combobox-item",{value:"Circular",heading:r.gradient.circular,selected:"Circular"===e.gradientMethod}))),"stroke"===s&&(0,i.h)("calcite-label",null,r.width,(0,i.h)("arcgis-slider-input",{disabled:h&&"editable"!==h&&a?.autoAdjusted,min:d,max:p,step:1,unitsLabel:this.mergedStrings.px,value:j((0,f.a)(e.width)),onArcgisValueChange:t=>{e.width=$((0,f.p)(t.detail)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:r.width})),(0,i.h)("div",{class:"gradient-margin"},(0,i.h)("calcite-label",null,r.gradient.type),(0,i.h)("calcite-combobox",{selectionMode:"single-persist",clearDisabled:!0,label:r.gradient.type,onCalciteComboboxChange:t=>{const o=t.currentTarget.value;e.gradientType=o,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-combobox-item",{value:"Continuous",heading:r.gradient.continuous,selected:"Continuous"===e.gradientType}),(0,i.h)("calcite-combobox-item",{value:"Discrete",heading:r.gradient.discrete,selected:"Discrete"===e.gradientType}))),"Discrete"===e.gradientType&&(0,i.h)("calcite-label",null,r.gradient.interval,(0,i.h)("arcgis-slider-input",{max:100,min:1,onArcgisValueChange:t=>{e.interval=t.detail,this.setInternalSymbol(this.symbol,!0)},step:1,value:e.interval,withSteppers:!this.narrow,label:r.gradient.interval})),(0,i.h)("div",{class:"gradient-margin"},(0,i.h)("calcite-label",null,r.gradient.extent),(0,i.h)("calcite-combobox",{selectionMode:"single-persist",clearDisabled:!0,label:r.gradient.extent,onCalciteComboboxChange:t=>{const o=t.currentTarget.value;"Relative"===o&&e.gradientSize&&e.gradientSize>100&&(e.gradientSize=100),e.gradientSizeUnits=o,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-combobox-item",{value:"Absolute",heading:r.gradient.absolute,selected:"Absolute"===e.gradientSizeUnits}),(0,i.h)("calcite-combobox-item",{value:"Relative",heading:r.gradient.relative,selected:"Relative"===e.gradientSizeUnits}))),(0,i.h)("calcite-label",null,r.gradient.size,"Relative"===e.gradientSizeUnits?(0,i.h)("arcgis-slider-input",{max:100,min:1,onArcgisValueChange:t=>{e.gradientSize=t.detail,this.setInternalSymbol(this.symbol,!0)},step:1,value:e.gradientSize,flipLabels:this.percentLabelFlip,unitsLabel:"%",withSteppers:!this.narrow,label:r.gradient.size}):(0,i.h)("calcite-input-number",{label:r.gradient.size,scale:"s",inputMode:"decimal",min:1,max:Number.MAX_SAFE_INTEGER,step:1,value:`${j((0,f.a)(e.gradientSize??75))}`,numberButtonType:this.narrow?"none":"vertical",prefixText:l?r.px:"",suffixText:l?"":r.px,onCalciteInputNumberInput:t=>{const o=t.currentTarget;this.waitOnUser(t,(()=>{e.gradientSize=(0,f.p)(Number.parseInt(o.value)),this.setInternalSymbol(this.symbol,!0)}),0)}}))));return o?g:this.renderBlock({icon:(0,i.h)("arcgis-map-config-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__gradient-${s}-symbol-layer-preview`,symbol:c,slot:"icon"}),heading:"fill"===s?r.gradient.gradientFill:r.gradient.gradientStroke,key:`${t}__gradient-${s}-symbol-layer`,content:g})}renderCIMAnimationEntryPoint(e,t,o){if(!e)return(0,i.h)(i.F,null);const{mergedStrings:s,config:r}=this,{hideAnimation:n}=r,a="rtl"===(0,u.b)(this.el);return e.animations?.length??("CIMPictureMarker"===e.type&&e.animatedSymbolProperties)?(0,i.h)("calcite-label",null,(0,i.h)("button",{disabled:n,class:n?y.C.changeSymbolTriggerDisabled:y.C.changeSymbolTrigger,onClick:()=>{this.currentAnimationSymbolLayer=e,this.currentAnimationInfo={symbolLayerKey:t,symbolLayerType:o},this.state="animation"},type:"button"},(0,i.h)("div",{class:y.C.container,tabIndex:0},(0,i.h)("div",{class:`${y.C.label} animation-label`},s.animation)),(0,i.h)("calcite-icon",{icon:"chevron-"+(a?"left":"right"),scale:"s"}))):(0,i.h)(i.F,null)}renderCIMMarkerPlacementSection(e){const{dir:t,mergedStrings:o}=this,{markerPlacement:s}=e;return"CIMMarkerPlacementInsidePolygon"!==s?.type||"Random"!==s?.gridType&&"Fixed"!==s?.gridType?(0,i.h)(i.F,null):(0,i.h)("calcite-block-section",{key:"marker-placement",text:o.markerPlacement},(0,i.h)("calcite-label",null,o.gridType,(0,i.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;s.gridType=t,this.setInternalSymbol(this.symbol,!0)}},(0,i.h)("calcite-segmented-control-item",{value:"Fixed",checked:"Fixed"===s.gridType},o.fixed),(0,i.h)("calcite-segmented-control-item",{value:"Random",checked:"Random"===s.gridType},o.random))),(0,i.h)("calcite-label",null,o.randomness,(0,i.h)("arcgis-slider-input",{disabled:"Fixed"===s.gridType,flipLabels:this.percentLabelFlip,max:y.y,min:y.z,onArcgisValueChange:e=>{const t=e.detail;s.randomness=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:s.randomness,unitsLabel:"%",withSteppers:!this.narrow,label:o.randomness})),(0,i.h)("calcite-label",null,o.stepX,(0,i.h)("arcgis-slider-input",{max:y.w,min:y.x,onArcgisValueChange:e=>{const t=e.detail;s.stepX=$((0,f.p)(t)),this.setInternalSymbol(this.symbol,!0)},step:1,value:void 0!==s.stepX?j((0,f.a)(s.stepX)):0,unitsLabel:o.px,withSteppers:!this.narrow,label:o.stepX})),(0,i.h)("calcite-label",null,o.stepY,(0,i.h)("arcgis-slider-input",{max:y.w,min:y.x,onArcgisValueChange:e=>{const t=e.detail;s.stepY=$((0,f.p)(t)),this.setInternalSymbol(this.symbol,!0)},step:1,unitsLabel:o.px,value:void 0!==s.stepY?j((0,f.a)(s.stepY)):0,withSteppers:!this.narrow,label:o.stepY})),(0,i.h)("calcite-label",{dir:t,layout:"inline"},(0,i.h)("calcite-checkbox",{checked:s.shiftOddRows&&"Fixed"===s.gridType,disabled:"Random"===s.gridType,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;s.shiftOddRows=t,this.setInternalSymbol(this.symbol,!0)}}),o.shiftOddRows))}renderColorFillTransparencyContent(e,t){const{fill:o}=this;return(0,i.h)("calcite-label",null,e,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,l.p)(o?.color?.a??1)),onArcgisValueChange:e=>this.onColorFillTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:t,label:e}))}renderColorRampFillBlock(e=!1){const t=this.sections?.fill,{parts:o}=t;if(this.hasActivePictureMarkerSymbol()||this.hasActiveLineOnlySimpleMarkerSymbol())return(0,i.h)(i.F,null);const s=[];return o.colorRamps&&s.push({content:this.renderFillColorRampsContent()}),o.transparency&&s.push({content:this.renderColorRampFillTransparencyContent()}),this.renderSection({key:"color-ramp-fill",disabled:"non-editable"===t.optional,embedded:e,sectionContent:s})}renderFillColorRampsContent(){const{style:e}=this.stylerProps?.sections?.fill,{activeCategory:t,colorRamps:o}=this.sections?.fill;return this.renderRampsContent({style:e,activeCategory:t,colorRampStops:this.fill?.color,colorRamps:o,heading:this.mergedStrings.colors,onCategoryChange:this.onFillColorRampCategoryChange,isSelected:t=>{const o=this.fill?.color;return N(o,t.stops,"2d"===e)},onSelect:e=>{const{detail:t}=e,o=t.stops.slice(),{fill:i}=this,s={...i,color:o};this.fill=s,this.tempStrokeColorRampStateStops=o,this.arcgisFillChange.emit(s),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0),e.stopPropagation()},onFlip:this.flipFillColorRamps})}renderGradientColorRampsContent(e,t){const{activeCategory:o}="fill"===t?this.sections?.fill:this.sections?.stroke,s="fill"===t?this.sections.fill:this.sections.stroke;let r=e.colorRamp,n=[],a=["CIMLinearContinuousColorRamp","CIMPolarContinuousColorRamp"].includes(r.type);if("CIMMultipartColorRamp"===r.type&&1===r.colorRamps.length&&(a=!0,r=r.colorRamps[0]),a){const e=b.e.esriLang.clone(r.fromColor),t=b.e.esriLang.clone(r.toColor);e[3]=e[3]/255,t[3]=t[3]/255,n=[new b.e.EsriColor(e),new b.e.EsriColor(t)]}else{n=r.colorRamps.map((e=>new b.e.EsriColor(e.fromColor)));const e=r.colorRamps[r.colorRamps.length-1];n.push(new b.e.EsriColor(e.toColor))}if("stroke"===t&&this.sections?.stroke&&!this.sections.stroke.colorRamps||"fill"===t&&this.sections?.fill&&!this.sections.fill.colorRamps){const e=b.e.colorRamps.all().filter((e=>e.colors.length<=10)).map((e=>({name:e.name,tags:e.tags,stops:a?[e.colors[0],e.colors[e.colors.length-1]]:e.colors})));s.colorRamps=e}const l=s.colorRamps;return(0,i.h)(i.F,null,this.renderRampsContent({style:"continuous",activeCategory:o,colorRampStops:n,colorRamps:l,allowTransparency:!0,heading:"fill"===t?this.mergedStrings.colors:this.getStrokeString("color"),onCategoryChange:"fill"===t?this.onFillColorRampCategoryChange:this.onStrokeColorRampCategoryChange,isSelected:e=>N(n,e.stops),onSelect:o=>{const{detail:i}=o,s=i.stops.slice(),{fill:r,stroke:n}=this,a="fill"===t?{...r,color:s}:{...n,color:s};"fill"===t?(this.fill=a,this.arcgisFillChange.emit(a)):(this.stroke=a,this.arcgisStrokeChange.emit(a));const l="fill"===t?this.fill:this.stroke;if(2===l.color.length){const t=l.color;"CIMMultipartColorRamp"===e.colorRamp.type?(e.colorRamp.colorRamps[0].fromColor=t[0].toJSON(),e.colorRamp.colorRamps[0].toColor=t[1].toJSON()):(e.colorRamp.fromColor=t[0].toJSON(),e.colorRamp.toColor=t[t.length-1].toJSON())}else{const t=[];for(let e=0;e<a.color.length-1;e++)t.push({type:"CIMLinearContinuousColorRamp",fromColor:a.color[e].toJSON(),toColor:a.color[e+1].toJSON()});const o={type:"CIMMultipartColorRamp",colorRamps:t,weights:new Array(t.length).fill(1/t.length)};e.colorRamp=o}const c=this.sections?.stroke?.extraParts?.hideColor;if(c){const e=this.symbol.data.symbol.symbolLayers?.find((e=>"CIMSolidStroke"===e.type));if(e){const t=s[0];e.color=[t.r,t.g,t.b,255]}}this.setInternalSymbol(this.symbol,!0),o.stopPropagation()},onFlip:()=>{const o=e.colorRamp,i="fill"===t?this.fill:this.stroke,s=(0,y.f)(n,!1);if(["CIMLinearContinuousColorRamp","CIMLinearContinuousColorRamp","CIMPolarContinuousColorRamp"].includes(o.type))o.fromColor=s[0].toJSON(),o.toColor=s[s.length-1].toJSON();else{const e=[];for(let t=0;t<s.length-1;t++)e.push({type:"CIMLinearContinuousColorRamp",fromColor:s[t].toJSON(),toColor:s[t+1].toJSON()});o.colorRamps=e,o.weights=new Array(e.length).fill(1/e.length)}const r=this.sections?.stroke?.extraParts?.hideColor;if(r){const e=this.symbol.data.symbol.symbolLayers?.find((e=>"CIMSolidStroke"===e.type));if(e){const t=s[0];e.color=[t.r,t.g,t.b,255]}}this.setInternalSymbol(this.symbol,!0),i.color=s,"fill"===t?this.flipFillColorRamps():this.flipStrokeColorRamps()}}),2===n.length?(0,i.h)("div",{class:"gradient-color-inputs"},(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(n[1],!0),clearable:!1,onArcgisChange:t=>{const o=t.currentTarget.color,i=(0,y.c)(o),s=new b.e.EsriColor(i).toRgba();s[3]=255*s[3],"CIMMultipartColorRamp"===e.colorRamp.type?e.colorRamp.colorRamps[0].toColor=s:e.colorRamp.toColor=s,this.setInternalSymbol(this.symbol,!0)},popoverProps:this.popoverProps,storageId:y.g,hideRecentColors:!0,showTransparency:!0,ref:this.setColorInputRef}),(0,i.h)("arcgis-color-input",{color:this.toColorPickerValue(n[0],!0),clearable:!1,onArcgisChange:t=>{const o=t.currentTarget.color,i=(0,y.c)(o),s=new b.e.EsriColor(i).toRgba();s[3]=255*s[3],"CIMMultipartColorRamp"===e.colorRamp.type?e.colorRamp.colorRamps[0].fromColor=s:e.colorRamp.fromColor=s;const r=this.sections?.stroke?.extraParts?.hideColor;if(r){const e=this.symbol.data.symbol.symbolLayers?.find((e=>"CIMSolidStroke"===e.type));e&&(e.color=[s[0],s[1],s[2],255])}this.setInternalSymbol(this.symbol,!0)},popoverProps:this.popoverProps,storageId:y.g,hideRecentColors:!0,showTransparency:!0,ref:this.setColorInputRef})):null)}renderRampsContent(e){return(0,i.h)("calcite-label",null,e.heading,(0,i.h)("arcgis-map-config-symbol-styler-color-ramp-input",{options:e,strings:this.mergedStrings,popoverProps:this.popoverProps,style:{"--scroller-max-height":"var(--ramp-scroller-max-height)"},ref:this.setRampInputRef}))}renderColorRampFillTransparencyContent(){const{fill:e}=this,t=e.color[0],o=4===t.length?t[3]/255:t.a;return(0,i.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,l.p)(o)),onArcgisValueChange:e=>this.onColorRampFillTransparencyChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency}))}renderStrokeBlock(){const e=this.stylerProps?.sections?.stroke;return"color"===e?.type?this.renderColorStrokeBlock():this.renderColorRampStrokeBlock()}renderColorStrokeBlock(){const e=this.sections,t=e?.stroke,{parts:o}=t,s=[];if((o.suggestedColors||o.customColor)&&s.push({content:this.renderStrokeColorsContent()}),o.transparency||o.extra){const e=[];o.transparency&&e.push(this.showingRampOptionsInStroke()?this.renderColorRampStrokeTransparencyContent(!t.enabled):this.renderColorStrokeTransparencyContent(!t.enabled)),o.extra&&e.push(this.renderStrokeExtraContent(!t.enabled)),s.push({content:(0,i.h)("arcgis-map-config-symbol-styler-section",{embedded:!0,disabled:!t.enabled},e)})}return this.renderSection({key:"color-stroke",disabled:"non-editable"===t.optional||this.hasActivePictureMarkerSymbol(),sectionContent:s})}renderStrokeColorRampsContent(){const{style:e}=this.stylerProps?.sections?.stroke,{activeCategory:t,colorRamps:o}=this.sections?.stroke;return this.renderRampsContent({style:e,activeCategory:t,colorRampStops:this.stroke?.color,colorRamps:o,heading:this.getStrokeString("color"),onCategoryChange:this.onStrokeColorRampCategoryChange,isSelected:e=>{const t=this.stroke?.color;return N(t,e.stops)},onSelect:e=>{const{detail:t}=e,o=t.stops.slice(),{stroke:i}=this,s={...i,color:o};this.stroke=s,this.arcgisStrokeChange.emit(U(s)),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0),e.stopPropagation()},onFlip:this.flipStrokeColorRamps})}showingRampOptionsInStroke(){const e=this.stylerProps?.sections?.stroke,t=H(this.activeSymbol),o=this.sections?.fill?.type;return t&&"color-ramp"===o&&"color"===e.type}renderStrokeColorsContent(){const e=this.sections?.stroke;if(this.showingRampOptionsInStroke()){const e=this.tempStrokeColorRampStateActiveCategory,{style:t}=this.stylerProps?.sections?.fill,{colorRamps:o}=this.sections?.fill;return this.renderRampsContent({style:t,activeCategory:e,colorRampStops:this.tempStrokeColorRampStateStops,colorRamps:o,heading:this.getStrokeString("color"),onCategoryChange:e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-value");this.tempStrokeColorRampStateActiveCategory=t,e.stopPropagation()},isSelected:e=>N(this.tempStrokeColorRampStateStops,e.stops),onSelect:e=>{const{detail:t}=e,o=t.stops.slice(),{stroke:i}=this,s={...i,color:o};this.stroke=s,this.tempStrokeColorRampStateStops=o,this.arcgisStrokeChange.emit(U(s)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},onFlip:this.flipFillColorRamps})}const t=e?.enabled?this.toColorPickerValue(this.stroke?.color):void 0;return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,this.getStrokeString("color")),(0,i.h)("arcgis-color-input",{color:t,clearable:!1!==e?.optional,onArcgisChange:t=>{const o=t.currentTarget.color;if(!o)return void this.onStrokeEnabledChange(!1);e?.enabled||this.onStrokeEnabledChange(!0);const i=(0,y.c)(o),s=this.stroke?.color,{stroke:r}=this,n={...r,color:(0,y.c)(D(s,{...s,...i,a:s.a}))};this.stroke=n,this.arcgisStrokeChange.emit(U(n)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:y.g,ref:this.setColorInputRef}))}renderColorStrokeTransparencyContent(e){const{stroke:t}=this;return(0,i.h)("calcite-label",null,this.getStrokeString("transparency"),(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,l.p)((t?.color).a)),onArcgisValueChange:e=>this.onColorStrokeTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:e,label:this.getStrokeString("transparency")}))}renderStrokeExtraContent(e){const{sections:t,stroke:o}=this,s=t?.stroke?.extraParts.arrow,r=t?.stroke?.extraParts.autoStrokeAdjust,n=t?.stroke?.extraParts.style,a=t?.stroke?.extraParts.width,l="line"===this.editGeometry,c="polygon"===this.editGeometry,h=l?.1:0,d=(0,b.b)(this.symbol),p=!d&&n&&(l||c),m=!d&&s&&l,g=!d&&a,f=!d&&r,C=(0,u.b)(this.el),S=q(o?.marker);return(0,i.h)("div",{class:y.C.contentGroup},g?(0,i.h)("calcite-label",{dir:C,key:"width-options"},this.getStrokeString("width"),(0,i.h)("arcgis-slider-input",{disabled:e||r&&"editable"!==r&&o?.autoAdjusted,min:h,max:18,step:1,unitsLabel:this.mergedStrings.px,value:o?.size,onArcgisValueChange:e=>this.onStrokeWidthChange(e.detail),withSteppers:!this.narrow,label:this.getStrokeString("width")})):null,f?this.renderAutoAdjust(C,o?.autoAdjusted??!1,this.mergedStrings.autoAdjustStroke,this.onAutoAdjustStrokeChange):null,m?(0,i.h)("calcite-label",{dir:C,key:"arrow-options"},this.mergedStrings.arrow,(0,i.h)("calcite-dropdown",{class:{[y.C.iconDropdown]:!0,[y.C.arrowDropdown]:!0},onCalciteDropdownSelect:this.onStrokeArrowChange,widthScale:"l",placement:"top-end",overlayPositioning:this.popoverProps?.overlayPositioning,scale:"s"},(0,i.h)("div",{role:"button",slot:"trigger",tabIndex:0},(0,i.h)("div",{"data-arrow":S,class:y.C.iconDropdownSelected,style:this.getSelectedArrowPatternStyle()}),(0,i.h)("calcite-icon",{icon:"chevron-down",scale:"s"})),(0,i.h)("calcite-dropdown-group",null,y.s.map((e=>(0,i.h)("calcite-dropdown-item",{selected:e===S,"data-arrow":e},(0,i.h)("div",{class:y.C.iconDropdownItemContent,"data-arrow":e,style:this.getArrowPatternOptionStyle()}))))))):null,p?(0,i.h)("calcite-label",{dir:C,key:"pattern-options"},this.mergedStrings.pattern,(0,i.h)("calcite-dropdown",{class:{[y.C.iconDropdown]:!0,[y.C.styleDropdown]:!0},onCalciteDropdownSelect:this.onStrokeStyleChange,widthScale:"l",placement:"top-end",overlayPositioning:this.popoverProps?.overlayPositioning,scale:"s",maxItems:7},(0,i.h)("div",{role:"button",slot:"trigger",tabIndex:0},(0,i.h)("div",{class:y.C.iconDropdownSelected,style:this.getLinePatternStyle(o?.style||"solid")}),(0,i.h)("calcite-icon",{icon:"chevron-down",scale:"s"})),(0,i.h)("calcite-dropdown-group",null,y.A.map((e=>(0,i.h)("calcite-dropdown-item",{selected:e===o?.style,"data-style":e},(0,i.h)("div",{style:this.getLinePatternStyle(e),class:y.C.iconDropdownItemContent}))))))):null)}renderColorRampStrokeBlock(e=!1){const t=this.sections?.stroke,o=t.parts,i=[];return o.colorRamps&&i.push({content:this.renderStrokeColorRampsContent()}),o.transparency&&i.push({content:this.renderColorRampStrokeTransparencyContent("non-editable"===t.optional||this.hasActivePictureMarkerSymbol())}),o.extra&&i.push({content:this.renderStrokeExtraContent("non-editable"===t.optional||this.hasActivePictureMarkerSymbol())}),this.renderSection({key:"color-ramp-stroke",disabled:"non-editable"===t.optional||this.hasActivePictureMarkerSymbol(),embedded:e,sectionContent:i})}renderColorRampStrokeTransparencyContent(e){const{stroke:t}=this;return(0,i.h)("calcite-label",null,this.getStrokeString("transparency"),(0,i.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,l.p)(t?.color[0].a)),onArcgisValueChange:e=>this.onColorRampStrokeTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:e,label:this.getStrokeString("transparency")}))}checkPopoverMaxHeight(){if(this.flowEl&&this.popoverProps&&(!this.popoverProps.maxHeight||this.autoCalcHeight)){this.autoCalcHeight=!0;const e=this.flowEl.getBoundingClientRect(),t=window.innerHeight||document.documentElement?.clientHeight||document.body?.clientHeight||0,o=t&&e?.top?t-e.top-30:0;this.popoverProps.maxHeight=Math.max(o||e.height,250)-(this.popoverProps.offsetDistance??0)-5+"px"}}getAnimationBlockHeadingInfo(e){const{mergedStrings:t}=this;switch(e){case"CIMSymbolAnimationColor":return{heading:t.animations.color,icon:"styling"};case"CIMSymbolAnimationOffset":return{heading:t.animations.offset,icon:"relative-direction"};case"CIMSymbolAnimationRotation":return{heading:t.animations.rotation,icon:"rotate"};case"CIMSymbolAnimationScale":return{heading:t.animations.scale,icon:"stretch"};case"CIMSymbolAnimationSize":return{heading:t.animations.size,icon:"dimensions-unit"};case"CIMSymbolAnimationTransparency":return{heading:t.animations.transparency,icon:"transparency"};default:return{heading:t.animation,icon:"play"}}}waitOnUser(e,t,o){const i=e.target;this.typingHandle&&(clearTimeout(this.typingHandle),this.typingHandle=void 0);const s=i.value,r=Number.parseFloat(s);s?(0,l.i)(i.min)&&(0,l.i)(i.max)&&(i.min>r||i.max<r)?this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,i.min>r?(i.value=`${i.min}`,t(i)):i.max<r&&(i.value=`${i.max}`,t(i))}),750):s.startsWith("-")&&(0===r||Number.isNaN(r))||t(i):this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,i.value=`${o}`,t(i)}),2e3)}static get assetsDirs(){return["assets"]}get el(){return(0,i.a)(this)}static get watchers(){return{builtInStrings:["handleStringChanges"],stringOverrides:["handleStringChanges"]}}};ee.style=':host {\n  min-width: 220px;\n  height: -moz-min-content;\n  height: min-content;\n  display: flex;\n  flex: 1 1 auto;\n  flex-flow: column nowrap;\n  align-items: stretch;\n}\n\nbutton {\n  overflow: hidden;\n  align-items: center;\n  border: none;\n  border-radius: 0;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: flex;\n  font-family: inherit;\n  gap: 8px;\n  height: 100%;\n  justify-content: center;\n  outline-color: transparent;\n  outline-offset: 0;\n  padding: 3px 0;\n  padding-inline: 3px 8px;\n  position: relative;\n  text-decoration: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  text-align: center;\n  -webkit-appearance: none;\n  width: 100%;\n  &:focus {\n    outline: 2px solid var(--calcite-color-brand);\n    outline-offset: 2px;\n  }\n  &:hover {\n    text-decoration: none;\n  }\n}\n\ncalcite-dropdown {\n  width: 100%;\n}\n\ncalcite-flow {\n  height: 100%;\n}\n\n.content {\n  background-color: var(--calcite-color-foreground-1);\n}\n\n.color-locked-info {\n  display: flex;\n  gap: 4px;\n  margin: 8px 0;\n  align-items: center;\n\n  calcite-icon {\n    color: var(--calcite-color-text-3);\n  }\n}\n\n.icon-dropdown {\n  padding: 0.25rem 0 0 0;\n  width: 100%;\n  background-color: var(--calcite-color-foreground-1);\n  height: 2.25rem;\n  border: 1px solid #a9a9a9;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.075);\n}\n\n.icon-dropdown--selected {\n  cursor: pointer;\n  margin-left: 12px;\n  height: 3px;\n  width: 100%;\n}\n\n.icon-dropdown-item-content,\n.icon-dropdown--selected {\n  background-position: center;\n  background-clip: content-box;\n  background-origin: content-box;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.icon-dropdown-item-content {\n  height: 30px;\n  width: 200px;\n}\n\n:dir(rtl) {\n  .icon-dropdown--selected {\n    margin-right: 12px;\n  }\n}\n\n.style-dropdown {\n  [slot="trigger"] {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    calcite-icon {\n      margin: 8px;\n      background-color: #fff;\n    }\n  }\n\n  [slot="trigger"],\n  .icon-dropdown-item-content {\n    background-repeat: repeat-x;\n  }\n}\n\n.arrow-dropdown {\n  [slot="trigger"] {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .icon-dropdown--selected {\n      height: 30px;\n      background-size: 100% 119px;\n    }\n\n    calcite-icon {\n      margin: 8px;\n      background-color: #fff;\n    }\n  }\n\n  [slot="trigger"] .icon-dropdown--selected,\n  .icon-dropdown-item-content {\n    background-repeat: no-repeat;\n\n    &[data-arrow="none"] {\n      background-position: 0 0;\n    }\n\n    &[data-arrow="begin"] {\n      background-position: 0 -32px;\n    }\n\n    &[data-arrow="end"] {\n      background-position: 0 -61px;\n    }\n\n    &[data-arrow="begin-end"] {\n      background-position: 0 -91px;\n    }\n  }\n}\n\n.content-group {\n  display: flex;\n  flex-direction: column;\n\n  label {\n    margin: 8px 0 0 0;\n  }\n}\n\n.color-ramp-selection {\n  padding: 4px;\n}\n\n.section-toggle--disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n\n.swatch-item {\n  box-sizing: border-box;\n  height: 16px;\n  width: 16px;\n  border-radius: 2px;\n  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.33);\n}\n\n/* workaround for https://github.com/Esri/calcite-components/issues/2582 */\ncalcite-input[disabled] {\n  [data-adjustment] {\n    pointer-events: none;\n  }\n}\n\narcgis-map-config-symbol-styler-section {\n  calcite-block {\n    overflow: visible;\n    margin: 0 -12px;\n\n    &[open]:before :not(.no-top-margin) {\n      content: "";\n      height: 16px;\n      display: flex;\n      background-color: var(--calcite-color-foreground-2);\n    }\n\n    &:nth-of-type(n + 1) {\n      border-bottom: 1px solid #f0f0f0;\n    }\n\n    &:last-child {\n      border-bottom: none;\n    }\n\n    arcgis-map-config-symbol-styler-section:nth-of-type(2) {\n      margin-top: 12px;\n    }\n  }\n}\n\ncalcite-panel {\n  overflow: visible;\n  /* stopgap to allow styler to be embedded into existing panels */\n  margin-top: 0;\n}\n\n.input-color {\n  flex-wrap: nowrap;\n  gap: 8px;\n  align-items: center;\n}\n\ncalcite-tooltip {\n  max-width: 250px;\n\n  &:not([open]) {\n    visibility: hidden;\n    pointer-events: none;\n  }\n}\n\n.message {\n  margin-top: 8px;\n}\n\n/* symbol layer previews */\narcgis-map-config-symbol-styler-symbol-preview[slot="icon"],\narcgis-map-config-symbol-styler-symbol-preview.gradient-margin {\n  width: 32px;\n  height: 32px;\n  padding: 2px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.container {\n  display: flex;\n  padding: 8px 12px;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  gap: 8px;\n  flex-grow: 1;\n}\n\n.symbol {\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.label {\n  flex-grow: 1;\n  display: flex;\n  justify-content: flex-start;\n}\n\n.animation-label {\n  font-weight: var(--calcite-font-weight-medium);\n}\n\n.change-symbol-trigger {\n  border: 1px solid var(--calcite-color-border-input);\n}\n\n.change-symbol-trigger-disabled {\n  border: 1px solid var(--calcite-color-border-ghost);\n}\n\n.symbol-selection-panel {\n  min-height: min(100vh - 200px, 500px);\n  display: flex;\n  flex-direction: column;\n\n  arcgis-map-config-item-palette .item-palette {\n    gap: 8px;\n  }\n\n  calcite-notice:first-of-type {\n    margin: auto 0 0 0;\n  }\n\n  calcite-label {\n    margin: 16px 12px 0 12px;\n  }\n\n  calcite-panel {\n    overflow: visible;\n  }\n}\n\n.section {\n  display: flex;\n  flex-direction: column;\n  background-color: var(--calcite-color-foreground-1);\n}\n\narcgis-color-input {\n  margin-top: calc(-1 * var(--calcite-spacing-xxs));\n  padding-bottom: var(--calcite-spacing-md);\n}\n\n.animation-panel {\n  min-height: min(100vh - 200px, 500px);\n  display: flex;\n  flex-direction: column;\n}\n\n.animation-checkbox-container {\n  display: flex;\n  align-items: center;\n  padding-bottom: var(--calcite-spacing-sm);\n}\n\n.animation-checkbox-container-text {\n  margin: 0px var(--calcite-spacing-sm);\n}\n\n.offset-div {\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  gap: 16px;\n  margin-bottom: var(--calcite-spacing-md);\n}\n\n.offset-animation-content-margin,\n.gradient-margin {\n  margin-bottom: var(--calcite-spacing-md);\n}\n\n.gradient-color-inputs {\n  display: flex;\n  gap: var(--calcite-spacing-md);\n  width: 100%;\n  justify-content: space-between;\n}\n\n.gradient-color-inputs arcgis-color-input {\n  max-width: 64px;\n}\n\n.scale-animation-wrapper {\n  margin: var(--calcite-spacing-md) 0px;\n}\n\n.scale-animation-slider-labels {\n  display: flex;\n  justify-content: space-between;\n}\n'},89731:(e,t,o)=>{o.d(t,{a:()=>s,p:()=>r});const i=96;function s(e){return e?e/72*i:0}function r(e){return e?72*e/i:0}}}]);