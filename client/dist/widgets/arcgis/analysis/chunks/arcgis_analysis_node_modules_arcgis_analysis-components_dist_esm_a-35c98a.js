"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_a-35c98a"],{17258:(e,t,i)=>{i.r(t),i.d(t,{analysis_areal_unit_input:()=>L,analysis_attribute_expression:()=>n.C,analysis_boolean_input:()=>n.A,analysis_chip_group:()=>n.a,analysis_data_file_input:()=>n.b,analysis_dataset_input:()=>n.o,analysis_dataset_input_popover:()=>x,analysis_date_input:()=>n.c,analysis_expression_group:()=>n.B,analysis_field_input:()=>n.d,analysis_field_select:()=>n.e,analysis_folder_input:()=>P,analysis_geoenrichment_databrowser:()=>n.g,analysis_geoenrichment_input:()=>n.f,analysis_help_popover:()=>n.u,analysis_item_input:()=>n.h,analysis_layer_input:()=>n.l,analysis_layer_input_popover:()=>D,analysis_linear_unit_input:()=>n.i,analysis_multiple_input:()=>n.p,analysis_number_input:()=>n.n,analysis_overwrite:()=>Nn,analysis_query_builder:()=>n.y,analysis_query_input:()=>n.w,analysis_query_modal:()=>n.x,analysis_query_target_select:()=>n.z,analysis_sketch:()=>Gn,analysis_spatial_expression:()=>n.D,analysis_spatial_reference_input:()=>n.s,analysis_spatial_reference_selector:()=>n.r,analysis_string_input:()=>n.j,analysis_summary_fields:()=>n.m,analysis_summary_fields_popover:()=>ea,analysis_traffic_time_input:()=>n.k,analysis_tree:()=>n.q,analysis_unsupported_input:()=>n.v,analysis_workflow_select:()=>n.t,analysis_workflow_select_popover:()=>ta,variable_node_input_popover:()=>n.V});var r=i(28445),s=i(34074),n=i(44851),a=i(35385),o=i(60443),l=i(84121),c=i(32513),h=i(588),u=i(44345),d=(i(55448),i(18423),i(91813),i(21255),i(54312),i(34031),i(9316),i(13661),i(43786),i(61320),i(64016),i(56451),i(6550)),p=(i(2924),i(5258),i(52373),i(33752)),f=(i(53976),i(49403),i(77462),i(23054),i(73645),i(12762)),y=(i(82567),i(28927)),m=i(35970),v=i(5933),g=(i(57295),i(72349),i(89962),i(97703),i(71802));i(43284),i(22741),i(1161),i(69402),i(52095);function _(e,t,i,r){for(var s=-1,n=null==e?0:e.length;++s<n;){var a=e[s];t(r,a,i(a),e)}return r}e=i.hmd(e);var b,w=(b=function(e,t){return e&&(0,o.f)(e,t,l.x)},function(e,t){if(null==e)return e;if(!(0,l.g)(e))return b(e,t);for(var i=e.length,r=-1,s=Object(e);++r<i&&!1!==t(s[r],r,s););return e});function k(e,t,i,r){return w(e,(function(e,s,n){t(r,e,i(e),n)})),r}var S,O,I=(S=function(e,t,i){e[i?0:1].push(t)},O=function(){return[[],[]]},function(e,t){var i=(0,l.p)(e)?_:k,r=O?O():{};return i(e,S,(0,o.h)(t),r)});const L=class{constructor(e){(0,r.r)(this,e),this.analysisArealUnitInputChange=(0,r.c)(this,"analysisArealUnitInputChange",7),this.analysisHelpClick=(0,r.c)(this,"analysisHelpClick",7),this.required=!1,this.hideHelp=!1,this.isValid=!0,this.areaChange=e=>{const t=e?.target,i=t?.value,r=this.value?.units;void 0===t||Array.isArray(i)||"multi"===(e?.target).selectionMode||(void 0!==i?(this.value={units:r,area:i},this.onUnitChoiceListChange()):this.value=void 0,this.analysisArealUnitInputChange.emit())},this.unitChanged=e=>{const t=e?.target;this.value={area:this.value?.area,units:t?.value},this.validate(),void 0!==this.value?.area&&this.analysisArealUnitInputChange.emit()}}onUnitChoiceListChange(){const e=this.value?.units;void 0===this.unitChoiceList||void 0!==e&&this.unitChoiceList.includes(e)||(this.value={area:this.value?.area,units:this.unitChoiceList[0]})}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,s.G)(this.hostElement,(0,r.g)("."))),this.onUnitChoiceListChange()}async checkValidity(){return await this.validate(),Promise.resolve(this.isValid)}async validate(){const e=this.hostElement.shadowRoot?.querySelector("analysis-number-input"),t=await(e?.checkValidity())??!1,i=!this.required||void 0!==this.value?.units&&this.unitChoiceList?.includes(this.value?.units);return this.isValid=t&&i,Promise.resolve()}render(){return void 0!==this.value?.units&&(void 0===this.unitChoiceList||this.unitChoiceList.includes(this.value?.units)||(this.unitChoiceList=[...this.value?.units,...this.unitChoiceList])),(0,r.h)(r.H,{key:"ded8e4d60cfcb086eb95ed84878c017e7c3a06db"},(0,r.h)(n.E,{key:"95faa3f0f3d90d3c015ba1411feb3544b68d513a",label:this.label,required:this.required,value:this.value,minimum:this.minimum,maximum:this.maximum,excludeMinValue:this.excludeMinValue,excludeMaxValue:this.excludeMaxValue,placeholderText:this.placeholderText,strings:this.strings,dir:this.dir,unitChoiceList:this.unitChoiceList,hideHelp:this.hideHelp??!0,amountChoiceList:this.areaChoiceList,amountChange:this.areaChange,unitChanged:this.unitChanged,analysisHelpClick:this.analysisHelpClick,choiceListLabels:this.choiceListLabels,scale:s.c.Scale}))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}static get watchers(){return{unitChoiceList:["onUnitChoiceListChange"]}}};L.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input)}.controls-container{display:flex;column-gap:5%}.control{flex:1 1 0}.text{cursor:pointer;padding-bottom:var(--analysis-quarter-spacing);margin-block-start:0;margin-block-end:0}.unit-select{margin-bottom:var(--analysis-half-spacing)}";const C="analysis-popover",E="popover-content",j="js-app-flyout",T="list-item",x=class{constructor(e){(0,r.r)(this,e),this.analysisDatasetInputPopoverClose=(0,r.c)(this,"analysisDatasetInputPopoverClose",7),this.analysisDatasetInputPopoverSelectionChange=(0,r.c)(this,"analysisDatasetInputPopoverSelectionChange",7),this.placement="auto",this.buildListItem=e=>(0,r.h)("calcite-list-item",{class:T,key:e.id,value:e.id,label:e.name,description:e.description,selected:void 0!==this.selectedDatasetIds&&this.selectedDatasetIds.includes(e.id)}),this.onListChange=()=>{const e=this.list?.selectedItems.map((e=>e.value));this.analysisDatasetInputPopoverSelectionChange.emit({selectedDatasetIds:e}),"multiple"!==this.selectionMode&&(this.open=!1)}}async componentWillLoad(){({strings:this.strings}=await(0,s.G)(this.hostElement,(0,r.g)(".")))}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.popoverElement?.setFocus?.()))),1),setTimeout((()=>{this.popoverElement?.reposition?.()}),s.c.PopoverTimer)}async reposition(){await(this.popoverElement?.reposition?.())}render(){const e=this.popoverWidth??this.referenceElement?.getBoundingClientRect().width;return(0,r.h)(r.H,{key:"ffc7c9ef745ab3e53713f9c73c1256bd1ea53ca3",class:`${C} ${j}`},(0,r.h)("calcite-popover",{key:"ae63a62d5666d8242e8684af68665dc9889c4ae9",ref:e=>{this.popoverElement=e},autoClose:!0,referenceElement:this.referenceElement??"analysis-dataset-input",placement:this.placement,open:this.open,closable:!0,heading:this.strings.heading,label:this.strings.heading,focusTrapDisabled:!0,onCalcitePopoverClose:()=>this.analysisDatasetInputPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"c5de4011568d16c20d068868e3b907fdeb087b15",style:{width:void 0!==e?`${e}px`:void 0,maxWidth:s.c.MaxPopoverWidth}},(0,r.h)("calcite-list",{key:"ae49e92fea5c845f41f180e582c2717d913c8209",class:E,label:"",selectionMode:this.selectionMode,onCalciteListChange:this.onListChange,filterEnabled:!0,ref:e=>{this.list=e}},this.analysisDatasets?.map(this.buildListItem)))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}};x.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;--calcite-popover-z-index:var(--analysis-popover-z-index)}.popover-content{height:var(--analysis-popover-content-height)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const P=class{constructor(e){(0,r.r)(this,e),this.analysisFolderInputChange=(0,r.c)(this,"analysisFolderInputChange",6),this.analysisHelpClick=(0,r.c)(this,"analysisHelpClick",7),this.hideHelp=!1,this.disabled=!1,this.validate=async()=>!0===await this.folderPicker.saveActiveFolder(),this.folderSelect=e=>{const t=e.detail.id;this.value=(t===this.user.username?"":t)??"",this.analysisFolderInputChange.emit(this.value)},this.setDefaultFolder=()=>{const e=this.folderPicker.folders.find((e=>e.id===this.value));this.folderPicker.folder=void 0!==e?e:{id:this.folderPicker.folders[0]?.id}},this.setRef=e=>{(0,s.m)(e)&&(this.folderPicker=e)}}async checkValidity(){return await this.validate()}render(){return(0,r.h)(r.H,{key:"cc700308ea3be0aee3f8da46a719961dded9f8e8"},void 0!==this.label&&""!==this.label?(0,r.h)("analysis-label",{label:this.label,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,(0,r.h)("arcgis-folder-picker",{key:this.value,ref:this.setRef,api:4,user:this.user,disabled:this.disabled,portal:this.user.portal,scale:s.c.Scale,label:"",onArcgisFolderPickerLoad:this.setDefaultFolder,onArcgisFolderPickerChange:e=>this.folderSelect(e)}))}get hostElement(){return(0,r.a)(this)}};P.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{--calcite-color-border-input:var(--analysis-ui-border-input)}";const A="analysis-popover",M="js-app-flyout",B="popover-content",z="half-margin",F="list-message",N="layers-list",D=class{constructor(e){(0,r.r)(this,e),this.analysisLayerInputPopoverClose=(0,r.c)(this,"analysisLayerInputPopoverClose",7),this.analysisLayerInputPopoverSelectionChange=(0,r.c)(this,"analysisLayerInputPopoverSelectionChange",7),this.analysisLayerInputPopoverLayerBrowsed=(0,r.c)(this,"analysisLayerInputPopoverLayerBrowsed",7),this.analysisLayerInputPopoverConfirm=(0,r.c)(this,"analysisLayerInputPopoverConfirm",7),this.hideAddToMap=!1,this.hideModelVariableLayers=!1,this.analysisSessionLayers=[],this.hideBrowseButton=!1,this.showNoticeMessage=!1,this.placement="auto",this.itemBrowserFilter="",this.itemBrowserQ="",this.pointerDisabled=!1,this.noSearchedLayersMessageActive=!1,this.checkForMatchingLayer=()=>{this.calciteFilterSearchTerm=this.listElement?.filterText,this.noSearchedLayersMessageActive=0===this.listElement?.filteredItems?.length&&0!==this.listElement?.filterText.length},this.buildLayerListItem=e=>{let t=e;return(0,s.K)(e)&&(t=(0,s.$)(e)),(0,r.h)("calcite-list-item",{class:N,key:e.id,value:e.id,label:(0,s.N)(e),description:(0,s.K)(e)?(0,s.i)(t)?this.strings.table:this.strings[e.geometryType]:"",selected:void 0!==this.selectedIds&&this.selectedIds.includes(e.id),onClick:this.onListChange,"data-layer-title":e.title})},this.buildVariableListItem=e=>{const{id:t,isDerived:i,name:s,dataType:n,layer:a}=e,o=!0===i?"":void 0!==a&&"GPRecordSet"===n?this.strings.table:this.strings[a.geometryType];return(0,r.h)("calcite-list-item",{class:N,key:t,value:t,label:s,description:o,selected:void 0!==this.selectedIds&&this.selectedIds.includes(t),onClick:this.onListChange,"data-layer-title":s})},this.openItemBrowser=()=>{this.itemBrowserElement?.remove(),this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.heading,this.itemBrowserElement.hideAddToMap=this.hideAddToMap,this.itemBrowserElement.filter=this.itemBrowserFilter,this.itemBrowserElement.q=this.itemBrowserQ,this.itemBrowserElement.allowedGeometries=this.itemBrowserAllowedGeometries,this.itemBrowserElement.layerFilterType=this.layerFilterType,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.bucketOptions=this.bucketOptions,this.itemBrowserElement.user=this.user,this.itemBrowserElement.viewIsSceneView=(0,a.v)(this.mapView),this.itemBrowserElement.selectionMode="multi"!==this.selectionMode?"single-sublayer":"multiple-sublayer",this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.addEventListener("analysisItemBrowserAddToMap",this.handleItemBrowserAddToMap),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.popoverElement.autoClose=!1,this.popoverElement.hidden=!0,document.body.appendChild(this.itemBrowserElement)},this.closeModals=()=>{this.popoverElement.autoClose=!0,this.popoverElement.hidden=!1,void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.removeEventListener("analysisItemBrowserAddToMap",this.handleItemBrowserAddToMap),this.itemBrowserElement.removeEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0)},this.addLayersToMap=(e,t)=>{const i=I(t,(e=>(0,s.i)(e))),r=i[1].map((e=>(0,s.K)(e)?(0,s.$)(e):e));e?.addMany(r),e?.tables.addMany(i[0])},this.handleItemBrowserAddToMap=e=>{this.addLayersToMap(this.mapView.map,e.detail),this.analysisLayerInputPopoverLayerBrowsed.emit(e.detail),this.open=!1},this.handleItemBrowserSelection=e=>{this.analysisLayerInputPopoverLayerBrowsed.emit(e.detail),this.open=!1},this.onListChange=()=>{const e=this.listElement?.selectedItems;this.analysisLayerInputPopoverSelectionChange.emit(e?.map((e=>e.value))),"multi"!==this.selectionMode&&(this.open=!1)},this.onConfirm=()=>{const e=this.listElement?.selectedItems??[];this.analysisLayerInputPopoverConfirm.emit(e?.map((e=>e.value))),this.open=!1}}get bucketOptions(){const e=["my","favorites","group","org","all"];if(!0!==this.portal.isPortal||this.portal.sourceJSON.portalDeploymentType!==s.R.Kubernetes){const t=this.isImageryLayerBrowser();e.splice(4,0,t?"living atlas":"living atlas analysis")}return e}isImageryLayerBrowser(){const e=Array.isArray(this.layerFilterType)?this.layerFilterType:[this.layerFilterType];return e?.map((e=>!!e&&e.indexOf("imagery")>-1)).includes(!0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,s.G)(this.hostElement,(0,r.g)(".")))}componentDidLoad(){this.focusTimeoutId=setTimeout((async()=>{await(this.listElement?.setFocus?.())}),s.c.PopoverTimer),setTimeout((()=>{this.popoverElement?.reposition?.()}),s.c.PopoverTimer)}disconnectedCallback(){void 0!==this.focusTimeoutId&&clearTimeout(this.focusTimeoutId),this.closeModals()}async reposition(){await(this.popoverElement?.reposition?.())}render(){const e=this.popoverWidth??this.referenceElement?.getBoundingClientRect().width,t=(0,s.t)(this.strings.noMatchesFound,{searchTerm:this.calciteFilterSearchTerm??""}),i=0===this.analysisSessionLayers?.length&&0===this.mapLayers?.length&&(void 0===this.modelVariables||0===this.modelVariables?.length),n=!0===this.hideBrowseButton;return(0,r.h)(r.H,{key:"41af10caa27487d0ed3504cd94c7cdaf30bff077",dir:this.dir,class:`${A} ${M}`},(0,r.h)("calcite-popover",{key:"6fb6b5839c1272bd6f87653ae735cf854746484f",ref:e=>{this.popoverElement=e},autoClose:!0,closable:!0,heading:this.heading??this.strings.heading,referenceElement:this.referenceElement??"analysis-layer-input",placement:this.placement,open:this.open,label:"",focusTrapDisabled:!0,pointerDisabled:this.pointerDisabled,onCalcitePopoverClose:()=>this.analysisLayerInputPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"f3fb8c426c0544c3632e17e71feff111d1c515e3",style:{maxHeight:void 0!==this.maxHeight?this.maxHeight-50+"px":void 0,width:void 0!==e?`${e}px`:void 0,maxWidth:s.c.MaxPopoverWidth}},(0,r.h)("calcite-list",{key:"199a6db4cb8a5ff32497a16599ae7ca4047dd767",class:B,label:"",selectionMode:"multi"===this.selectionMode?"multiple":"single",filterEnabled:!0,ref:e=>{this.listElement=e},onCalciteListFilter:this.checkForMatchingLayer},(0,r.h)("calcite-notice",{key:"37d15802aafc99b963b0e12684e81d27a645787f",open:this.showNoticeMessage,class:this.showNoticeMessage?z:"",kind:"warning",scale:s.c.Scale},(0,r.h)("div",{key:"ca99d6effe129f98581e764bacaace2bf5a6c2dd",slot:"message"},Array.from(new Set(this.noticeMessage))?.map((e=>(0,r.h)("p",{innerHTML:e}))))),this.noSearchedLayersMessageActive&&(0,r.h)("p",{key:"7ec8baf733e48066738bf881cf5ba4e8a55c2706",class:F},t),i&&!1===this.noSearchedLayersMessageActive?(0,r.h)("p",{class:F},this.strings.noCompatibleLayers):(0,r.h)("div",null,(0,r.h)("calcite-list-item-group",{heading:this.strings.analysisSessionLayers,hidden:0===this.analysisSessionLayers?.length},(this.analysisSessionLayers??[]).map((e=>this.buildLayerListItem(e)))),(this.modelVariables?.length??0)>0&&!1===this.hideModelVariableLayers&&(0,r.h)("calcite-list-item-group",{heading:this.strings.modelVariableLayers},(this.modelVariables??[]).map((e=>this.buildVariableListItem(e)))),(0,r.h)("calcite-list-item-group",{heading:this.strings.mapLayers,hidden:0===this.mapLayers?.length},(this.mapLayers??[]).map((e=>this.buildLayerListItem(e)))))),!n&&(0,r.h)("calcite-button",{key:"72e33a70e75a0d86e9572fe9f7b26e4fb0d2dc01",slot:"footer-actions",appearance:"transparent",width:"full",onClick:this.openItemBrowser},this.strings.browseAnalysisLayers),n&&(0,r.h)(r.F,{key:"dbb964c8a2f0b8af51a5bf9aa2ceaccec2468fc7"},(0,r.h)("calcite-button",{key:"9f373cf381a5923fb03a033813ff662877c26d48",slot:"footer-actions",appearance:"outline",width:"half",onClick:()=>this.analysisLayerInputPopoverClose.emit()},this.strings.cancel),(0,r.h)("calcite-button",{key:"ad244b0ba3dcf662d3dd6606dea7035c1baf8b64",slot:"footer-actions",appearance:"solid",width:"half",onClick:this.onConfirm},this.strings.add)))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}};function $(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}D.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex}.popover-content{height:var(--analysis-popover-content-height)}.fab{justify-content:center;padding:var(--analysis-half-spacing)}.half-margin{margin:var(--analysis-half-spacing)}.list-message{font-size:var(--calcite-font-size--2);background-color:var(--calcite-color-background);padding:var(--analysis-half-spacing);margin:0}.layers-list{--calcite-font-size--1:var(--calcite-font-size--2)}";var R,H={exports:{}};const V=$(function(){if(R)return H.exports;function e(e,t,i,r){var s=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(r)?r:i(r),n=t.get(s);return typeof n>"u"&&(n=e.call(this,r),t.set(s,n)),n}function t(e,t,i){var r=Array.prototype.slice.call(arguments,3),s=i(r),n=t.get(s);return typeof n>"u"&&(n=e.apply(this,r),t.set(s,n)),n}function i(e,t,i,r,s){return i.bind(t,e,r,s)}function r(r,s){return i(r,this,1===r.length?e:t,s.cache.create(),s.serializer)}function s(){return JSON.stringify(arguments)}function n(){this.cache=Object.create(null)}R=1,n.prototype.has=function(e){return e in this.cache},n.prototype.get=function(e){return this.cache[e]},n.prototype.set=function(e,t){this.cache[e]=t};var a={create:function(){return new n}};return H.exports=function(e,t){var i=t&&t.cache?t.cache:a,n=t&&t.serializer?t.serializer:s;return(t&&t.strategy?t.strategy:r)(e,{cache:i,serializer:n})},H.exports.strategies={variadic:function(e,r){return i(e,this,t,r.cache.create(),r.serializer)},monadic:function(t,r){return i(t,this,e,r.cache.create(),r.serializer)}},H.exports}());var U="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,q="object"==typeof self&&self&&self.Object===Object&&self,G=U||q||Function("return this")(),W=G.Symbol,J=Object.prototype,K=J.hasOwnProperty,Z=J.toString,Y=W?W.toStringTag:void 0;var Q=Object.prototype.toString;var X=W?W.toStringTag:void 0;function ee(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":X&&X in Object(e)?function(e){var t=K.call(e,Y),i=e[Y];try{e[Y]=void 0;var r=!0}catch{}var s=Z.call(e);return r&&(t?e[Y]=i:delete e[Y]),s}(e):function(e){return Q.call(e)}(e)}function te(e){return null!=e&&"object"==typeof e}function ie(e){return"symbol"==typeof e||te(e)&&"[object Symbol]"==ee(e)}function re(e,t){for(var i=-1,r=null==e?0:e.length,s=Array(r);++i<r;)s[i]=t(e[i],i,e);return s}var se=Array.isArray,ne=W?W.prototype:void 0,ae=ne?ne.toString:void 0;function oe(e){if("string"==typeof e)return e;if(se(e))return re(e,oe)+"";if(ie(e))return ae?ae.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function le(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ce(e){return e}function he(e){if(!le(e))return!1;var t=ee(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var ue,de=G["__core-js_shared__"],pe=(ue=/[^.]+$/.exec(de&&de.keys&&de.keys.IE_PROTO||""))?"Symbol(src)_1."+ue:"";var fe=Function.prototype.toString;function ye(e){if(null!=e){try{return fe.call(e)}catch{}try{return e+""}catch{}}return""}var me=/^\[object .+?Constructor\]$/,ve=Function.prototype,ge=Object.prototype,_e=ve.toString,be=ge.hasOwnProperty,we=RegExp("^"+_e.call(be).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ke(e){return!(!le(e)||function(e){return!!pe&&pe in e}(e))&&(he(e)?we:me).test(ye(e))}function Se(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return ke(i)?i:void 0}var Oe=Se(G,"WeakMap");function Ie(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var Le=Date.now;function Ce(e){return function(){return e}}var Ee=function(){try{var e=Se(Object,"defineProperty");return e({},"",{}),e}catch{}}(),je=Ee?function(e,t){return Ee(e,"toString",{configurable:!0,enumerable:!1,value:Ce(t),writable:!0})}:ce,Te=function(e){var t=0,i=0;return function(){var r=Le(),s=16-(r-i);if(i=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(je);function xe(e){return e!=e}function Pe(e,t){return!!(null==e?0:e.length)&&function(e,t,i){return t==t?function(e,t,i){for(var r=i-1,s=e.length;++r<s;)if(e[r]===t)return r;return-1}(e,t,i):function(e,t,i){for(var r=e.length,s=i+-1;++s<r;)if(t(e[s],s,e))return s;return-1}(e,xe,i)}(e,t,0)>-1}var Ae=/^(?:0|[1-9]\d*)$/;function Me(e,t){var i=typeof e;return!!(t=t??9007199254740991)&&("number"==i||"symbol"!=i&&Ae.test(e))&&e>-1&&e%1==0&&e<t}function Be(e,t,i){"__proto__"==t&&Ee?Ee(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function ze(e,t){return e===t||e!=e&&t!=t}var Fe=Object.prototype.hasOwnProperty;function Ne(e,t,i){var r=e[t];(!Fe.call(e,t)||!ze(r,i)||void 0===i&&!(t in e))&&Be(e,t,i)}function De(e,t,i,r){var s=!i;i||(i={});for(var n=-1,a=t.length;++n<a;){var o=t[n],l=r?r(i[o],e[o],o,i,e):void 0;void 0===l&&(l=e[o]),s?Be(i,o,l):Ne(i,o,l)}return i}var $e=Math.max;function Re(e,t,i){return t=$e(void 0===t?e.length-1:t,0),function(){for(var r=arguments,s=-1,n=$e(r.length-t,0),a=Array(n);++s<n;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=i(a),Ie(e,this,o)}}function He(e,t){return Te(Re(e,t,ce),e+"")}function Ve(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ue(e){return null!=e&&Ve(e.length)&&!he(e)}function qe(e){return He((function(t,i){var r=-1,s=i.length,n=s>1?i[s-1]:void 0,a=s>2?i[2]:void 0;for(n=e.length>3&&"function"==typeof n?(s--,n):void 0,a&&function(e,t,i){if(!le(i))return!1;var r=typeof t;return!!("number"==r?Ue(i)&&Me(t,i.length):"string"==r&&t in i)&&ze(i[t],e)}(i[0],i[1],a)&&(n=s<3?void 0:n,s=1),t=Object(t);++r<s;){var o=i[r];o&&e(t,o,r,n)}return t}))}var Ge=Object.prototype;function We(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Ge)}function Je(e){return te(e)&&"[object Arguments]"==ee(e)}var Ke=Object.prototype,Ze=Ke.hasOwnProperty,Ye=Ke.propertyIsEnumerable,Qe=Je(function(){return arguments}())?Je:function(e){return te(e)&&Ze.call(e,"callee")&&!Ye.call(e,"callee")};var Xe="object"==typeof exports&&exports&&!exports.nodeType&&exports,et=Xe&&e&&!e.nodeType&&e,tt=et&&et.exports===Xe?G.Buffer:void 0,it=(tt?tt.isBuffer:void 0)||function(){return!1},rt={};function st(e){return function(t){return e(t)}}rt["[object Float32Array]"]=rt["[object Float64Array]"]=rt["[object Int8Array]"]=rt["[object Int16Array]"]=rt["[object Int32Array]"]=rt["[object Uint8Array]"]=rt["[object Uint8ClampedArray]"]=rt["[object Uint16Array]"]=rt["[object Uint32Array]"]=!0,rt["[object Arguments]"]=rt["[object Array]"]=rt["[object ArrayBuffer]"]=rt["[object Boolean]"]=rt["[object DataView]"]=rt["[object Date]"]=rt["[object Error]"]=rt["[object Function]"]=rt["[object Map]"]=rt["[object Number]"]=rt["[object Object]"]=rt["[object RegExp]"]=rt["[object Set]"]=rt["[object String]"]=rt["[object WeakMap]"]=!1;var nt="object"==typeof exports&&exports&&!exports.nodeType&&exports,at=nt&&e&&!e.nodeType&&e,ot=at&&at.exports===nt&&U.process,lt=function(){try{return at&&at.require&&at.require("util").types||ot&&ot.binding&&ot.binding("util")}catch{}}(),ct=lt&&lt.isTypedArray,ht=ct?st(ct):function(e){return te(e)&&Ve(e.length)&&!!rt[ee(e)]},ut=Object.prototype.hasOwnProperty;function dt(e,t){var i=se(e),r=!i&&Qe(e),s=!i&&!r&&it(e),n=!i&&!r&&!s&&ht(e),a=i||r||s||n,o=a?function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}(e.length,String):[],l=o.length;for(var c in e)(t||ut.call(e,c))&&(!a||!("length"==c||s&&("offset"==c||"parent"==c)||n&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Me(c,l)))&&o.push(c);return o}function pt(e,t){return function(i){return e(t(i))}}var ft=pt(Object.keys,Object),yt=Object.prototype.hasOwnProperty;function mt(e){if(!We(e))return ft(e);var t=[];for(var i in Object(e))yt.call(e,i)&&"constructor"!=i&&t.push(i);return t}function vt(e){return Ue(e)?dt(e):mt(e)}var gt=Object.prototype.hasOwnProperty;qe((function(e,t){if(We(t)||Ue(t))De(t,vt(t),e);else for(var i in t)gt.call(t,i)&&Ne(e,i,t[i])}));var _t=Object.prototype.hasOwnProperty;function bt(e){if(!le(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=We(e),i=[];for(var r in e)"constructor"==r&&(t||!_t.call(e,r))||i.push(r);return i}function wt(e){return Ue(e)?dt(e,!0):bt(e)}qe((function(e,t,i,r){De(t,wt(t),e,r)}));var kt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/;function Ot(e,t){if(se(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!ie(e))||(St.test(e)||!kt.test(e)||null!=t&&e in Object(t))}var It=Se(Object,"create");var Lt=Object.prototype.hasOwnProperty;var Ct=Object.prototype.hasOwnProperty;function Et(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function jt(e,t){for(var i=e.length;i--;)if(ze(e[i][0],t))return i;return-1}Et.prototype.clear=function(){this.__data__=It?It(null):{},this.size=0},Et.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Et.prototype.get=function(e){var t=this.__data__;if(It){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return Lt.call(t,e)?t[e]:void 0},Et.prototype.has=function(e){var t=this.__data__;return It?void 0!==t[e]:Ct.call(t,e)},Et.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=It&&void 0===t?"__lodash_hash_undefined__":t,this};var Tt=Array.prototype.splice;function xt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}xt.prototype.clear=function(){this.__data__=[],this.size=0},xt.prototype.delete=function(e){var t=this.__data__,i=jt(t,e);return!(i<0)&&(i==t.length-1?t.pop():Tt.call(t,i,1),--this.size,!0)},xt.prototype.get=function(e){var t=this.__data__,i=jt(t,e);return i<0?void 0:t[i][1]},xt.prototype.has=function(e){return jt(this.__data__,e)>-1},xt.prototype.set=function(e,t){var i=this.__data__,r=jt(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this};var Pt=Se(G,"Map");function At(e,t){var i=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?i["string"==typeof t?"string":"hash"]:i.map}function Mt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}Mt.prototype.clear=function(){this.size=0,this.__data__={hash:new Et,map:new(Pt||xt),string:new Et}},Mt.prototype.delete=function(e){var t=At(this,e).delete(e);return this.size-=t?1:0,t},Mt.prototype.get=function(e){return At(this,e).get(e)},Mt.prototype.has=function(e){return At(this,e).has(e)},Mt.prototype.set=function(e,t){var i=At(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this};function Bt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var i=function(){var r=arguments,s=t?t.apply(this,r):r[0],n=i.cache;if(n.has(s))return n.get(s);var a=e.apply(this,r);return i.cache=n.set(s,a)||n,a};return i.cache=new(Bt.Cache||Mt),i}Bt.Cache=Mt;var zt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ft=/\\(\\)?/g,Nt=function(e){var t=Bt(e,(function(e){return 500===i.size&&i.clear(),e})),i=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(zt,(function(e,i,r,s){t.push(r?s.replace(Ft,"$1"):i||e)})),t}));function Dt(e,t){return se(e)?e:Ot(e,t)?[e]:Nt(function(e){return null==e?"":oe(e)}(e))}function $t(e){if("string"==typeof e||ie(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Rt(e,t){for(var i=0,r=(t=Dt(t,e)).length;null!=e&&i<r;)e=e[$t(t[i++])];return i&&i==r?e:void 0}function Ht(e,t,i){var r=null==e?void 0:Rt(e,t);return void 0===r?i:r}function Vt(e,t){for(var i=-1,r=t.length,s=e.length;++i<r;)e[s+i]=t[i];return e}var Ut=W?W.isConcatSpreadable:void 0;function qt(e){return se(e)||Qe(e)||!!(Ut&&e&&e[Ut])}function Gt(e,t,i,r,s){var n=-1,a=e.length;for(i||(i=qt),s||(s=[]);++n<a;){var o=e[n];i(o)?Vt(s,o):r||(s[s.length]=o)}return s}function Wt(e){return(null==e?0:e.length)?Gt(e):[]}function Jt(e){return Te(Re(e,void 0,Wt),e+"")}var Kt=pt(Object.getPrototypeOf,Object),Zt=Function.prototype,Yt=Object.prototype,Qt=Zt.toString,Xt=Yt.hasOwnProperty,ei=Qt.call(Object);function ti(e){if(!te(e)||"[object Object]"!=ee(e))return!1;var t=Kt(e);if(null===t)return!0;var i=Xt.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Qt.call(i)==ei}He((function(e,t){try{return Ie(e,void 0,t)}catch(e){return function(e){if(!te(e))return!1;var t=ee(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ti(e)}(e)?e:new Error(e)}}));function ii(e){var t=this.__data__=new xt(e);this.size=t.size}function ri(){return[]}ii.prototype.clear=function(){this.__data__=new xt,this.size=0},ii.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},ii.prototype.get=function(e){return this.__data__.get(e)},ii.prototype.has=function(e){return this.__data__.has(e)},ii.prototype.set=function(e,t){var i=this.__data__;if(i instanceof xt){var r=i.__data__;if(!Pt||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new Mt(r)}return i.set(e,t),this.size=i.size,this},"object"==typeof exports&&exports&&!exports.nodeType&&exports&&e&&e.nodeType;var si=Object.prototype.propertyIsEnumerable,ni=Object.getOwnPropertySymbols,ai=ni?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,r=null==e?0:e.length,s=0,n=[];++i<r;){var a=e[i];t(a,i,e)&&(n[s++]=a)}return n}(ni(e),(function(t){return si.call(e,t)})))}:ri,oi=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Vt(t,ai(e)),e=Kt(e);return t}:ri;function li(e,t,i){var r=t(e);return se(e)?r:Vt(r,i(e))}function ci(e){return li(e,vt,ai)}function hi(e){return li(e,wt,oi)}var ui=Se(G,"DataView"),di=Se(G,"Promise"),pi=Se(G,"Set"),fi="[object Map]",yi="[object Promise]",mi="[object Set]",vi="[object WeakMap]",gi="[object DataView]",_i=ye(ui),bi=ye(Pt),wi=ye(di),ki=ye(pi),Si=ye(Oe),Oi=ee;(ui&&Oi(new ui(new ArrayBuffer(1)))!=gi||Pt&&Oi(new Pt)!=fi||di&&Oi(di.resolve())!=yi||pi&&Oi(new pi)!=mi||Oe&&Oi(new Oe)!=vi)&&(Oi=function(e){var t=ee(e),i="[object Object]"==t?e.constructor:void 0,r=i?ye(i):"";if(r)switch(r){case _i:return gi;case bi:return fi;case wi:return yi;case ki:return mi;case Si:return vi}return t});var Ii=Object.prototype.hasOwnProperty;var Li=G.Uint8Array;function Ci(e){var t=new e.constructor(e.byteLength);return new Li(t).set(new Li(e)),t}var Ei=/\w*$/;var ji=W?W.prototype:void 0,Ti=ji?ji.valueOf:void 0;function xi(e,t,i){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Ci(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e){var t=Ci(e.buffer);return new e.constructor(t,e.byteOffset,e.byteLength)}(e);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e){var t=Ci(e.buffer);return new e.constructor(t,e.byteOffset,e.length)}(e);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Ei.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return Ti?Object(Ti.call(e)):{}}(e)}}var Pi=lt&&lt.isMap,Ai=Pi?st(Pi):function(e){return te(e)&&"[object Map]"==Oi(e)};var Mi=lt&&lt.isSet,Bi=Mi?st(Mi):function(e){return te(e)&&"[object Set]"==Oi(e)},zi="[object Arguments]",Fi="[object Function]",Ni="[object Object]",Di={};function $i(e,t,i,r,s,n){var a;if(i&&(a=s?i(e,r,s,n):i(e)),void 0!==a)return a;if(!le(e))return e;var o=se(e);if(o)a=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&Ii.call(e,"index")&&(i.index=e.index,i.input=e.input),i}(e);else{var l=Oi(e),c=l==Fi||"[object GeneratorFunction]"==l;if(it(e))return function(e){return e.slice()}(e);if(l==Ni||l==zi||c&&!s)a={};else{if(!Di[l])return s?e:{};a=xi(e,l)}}n||(n=new ii);var h=n.get(e);if(h)return h;n.set(e,a),Bi(e)?e.forEach((function(r){a.add($i(r,t,i,r,e,n))})):Ai(e)&&e.forEach((function(r,s){a.set(s,$i(r,t,i,s,e,n))}));var u=o?void 0:hi(e);return function(e,t){for(var i=-1,r=null==e?0:e.length;++i<r&&!1!==t(e[i],i,e););}(u||e,(function(r,s){u&&(r=e[s=r]),Ne(a,s,$i(r,t,i,s,e,n))})),a}Di[zi]=Di["[object Array]"]=Di["[object ArrayBuffer]"]=Di["[object DataView]"]=Di["[object Boolean]"]=Di["[object Date]"]=Di["[object Float32Array]"]=Di["[object Float64Array]"]=Di["[object Int8Array]"]=Di["[object Int16Array]"]=Di["[object Int32Array]"]=Di["[object Map]"]=Di["[object Number]"]=Di[Ni]=Di["[object RegExp]"]=Di["[object Set]"]=Di["[object String]"]=Di["[object Symbol]"]=Di["[object Uint8Array]"]=Di["[object Uint8ClampedArray]"]=Di["[object Uint16Array]"]=Di["[object Uint32Array]"]=!0,Di["[object Error]"]=Di[Fi]=Di["[object WeakMap]"]=!1;function Ri(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new Mt;++t<i;)this.add(e[t])}function Hi(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}function Vi(e,t){return e.has(t)}Ri.prototype.add=Ri.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ri.prototype.has=function(e){return this.__data__.has(e)};function Ui(e,t,i,r,s,n){var a=1&i,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=n.get(e),h=n.get(t);if(c&&h)return c==t&&h==e;var u=-1,d=!0,p=2&i?new Ri:void 0;for(n.set(e,t),n.set(t,e);++u<o;){var f=e[u],y=t[u];if(r)var m=a?r(y,f,u,t,e,n):r(f,y,u,e,t,n);if(void 0!==m){if(m)continue;d=!1;break}if(p){if(!Hi(t,(function(e,t){if(!Vi(p,t)&&(f===e||s(f,e,i,r,n)))return p.push(t)}))){d=!1;break}}else if(f!==y&&!s(f,y,i,r,n)){d=!1;break}}return n.delete(e),n.delete(t),d}function qi(e){var t=-1,i=Array(e.size);return e.forEach((function(e,r){i[++t]=[r,e]})),i}function Gi(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var Wi=W?W.prototype:void 0,Ji=Wi?Wi.valueOf:void 0;var Ki=Object.prototype.hasOwnProperty;var Zi="[object Arguments]",Yi="[object Array]",Qi="[object Object]",Xi=Object.prototype.hasOwnProperty;function er(e,t,i,r,s,n){var a=se(e),o=se(t),l=a?Yi:Oi(e),c=o?Yi:Oi(t),h=(l=l==Zi?Qi:l)==Qi,u=(c=c==Zi?Qi:c)==Qi,d=l==c;if(d&&it(e)){if(!it(t))return!1;a=!0,h=!1}if(d&&!h)return n||(n=new ii),a||ht(e)?Ui(e,t,i,r,s,n):function(e,t,i,r,s,n,a){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!n(new Li(e),new Li(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ze(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=qi;case"[object Set]":var l=1&r;if(o||(o=Gi),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var h=Ui(o(e),o(t),r,s,n,a);return a.delete(e),h;case"[object Symbol]":if(Ji)return Ji.call(e)==Ji.call(t)}return!1}(e,t,l,i,r,s,n);if(!(1&i)){var p=h&&Xi.call(e,"__wrapped__"),f=u&&Xi.call(t,"__wrapped__");if(p||f){var y=p?e.value():e,m=f?t.value():t;return n||(n=new ii),s(y,m,i,r,n)}}return!!d&&(n||(n=new ii),function(e,t,i,r,s,n){var a=1&i,o=ci(e),l=o.length;if(l!=ci(t).length&&!a)return!1;for(var c=l;c--;){var h=o[c];if(!(a?h in t:Ki.call(t,h)))return!1}var u=n.get(e),d=n.get(t);if(u&&d)return u==t&&d==e;var p=!0;n.set(e,t),n.set(t,e);for(var f=a;++c<l;){var y=e[h=o[c]],m=t[h];if(r)var v=a?r(m,y,h,t,e,n):r(y,m,h,e,t,n);if(!(void 0===v?y===m||s(y,m,i,r,n):v)){p=!1;break}f||(f="constructor"==h)}if(p&&!f){var g=e.constructor,_=t.constructor;g!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof _&&_ instanceof _)&&(p=!1)}return n.delete(e),n.delete(t),p}(e,t,i,r,s,n))}function tr(e,t,i,r,s){return e===t||(null==e||null==t||!te(e)&&!te(t)?e!=e&&t!=t:er(e,t,i,r,tr,s))}function ir(e){return e==e&&!le(e)}function rr(e,t){return function(i){return null!=i&&(i[e]===t&&(void 0!==t||e in Object(i)))}}function sr(e){var t=function(e){for(var t=vt(e),i=t.length;i--;){var r=t[i],s=e[r];t[i]=[r,s,ir(s)]}return t}(e);return 1==t.length&&t[0][2]?rr(t[0][0],t[0][1]):function(i){return i===e||function(e,t,i,r){var s=i.length,n=s;if(null==e)return!n;for(e=Object(e);s--;){var a=i[s];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++s<n;){var o=(a=i[s])[0],l=e[o],c=a[1];if(a[2]){if(void 0===l&&!(o in e))return!1}else if(!tr(c,l,3,r,new ii))return!1}return!0}(i,0,t)}}function nr(e,t){return null!=e&&t in Object(e)}function ar(e,t){return null!=e&&function(e,t,i){for(var r=-1,s=(t=Dt(t,e)).length,n=!1;++r<s;){var a=$t(t[r]);if(!(n=null!=e&&i(e,a)))break;e=e[a]}return n||++r!=s?n:!!(s=null==e?0:e.length)&&Ve(s)&&Me(a,s)&&(se(e)||Qe(e))}(e,t,nr)}function or(e){return Ot(e)?function(e){return function(t){return null==t?void 0:t[e]}}($t(e)):function(e){return function(t){return Rt(t,e)}}(e)}function lr(e){return"function"==typeof e?e:null==e?ce:"object"==typeof e?se(e)?function(e,t){return Ot(e)&&ir(t)?rr($t(e),t):function(i){var r=Ht(i,e);return void 0===r&&r===t?ar(i,e):tr(t,r,3)}}(e[0],e[1]):sr(e):or(e)}function cr(e){return te(e)&&Ue(e)}function hr(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var ur=Math.min;function dr(e){return cr(e)?e:[]}function pr(e,t){return t.length<2?e:Rt(e,function(e,t,i){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(i=i>s?s:i)<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;for(var n=Array(s);++r<s;)n[r]=e[r+t];return n}(t,0,-1))}He((function(e){var t=hr(e),i=re(e,dr);return t===hr(i)?t=void 0:i.pop(),i.length&&i[0]===e[0]?function(e,t){for(var i=Pe,r=e[0].length,s=e.length,n=s,a=Array(s),o=1/0,l=[];n--;){var c=e[n];n&&t&&(c=re(c,st(t))),o=ur(c.length,o),a[n]=t||r>=120&&c.length>=120?new Ri(n&&c):void 0}c=e[0];var h=-1,u=a[0];e:for(;++h<r&&l.length<o;){var d=c[h],p=t?t(d):d;if(d=0!==d?d:0,!(u?Vi(u,p):i(l,p))){for(n=s;--n;){var f=a[n];if(!(f?Vi(f,p):i(e[n],p)))continue e}u&&u.push(p),l.push(d)}}return l}(i,lr(t)):[]}));var fr=Object.prototype.hasOwnProperty;function yr(e,t){return null==(e=pr(e,t=Dt(t,e)))||delete e[$t(hr(t))]}function mr(e){return ti(e)?void 0:e}var vr=Jt((function(e,t){var i={};if(null==e)return i;var r=!1;t=re(t,(function(t){return t=Dt(t,e),r||(r=t.length>1),t})),De(e,hi(e),i),r&&(i=$i(i,7,mr));for(var s=t.length;s--;)yr(i,t[s]);return i}));function gr(e,t,i,r){if(!le(e))return e;for(var s=-1,n=(t=Dt(t,e)).length,a=n-1,o=e;null!=o&&++s<n;){var l=$t(t[s]),c=i;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(s!=a){var h=o[l];void 0===(c=void 0)&&(c=le(h)?h:Me(t[s+1])?[]:{})}Ne(o,l,c),o=o[l]}return e}function _r(e,t){return function(e,t,i){for(var r=-1,s=t.length,n={};++r<s;){var a=t[r],o=Rt(e,a);i(o,a)&&gr(n,Dt(a,e),o)}return n}(e,t,(function(t,i){return ar(e,i)}))}Jt((function(e,t){return null==e?{}:_r(e,t)}));var br=Math.floor,wr=Math.min;function kr(e,t,i){return function(e,t,i){var r=0,s=null==e?0:e.length;if(0===s)return 0;for(var n=(t=i(t))!=t,a=null===t,o=ie(t),l=void 0===t;r<s;){var c=br((r+s)/2),h=i(e[c]),u=void 0!==h,d=null===h,p=h==h,f=ie(h);if(n)var y=p;else y=l?p&&u:a?p&&u&&!d:o?p&&u&&!d&&!f:!d&&!f&&h<t;y?r=c+1:s=c}return wr(s,4294967294)}(e,t,lr(i))}var Sr=pi&&1/Gi(new pi([,-0]))[1]==1/0?function(e){return new pi(e)}:function(){};function Or(e){return null==e||"string"==typeof e&&""===e||ti(e)&&function(e){if(null==e)return!0;if(Ue(e)&&(se(e)||"string"==typeof e||"function"==typeof e.splice||it(e)||ht(e)||Qe(e)))return!e.length;var t=Oi(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(We(e))return!mt(e).length;for(var i in e)if(fr.call(e,i))return!1;return!0}(e)||Array.isArray(e)&&e.length<1||"object"==typeof e&&!1===se(e)&&function(e){let t=!0;if("object"==typeof e&&!1===se(e))for(const i in e){const r=null==e?void 0:e[i];if(!0===e.hasOwnProperty(i)&&null!=r&&""!==r){t=!1;break}}return t}(e)}async function Ir(e,t){return(0,u.default)(e,t)}He((function(e){var t=hr(e);return cr(t)&&(t=void 0),function(e,t,i){var r=-1,s=Pe,n=e.length,a=!0,o=[],l=o;if(n>=200){var c=t?null:Sr(e);if(c)return Gi(c);a=!1,s=Vi,l=new Ri}else l=t?[]:o;e:for(;++r<n;){var h=e[r],u=t?t(h):h;if(h=0!==h?h:0,a&&u==u){for(var d=l.length;d--;)if(l[d]===u)continue e;t&&l.push(u),o.push(h)}else s(l,u,i)||(l!==o&&l.push(u),o.push(h))}return o}(Gt(e,0,cr,!0),lr(t))}));const Lr={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",Norwegian:"no",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"},Cr=[...Object.values(Lr),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"],Er=[Lr.Arabic,Lr.Hebrew];function jr(e){let t=Lr.English;if(void 0!==e){const i=Object.values(Lr),r=i.filter((e=>-1!==e.indexOf("-")));if(-1!==e.indexOf("-")){const[t,i]=e.split("-");e=`${t}-${i.toUpperCase()}`}if(!0===r.includes(e))t=e;else{const r=function(e){const t=null==e?void 0:e.match(/^([a-z]{2})-([A-Z]{1,2})$/);let i=Lr.English;return null!=t&&(null==t?void 0:t.length)>1?i=t[1]:2===(null==e?void 0:e.length)&&e.toLowerCase()===e&&(i=e),i}(e);!0===i.includes(r)?t=r:["nb","nn"].includes(r)&&(t="no")}}return t}function Tr(e=document.documentElement){const t=function(e,t){return function t(i){let r;return r=void 0===i||i===document||i===window?null:i.closest(e)||t(i.getRootNode().host),r}(t)}("[lang]",e),i=(null==t?void 0:t.lang)??window.navigator.language,r=jr(i),s=function(e){let t=Cr.find((t=>t===e));if(void 0===t&&(t=e),void 0!==t&&-1!==t.indexOf("-")){const[e,i]=t.split("-");t=`${e}-${i.toUpperCase()}`}return"ar"===t?t="ar-u-nu-latn":("nn"===t||"nn-NO"===t)&&(t="no-NN"),t}(i);return{locale:r,rtl:Er.includes(r),formatLocale:s}}class xr extends Error{constructor(e,t,i,r){super(t),this.name=e,this.details=i,this.cause=r}}const Pr="networkError",Ar="portalLoadError",Mr="webToolFailedFetch",Br="accessBlocked";function zr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fr,Nr,Dr,$r,Rr,Hr,Vr,Ur;function qr(){return Hr||(Hr=1,Rr=(Nr||(Nr=1,Fr=function(){return!("object"!=typeof globalThis||!globalThis)&&globalThis.Array===Array}),Fr)()?globalThis:function(){if($r)return Dr;$r=1;var e=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};return Dr=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return e()}try{return __global__||e()}finally{delete Object.prototype.__global__}}()}()),Rr}var Gr,Wr,Jr,Kr,Zr,Yr,Qr,Xr,es,ts,is,rs,ss,ns,as,os,ls,cs,hs,us,ds,ps,fs,ys,ms,vs,gs,_s,bs,ws,ks,Ss,Os,Is,Ls,Cs,Es,js,Ts,xs,Ps,As,Ms,Bs,zs,Fs,Ns,Ds,$s,Rs,Hs,Vs,Us,qs,Gs,Ws={exports:{}};function Js(){if(Wr)return Gr;Wr=1;return Gr=function(e){return null!=e}}function Ks(){if(Yr)return Zr;Yr=1;var e=function(){if(Kr)return Jr;Kr=1;var e=Js(),t={object:!0,function:!0,undefined:!0};return Jr=function(i){return!!e(i)&&hasOwnProperty.call(t,typeof i)}}();return Zr=function(t){if(!e(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch{return!1}}}function Zs(){if(ts)return es;ts=1;var e=function(){if(Xr)return Qr;Xr=1;var e=Ks();return Qr=function(t){if("function"!=typeof t||!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length||"function"!=typeof t.call||"function"!=typeof t.apply)return!1}catch{return!1}return!e(t)}}(),t=/^\s*class[\s{/}]/,i=Function.prototype.toString;return es=function(r){return!(!e(r)||t.test(i.call(r)))}}function Ys(){if(cs)return ls;cs=1;var e=(os||(os=1,as=function(){}),as)();return ls=function(t){return t!==e&&null!==t}}function Qs(){return ps||(ps=1,ds=(ns||(ns=1,ss=function(){try{return!0}catch{return!1}}),ss)()?Object.keys:function(){if(us)return hs;us=1;var e=Ys(),t=Object.keys;return hs=function(i){return t(e(i)?Object(i):i)}}()),ds}function Xs(){if(vs)return ms;vs=1;var e=Qs(),t=function(){if(ys)return fs;ys=1;var e=Ys();return fs=function(t){if(!e(t))throw new TypeError("Cannot use null or undefined");return t}}(),i=Math.max;return ms=function(r,s){var n,a,o,l=i(arguments.length,2);for(r=Object(t(r)),o=function(e){try{r[e]=s[e]}catch(e){n||(n=e)}},a=1;a<l;++a)e(s=arguments[a]).forEach(o);if(void 0!==n)throw n;return r},ms}function en(){return _s||(_s=1,gs=(rs||(rs=1,is=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),is)()?Object.assign:Xs()),gs}function tn(){return Cs||(Cs=1,Ls=function(){if(Ss)return ks;Ss=1;var e="razdwatrzy";return ks=function(){return"function"==typeof e.contains&&!0===e.contains("dwa")&&!1===e.contains("foo")}}()()?String.prototype.contains:function(){if(Is)return Os;Is=1;var e=String.prototype.indexOf;return Os=function(t){return e.call(this,t,arguments[1])>-1},Os}()),Ls}function rn(){if(Es)return Ws.exports;Es=1;var e=Js(),t=Zs(),i=en(),r=function(){if(ws)return bs;ws=1;var e=Ys(),t=Array.prototype.forEach,i=Object.create;return bs=function(r){var s=i(null);return t.call(arguments,(function(t){e(t)&&function(e,t){var i;for(i in e)t[i]=e[i]}(Object(t),s)})),s},bs}(),s=tn(),n=Ws.exports=function(t,n){var a,o,l,c,h;return arguments.length<2||"string"!=typeof t?(c=n,n=t,t=null):c=arguments[2],e(t)?(a=s.call(t,"c"),o=s.call(t,"e"),l=s.call(t,"w")):(a=l=!0,o=!1),h={value:n,configurable:a,enumerable:o,writable:l},c?i(r(c),h):h};return n.gs=function(n,a,o){var l,c,h,u;return"string"!=typeof n?(h=o,o=a,a=n,n=null):h=arguments[3],e(a)?t(a)?e(o)?t(o)||(h=o,o=void 0):o=void 0:(h=a,a=o=void 0):a=void 0,e(n)?(l=s.call(n,"c"),c=s.call(n,"e")):(l=!0,c=!1),u={get:a,set:o,configurable:l,enumerable:c},h?i(r(h),u):u},Ws.exports}function sn(){if(Ps)return xs;Ps=1;var e=(Ts||(Ts=1,js=function(e){return!(!e||"symbol"!=typeof e&&(!e.constructor||"Symbol"!==e.constructor.name||"Symbol"!==e[e.constructor.toStringTag]))}),js);return xs=function(t){if(!e(t))throw new TypeError(t+" is not a symbol");return t}}function nn(){if($s)return Ds;$s=1;var e,t,i,r=rn(),s=sn(),n=qr().Symbol,a=function(){if(Ms)return As;Ms=1;var e=rn(),t=Object.create,i=Object.defineProperty,r=Object.prototype,s=t(null);return As=function(t){for(var n,a,o=0;s[t+(o||"")];)++o;return s[t+=o||""]=!0,i(r,n="@@"+t,e.gs(null,(function(t){a||(a=!0,i(this,n,e(t)),a=!1)}))),n}}(),o=function(){if(zs)return Bs;zs=1;var e=rn(),t=qr().Symbol;return Bs=function(i){return Object.defineProperties(i,{hasInstance:e("",t&&t.hasInstance||i("hasInstance")),isConcatSpreadable:e("",t&&t.isConcatSpreadable||i("isConcatSpreadable")),iterator:e("",t&&t.iterator||i("iterator")),match:e("",t&&t.match||i("match")),replace:e("",t&&t.replace||i("replace")),search:e("",t&&t.search||i("search")),species:e("",t&&t.species||i("species")),split:e("",t&&t.split||i("split")),toPrimitive:e("",t&&t.toPrimitive||i("toPrimitive")),toStringTag:e("",t&&t.toStringTag||i("toStringTag")),unscopables:e("",t&&t.unscopables||i("unscopables"))})}}(),l=function(){if(Ns)return Fs;Ns=1;var e=rn(),t=sn(),i=Object.create(null);return Fs=function(r){return Object.defineProperties(r,{for:e((function(e){return i[e]?i[e]:i[e]=r(String(e))})),keyFor:e((function(e){var r;for(r in t(e),i)if(i[r]===e)return r}))})}}(),c=Object.create,h=Object.defineProperties,u=Object.defineProperty;if("function"==typeof n)try{String(n()),i=!0}catch{}else n=null;return t=function(i){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return e(i)},Ds=e=function e(s){var o;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return i?n(s):(o=c(t.prototype),s=void 0===s?"":String(s),h(o,{__description__:r("",s),__name__:r("",a(s))}))},o(e),l(e),h(t.prototype,{constructor:r(e),toString:r("",(function(){return this.__name__}))}),h(e.prototype,{toString:r((function(){return"Symbol ("+s(this).__description__+")"})),valueOf:r((function(){return s(this)}))}),u(e.prototype,e.toPrimitive,r("",(function(){var e=s(this);return"symbol"==typeof e?e:e.toString()}))),u(e.prototype,e.toStringTag,r("c","Symbol")),u(t.prototype,e.toStringTag,r("c",e.prototype[e.toStringTag])),u(t.prototype,e.toPrimitive,r("c",e.prototype[e.toPrimitive])),Ds}function an(){return Hs||(Hs=1,Rs=function(){if(Ur)return Vr;Ur=1;var e=qr(),t={object:!0,symbol:!0};return Vr=function(){var i=e.Symbol;return"function"==typeof i&&(i("test symbol"),!(!t[typeof i.iterator]||!t[typeof i.toPrimitive]||!t[typeof i.toStringTag]))}}()()?qr().Symbol:nn()),Rs}!function(){if(Gs)return qs;Gs=1;const e=an(),t=function(){if(Us)return Vs;Us=1;const e="modeNone",t="modeDefault",i="modeMatch",r=(e,t)=>e.length>t.length?-1:e.length<t.length?1:0,s=(e,t)=>-1!==e.indexOf(t,e.length-t.length);class n{constructor(t,i,r){this.factory=t,this.str=i,this.forEachToken=r,this.previousChr="",this.toMatch="",this.currentToken="",this.modeStack=[e],this.currentIndex=0}getCurrentMode(){return this.modeStack[this.modeStack.length-1]}setCurrentMode(e){return this.modeStack.push(e)}completeCurrentMode(){const e=this.getCurrentMode();return e===t&&this.pushDefaultModeTokenizables(),(e===i&&""===this.currentToken||""!==this.currentToken)&&this.push(this.currentToken),this.currentToken="",this.modeStack.pop()}push(e){let t="";if(this.factory.convertLiterals&&this.getCurrentMode()!==i)switch(e.toLowerCase()){case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:isFinite(e)&&(e=Number(e))}else t=this.toMatch;this.forEachToken&&this.forEachToken(e,t,this.currentIndex)}tokenize(){let t=0;for(;t<this.str.length;)this.currentIndex=t,this.consume(this.str.charAt(t++));for(;this.getCurrentMode()!==e;)this.completeCurrentMode()}consume(e){this[this.getCurrentMode()](e),this.previousChr=e}[e](e){if(!this.factory.matchMap[e])return this.setCurrentMode(t),this.consume(e);this.setCurrentMode(i),this.toMatch=e}[t](e){if(this.factory.delimiterMap[e])return this.completeCurrentMode();if(this.factory.matchMap[e]){let t=0;for(;t<this.factory.tokenizeList.length;)if(s(this.currentToken,this.factory.tokenizeList[t++]))return this.completeCurrentMode(),this.consume(e)}return this.currentToken+=e,this.currentToken}pushDefaultModeTokenizables(){let e=0,t=1/0,i=null;for(;this.currentToken&&e<this.factory.tokenizeList.length;){const r=this.factory.tokenizeList[e++],s=this.currentToken.indexOf(r);-1!==s&&s<t&&(t=s,i=r)}if(i&&(t>0&&this.push(this.currentToken.substring(0,t)),-1!==t))return this.push(i),this.currentToken=this.currentToken.substring(t+i.length),this.pushDefaultModeTokenizables()}[i](e){if(e===this.toMatch){if(this.previousChr!==this.factory.escapeCharacter)return this.completeCurrentMode();this.currentToken=this.currentToken.substring(0,this.currentToken.length-1)}return this.currentToken+=e,this.currentToken}}return Vs=class{constructor(e){e||(e={}),e=Object.assign({},this.constructor.defaultConfig,e),this.convertLiterals=e.convertLiterals,this.escapeCharacter=e.escapeCharacter,this.tokenizeList=[],this.tokenizeMap={},this.matchList=[],this.matchMap={},this.delimiterList=[],this.delimiterMap={},e.shouldTokenize.sort(r).forEach((e=>{this.tokenizeMap[e]||(this.tokenizeList.push(e),this.tokenizeMap[e]=e)})),e.shouldMatch.forEach((e=>{this.matchMap[e]||(this.matchList.push(e),this.matchMap[e]=e)})),e.shouldDelimitBy.forEach((e=>{this.delimiterMap[e]||(this.delimiterList.push(e),this.delimiterMap[e]=e)}))}tokenize(e,t){return new n(this,e,t).tokenize()}static get defaultConfig(){return{shouldTokenize:["(",")",",","*","/","%","+","-","=","!=","!","<",">","<=",">=","^"],shouldMatch:['"',"'","`"],shouldDelimitBy:[" ","\n","\r","\t"],convertLiterals:!0,escapeCharacter:"\\"}}}}(),i=e("-"),r={[i]:1};class s{constructor(e,t,i){this.value=e,this.type=t,this.precedence=i}toJSON(){return this.value}toString(){return`${this.value}`}}qs=class{constructor(e){e||(e={}),e=Object.assign({},this.constructor.defaultConfig,e),this.tokenizer=new t(e.tokenizer),this.operators={},e.operators.forEach(((e,t)=>{Object.keys(e).concat(Object.getOwnPropertySymbols(e)).forEach((i=>{this.operators[i]=new s(i,e[i],t)}))}))}parse(e,t){const r=[],s=[];let n,a=0,o=!1;for(t||(t=this.defaultEvaluator),this.tokenizer.tokenize(`(${e})`,((e,l)=>{if(a++,"string"!=typeof e||l)s.push(e),o=!1;else{let l=e.toUpperCase();if(this.operators[l]){if("BETWEEN"===n&&"AND"===l)return void(n="AND");for("-"===l&&(1===a||o)&&(l=i);r[r.length-1]&&"("!==r[r.length-1]&&this.operatorPrecedenceFromValues(l,r[r.length-1]);){const e=this.operators[r.pop()],i=[];let n=e.type;for(;n--;)i.unshift(s.pop());s.push(t(e.value,i))}r.push(l),n=l,o=!0}else if("("===e)r.push(e),o=!0;else if(")"===e){for(;r.length&&"("!==r[r.length-1];){const e=this.operators[r.pop()],i=[];let n=e.type;for(;n--;)i.unshift(s.pop());s.push(t(e.value,i))}if(!r.length)throw new SyntaxError("Unmatched parenthesis.");r.pop(),o=!1}else s.push(e),o=!1}}));r.length;){const e=r.pop();if("("===e)throw new SyntaxError("Unmatched parenthesis.");const i=this.operators[e],n=[];let a=i.type;for(;a--;)n.unshift(s.pop());s.push(t(i.value,n))}if(s.length>1)throw new SyntaxError("Could not reduce to a single expression.");return s[0]}toArray(e){let t,r=[],n=0;const a=[];for(this.tokenizer.tokenize(`(${e})`,((e,o)=>{switch(n++,e){case"(":a.push(r.length);break;case")":const l=a.pop();let c=r.splice(l,r.length);for(;c&&c.constructor===Array&&1===c.length;)c=c[0];r.push(c);break;case"":case",":break;default:let h=null;o||(h=this.getOperator(e),"-"===e&&(1===n||"("===t||t&&t.constructor===s)&&(h=this.getOperator(i))),r.push(h||e)}t=e}));r&&r.constructor===Array&&1===r.length;)r=r[0];return r}operatorPrecedenceFromValues(e,t){return this.operators[t].precedence<=this.operators[e].precedence}getOperator(e){return"string"==typeof e?this.operators[e.toUpperCase()]:"symbol"==typeof e?this.operators[e]:null}defaultEvaluator(e,t){return e===i&&(e="-"),","===e?[].concat(t[0],t[1]):{[e]:t}}static get defaultConfig(){return{operators:[{"!":1},r,{"^":2},{"*":2,"/":2,"%":2},{"+":2,"-":2},{"=":2,"<":2,">":2,"<=":2,">=":2,"!=":2},{",":2},{NOT:1},{BETWEEN:3,IN:2,IS:2,LIKE:2},{AND:2},{OR:2}],tokenizer:{shouldTokenize:["(",")",",","*","/","%","+","-","=","!=","!","<",">","<=",">=","^"],shouldMatch:['"',"'","`"],shouldDelimitBy:[" ","\n","\r","\t"]}}}static get Operator(){return s}static get OPERATOR_UNARY_MINUS(){return i}}}();const on="standard",ln="raster";var cn,hn={exports:{}};const un=zr(function(){if(cn)return hn.exports;function e(e,t,i,r){var s=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(r)?r:i(r),n=t.get(s);return typeof n>"u"&&(n=e.call(this,r),t.set(s,n)),n}function t(e,t,i){var r=Array.prototype.slice.call(arguments,3),s=i(r),n=t.get(s);return typeof n>"u"&&(n=e.apply(this,r),t.set(s,n)),n}function i(e,t,i,r,s){return i.bind(t,e,r,s)}function r(r,s){return i(r,this,1===r.length?e:t,s.cache.create(),s.serializer)}function s(){return JSON.stringify(arguments)}function n(){this.cache=Object.create(null)}cn=1,n.prototype.has=function(e){return e in this.cache},n.prototype.get=function(e){return this.cache[e]},n.prototype.set=function(e,t){this.cache[e]=t};var a={create:function(){return new n}};return hn.exports=function(e,t){var i=t&&t.cache?t.cache:a,n=t&&t.serializer?t.serializer:s;return(t&&t.strategy?t.strategy:r)(e,{cache:i,serializer:n})},hn.exports.strategies={variadic:function(e,r){return i(e,this,t,r.cache.create(),r.serializer)},monadic:function(t,r){return i(t,this,e,r.cache.create(),r.serializer)}},hn.exports}()),dn=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];un((async({data:e,toolUIStrings:t})=>{const i=mn(e,"geocodeServiceURL");let r;try{({data:{detailedCountries:r}}=await Ir(`${i}?f=json`,{responseType:"json"}))}catch{return[]}const{locale:s}=Tr(),n=r.map((e=>{const t=e.localizedNames,i=s.length>2&&s;let r;if("boolean"!=typeof i&&(r=t[i]),void 0===r){const e=2===s.length?s:s.slice(0,2);if(r=t[e],void 0===r){const i=Object.keys(t).find((t=>t.startsWith(e)));void 0!==i&&(r=t[i])}}return(null==r||""===r)&&(r=t[Lr.English]??t[Lr.EnglishUSA]),{name:e.name,label:r}}));if(!0===(function(e){return null!==e.match(/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi)}(i)||function(e){return null!==e.match(/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi)}(i))){const e={name:"",label:(null==t?void 0:t.world)??"World"};n.splice(kr(n,e,"label"),0,e)}return n}),{serializer:e=>{const{data:{geocodeServiceURL:t}}=e;return t??"EMPTY_KEY"}}),un((async(e,t)=>{const i=function(e,t){const{locale:i}=Tr(),r=mn(e,"geocodeServiceURL");let s={asyncGeocodeUrl:t.helperServices.asyncGeocode.url,geocodeServiceURL:r,locale:i};const n=gn(Ht(e,"inputFileItem.itemId"),t),a=mn(e,"inputTable");if(Or(null==n?void 0:n.id))Or(null==a?void 0:a.url)||(s={...s,inputTable:{url:a.url,serviceToken:a.serviceToken}});else{const e="CSV"===n.type?"csv":"xlsx";s={...s,inputFileItem:{itemid:n.id},inputFileParameters:{fileType:e,headerRowExists:"true",columnDelimiter:"",textQualifier:""}}}return s}(e,t);let r,s,n;try{r=await vn(i)}catch{return{geocodeParameters:void 0,addressFields:[],labels:{},values:[]}}try{s=JSON.parse(r.field_info),n=JSON.parse(r.field_mapping).reduce(((e,t)=>({...e,[t[1]]:t[0]})),{})}catch{return{addressFields:[],labels:{},values:[]}}const a=s.map((e=>e[0])),o=a.reduce(((e,t)=>({...e,[t]:t})),{});return{geocodeParameters:r,addressFields:a,labels:o,values:dn.map((e=>n[e]))}}),{serializer:e=>{const{geocodeServiceURL:t,inputFileItem:i,inputTable:r}=e[0],s=null==i?void 0:i.itemId,n=null==r?void 0:r.url;return Or(t)||Or(s)&&Or(n)?"EMPTY_KEY":`${t}${s}${n}`}});async function pn(e,t){const r=await async function(e=Tr().locale){let t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-81c771").then(i.bind(i,33590));switch(e){case Lr.Arabic:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-dc50b6").then(i.bind(i,11129));break;case Lr.Bosnian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-aa1be8").then(i.bind(i,19490));break;case Lr.Bulgarian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-ff7109").then(i.bind(i,98208));break;case Lr.Catalan:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-ab12fe").then(i.bind(i,97961));break;case Lr.Czech:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-6dd664").then(i.bind(i,28085));break;case Lr.Danish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-1049fb").then(i.bind(i,77633));break;case Lr.German:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-3fb78f").then(i.bind(i,24362));break;case Lr.Greek:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-c6af63").then(i.bind(i,32004));break;case Lr.EnglishUSA:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-d90e25").then(i.bind(i,65102));break;case Lr.Spanish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-4d0d8c").then(i.bind(i,47868));break;case Lr.Estonian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-b7e0bb").then(i.bind(i,4534));break;case Lr.Finnish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-55965f").then(i.bind(i,64732));break;case Lr.French:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-82fbf1").then(i.bind(i,45069));break;case Lr.Hebrew:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-862f94").then(i.bind(i,10966));break;case Lr.Croatian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-60cdc9").then(i.bind(i,23481));break;case Lr.Hungarian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-e8a552").then(i.bind(i,18824));break;case Lr.Indonesian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-9a6446").then(i.bind(i,24667));break;case Lr.Italian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-4d76e8").then(i.bind(i,94798));break;case Lr.Japanese:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-de1718").then(i.bind(i,87128));break;case Lr.Korean:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-3ec75d").then(i.bind(i,91812));break;case Lr.Lithuanian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-42133f").then(i.bind(i,98657));break;case Lr.Latvian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-45b9e9").then(i.bind(i,89259));break;case Lr.Norwegian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-37495b").then(i.bind(i,96457));break;case Lr.Dutch:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-85ea39").then(i.bind(i,29870));break;case Lr.Polish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-0c6ae0").then(i.bind(i,83550));break;case Lr.PortugueseBrazil:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-4fefa0").then(i.bind(i,42067));break;case Lr.PortuguesePortugal:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-f1c2ca").then(i.bind(i,66964));break;case Lr.Romanian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-348791").then(i.bind(i,76526));break;case Lr.Russian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-8a0174").then(i.bind(i,94422));break;case Lr.Serbian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-938f0d").then(i.bind(i,9794));break;case Lr.Slovak:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-6e1109").then(i.bind(i,62690));break;case Lr.Slovenian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-da876d").then(i.bind(i,99104));break;case Lr.Swedish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-93aaec").then(i.bind(i,69760));break;case Lr.Thai:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-914fff").then(i.bind(i,93942));break;case Lr.Turkish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-5d9ca1").then(i.bind(i,49152));break;case Lr.Ukrainian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-431f1a").then(i.bind(i,57104));break;case Lr.Vietnamese:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-5d5fa5").then(i.bind(i,34786));break;case Lr.ChineseChina:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-a9381c").then(i.bind(i,90577));break;case Lr.ChineseHongKong:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-574d6d").then(i.bind(i,57231));break;case Lr.ChineseTaiwan:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-eff8dc").then(i.bind(i,7079))}return t}(),s=r[e]??r.defaultError;throw new xr(e,s,{type:"analysis_ui"},t)}const fn={Standalone:"standalone"};function yn(e){e??(e=on);let t="";if(e===ln)t="_ra";else t="";return t}function mn(e,t){return Ht(e,t)}Bt((async e=>{const{locale:t,name:i,assetPrefix:r,analysisEngine:s,uiMode:n=fn.Standalone,memoizedHelper:a}=e,o=`${i.toLowerCase()}${yn(s)}`;let l,c,h,u,d,p="",f="";if("modelbuilder"===n){const e=`${r}/tool-ui-json/mb/mb-overrides-manifest.json`,t=await a(e),i=null==t?void 0:t.overrides;p=`${r}/tool-ui-json/${!0===(void 0!==t&&(null==i?void 0:i.includes(o)))?"mb/":""}${o}.tool.ui.json`,f=`${r}/tool-ui-json/mb/allToolOverrides.json`}else p=`${r}/tool-ui-json/${o}.tool.ui.json`;l=await a(p);const y=`${r}/tool-json/${o}.tool.json`,m=`${r}/t9n/${o}/${o}.t9n.${t}.json`,v=`${r}/t9n/common.t9n.${t}.json`;let g=t;(t===Lr.English||t===Lr.EnglishUSA)&&(g="");const _=`${r}/help/${""!==g?g+"/":""}${i}${yn(s)}.html`;try{c=await a(m),h=await a(v),c={...h,...c},"modelbuilder"===n?d=await a(f):u=await a(y)}catch{l=void 0}return{toolJson:u,toolUIJson:l,toolT9n:c,toolHelpFilePath:_,allToolOverrides:d}})),Bt((e=>{var t;const i={};let r;if(void 0!==e.featureSet){if(i.source=v.default.fromJSON(e.featureSet).features,r=e.layerDefinition,void 0!==r.fields&&(i.fields=r.fields.map((e=>y.default.fromJSON(e)))),void 0!==r.objectIdField&&(i.objectIdField=r.objectIdField),void 0!==r.geometryType){let e="point";switch(r.geometryType){case"esriGeometryMultipoint":e="multipoint";break;case"esriGeometryPoint":e="point";break;case"esriGeometryPolygon":e="polygon";break;case"esriGeometryPolyline":e="polyline"}i.geometryType=e}void 0!==r.spatialReference&&(i.spatialReference=r.spatialReference),void 0!==(null==(t=r.drawingInfo)?void 0:t.renderer)&&(i.renderer=m.default.fromJSON(r.drawingInfo.renderer))}return new d.default(i)})),Bt((async(e,t)=>{let i=!1;if(!0===window.location.href.includes("://localhost:")||void 0===t)i=!0;else{const r=`${e}${e.indexOf("?")>-1?"&":"?"}f=json`;f.default.request.proxyUrl=`${t}/sharing/proxy`;try{i=!1===Or((await Ir(r,{useProxy:!0})).data)}catch{i=!1}}return!0===i?e:void 0})),un((async e=>{const{url:t}=e,i=`${t}/sharing/rest/community/self`,r=h.default.findCredential(i);let s;void 0!==r&&(s=r.token);const n={query:{returnUserLicensedItems:!0,token:s,f:"json"}};try{const{data:{userLicensedItems:e}}=await Ir(i,n);return[...e.map((({entitlements:e})=>e))].flat()}catch{await pn(Pr)}return[]}),{serializer:e=>{var t;return`${null==(t=null==e?void 0:e.user)?void 0:t.username}`}}),un((e=>function(e){const t=new Set(e.map((e=>e.id)));return Array.from(t).map((t=>e.find((e=>e.id===t))))}(e)),{serializer:e=>Array.isArray(e)?e.map((e=>null==e?void 0:e.id)).join("-"):""}),un((async e=>{var t;let i={isMultidimensional:!1};const r="imagery-tile"===e.type?null==(t=e.serviceRasterInfo)?void 0:t.multidimensionalInfo:e.multidimensionalInfo,s=e.multidimensionalSubset;if(null!=r){const t=null!=s?e.getMultidimensionalSubsetVariables():r.variables;if(void 0!==t&&t.length>0){const e=[],r=[],s={},n={},a={},o={},l={},c={},h={};t.forEach(((t,i)=>{let a="";const u=t.name;t.dimensions.forEach(((t,r)=>{var d,p;const f=t.name;-1===e.indexOf(f)&&e.push(f);const y=r>0?`,${f}=${null==(d=t.values)?void 0:d.length}`:`${f}=${null==(p=t.values)?void 0:p.length}`;if(a=a.concat(y),0===r&&(n[u]={}),void 0===s[f]&&(s[f]=[]),n[u][f]=t.values,0===i){const e=t.values;if(void 0!==e)if("StdTime"!==f||void 0!==t.unit&&"ISO8601"!==t.unit)Array.isArray(e)&&"number"==typeof e[0]?o[f]=l[f]=e.map(String):Array.isArray(null==e?void 0:e[0])&&Array.isArray(e[1])&&(o[f]=e[0].map(String),l[f]=e[1].map(String));else{const t=[],i=[],r={},s={};null==e||e.forEach((e=>{if("number"==typeof e){const n=new Date(e),a=n.toLocaleString(),o=n.toISOString();t.push(o),i.push(o),r[o]=a,s[o]=a}else if(Array.isArray(e)){const n=new Date(e[0]),a=new Date(e[1]),o=n.toISOString(),l=a.toISOString();t.push(o),i.push(l),r[o]=n.toLocaleString(),s[l]=a.toLocaleString()}})),o[f]=t,l[f]=i,c[f]=r,h[f]=s}}s[f].push(u)})),r.push({name:u,alias:`${u}[${a}](${t.description})`,type:"string"})}));for(const e in s){const t=r.filter((t=>s[e].indexOf(t.name)>-1));a[e]={id:"1",name:e,description:"DimensionVariables",getFields:()=>Promise.resolve(t)}}i={isMultidimensional:!0,dimensions:e,dimensionVariableDatasets:a,dimensionValues:n,variablesDataset:{id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(r)},dimensionMinValues:o,dimensionMaxValues:l,dimensionMinValuesWithLabels:c,dimensionMaxValuesWithLabels:h}}}let n;try{n=await e.generateRasterInfo(e.rasterFunction)}catch{n=e.serviceRasterInfo}return i.rasterInfo=n,i}));const vn=async e=>{const{asyncGeocodeUrl:t}=e,i=await g.submitJob(`${t}/AnalyzeGeocodeInput`,{...vr(e,"asyncGeocodeUrl"),f:"json"});return await i.waitForJobCompletion(),(await i.fetchResultData("geocodeParameters")).value},gn=un(((e,t)=>new p.default({id:e,portal:t})),{serializer:e=>{var t;return`${e[0]}-${null==(t=e[1])?void 0:t.url}`}});un((async e=>{var t;const{restUrl:i}=e,r=`${i}/portals/helpmap`;let s;try{s=await(null==(t=(await(0,u.default)(r,{query:{f:"json"},responseType:"json",method:"auto"})).data)?void 0:t.helpMap)??void 0}catch{s=void 0}return s}),{serializer:e=>{var t;return`${e[0]}-${null==(t=e[1])?void 0:t.url}`}}),V((async e=>{const t=new c.default({url:e});t.authMode="immediate";try{await t.load()}catch{await pn(Ar)}return t}));const _n="standard",bn="geoanalytics",wn="raster";function kn(e,t,i=!1){let r=t.helperServices.analysis.url;switch(e){case bn:r=t.helperServices.geoanalytics.url;break;case wn:r=t.helperServices.rasterAnalytics.url;break;case _n:r=i?t.helperServices.asyncGeocode.url:t.helperServices.analysis.url}return r}const Sn=e=>{const t=Array.from(e).map((e=>{let t;return t="object"==typeof e&&void 0!==e.id?e.id:e,t}));return JSON.stringify(t)},On=V((async(e,t,i)=>{var r;const s=`${kn(t,i,"BatchGeocode"===e)}/${e}?f=json`,n=await(await(0,u.default)(s,{responseType:"json",authMode:"no-prompt"})).data;return null==(r=n.parameters)||r.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),n}),{serializer:Sn}),In=V((async(e,t)=>{const i=kn(e,t),r=await(0,u.default)(`${i}?f=json`,{responseType:"json"}),{data:{tasks:s}}=r,n=s.map((i=>On(i,e,t)));return await Promise.all(n)}),{serializer:Sn});V((async(e,t)=>{let i=[];return i=void 0!==t?await In(t,e):[...await In(_n,e),...await In(wn,e),...await In(bn,e)],new Map(i.map((e=>[e.name.toLowerCase(),e])))}),{serializer:Sn}),V((async e=>{const{helperServices:t}=e;let i;if(void 0!==t.routingUtilities){const e=await g.execute(`${t.routingUtilities.url}/GetTravelModes?f=json`),{results:[{value:{features:r}},{value:s}]}=e;i={travelModes:r.map((e=>JSON.parse(e.attributes.TravelMode))),defaultTravelModeId:s}}return i}),{serializer:Sn});const Ln=V((async e=>(await(0,u.default)(`${e}?f=json`,{responseType:"json"})).data)),Cn=V((async(e,t)=>{var i;const r=`${e}/${t}?f=json`,s=await(0,u.default)(r,{responseType:"json",authMode:"no-prompt"}),n=await(null==s?void 0:s.data);return void 0!==(null==n?void 0:n.parameters)&&(null==(i=n.parameters)||i.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)}))),n}));V((async e=>{const t=await(0,u.default)(`${e}?f=json`,{responseType:"json"}),{data:{tasks:i}}=t,r=i.map((t=>Cn(e,t)));return await Promise.all(r)})),V((async(e,t)=>{var i;let r,s;try{r=await Cn(e,t),s=await Ln(e)}catch(e){throw function(e){if(!(e instanceof xr))throw e}(e),"OAUTH_0070"===(null==(i=e.details)?void 0:i.messageCode)?new xr(Br,e.message,e.details):new xr(Mr,e.message,e.details)}return r.serviceInfo=s,{...r,serviceInfo:s}}));const En="error-message",jn="string-item-browser-input-wrapper",Tn="layer-overwrite-checkbox",xn="calcite-input",Pn="item-browser-layer-button",An="top-spacing",Mn="list-item",Bn="intermediateData",zn="hostedLayer",Fn="overwriteExistingLayer",Nn=class{constructor(e){(0,r.r)(this,e),this.analysisOverwriteValueChange=(0,r.c)(this,"analysisOverwriteValueChange",7),this.analysisHelpPopoverOpen=(0,r.c)(this,"analysisHelpPopoverOpen",7),this.required=!1,this.isOutputNameTaken=!1,this.readOnly=!1,this.overwriteExistingLayer=!0,this.outputName="",this.showItemBrowser=!1,this.overwriteMode=Bn,this.filter='(type: "Feature Service")',this.itemBrowserBucketOptions=["my","favorites","group","org"],this.handleAnalysisHelpPopoverClose=()=>{(0,s.V)(this.toolHelpPopover),this.toolHelpPopover?.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.toolHelpPopover=void 0},this.updateValue=()=>{let e;if(this.overwriteMode===zn||this.overwriteMode===Fn&&void 0!==this.selectedOverwriteItem){const t=this.folderId??this.folderInputRef?.value??"";e={serviceProperties:{name:this.outputName},itemProperties:{overwrite:this.overwriteExistingLayer,folderId:t},overwriteMode:this.overwriteMode},e.itemProperties=this.selectedOverwriteItem?{...e.itemProperties,id:this.selectedOverwriteItem.id??void 0}:e.itemProperties,e=this.serializeOutputName(e,this.toolData)}else this.overwriteMode===Fn&&void 0===this.selectedOverwriteItem&&(e={serviceProperties:{name:""},itemProperties:{overwrite:!0},overwriteMode:this.overwriteMode});this.value=e,this.analysisOverwriteValueChange.emit(this.value)},this.formatUnavailableItemErrorMessage=e=>{let t=this.strings.itemNameTaken;return!1===e?t=this.strings.noPermissionToOverwrite:this.overwriteMode===Fn?t=this.strings.cannotUndoOverwrite:this.overwriteMode===zn&&!0===this.overwriteExistingLayer&&(t=this.strings.layerExistsOverwritten),{message:t,uiInputStatus:this.overwriteExistingLayer&&e?s.Z.IDLE:s.Z.INVALID}},this.validateOutputName=async()=>{if(this.isOutputNameTaken=!1,!(0,s.m)(this.outputName))return void(this.error={message:this.strings.requiredError,uiInputStatus:s.Z.INVALID});if(!1===(0,s.a5)([this.outputName]))return void(this.error={message:this.strings.specialCharactersInServiceNameError,uiInputStatus:s.Z.INVALID});const e=await async function(e){const{portal:{url:t,id:i},itemType:r,includeItemId:s=!1}=e,{serviceName:n}=e,a=`${t}/sharing/rest/portals/${i}/isServiceNameAvailable?f=json`,o={query:{f:"json",name:n,type:r,includeitemid:s}};let l={available:!0};try{const e=await(0,u.default)(a,o);l=void 0!==e.data.itemId?{available:e.data.available,itemId:e.data.itemId,inRecycleBin:e.data.inRecycleBin}:{available:e.data.available,inRecycleBin:e.data.inRecycleBin}}catch{await pn(Pr)}return l}({portal:this.portal,itemType:"Feature Service",serviceName:this.outputName,includeItemId:!0}),{itemId:t,available:i,inRecycleBin:r}=e??{};if(!0===r)this.error={message:this.strings.recycleBinError,uiInputStatus:s.Z.INVALID};else if(!1===i&&(0,s.m)(t)){this.isOutputNameTaken=!0;const e=await(0,s._)(t),i=(0,s.a0)(e,this.portal.user);!0===this.overwriteExistingLayer&&(this.folderId=e.ownerFolder),this.error=this.formatUnavailableItemErrorMessage(i)}else!1===i&&!1===(0,s.m)(t)?this.error={message:this.strings.noPermissionToOverwrite,uiInputStatus:s.Z.INVALID}:this.error=void 0},this.debouncedValidateOutputName=(0,o.l)(this.validateOutputName,500),this.setOutputNameFromSelectedItem=e=>{this.overwriteExistingLayer=!0,this.outputName=e.name??(0,s.a1)(e.url),this.isOutputNameTaken=!0,this.folderId=e.ownerFolder,(0,s.a0)(e,this.portal.user)?(this.selectedOverwriteItem=e,this.error={message:this.strings.cannotUndoOverwrite,uiInputStatus:s.Z.IDLE}):this.error={message:this.strings.noPermissionToOverwrite,uiInputStatus:s.Z.INVALID}},this.removeItemBrowser=()=>{this.itemBrowserElement?.removeEventListener("analysisItemBrowserClose",this.handleItemBrowserClose),this.itemBrowserElement?.removeEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.itemBrowserElement?.remove(),this.itemBrowserElement=void 0},this.openItemBrowser=()=>{this.removeItemBrowser(),this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.selectLayerToOverwrite,this.itemBrowserElement.hideAddToMap=!0,this.itemBrowserElement.filter=this.filter,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.bucketOptions=this.itemBrowserBucketOptions,this.itemBrowserElement.user=this.portal.user,this.itemBrowserElement.selectionMode="single",this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.handleItemBrowserClose),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),document.body.appendChild(this.itemBrowserElement)},this.renderItemBrowser=()=>(0,r.h)(r.F,null,(0,r.h)("analysis-label",{class:An,label:this.strings.overwriteLayer,ref:e=>this.itemBrowserRef=e,required:!0,onAnalysisLabelHelpActionClick:()=>{this.createHelpPopover(this.strings.overwriteLayer,"existingLayerToOverwrite",this.itemBrowserRef)}}),this.selectedOverwriteItem?this.renderSelectedLayer():(0,r.h)("calcite-button",{class:Pn,scale:s.c.Scale,appearance:"outline",kind:"neutral",disabled:this.readOnly,iconStart:"add-layer",onMouseOver:!1===this.readOnly?this.addTooltip:void 0,onMouseOut:this.removeTooltip,onClick:this.handleOpenItemBrowserClick},this.strings.layer),!1===this.readOnly&&this.renderErrorMessage()),this.renderStringInput=()=>(0,r.h)(r.F,null,(0,r.h)("analysis-label",{class:An,label:this.strings.outputName,ref:e=>this.outputNameLabelRef=e,required:!0,onAnalysisLabelHelpActionClick:()=>{this.createHelpPopover(this.strings.outputName,"outputName",this.outputNameLabelRef)}}),(0,r.h)("div",{class:jn},(0,r.h)("calcite-input",{class:xn,scale:s.c.Scale,type:"text",readOnly:this.readOnly,value:this.outputName,status:this.error?.uiInputStatus,placeholder:this.readOnly?void 0:this.strings.enterUniqueName,onCalciteInputInput:this.handleStringInputChange})),!1===this.readOnly&&this.renderErrorMessage()),this.renderLayerOverwriteCheckbox=()=>(0,r.h)("div",{class:Tn},(0,r.h)("analysis-boolean-input",{ref:e=>this.layerOverwriteCheckboxRef=e,label:this.strings.layerExistsAutomaticallyOverwrite,onAnalysisBooleanInputChange:this.handleLayerOverwriteBooleanInputChange,value:this.overwriteExistingLayer,readOnly:this.readOnly,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.overwrite,"layerExistsAutomaticallyOverwrite",this.layerOverwriteCheckboxRef)}})),this.renderFolderInput=()=>(0,r.h)("analysis-folder-input",{ref:e=>this.folderInputRef=e,label:this.strings.saveInFolder,value:this.folderId,user:this.portal.user,disabled:this.isOutputNameTaken||this.readOnly,onAnalysisFolderInputChange:this.handleFolderInputChange,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.saveInFolder,"saveResultIn",this.folderInputRef)}}),this.renderErrorMessage=()=>void 0!==this.error?.message&&void 0!==this.error?.uiInputStatus&&(0,r.h)("calcite-input-message",{class:En,status:this.error.uiInputStatus,hidden:!1,scale:s.c.Scale,icon:"exclamationMarkTriangle"},this.error.message),this.handleOverwriteModeChange=async()=>{this.overwriteMode=this.stringInputRef.value,this.overwriteMode===zn?await this.validateOutputName():this.overwriteMode===Fn&&void 0===this.selectedOverwriteItem?this.error={message:this.strings.requiredError,uiInputStatus:s.Z.INVALID}:this.overwriteMode===Fn&&void 0!==this.selectedOverwriteItem&&this.setOutputNameFromSelectedItem(this.selectedOverwriteItem),this.updateValue()},this.addTooltip=e=>{const t=e.target;void 0===this.tooltipElement&&(this.tooltipElement=document.createElement("calcite-tooltip"),this.tooltipElement.placement="bottom",this.tooltipElement.innerText=this.strings.chooseLayerToOverwrite,this.tooltipElement.offsetDistance=14,this.tooltipElement.referenceElement=t),(0,s.a2)(document,this.tooltipElement)},this.removeTooltip=()=>{(0,s.V)(this.tooltipElement)},this.handleStringInputChange=async e=>{const t=e.target.value;this.outputName=t,await this.debouncedValidateOutputName(),this.updateValue()},this.handleLayerOverwriteBooleanInputChange=async e=>{const t=e.target.value;this.overwriteExistingLayer=t,await this.validateOutputName(),this.updateValue()},this.handleFolderInputChange=e=>{const t=e.target.value;t!==this.folderId&&(this.folderId=t,this.updateValue())},this.handleItemBrowserSelection=e=>{const t=e.detail;this.setOutputNameFromSelectedItem(t),this.updateValue()},this.handleRemoveSelectedItem=async()=>{this.selectedOverwriteItem=void 0,this.outputName="",this.overwriteExistingLayer=!1,this.folderId=void 0,await this.validateOutputName(),this.updateValue()},this.handleOpenItemBrowserClick=()=>{this.openItemBrowser()},this.handleItemBrowserClose=()=>{this.showItemBrowser=!1,this.removeItemBrowser()},this.replaceLayer=e=>{const t=e.target;"calcite-list-item"===t?.localName&&this.openItemBrowser()},this.handleMouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&!1===this.readOnly&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.strings.replaceLayer),this.replaceTooltip.referenceElement=t,(0,s.a2)(document,this.replaceTooltip))},this.handleMouseOut=()=>{(0,s.V)(this.replaceTooltip)}}async componentWillLoad(){let e="";({strings:this.strings,locale:e}=await(0,s.G)(this.hostElement,(0,r.g)("."))),!0===(0,s.m)(this.value)&&(this.outputName=this.value.serviceProperties?.name??"",this.overwriteExistingLayer=this.value.itemProperties?.overwrite??!1,this.folderId=this.value.itemProperties?.folderId,this.overwriteMode=this.value.overwriteMode??zn,!0===(0,s.m)(this.value.itemProperties?.id)&&(this.selectedOverwriteItem=await(0,s._)(this.value.itemProperties.id)),!1===this.readOnly&&await this.validateOutputName()),this.portalChange(this.portal),this.updateValue(),this.setToolHelpFilePath(e)}disconnectedCallback(){this.toolHelpPopover?.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),(0,s.V)(this.toolHelpPopover)}portalChange(e){void 0!==e?.user&&(this.itemBrowserBucketOptions=(0,s.a3)(e.user)?["my","favorites","group","org"]:["my","favorites"])}get hasError(){return this.error?.uiInputStatus===s.Z.INVALID}async checkValidity(){const e=void 0===this.error||!1===this.hasError;return Promise.resolve(e)}setToolHelpFilePath(e){if(void 0===this.toolHelpFilePath){let t=e;switch(e){case s.a6.English:case s.a6.EnglishUSA:t=""}this.toolHelpFilePath=(0,r.g)(`assets/help/${""!==t?t+"/":""}AnalysisOverwrite.html`)}}serializeOutputName(e,t){const i=(0,s.a4)(e,t);return void 0!==t.itemProperties&&(i.itemProperties={...i.itemProperties,...t.itemProperties}),i}createHelpPopover(e,t,i){(0,s.y)(),void 0!==this.toolHelpPopover&&(this.toolHelpPopover.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.toolHelpPopover=void 0),void 0!==this.toolHelpFilePath&&(this.toolHelpPopover=(0,o.s)(this.toolHelpPopover,{heading:e,helpFileName:"AnalysisOverwrite",helpId:t,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:!0,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??void 0,portal:this.portal,referenceElement:i}),this.toolHelpPopover.addEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.analysisHelpPopoverOpen.emit())}renderSelectedLayer(){const e=this.selectedOverwriteItem.name??(0,s.a1)(this.selectedOverwriteItem.url),t=(0,s.t)(this.strings.layerAction,{layerName:e});return(0,r.h)("calcite-list",{label:"",onClick:this.replaceLayer,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},(0,r.h)("calcite-list-item",{key:this.selectedOverwriteItem.id??void 0,label:e,disabled:this.readOnly,class:Mn,description:this.selectedOverwriteItem.type??""},!1===this.readOnly&&(0,r.h)("calcite-action",{"data-layerId":this.selectedOverwriteItem.id,text:t,label:t,slot:"actions-end",appearance:"transparent",icon:"x",onClick:this.handleRemoveSelectedItem})))}render(){return(0,r.h)(r.H,{key:"f96a2076fe6fb537ac2469b25bb25aa1ccba915c"},(0,r.h)("analysis-string-input",{key:"12b07f244fde25178e2a34038e89b778d978550b",readOnly:this.readOnly,label:this.strings.resultType,required:!0,value:this.overwriteMode,ref:e=>this.stringInputRef=e,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.resultType,"resultType",this.stringInputRef)},choiceList:[Bn,zn,Fn],choiceListLabels:{[Bn]:this.strings.createIntermediateData,[zn]:this.strings.createHostedLayer,[Fn]:this.strings.overwriteExistingLayer},onAnalysisStringInputChange:this.handleOverwriteModeChange}),this.overwriteMode===Bn&&!1===this.readOnly&&(0,r.h)("calcite-input-message",{key:"6a8473ae4dcd36370d01b7f5afccf28d32aa1e50",class:An,status:"idle",hidden:!1,scale:s.c.Scale,icon:"exclamationMarkTriangle"},this.strings.intermediateDataWarning),this.overwriteMode===zn&&(0,r.h)("div",{key:"2674dacf38361d536b2969e3cde9de46fb3b3682"},this.renderStringInput(),this.renderLayerOverwriteCheckbox(),this.renderFolderInput()),this.overwriteMode===Fn&&this.renderItemBrowser())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}static get watchers(){return{portal:["portalChange"]}}};Nn.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:block}.error-message{margin-top:var(--analysis-half-spacing)}.string-item-browser-input-wrapper{display:flex;gap:var(--analysis-half-spacing)}.layer-overwrite-checkbox{margin:var(--analysis-half-spacing) 0}.calcite-input{flex-grow:1}.calcite-dropdown{width:100%}.item-browser-layer-button{width:100%}.top-spacing{margin-top:var(--analysis-half-spacing)}.negative-top-spacing{margin-top:calc(-1 * var(--analysis-half-spacing))}.list-item{--calcite-font-size--1:var(--calcite-font-size--2);border:1px solid var(--calcite-color-border-input);margin-bottom:var(--analysis-half-spacing)}";const Dn="circle",$n="polygon",Rn="polyline",Hn="point",Vn="rectangle",Un="text",qn="bezier-curve",Gn=class{constructor(e){(0,r.r)(this,e),this.analysisSketchLayerChange=(0,r.c)(this,"analysisSketchLayerChange",7),this.analysisSketchToolsRendered=(0,r.c)(this,"analysisSketchToolsRendered",7),this.analysisSketchRemove=(0,r.c)(this,"analysisSketchRemove",7),this.sketchUpdated=!1,this.mapLayers=[],this.sketchLayerTitleNumber=1,this.createSketch=()=>{void 0!==this.sketchElement&&this.removeSketch();const e=(0,s.a7)();this.reactiveUtilsHandler=e.on((()=>this.mapView?.map?.allLayers),"change",(()=>this.handleMapLayerChange())),this.createSketchLayer(),this.mapView?.when((()=>{this.sketchElement=document.createElement("arcgis-sketch-layer-editor"),this.sketchElement.mapView=this.mapView,this.sketchElement.showSketchToolsOnly=!0,this.sketchElement.layer=this.sketchLayer,this.sketchElement.sketchToolsToHide=this.hiddenSketchTools,this.sketchElement.sketchToolsReferenceElement=this.referenceElement;const e=this.mapLayers.filter((e=>!0===e?.title?.includes(this.sketchLayerTitle)));this.sketchElement.hideSelectionTools=!(e.length>0),this.sketchElement.addEventListener("arcgisContentReRender",this.handleSketchContentReRender),this.sketchElement.addEventListener("arcgisChange",this.handleSketchUpdated),this.hostElement.appendChild(this.sketchElement),this.setupMutationObserver()})),setTimeout((()=>requestAnimationFrame((()=>this.sketchElement?.setFocus()))),1)},this.handleSketchUpdated=()=>{this.sketchUpdated=!0},this.handleSketchContentReRender=e=>{const t=e.detail;t===Vn||t===Dn?this.currentSketchTool=$n:(0,s.d)(t)||(this.currentSketchTool=t),this.selectSketchFeatureLayer()},this.selectSketchFeatureLayer=()=>{const e=this.mapLayers.find((e=>!0===e?.title?.includes(this.sketchLayerTitle)&&"geometryType"in e&&e?.geometryType===this.currentSketchTool));void 0!==e&&(this.previousSketchFeatureLayer=e),this.analysisSketchLayerChange.emit(e)}}mapLayersChange(e,t){const i=e.find((e=>e.title===this.previousSketchFeatureLayer?.title)),r=this.previousSketchFeatureLayer?.source?.length!==i?.source?.length;e?.length===t?.length&&!0!==r||!0!==this.sketchUpdated||(this.selectSketchFeatureLayer(),this.updateSketchTools())}async componentWillLoad(){({strings:this.strings}=await(0,s.G)(this.hostElement,(0,r.g)("."))),this.createSketch()}async disconnectedCallback(){await this.removeSketch(),this.mutationObserver?.disconnect()}setupMutationObserver(){this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{if(e.addedNodes.length>0){void 0!==Array.from(e.addedNodes).find((e=>"ARCGIS-SKETCH-LAYER-EDITOR-TOOLS"===e.nodeName))&&this.analysisSketchToolsRendered.emit(!0)}}))})),this.mutationObserver.observe(document,{childList:!0,subtree:!0})}handleMapLayerChange(){const e=this.mapView?.map?.allLayers.find((e=>e.title===this.sketchLayerTitle));void 0===e&&this.analysisSketchRemove.emit()}async removeSketch(){this.sketchUpdated=!1,this.reactiveUtilsHandler?.remove(),await(this.sketchElement?.done()),this.sketchElement?.removeEventListener("arcgisContentReRender",this.handleSketchContentReRender),this.sketchElement?.remove(),this.sketchElement=void 0}updateSketchTools(){const e=this.mapLayers.filter((e=>!0===e?.title?.includes(this.sketchLayerTitle)));void 0!==this.sketchElement&&(this.sketchElement.hideSelectionTools=!(e.length>0),this.sketchElement.updateSketchTools())}createSketchLayer(){this.setSketchLayerName(),this.sketchLayer=(0,s.a8)(this.sketchLayerTitle),this.mapView?.map?.add(this.sketchLayer)}setSketchLayerName(){let e=`${this.toolTitle?.trim()??""} ${this.label} ${this.strings.sketchLayerTitle}`.trim();e=(0,s.a9)(e);const t=this.mapView?.map?.allLayers.filter((t=>!0===t?.title?.includes(e)))??[];if(0===t?.length)this.sketchLayerTitle=e;else{let t=!1;for(;!1===t;){const i=`${e} ${this.sketchLayerTitleNumber}`;t=void 0===this.mapView?.map?.allLayers.find((e=>e?.title===i)),!0===t?this.sketchLayerTitle=i:this.sketchLayerTitleNumber+=1}}}get hiddenSketchTools(){const e=Array.isArray(this.layerFilterType)?this.layerFilterType:[this.layerFilterType];let t=[Hn,Rn,$n,Vn,Dn,Un,qn];return!1===e.includes("feature")?e.forEach((e=>{"feature_point"===e||"feature_multiPoint"===e?t=t.filter((e=>e!==Hn)):"feature_line"===e?t=t.filter((e=>e!==Rn)):"feature_polygon"===e&&(t=t.filter((e=>e!==$n&&e!==Vn&&e!==Dn)))})):t=[Un,qn],t}render(){return(0,r.h)(r.H,{key:"ca86d184735d1e95cf401462ee39d74acaa0e6b2"})}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}static get watchers(){return{mapLayers:["mapLayersChange"]}}};Gn.style="";const Wn="analysis-popover",Jn="popover-content",Kn="js-app-flyout",Zn="toggle-select-all-button",Yn="analysis--rtl",Qn="fields-message",Xn="list-item",ea=class{constructor(e){(0,r.r)(this,e),this.analysisSummaryFieldSelectionDone=(0,r.c)(this,"analysisSummaryFieldSelectionDone",6),this.analysisSummaryFieldPopoverClose=(0,r.c)(this,"analysisSummaryFieldPopoverClose",7),this.showFieldDescription=!1,this.usePopupTemplatesInfo=!0,this.allowDateType=!1,this.allowDateOnlyType=!1,this.allowTimeOnlyType=!1,this.allowStringType=!1,this.selection=new Set,this.showSelectAllString=!0,this.hasEmptySearchResults=!1,this.onSelectionDone=()=>{this.analysisSummaryFieldSelectionDone.emit(this.selection),this.open=!1},this.onCalciteListItemChange=e=>{const t=e.target,i=t.value,r=new Set(this.selection);t.selected?r.add(i):r.delete(i),this.selection=r},this.handleSelectAllClick=()=>{this.showSelectAllString?this.selection=new Set(this.fields?.map((e=>e.name))):this.selection=new Set},this.handleCalciteListFilterChange=e=>{const t=e.target;this.hasEmptySearchResults=0===t.filteredData.length,this.searchString=t.filterText},this.renderMessages=()=>{const{noInputSelected:e,noFieldsAvailable:t,noSearchResults:i}=this.strings,n=!0===(0,s.d)(this.layer)&&(0,r.h)("calcite-label",{class:Qn},this.noLayersText??(0,s.t)(void 0!==this.layerInputLocalizedLabel?e.withLayerInputLabel:e.withoutLayerInputLabel,{layerInputLabel:this.layerInputLocalizedLabel})),a=!1===(0,s.d)(this.layer)&&0===this.fields?.length&&(0,r.h)("calcite-label",{class:Qn},this.noFieldsText??(0,s.t)(t,{layerName:this.layer.title})),o=this.noSearchResults&&(0,r.h)("calcite-label",{class:Qn},i);return(0,r.h)("div",null,n,a,o)},this.renderFields=()=>(0,r.h)("calcite-list",{class:Jn,label:"",selectionMode:"multiple",filterEnabled:!0,onCalciteListFilter:this.handleCalciteListFilterChange},this.shouldDisplaySelectAllButton&&(0,r.h)("calcite-button",{class:Zn,appearance:"transparent",onClick:this.handleSelectAllClick,scale:s.c.Scale},this.showSelectAllString?this.strings.selectAll:this.strings.deselectAll),this.fields?.map((e=>{const{name:t,alias:i,type:s,description:n}=e;return(0,r.h)("calcite-list-item",{onCalciteListItemSelect:this.onCalciteListItemChange,selected:this.selection.has(t),key:t,value:t,label:i??void 0,description:this.showFieldDescription?n??void 0:`{${t}}`,"data-field-type":s,class:Xn})})),this.renderMessages())}async layerChange(){void 0!==this.layer?(this.fields=await(0,s.aa)(this.layer,this.usePopupTemplatesInfo),this.fields=(0,s.ab)({fields:this.fields,layer:this.layer,allowObjectId:!1,allowDateType:this.allowDateType,allowStringType:this.allowStringType,allowDateOnlyType:this.allowDateOnlyType,allowTimeOnlyType:this.allowTimeOnlyType,allowBigIntType:!0,allowGeometryFields:!1})):this.fields=[]}onSelectionChange(){this.showSelectAllString=this.selection.size!==this.fields?.length}get noSearchResults(){return""!==this.searchString&&this.hasEmptySearchResults}get shouldDisplaySelectAllButton(){return(this.fields?.length??0)>0&&!this.noSearchResults}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,s.G)(this.hostElement,(0,r.g)("."))),await this.layerChange(),this.onSelectionChange()}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.summaryFieldsPopover?.setFocus()))),1),setTimeout((()=>{this.summaryFieldsPopover?.reposition?.()}),s.c.PopoverTimer)}async reposition(){await(this.summaryFieldsPopover?.reposition?.())}render(){const e=this.referenceElement?.offsetWidth;return(0,r.h)(r.H,{key:"60b3504dc4ed6ae778b0fe05b0b1d032fb1c1e88",dir:this.dir,class:`${Wn} ${Kn} ${"rtl"===this.dir?Yn:""}`},(0,r.h)("calcite-popover",{key:"4fe27b0438e99265512aaffdba25f32a746153af",ref:e=>{this.summaryFieldsPopover=e},autoClose:!0,label:this.strings.summaryFieldsPopover,referenceElement:this.referenceElement,placement:"trailing",closable:!0,heading:this.strings.addField,open:this.open,focusTrapDisabled:!0,onCalcitePopoverClose:()=>this.analysisSummaryFieldPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"2bcd236c20d861875f58607b0c169078c4ea9e4a",style:{width:void 0!==e?`${e}px`:void 0,maxWidth:s.c.MaxPopoverWidth}},this.renderFields(),(0,r.h)("calcite-button",{key:"936c7c4a6c541aaee5af3604d7dea68b23e1f8ff",slot:"footer",width:"full",name:"done",scale:"m",onClick:this.onSelectionDone},this.strings.done))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.a)(this)}static get watchers(){return{layer:["layerChange"],usePopupTemplatesInfo:["layerChange"],selection:["onSelectionChange"]}}};ea.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex}.popover-content{height:var(--analysis-popover-content-height)}.toggle-select-all-button{margin:0;margin-left:var(--analysis-quarter-spacing);margin-bottom:var(--analysis-quarter-spacing)}.chip-group{margin:var(--analysis-quarter-spacing)}.fields-message{background-color:var(--calcite-color-background);padding:var(--analysis-three-quarter-spacing)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}:host(.analysis--rtl) .toggle-select-all-button{margin:0;margin-right:var(--analysis-quarter-spacing);margin-top:var(--analysis-quarter-spacing)}";const ta=class{constructor(e){(0,r.r)(this,e),this.open=!0}render(){const e=this.popoverOptions?.referenceElement,t=e?.getBoundingClientRect().width,i={...this.popoverOptions,width:void 0!==t?`${t}px`:void 0,open:this.open};return(0,r.h)("calcite-popover",{key:"69594cb54070e0497ea2b90d21c88242dbb24434",...i},this.renderPopoverContent())}get hostElement(){return(0,r.a)(this)}}}}]);