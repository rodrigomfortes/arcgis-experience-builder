/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-cca2b1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-cca2b1"],{15968:(e,a,t)=>{t.r(a),t.d(a,{arcgis_new_item_pages_tile_layer_settings:()=>u});var i=t(87849),l=t(59317),s=t(87744),r=t(72257),n=t(32710),c=t(49770),o=t(3826),d=t(95878),h=t(11163);t(37762),t(86562),t(15332),t(83929),t(50637),t(931),t(93814),t(76246),t(63054),t(15912),t(24869),t(50020),t(50822),t(75294),t(38295),t(51102),t(56175),t(43555);const u=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.publishType="tiles",this.autoCreation=!0,this.basemapUrl="",this.featureLayerInfos=null,this.featureLayerLayers=null,this.serviceInfo=null,this.cacheOnDemandMinScale=h.T,this.calculatedScale={minScale:h.T,maxScale:h.e},this.curLods=[],this.ranges=[{level:0,label:"world"},{level:1,label:"continent"},{level:2,label:"countries"},{level:3,label:"countriesSmall"},{level:4,label:"states"},{level:5,label:"state"},{level:6,label:"counties"},{level:7,label:"county"},{level:8,label:"metropolitan"},{level:9,label:"cities"},{level:10,label:"city"},{level:11,label:"town"},{level:12,label:"neighborhood"},{level:13,label:"streets"},{level:14,label:"street"},{level:15,label:"buildings"},{level:16,label:"building"},{level:17,label:"small"},{level:18,label:"rooms"},{level:19,label:"room"}],this.tileLayerInfo=null,this.handleUrlInputError=e=>{const{error:a}=this.i18n;this.alertInfo={title:"invalidUrl"===e?this.invalidUrlString:a.urlErrorTitle,description:"invalidUrl"===e?void 0:a[e]}},this.getPublishTypeInfo=()=>{const{publishType:e}=this;switch(e){case"tiles":return"mapserver";case"scenes":return"sceneserver";case"features":return"featureserver";case"vectorTiles":return"vectortileserver";case"tiledImagery":case"dynamicImagery":return"imageserver";default:return e}},this.toggleAutoCreation=e=>{this.autoCreation=e.detail},this.handleBasemapChange=e=>{var a;const{tileLayerInfo:t,curLods:i}=this;this.basemapType=e;const l=e=>{e.length===i.length&&e.every(((e,a)=>{const t=i[a];return e.level===t.level&&e.resolution===t.resolution&&e.scale===t.scale&&e.label===t.label}))||(this.curLods=e)},s=null===(a=null==t?void 0:t.info)||void 0===a?void 0:a.lods;"standard"===e?l(h.g):s&&l(s)},this.fetchTileLayerInfo=async e=>{this.isProcessing=!0,this.alertInfo=null,this.tileLayerInfo=null;const{error:a,result:t}=await(0,c.b)(e,!1);return a?this.handleUrlInputError(a.code):t&&(this.tileLayerInfo={url:e,info:t}),this.isProcessing=!1,!a},this.onUrlInputBlur=async()=>{const{tileLayerInfo:e,basemapUrl:a}=this;if(!a)return this.tileLayerInfo=null,void(this.basemapUrl=null);(null==e?void 0:e.url)!==a&&this.fetchTileLayerInfo(a)},this.alertInfo=void 0,this.isProcessing=!1,this.showIncreaseScaleRangeWarning=!1,this.selectedItem=void 0,this.basemapType=void 0}async handleNext(){var e;if("3dTiles"===o.a.tileLayerPublishType)return;const{publishType:a,serviceInfo:t,autoCreation:i,cacheOnDemandMinScale:s,calculatedScale:r,tileLayerInfo:n,selectedItem:d,basemapType:h,basemapUrl:u,inputRef:p,handleUrlInputError:y,fetchTileLayerInfo:b}=this;if("custom"===h){if(!u)return y("invalidUrl"),void p.setFocus();if(!n){if(!await b(u))return void p.setFocus()}}const{publishContent:f}=(0,c.d)({id:d.id,title:d.title},{publishType:a,cacheOnDemand:"vectorTiles"!==a&&i,cacheOnDemandMinScale:s,tileInfo:null==n?void 0:n.info,scale:Object.assign({},r),layers:null===(e=o.a.tileLayerData)||void 0===e?void 0:e.layers},l.c.portal.isPortal);o.a.tileLayerPublishContent=f,o.a.tileAutoCreation=i,o.a.tileLayerBasemapType=h,o.a.tileLayerBasemapUrl=u,o.a.tileLayerPublishType=a,this.newItemUpdatePage.emit("itemProperties")}async componentWillLoad(){var e,a;if("3dTiles"===o.a.tileLayerPublishType)return;this.fromFeatureLayer=o.a.tileLayerFromFeatureLayer,this.publishType=o.a.tileLayerPublishType,this.i18n=d.u.i18n.tileLayerSettings,this.invalidUrlString=d.u.i18n.url.invalidUrl,this.autoCreation=null!==(e=o.a.tileAutoCreation)&&void 0!==e?e:!l.c.portal.isPortal,this.basemapUrl=o.a.tileLayerBasemapUrl,this.basemapType=null!==(a=o.a.tileLayerBasemapType)&&void 0!==a?a:"standard",o.a.tileLayerPublishContent=null;let t=o.a.item;t||(t=Object.assign(Object.assign({},o.a.existingItem),{id:o.a.id,title:o.a.sourceTitle,type:o.a.type,tags:r.i.tags}),o.a.item=t);o.a.type={vectorTiles:"Vector Tile Service",tiles:"Tile Layer",scenes:"Scene Service"}[o.a.tileLayerPublishType],o.a.initialTitle=t.title,this.selectedItem=t;(async()=>{var e;if("3dTiles"===o.a.tileLayerPublishType)return;this.isProcessing=!0;const a=t.url;let i=o.a.tileLayerLayers,r=o.a.tileLayerTables,d=o.a.tileLayerServiceInfo;if(!(l.c.portal.isPortal&&o.a.tileLayerFromFeatureLayer||i||r||d)){const e=await(0,n.v)({serviceUrl:a,restBaseUrl:(0,s.g)(l.c.portal),forceAddToken:!0});i=e.layers,r=e.tables,d=e.serviceInfo}this.serviceInfo=d,this.featureLayerInfos=[...i||[],...r||[]],this.featureLayerLayers=[...i||[]],await this.handleTileLayerScaleChange({minScale:h.T,maxScale:h.e}),"tiles"===this.publishType&&(0,c.h)(this.featureLayerLayers,null!==(e=l.c.config.tilesOnDemandEnabled)&&void 0!==e&&e),this.isProcessing=!1})()}async handleTileLayerScaleChange(e){var a,t;const{selectedItem:i,featureLayerInfos:l,tileLayerInfo:s,publishType:r}=this;if("tiles"!==r)return;const n=i.url,{cacheOnDemandMinScale:o,calculatedScale:d}=await(0,c.e)(e,null!==(t=null===(a=null==s?void 0:s.info)||void 0===a?void 0:a.lods)&&void 0!==t?t:h.a.lods,l,n);n&&(o&&(this.cacheOnDemandMinScale=o),this.calculatedScale=d)}render(){const{ranges:e,i18n:a,toggleAutoCreation:t,handleBasemapChange:s,onUrlInputBlur:r,isProcessing:n,autoCreation:c,basemapType:o,basemapUrl:d,alertInfo:u,publishType:p,fromFeatureLayer:y}=this;return(0,i.h)(i.H,{key:"9fdf4ba84efeb80a2114f198f5c40d570649189d"},(0,i.h)("arcgis-new-item-loader",{key:"4b0e00cb5761fc016c5cbdac58cba8c23bf03419",active:n}),(0,i.h)("div",{key:"10f03af96d14ac3a40fbb301efe8d28120e005c7",class:"title"},(0,i.h)("arcgis-new-item-description",{key:"3fd858c8aafc90dc9752cd11103267a901d1c828",header:a.title,scale:"l"})),"tiles"===p&&(!l.c.portal.isPortal||!y)&&(0,i.h)("div",{key:"2a64ba80374875b8f1c33a5aa3f27eb44930e9ae",class:"section"},(0,i.h)("arcgis-new-item-switch-card",{key:"6cddd8ea14f935e908a049fe212e9d6423140279",defaultChecked:c,header:a.autoCreateOption.title,description:a.autoCreateOption.description,onSwitchChange:t})),(0,i.h)("div",{key:"509633a2dfc027df063181797d7ce536dc9ffb36",class:"section"},(0,i.h)("p",{key:"bc7cc356ae190e701ae22da3ca252ec4d1342985",class:"section-title"},a.basemapOption),(0,i.h)("calcite-tile-select-group",{key:"43a91b4f0bb1631ba88f9a96eabc94c03c9d99aa",layout:"vertical"},h.f.map((e=>{const t="custom"===e?"customBasemap":"onlineBasemapOption";return(0,i.h)("calcite-tile-select",{key:e,checked:e===o,onCalciteTileSelectChange:()=>s(e),description:a[t].description,heading:a[t].title,name:e,"input-enabled":!0,"input-alignment":"start",type:"radio",value:e,width:"full",id:`${e}-input-option`})})))),"custom"===o&&(0,i.h)("div",{key:"b01eaa6625b9c3a9270d6140d515f262053c4557",class:"section"},(0,i.h)("p",{key:"6dc20858bea77da8bf21fe579c63e335455e3bf1",class:"section-title"},a.customBasemapUrl),(0,i.h)("calcite-input",{key:"182a62571dc6ee88c4ac20b12d05bdc528fd0e6a",scale:"m",disabled:n,value:d,onCalciteInputInput:e=>{this.basemapUrl=e.currentTarget.value,this.alertInfo=null},onBlur:r,placeholder:"https://webadaptorhost.domain.com/arcgis/rest/services/service/MapServer",ref:e=>this.inputRef=e})),(0,i.h)("arcgis-new-item-alert",{key:"fe90aef27a04db7ff7fa55bdd145a52fa3b3563c",heading:null==u?void 0:u.title,description:null==u?void 0:u.description,active:!!u,onAlertDismiss:()=>this.alertInfo=null}))}get el(){return(0,i.a)(this)}};u.style=".title{margin-bottom:1.5rem}.section{margin-bottom:2rem}.section-title{font-size:1rem;font-weight:400;margin-bottom:0.25rem;margin-top:0px}.description{margin-bottom:1rem;margin-top:0px;font-size:0.75rem}"}}]);