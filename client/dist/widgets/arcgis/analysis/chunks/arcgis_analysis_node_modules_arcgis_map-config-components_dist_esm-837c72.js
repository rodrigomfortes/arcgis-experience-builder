/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-837c72.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-837c72"],{10465:(e,t,s)=>{s.d(t,{D:()=>o,a:()=>h,b:()=>l,c:()=>n,g:()=>b,s:()=>y});class o{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}const r=(e,t,s)=>(0,a(t).subscribe)((t=>{const o=t.some((t=>((e,t)=>{let s=e;for(;s;){if(s===t)return!0;if(!s.parentNode)return!1;s=s.parentNode instanceof ShadowRoot?s.parentNode.host:s.parentNode}return!1})(e,t.target)));o&&s()})),i={},a=e=>{const t=e.join(","),s=i[t];if(void 0!==s)return s;const o=new Set,r=new MutationObserver((e=>o.forEach((t=>t(e)))));globalThis.document&&r.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const a={subscribe:e=>(o.add(e),()=>{o.delete(e),0===o.size&&(r.disconnect(),i[t]=void 0)})};return i[t]=a,a},n=(e,t)=>{let s=e;for(;s;){const e=s.closest?.(t);if(e)return e;const o=s.getRootNode?.();if(o===globalThis.document)return null;s=o.host}return null},l=e=>c(e,"dir","ltr"),c=(e,t,s)=>{const o=n(e,`[${t}]`);return o?.getAttribute(t)??s},p=e=>{let t="";for(let s=0;s<e;s++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},h=()=>[p(2),p(1),p(1),p(1),p(3)].join("-"),u="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),d=new Set(u),g="en",v={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},m={},P=async(e,t)=>{const s=`${t}${e}.json`;try{const e=await fetch(s);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===g?{}:await P(g,t)},b=e=>{const t=c(e,"lang",globalThis.navigator?.language||g);return{lang:t,t9nLocale:f(t)}},f=e=>{const[t,s]=e.split("-"),o=t.toLowerCase();let r=o;return s&&(r=`${o}-${s.toUpperCase()}`),r=v[r]??r,d.has(r)?r:s?f(o):g},y=(e,t,s,o)=>{let i;const a=()=>C(e,t(),o).then((e=>{i?.lang===e.lang&&i.t9nLocale===e.t9nLocale&&i.t9nStrings===e.t9nStrings||s(e),i=e})).catch(console.error);return queueMicrotask(a),r(e,["lang"],a)},C=async(e,t,s=e.localName.split("-").slice(1).join("-"))=>{const{lang:o,t9nLocale:r}=b(e),i=`${t}/${s}/t9n`,a=null===s?{}:await(async(e,t,s="")=>{const o=`${t}/${s}`,r=`${o}${e}.json`;return m[r]??(m[r]=P(e,o)),await m[r]})(r,i,"messages.");return{lang:o,t9nLocale:r,t9nStrings:a}}},43811:(e,t,s)=>{s.r(t),s.d(t,{arcgis_map_config_layer_override:()=>m});var o=s(11254),r=s(17840),i=s(76569),a=s(10465),n=s(14528),l=s(84260),c=s(69811);s(56612);const p="container",h="details",u="buttons",d="top-button",g="properties",v="properties-icon",m=class{constructor(e){(0,o.r)(this,e),this.arcgisChange=(0,o.c)(this,"arcgisChange",7),this.arcgisDuplicateClick=(0,o.c)(this,"arcgisDuplicateClick",7),this.arcgisSaveLayerClick=(0,o.c)(this,"arcgisSaveLayerClick",7),this.arcgisSaveAsLayerClick=(0,o.c)(this,"arcgisSaveAsLayerClick",7),this.manager=(0,n.u)(this),this.strings=(0,l.u)({blocking:!0}),this.afterCreateSource=e=>{this.sourceNode=e},this.afterCreateStatusButton=e=>{this.statusButtonNode=e},this.afterCreatePropertiesButton=e=>{this.propertiesNode=e},this.onPanelScroll=async()=>{if(this.statusPopover){const e=await(this.statusPopover?.getPopoverRect());(0,r.i)(e?.top)&&e.top<0&&this.closePopovers()}if(this.propertiesPopover){const e=await(this.propertiesPopover?.getPopoverRect());(0,r.i)(e?.top)&&e.top<0&&this.closePopovers()}},this.openDetails=e=>{e.stopPropagation(),e.preventDefault();const{layer:t}=this,{portalItem:s}=t;let o;o=s?.portal?s.portal.urlKey?`//${s.portal.urlKey}.${s.portal.customBaseUrl}/home/item.html?id=${s.id}&sublayer=${t.layerId}`:`//${s.portal.portalHostname}/home/item.html?id=${s.id}&sublayer=${t.layerId}`:`${t.url}/${t.layerId}`,window.open(o)},this.saveLayer=e=>{e.stopPropagation();const{layer:t}=this;this.arcgisSaveLayerClick.emit(t.id)},this.saveAsLayer=e=>{e.stopPropagation();const{layer:t}=this;this.arcgisSaveAsLayerClick.emit(t.id)},this.duplicateLayer=e=>{e.stopPropagation();const{layer:t}=this;this.arcgisDuplicateClick.emit(t.id)},this.openStatus=async e=>{if(e.stopPropagation(),this.props.containerPanelNode?.disabled||!this.sourceNode)return;if(this.statusPopover){if(this.statusPopover.parentNode)return this.statusPopover?.parentNode.removeChild(this.statusPopover),void(this.statusPopover=void 0);this.statusPopover=void 0}this.closePopovers(),await this.scrollIntoView(this.sourceNode);const{props:t,strings:s}=this,o=document.createElement("arcgis-map-config-layer-override-status");o.props=t,o.strings=s,o.popoverReferenceElement=this.sourceNode,document.body.appendChild(o),this.statusPopover=o,this.disableContainer(!0)},this.openManageProps=async()=>{if(!this.sourceNode)return;if(this.propertiesPopover){if(this.propertiesPopover.parentNode)return this.propertiesPopover.parentNode.removeChild(this.propertiesPopover),void(this.propertiesPopover=void 0);this.propertiesPopover=void 0}this.closePopovers(),await this.scrollIntoView(this.sourceNode);const{props:e,strings:t}=this,s=document.createElement("arcgis-map-config-layer-override-properties");s.props=e,s.strings=t,s.popoverReferenceElement=this.sourceNode,document.body.appendChild(s),this.propertiesPopover=s,this.disableContainer(!0)},this.layer=void 0,this.config=void 0,this.portal=void 0,this.hideDuplicate=!1,this.props=void 0,this.reRender=!1}closeAllPopoversHandler(){this.closePopovers()}arcgisPropChange(){this.arcgisChange.emit(),this.reRender=!this.reRender}arcgisStatusChange(){this.reRender=!this.reRender}async setFocus(){this.sourceActionNode?.setFocus()}async done(){this.closePopovers()}async refresh(){(0,i.g)(this.props),this.reRender=!this.reRender}async componentWillLoad(){this.props={layer:this.layer,portal:this.portal,config:this.config},this.props.layerOriginUtils=await(0,c.M)(),this.props.layerOriginUtils.isSupportedLayer(this.layer),(0,i.g)(this.props)}async componentDidLoad(){this.props.containerPanelNode=(0,r.q)(this.el,"calcite-panel"),this.props.containerPanelNode||(this.props.containerPanelNode=(0,r.q)(this.el,"calcite-flow-item")),this.props.containerPanelNode?.addEventListener("calcitePanelScroll",this.onPanelScroll)}disconnectedCallback(){this.props.containerPanelNode?.removeEventListener("calcitePanelScroll",this.onPanelScroll),this.closePopovers()}render(){return(0,o.h)(o.H,{key:"9f27ddff3fbb2c9fc6da68c0da9ca94e92942fe6"},(0,o.h)("div",{key:"5b77a9a3c2c46496a96fc55a718d379e64a23844",class:p},this.renderSource(),this.renderCopy(),this.renderStatus(),this.renderProperties()))}renderSource(){const{strings:e,layer:t}=this,s=t.portalItem?.title,r=t.title,i="rtl"===(0,a.b)(this.el);return(0,o.h)("calcite-label",{ref:this.afterCreateSource},e.sourceLayer,(0,o.h)("calcite-block",{class:h,heading:(s&&s!==r?i?`${r} / ${s}`:`${s} / ${r}`:r)??void 0,description:t.isTable?"Table":"Feature layer",onClick:e=>this.openDetails(e)},(0,o.h)("calcite-action",{scale:"s",slot:"control",icon:"launch",text:e.sourceLayer,onClick:e=>this.openDetails(e),ref:e=>this.sourceActionNode=e})))}renderCopy(){const{strings:e,layer:t,hideDuplicate:s,props:r}=this,{portal:i}=r,a=this.canCreateItems(i?.user),n=["admin","update"].includes(t.portalItem?.itemControl??"");return n||a||!t.isTable&&!s?(0,o.h)("div",{class:u},n&&(0,o.h)("calcite-button",{width:"full",appearance:"outline-fill",kind:"neutral",iconStart:"save",class:d,label:e.save,onClick:this.saveLayer},e.save),a&&(0,o.h)("calcite-button",{width:"full",appearance:"outline-fill",kind:"neutral",iconStart:"save",class:d,label:e.saveAs,onClick:this.saveAsLayer},e.saveAs),!t.isTable&&!s&&(0,o.h)("calcite-button",{width:"full",appearance:"outline-fill",kind:"neutral",iconStart:"duplicate",label:e.duplicate,onClick:this.duplicateLayer},e.duplicate)):(0,o.h)(o.F,null)}renderStatus(){const{strings:e,layer:t,props:s}=this,{layerOriginInfo:r}=s;return(0,o.h)("calcite-notice",{class:g,width:"full",scale:"s",open:!0,onClick:this.openStatus},(0,o.h)("div",{slot:"title"},"source"===r.status?e.propsFromSource:"overridden"===r.status?e.propsSetInWebmap:e.somePropsSetInWebmap),(0,o.h)("calcite-button",{slot:"actions-end",iconStart:"information",scale:"s",appearance:"transparent",kind:"neutral",class:v,label:t.isTable?e.tableStatus:e.layerStatus,onClick:this.openStatus,ref:this.afterCreateStatusButton}))}renderProperties(){const{strings:e,layer:t}=this;return(0,o.h)("calcite-button",{appearance:"outline-fill",kind:"neutral",width:"full",label:t.isTable?e.manageTableProps:e.manageLayerProps,onClick:this.openManageProps,ref:this.afterCreatePropertiesButton},t.isTable?e.manageTableProps:e.manageLayerProps)}closePopovers(){this.closeStatusPopover(),this.closePropertiesPopover(),this.disableContainer(!1)}closeStatusPopover(){this.statusPopover&&(this.statusPopover.parentNode?.removeChild(this.statusPopover),this.statusPopover=void 0,setTimeout((()=>{this.statusButtonNode?.setFocus()}),300))}closePropertiesPopover(){this.propertiesPopover&&(this.propertiesPopover.parentNode?.removeChild(this.propertiesPopover),this.propertiesPopover=void 0,setTimeout((()=>{this.propertiesNode?.setFocus()}),300))}scrollIntoView(e){return e.getBoundingClientRect()?.top<0?(e.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),new Promise((t=>{let s=0;const o=setInterval((()=>{(s>10||e.getBoundingClientRect()?.top>=0)&&(clearInterval(o),t()),s++}),100)}))):Promise.resolve()}disableContainer(e){this.props.containerPanelNode&&(this.props.containerPanelNode.disabled=e)}canCreateItems(e){return e&&(this.isPublicUser(e)||e.privileges?.includes("portal:user:createItem"))}isPublicUser(e){return!e.orgId}static get assetsDirs(){return["assets"]}get el(){return(0,o.a)(this)}};m.style=":host{height:100%}.container{padding:6px;background-color:white}.details{width:100%;margin-bottom:8px;border:1px solid var(--calcite-color-border-3);cursor:pointer}.buttons{margin-bottom:14px}.top-button{margin-bottom:4px}.properties{margin-bottom:16px;cursor:pointer}.properties-icon{height:100%;padding:0 var(--calcite-notice-spacing-token-large)}"},76569:(e,t,s)=>{function o(e){const{layer:t,layerOriginUtils:s}=e;e.layerOriginInfo=s.getLayerOriginInfo(t,"web-map")}s.d(t,{g:()=>o})},84260:(e,t,s)=>{s.d(t,{u:()=>a});var o=s(11254),r=s(10465),i=s(14528);function a({propertyName:e="strings",name:t}){let s=(0,i.r)();const a=(0,r.g)(s.el),l=new r.D,c={_lang:a.lang,_t9nLocale:a.t9nLocale};s.manager.onLoad((()=>l.promise));const p=new WeakRef(s);function h(){const e=p.deref();return e||d?.(),e}s=void 0;const u=n((()=>h()?.el)),d=(0,r.s)(u,(()=>(0,o.g)("./assets")),(({t9nLocale:t,t9nStrings:s,lang:o})=>{const r=h();if(!r)return;r[e]={...s,_lang:o,_t9nLocale:t},l.resolve()}),t);return c}const n=e=>new Proxy({},{get(t,s){const o=e();if(!o)return;const r=Reflect.get(o,s,o);return"function"==typeof r?r.bind(o):r}})}}]);