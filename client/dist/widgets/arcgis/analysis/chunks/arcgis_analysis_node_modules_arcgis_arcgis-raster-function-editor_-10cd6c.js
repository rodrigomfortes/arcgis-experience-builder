"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-10cd6c"],{71144:(e,n,t)=>{t.d(n,{a:()=>O,b:()=>g,c:()=>x,d:()=>p,e:()=>y,f:()=>m,g:()=>S,h:()=>o,i:()=>N,m:()=>V});var i=t(92991),r=t(5294);function s(e,n){if((0,i.i)(n))return r.clone(e);const t={};if("object"==typeof e&&null!==e&&!Array.isArray(e)){for(const i in e)e.hasOwnProperty(i)&&n.indexOf(i)<0&&(t[i]=s(e[i],n));return t}return Array.isArray(e)?e.map((e=>s(e,n))):r.clone(e)}const a="RasterFunctionTemplate";function o(e){if(!e||!e.value)return!1;const n=e.value.elements?e.value.elements:e.value;return Array.isArray(n)?n.filter((e=>e&&(e.isDataset||e.type===a))).length>0:n&&(n.isDataset||n.type===a)}function l(e){return new Date(Number(e)).toISOString().replace("Z","")}function u(e){return new Date(e+"Z").getTime()}function c(e,n){return e.map((e=>e[n]))}let f;function m(e){const n="esriMonthFebruary",t="esriMonthMarch",i="esriMonthApril",r="esriMonthMay",s="esriMonthJune",a="esriMonthJuly",o="esriMonthAugust",l="esriMonthSeptember",u="esriMonthOctober",c="esriMonthNovember",m="esriMonthDecember";f={1:e["esriMonthJanuary"],2:e[n],3:e[t],4:e[i],5:e[r],6:e[s],7:e[a],8:e[o],9:e[l],10:e[u],11:e[c],12:e[m]}}function d(e,n,t){const i=e=>f[e],r=(n,t)=>`${e} (${i(n)} - ${i(t)})`;if(t&&""===t)return e.toString();const s="Months"===t,a="Quarters"===t;if(!s&&!a)return e.toString();if(1==n&&s)return`${e} (${i(+e)})`;switch(+e){case 1:return r(1,3);case 2:return r(4,6);case 3:case 7:return r(7,9);case 4:return a?r(10,12):r(4,6);case 10:return r(10,12)}return e.toString()}function b(e){const{multidimensionalInfoVariables:n,selectedVariables:t=[]}=e;return n.filter((e=>{const n=t.some((n=>n===e.name));return!(t.length>0)||n}))}function h(e){const{variables:n=[],selectedDimension:t=""}=e;return n.reduce(((e,n)=>{const r=n.dimensions.filter((e=>!!(0,i.i)(t)||e.name===t));return r.length?[...e,...r]:e}),[])}function v(e){const n=[];return e.forEach((function(e){const t=e.hasRanges,r=e.recurring;let s;e.values.forEach((function(a){let o=(0,i.O)(a);t||(o=[o]),"StdTime"===e.name&&(o=o.map((n=>r?d(n,e.interval,e.intervalUnit):l(Number(n)))));const u=t?o.join(" \u2014 "):o.join("");var c;s={label:u,key:r?t?a.join(" \u2014 "):a.toString():u},c=s,n.some((e=>e.label===c.label))||n.push(s)}))})),n}function p(e,n){const t=c(h({variables:b({multidimensionalInfoVariables:e,selectedVariables:n})}),"name");return t.filter((function(e,n,t){return t.indexOf(e)===n}))}function y(e,n,t){return v(h({variables:b({multidimensionalInfoVariables:e,selectedVariables:n}),selectedDimension:t}))}function g(e,n,t,r){const a=Boolean(r);let o=h({variables:b({multidimensionalInfoVariables:s(e),selectedVariables:n}),selectedDimension:t});a&&(o=function(e,n){const t="BY_VALUES",r="BY_RANGES";let s=n?.dimensions?.length>0;if(n?.definitionType===r?s=s&&n.minValues?.length>0&&n.maxValues?.length>0:n&&n.definitionType===t&&(s=s&&n.values?.length>0),!s)return e;const a=(0,i.O)(e);return a.forEach((e=>{const s=e.hasRanges,a=e.recurring;let o=[];const l=n.dimensions.indexOf(e.name)>=0;l||(o=e.values),l&&n.dimensions.forEach(((i,l)=>{if(i===e.name)switch(n.definitionType){case r:{let t=n.minValues[l],i=n.maxValues[l];"StdTime"===e.name&&!0!==a&&(t=u(t),i=u(i)),"boolean"==typeof t||isNaN(t)||(t=Number(t)),"boolean"==typeof i||isNaN(i)||(i=Number(i));let r=-1,c=-1;if(s)for(let n=0;n<e.values.length&&(e.values[n][0]===t&&(r=n),e.values[n][1]===i&&(c=n+1),!(r>=0&&c>=1));n++);else r=e.values.indexOf(t),c=e.values.indexOf(i)+1;o=[...o,...e.values.slice(r,c)];break}case t:{let t;t=s?n.values[l].split(" \u2014 "):[n.values[l]],"StdTime"===e.name&&!0!==a&&(t=t.map((e=>u(e))));const i=e.values.filter((e=>("boolean"==typeof e||isNaN(e)||(e=Number(e)),s?e.includes(t[0])&&e.includes(t[1]):t[0]==e)));o=[...o,...i];break}}})),e.values=(0,i.O)(o)})),a}(o,r));const l=v(o);let c,f;const m=function(e){let n=!1;return e.length>0&&(n=e[0].hasRanges),n}(o);if(m){const e=function(e){const n=[],t=[];return e.forEach((e=>{const i=e.label.split(" \u2014 ");n.push({label:i[0],key:i[0]}),t.push({label:i[1],key:i[1]})})),{min:n,max:t}}(l);c=e.min,f=e.max}else c=(0,i.O)(l),f=(0,i.O)(l);return{startValueOptions:c,endValueOptions:f}}function V(e,n){if(["BY_ITERATION"].includes(e.definitionType))return!1;if((0,i.i)(n))return!1;const t=e.dimensions;if(!t)return function(e,n){const t=e?.find((e=>n===e.name));if(!t)return!1;const i=t.dimensions.reduce(((e,n)=>(e[n.name]=n.values.length,e)),{});return Object.values(i).every((e=>1===e))}(n,e.variables[0]);if(!t.every((function(e,n,t){return!(t.indexOf(e,n+1)>=0)})))return!1;const r=b({multidimensionalInfoVariables:n,selectedVariables:e.variables}),s=c(h({variables:r}),"name"),a=s.every((e=>{return n=e,t.indexOf(n)>=0;var n}));if(!a)return!1;if(!("BY_RANGES"===e.definitionType))return a;const o=e.maxValues,f=e.minValues;return o.every(((e,n)=>{const i=t[n],s=h({variables:r,selectedDimension:i}),a=s.length>0?s[0]:void 0;if(a&&a.hasRanges){const t=function(e,n){const t="StdTime"===e.name,i=t&&"string"==typeof n?u(n):n,r=e.values.find((e=>e[0]===i));return"object"==typeof r&&t?r.map((e=>l(Number(e)))):r}(a,f[n]);return e===t[1]}return f[n]===e}))}function N(e,n){return e.some((function(e){if(e.key===n)return!0}))}const O=(e,n)=>{const t=e.multidimensionalSubset;let i=[];return null!=n&&(i=null!=t?e.getMultidimensionalSubsetVariables():n.variables),i},S=async e=>{const n=await e.generateRasterInfo(e.rasterFunction);return"imagery-tile"===e.type?n.multidimensionalInfo:e.multidimensionalInfo},x=e=>{const n={definitionType:"BY_RANGES",variables:[],dimensions:[],minValues:[],maxValues:[]};return e.forEach((e=>{let t=e.values[0];"StdTime"===e.dimensionName&&(t=t.map((e=>l(Number(e))))),n.variables.push(e.variableName),n.dimensions.push(e.dimensionName),n.minValues.push(t[0]),n.maxValues.push(t[1])})),JSON.stringify(n)}}}]);