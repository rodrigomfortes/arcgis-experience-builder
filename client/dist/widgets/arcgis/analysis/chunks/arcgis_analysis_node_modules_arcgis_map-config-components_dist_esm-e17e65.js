/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-e17e65.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-e17e65"],{10465:(t,e,s)=>{s.d(e,{D:()=>i,a:()=>h,b:()=>l,c:()=>r,g:()=>v,s:()=>b});class i{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}const a=(t,e,s)=>(0,n(e).subscribe)((e=>{const i=e.some((e=>((t,e)=>{let s=t;for(;s;){if(s===e)return!0;if(!s.parentNode)return!1;s=s.parentNode instanceof ShadowRoot?s.parentNode.host:s.parentNode}return!1})(t,e.target)));i&&s()})),o={},n=t=>{const e=t.join(","),s=o[e];if(void 0!==s)return s;const i=new Set,a=new MutationObserver((t=>i.forEach((e=>e(t)))));globalThis.document&&a.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const n={subscribe:t=>(i.add(t),()=>{i.delete(t),0===i.size&&(a.disconnect(),o[e]=void 0)})};return o[e]=n,n},r=(t,e)=>{let s=t;for(;s;){const t=s.closest?.(e);if(t)return t;const i=s.getRootNode?.();if(i===globalThis.document)return null;s=i.host}return null},l=t=>c(t,"dir","ltr"),c=(t,e,s)=>{const i=r(t,`[${e}]`);return i?.getAttribute(e)??s},d=t=>{let e="";for(let s=0;s<t;s++)e+=(65536*(1+Math.random())|0).toString(16).substring(1);return e},h=()=>[d(2),d(1),d(1),d(1),d(3)].join("-"),g="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),p=new Set(g),u="en",m={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},C={},y=async(t,e)=>{const s=`${e}${t}.json`;try{const t=await fetch(s);if(t.ok)return await t.json()}catch(t){return console.error(t),{}}return t===u?{}:await y(u,e)},v=t=>{const e=c(t,"lang",globalThis.navigator?.language||u);return{lang:e,t9nLocale:f(e)}},f=t=>{const[e,s]=t.split("-"),i=e.toLowerCase();let a=i;return s&&(a=`${i}-${s.toUpperCase()}`),a=m[a]??a,p.has(a)?a:s?f(i):u},b=(t,e,s,i)=>{let o;const n=()=>w(t,e(),i).then((t=>{o?.lang===t.lang&&o.t9nLocale===t.t9nLocale&&o.t9nStrings===t.t9nStrings||s(t),o=t})).catch(console.error);return queueMicrotask(n),a(t,["lang"],n)},w=async(t,e,s=t.localName.split("-").slice(1).join("-"))=>{const{lang:i,t9nLocale:a}=v(t),o=`${e}/${s}/t9n`,n=null===s?{}:await(async(t,e,s="")=>{const i=`${e}/${s}`,a=`${i}${t}.json`;return C[a]??(C[a]=y(t,i)),await C[a]})(a,o,"messages.");return{lang:i,t9nLocale:a,t9nStrings:n}}},14528:(t,e,s)=>{function i(t){const e=[];a=t,queueMicrotask((()=>{a===t&&(a=void 0)}));const s=t.componentWillLoad;return t.componentWillLoad=async()=>{await Promise.all(e.map((t=>t()))).then((()=>{})),await(s?.call(t))},{onLoad:t=>e.push(t)}}let a;function o(){return a}s.d(e,{r:()=>o,u:()=>i})},65863:(t,e,s)=>{s.r(e),s.d(e,{arcgis_layer_template:()=>n});var i=s(11254),a=s(14528),o=s(84260);s(10465);const n=class{constructor(t){(0,i.r)(this,t),this.arcgisClose=(0,i.c)(this,"arcgisClose",7),this.manager=(0,a.u)(this),this.strings=(0,o.u)({blocking:!0}),this.layer=void 0,this.portal=void 0,this.readOnly=!1,this.templateCoordinatorState={canUndo:!1,canRedo:!1,undoLabels:[],redoLabels:[],selectedTemplate:void 0,hasUnsavedChanges:!1},this.showUnsavedChangesDialog=!1,this.saveInProgress=!1}componentWillLoad(){this.templateCoordinatorState.selectedTemplate="feature"===this.layer.type?this.layer.types?.[0]?.templates?.[0]??this.layer.templates?.[0]:this.layer.templates?.[0]}render(){const t=this.portal??("feature"===this.layer.type?this.layer.portalItem?.portal:this.layer.parent?.portalItem?.portal);return t?(0,i.h)(i.F,null,(0,i.h)("calcite-dialog",{heading:this.layer.title||this.strings.configureTemplates,modal:!0,placement:"cover",open:!0,beforeClose:()=>this.templateCoordinatorState.hasUnsavedChanges?(this.showUnsavedChangesDialog=!0,Promise.reject(new Error(this.strings.unsavedChangesTitle))):Promise.resolve(),onCalciteDialogClose:()=>this.arcgisClose.emit(),ref:t=>{t&&(this.dialogNode=t)}},(0,i.h)("tc-templates-coordinator",{layer:this.layer,portal:t,initialTemplate:this.templateCoordinatorState.selectedTemplate,onTcTemplatesCoordinatorChange:t=>this.updateFromCoordinatorState(t.detail),ref:t=>{t&&(this.templatesCoordinator=t)}},(0,i.h)("div",{class:"main-container"},this.renderTemplateListPanel(),this.renderEditorPanel())),this.renderFooterButtons()),this.showUnsavedChangesDialog&&this.renderUnsavedChangesDialog()):(console.error("Portal information is required for template configuration."),(0,i.h)(i.F,null))}renderTemplateListPanel(){return(0,i.h)("calcite-panel",{class:"template-list",heading:this.strings.templates},this.readOnly?this.renderReadOnlyMessgae():this.renderActionBar(),this.readOnly&&"subtype-sublayer"!==this.layer.type&&(0,i.h)("calcite-label",{layout:"inline",class:"read-only-permissions-message"},(0,i.h)("calcite-icon",{scale:"s",icon:"lock"})," ",this.strings.editingNotAllowed),!this.readOnly&&this.layer.capabilities&&!this.layer.capabilities.operations.supportsEditing&&(0,i.h)("calcite-label",{layout:"inline",class:"read-only-permissions-message"},(0,i.h)("calcite-icon",{scale:"s",icon:"unlock"})," ",this.strings.editingAllowed),(0,i.h)("tc-template-list",{readOnly:this.readOnly}))}renderReadOnlyMessgae(){return(0,i.h)("calcite-button",{class:"read-only-message",disabled:!0,slot:"header-actions-end",appearance:"solid",kind:"neutral"},this.strings.readOnly)}renderActionBar(){return(0,i.h)("calcite-action-bar",{slot:"header-actions-end",layout:"horizontal",expandDisabled:!0,overflowActionsDisabled:!0},(0,i.h)("calcite-action-group",null,(0,i.h)("calcite-action",{text:this.strings.undo,icon:"undo",iconFlipRtl:!0,disabled:!this.templateCoordinatorState.canUndo,onClick:()=>this.handleUndoClick()},(0,i.h)("calcite-tooltip",{slot:"tooltip"},this.strings.undo)),(0,i.h)("calcite-action",{text:this.strings.redo,icon:"redo",iconFlipRtl:!0,disabled:!this.templateCoordinatorState.canRedo,onClick:()=>this.handleRedoClick()},(0,i.h)("calcite-tooltip",{slot:"tooltip"},this.strings.redo)),(0,i.h)("calcite-action",{text:this.strings.save,icon:"save",disabled:!this.templateCoordinatorState.hasUnsavedChanges||this.saveInProgress,onClick:t=>this.save(t.target)},(0,i.h)("calcite-tooltip",{slot:"tooltip"},this.strings.save))),(0,i.h)("calcite-dropdown",null,(0,i.h)("calcite-action",{id:"history-menu-trigger",text:this.strings.history,icon:"recent",slot:"trigger",disabled:!this.templateCoordinatorState.canRedo&&!this.templateCoordinatorState.canUndo},(0,i.h)("calcite-tooltip",{slot:"tooltip"},this.strings.history)),this.renderUndoHistoryGroup(),this.renderRedoHistoryGroup()))}renderEditorPanel(){return(0,i.h)("calcite-panel",{heading:this.strings.properties},this.templateCoordinatorState.selectedTemplate?this.renderEditors():this.renderEmptyState())}renderEditors(){return(0,i.h)(i.F,null,(0,i.h)("calcite-block",{heading:this.strings.formatting,open:!0,collapsible:!0},(0,i.h)("tc-formatting-editor",{readOnly:this.readOnly})),(0,i.h)("calcite-block",{heading:this.strings.defaultValues,open:!0,collapsible:!0},(0,i.h)("tc-default-values-editor",{readOnly:this.readOnly})))}renderEmptyState(){return(0,i.h)("div",{class:"empty-state"},(0,i.h)("div",{class:"empty-state-icon"},(0,i.h)("svg",{viewBox:"0 0 64 64",xmlns:"http://www.w3.org/2000/svg"},(0,i.h)("use",{href:`${(0,i.g)("./assets/icons/clipboard-64.svg")}#icon`}))),(0,i.h)("div",{class:"empty-state-title"},this.strings.emptyStateTitle),(0,i.h)("div",{class:"empty-state-description"},this.strings.emptyStateDescription))}renderUndoHistoryGroup(){return this.templateCoordinatorState.canUndo?(0,i.h)("calcite-dropdown-group",{selectionMode:"single",groupTitle:this.strings.undo},this.templateCoordinatorState.undoLabels.map(((t,e)=>(0,i.h)("calcite-dropdown-item",{iconFlipRtl:"start",iconStart:"undo",onCalciteDropdownItemSelect:()=>this.handleUndoClick(e+1)},t)))):(0,i.h)(i.F,null)}renderRedoHistoryGroup(){return this.templateCoordinatorState.canRedo?(0,i.h)("calcite-dropdown-group",{selectionMode:"single",groupTitle:this.strings.redo},this.templateCoordinatorState.redoLabels.map(((t,e)=>(0,i.h)("calcite-dropdown-item",{iconFlipRtl:"start",iconStart:"redo",onCalciteDropdownItemSelect:()=>this.handleRedoClick(e+1)},t)))):(0,i.h)(i.F,null)}renderFooterButtons(){return this.readOnly?(0,i.h)(i.F,null):(0,i.h)(i.F,null,(0,i.h)("calcite-button",{slot:"footer-end",appearance:"outline",disabled:!this.templateCoordinatorState.hasUnsavedChanges||this.saveInProgress,onClick:()=>this.handleCancelClick(),ref:t=>{t&&(this.cancelNode=t)}},this.strings.cancel),(0,i.h)("calcite-button",{slot:"footer-end",disabled:!this.templateCoordinatorState.hasUnsavedChanges||this.saveInProgress,onClick:t=>this.save(t.target,!0)},this.strings.ok))}renderUnsavedChangesDialog(){return(0,i.h)("calcite-dialog",{modal:!0,open:!0,kind:"danger",escapeDisabled:!0,outsideCloseDisabled:!0,onCalciteDialogClose:()=>this.showUnsavedChangesDialog=!1,ref:t=>{t&&(this.warningDialog=t)}},(0,i.h)("div",{slot:"header-content",class:"warning-title"},this.strings.unsavedChangesTitle),(0,i.h)("div",{class:"warning-description"},this.strings.unsavedChangesDescription),(0,i.h)("div",{class:"warning-dialog-buttons",slot:"footer-end"},(0,i.h)("calcite-button",{onClick:async()=>{await this.templatesCoordinator.reset(),this.warningDialog?.parentNode?.removeChild(this.warningDialog),this.close()}},this.strings.ok),(0,i.h)("calcite-button",{appearance:"outline",onClick:()=>this.showUnsavedChangesDialog=!1},this.strings.cancel)))}close(){this.dialogNode.parentNode?.removeChild(this.dialogNode),this.arcgisClose.emit()}async handleCancelClick(){if(this.templateCoordinatorState.hasUnsavedChanges)this.showUnsavedChangesDialog=!0;else try{this.cancelNode.loading=!0;const t=await this.templatesCoordinator.reset();this.updateFromCoordinatorState(t),this.close()}catch(t){console.error(t)}finally{this.cancelNode.loading=!1}}async handleUndoClick(t=1){const e=await this.templatesCoordinator.undo(t);this.updateFromCoordinatorState(e)}async handleRedoClick(t=1){const e=await this.templatesCoordinator.redo(t);this.updateFromCoordinatorState(e)}async save(t,e=!1){try{t.loading=!0,this.dialogNode.closeDisabled=!0,this.saveInProgress=!0;const s=await this.templatesCoordinator.save();return this.dialogNode.closeDisabled=e,this.updateFromCoordinatorState(s),this.showAlert("success",this.strings.saveSuccessful,"",e),!0}catch(t){return console.error(t),t instanceof Error&&"ValidationError"===t.name?this.showAlert("error",this.strings.unableToSave,this.strings.saveErrorInvalidTemplate):this.showAlert("error",this.strings.unableToSaveTemplates,this.strings.checkPrivileges),this.dialogNode.closeDisabled=!1,!1}finally{this.saveInProgress=!1,t.loading=!1}}showAlert(t,e,s,i=!1){const a=document.createElement("calcite-alert");a.kind="error"===t?"danger":"success",a.label=e,a.autoClose=!0,a.slot="alerts","success"===t&&i&&a.addEventListener("calciteAlertClose",(()=>this.close()));const o=document.createElement("div");if(o.innerHTML=e,o.slot="title",a.appendChild(o),s.length){const t=document.createElement("div");t.innerHTML=s,t.slot="message",a.appendChild(t)}a.open=!0,this.dialogNode.appendChild(a)}updateFromCoordinatorState(t){this.templateCoordinatorState=t}static get assetsDirs(){return["assets"]}get el(){return(0,i.a)(this)}};n.style=".empty-state{height:100%;align-content:center;text-align:center}.empty-state-description{color:#9f9f9f;font-size:var(--calcite-font-size-1)}.empty-state-icon{fill:#9f9f9f;display:inline-flex;height:80px;width:80px}.empty-state-title{color:#9f9f9f;font-weight:500;font-size:var(--calcite-font-size-3)}.main-container{display:flex;height:100%}.read-only-message{margin:auto 0.75rem auto auto}.read-only-permissions-message{margin:12px;align-self:center}.template-list{border-right:1px solid var(--calcite-color-border-3)}.warning-description{font-size:var(--calcite-font-size-md);padding:var(--calcite-spacing-md)}.warning-dialog-buttons{display:flex;gap:5px}.warning-title{margin:0px;font-weight:var(--calcite-font-weight-normal);color:var(--calcite-color-text-1);font-size:var(--calcite-font-size-xl)}"},84260:(t,e,s)=>{s.d(e,{u:()=>n});var i=s(11254),a=s(10465),o=s(14528);function n({propertyName:t="strings",name:e}){let s=(0,o.r)();const n=(0,a.g)(s.el),l=new a.D,c={_lang:n.lang,_t9nLocale:n.t9nLocale};s.manager.onLoad((()=>l.promise));const d=new WeakRef(s);function h(){const t=d.deref();return t||p?.(),t}s=void 0;const g=r((()=>h()?.el)),p=(0,a.s)(g,(()=>(0,i.g)("./assets")),(({t9nLocale:e,t9nStrings:s,lang:i})=>{const a=h();if(!a)return;a[t]={...s,_lang:i,_t9nLocale:e},l.resolve()}),e);return c}const r=t=>new Proxy({},{get(e,s){const i=t();if(!i)return;const a=Reflect.get(i,s,i);return"function"==typeof a?a.bind(i):a}})}}]);