/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--0b683b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--0b683b"],{87794:(i,t,n)=>{n.r(t),n.d(t,{arcgis_filter_expression:()=>g});var e=n(11254),o=n(40387),s=n(10465),d=n(14528);n(17840),n(56612),n(69811);const r="expression-block",c="add-condition-button",a="content",h="match-type-text",l="match-type-text-empty",p="match-condition",u="match-condition-dropdown",g=class{constructor(i){(0,e.r)(this,i),this.arcgisExpressionChanged=(0,e.c)(this,"arcgisExpressionChanged",7),this.arcgisFilterExpressionChanged=(0,e.c)(this,"arcgisFilterExpressionChanged",7),this.manager=(0,d.u)(this),this.onAddCondition=()=>{const{props:i,conditions:t}=this,n=(0,o.q)(i),e=(0,o.y)(i,n),s=(0,o.r)(i,n,e),d={fieldName:n.layerField.name,operator:(0,o.y)(i,n),...s,hasFocus:!0};t.forEach((i=>i.hasFocus=!1)),this.conditions=[...t,d],i.expressions=i.expressions.map((i=>i.uid===this.uid?{...i,conditions:this.conditions}:{...i})),this.fixUIDsForExpression(),this.menuNode.open=!1,this.emitChangeEvent()},this.onRemoveCondition=i=>{const{props:t,conditions:n}=this;n.forEach((i=>i.hasFocus=!1));let e=0;this.conditions=n.filter(((t,n)=>!t||n!==i||(e=n,!1))),this.conditions[Math.max(0,e-1)].hasFocus=!0,t.expressions=t.expressions.map((i=>i.uid===this.uid?{...i,conditions:this.conditions}:{...i})),this.fixUIDsForExpression(),this.emitChangeEvent()},this.onMatchSelect=i=>{const t=i.target.selectedOption.value;this.logicalOperatorForConditions=t,this.emitChangeEvent()},this.onCopyExpression=()=>{const{uid:i,conditions:t,logicalOperatorForConditions:n}=this,e={uid:i,conditions:t,logicalOperatorForConditions:n};this.menuNode.open=!1,this.arcgisFilterExpressionChanged.emit({type:"copy",uid:this.uid,expression:e}),this.arcgisExpressionChanged.emit({type:"copy",uid:this.uid,expression:e})},this.onRemoveExpression=()=>{this.arcgisFilterExpressionChanged.emit({type:"delete",uid:this.uid}),this.arcgisExpressionChanged.emit({type:"delete",uid:this.uid})},this.props=void 0,this.uid=void 0,this.conditions=void 0,this.logicalOperatorForConditions=void 0,this.hideRemove=!1,this.canRemove=!0,this.hideDuplicate=!1,this.canDuplicate=!0,this.showAddConditionButton=!1}arcgisFilterConditionChangeHandler(i){const{conditions:t}=this,{detail:n}=i;this.conditions=t.map((i=>i.uid===n.uid?n:i)),this.emitChangeEvent()}async onEdits(){this.el.shadowRoot?.querySelectorAll("arcgis-filter-condition").forEach((i=>i.onEdits()))}async componentWillLoad(){this.canRemove||this.hideRemove||(this.hideRemove=!0),this.canDuplicate||this.hideDuplicate||(this.hideDuplicate=!0),this.conditions=this.conditions||[]}render(){const{props:i,conditions:t}=this,{strings:n}=i,o=(0,s.b)(this.el);return(0,e.h)(e.H,{key:"6e1b8875c282b4db72873257120e6639c24364a8",dir:o},(0,e.h)("calcite-block",{key:"c2a056aa44801df9498c3e4d62ae16cf51aaa1f2",heading:1===t.length?n.condition:n.conditionSet,open:!0,class:r},this.renderMenu(),this.renderMatchCondition(),this.renderConditions(),this.renderAddConditionButton()))}renderMenu(){const{props:i,hideDuplicate:t,hideRemove:n,conditions:o}=this,{strings:s}=i;return(0,e.h)("calcite-action-menu",{slot:"control",placement:"bottom-end",overlayPositioning:"fixed",label:s.accessibility.moreOptions,ref:i=>this.menuNode=i},!n&&(0,e.h)("calcite-action",{text:1===o.length?s.deleteExpression:s.deleteSet,textEnabled:!0,"data-value":"remove",onClick:this.onRemoveExpression}),!t&&(0,e.h)("calcite-action",{text:s.duplicate,textEnabled:!0,"data-value":"copy",onClick:this.onCopyExpression}),(0,e.h)("calcite-action",{text:s.addCondition,textEnabled:!0,"data-value":"add",onClick:this.onAddCondition}))}renderMatchCondition(){const{conditions:i,logicalOperatorForConditions:t,props:n}=this,{strings:s}=n;if(!i?.length||1===i.length)return(0,e.h)(e.F,null);const d=t!==o.l.OR;return(0,e.h)("div",{class:p},(0,e.h)("calcite-select",{width:"full",scale:"m",label:s.accessibility.matchType,class:u,onCalciteSelectChange:this.onMatchSelect},(0,e.h)("calcite-option",{value:o.l.AND,label:s.matchAll,selected:d}),(0,e.h)("calcite-option",{value:o.l.OR,label:s.matchAtLeastOne,selected:!d})))}renderConditions(){const{conditions:i}=this;return(0,e.h)("div",{class:a},i.map(((i,t)=>this.renderCondition(i,t))))}renderCondition(i,t){const{conditions:n,props:o}=this;return(0,e.h)("div",null,this.renderConditionHeader(t),(0,e.h)("arcgis-filter-condition",{props:o,showDelete:n.length>1,...i,onArcgisFilterConditionDeleted:()=>this.onRemoveCondition(t)}))}renderAddConditionButton(){return this.showAddConditionButton&&(0,e.h)("calcite-button",{alignment:"center",appearance:"transparent",class:c,"icon-start":"plus",scale:"s",onClick:this.onAddCondition},this.props.strings.addCondition)}renderConditionHeader(i){const{props:t,logicalOperatorForConditions:n,conditions:s}=this,{strings:d}=t;if(s.length<2)return(0,e.h)(e.F,null);const r=n!==o.l.OR;return(0,e.h)("div",null,i>0?(0,e.h)("span",{class:h},r?d.and:d.or):s.length>1?(0,e.h)("div",{class:l}):null)}fixUIDsForExpression(){const{props:i}=this;i.expressions=(0,o.o)(i.expressions),this.conditions=i.expressions.find((i=>i.uid===this.uid)).conditions}emitChangeEvent(){const{uid:i,conditions:t,logicalOperatorForConditions:n}=this,e={uid:i,conditions:t,logicalOperatorForConditions:n};this.arcgisFilterExpressionChanged.emit({type:"replace",expression:e}),this.arcgisExpressionChanged.emit({type:"replace",expression:e})}get el(){return(0,e.a)(this)}};g.style=".expression-block {\n  margin: 0 8px;\n  border: 1px solid var(--calcite-color-border-3);\n}\n.content {\n  padding-bottom: 6px;\n}\n.match-type-text {\n  display: flex;\n  justify-content: flex-start;\n  margin: 6px 8px 0 8px;\n}\n:dir(rtl) {\n  .match-type-text {\n    justify-content: flex-end;\n  }\n}\n.match-type-text-empty {\n  margin: 10px 0 0 0;\n}\n.match-condition {\n  border-bottom: 1px solid var(--calcite-color-border-3);\n  padding-bottom: 18px;\n}\n.match-condition-dropdown {\n  width: 100%;\n}\n\n.add-condition-button {\n  display: flex;\n}\n"}}]);