/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-23e7f1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-23e7f1"],{37660:(e,t,o)=>{o.r(t),o.d(t,{arcgis_sketch_layer_editor_content:()=>m,arcgis_sketch_layer_editor_shortcuts:()=>y,arcgis_sketch_layer_editor_snapping:()=>b,arcgis_sketch_layer_editor_tools:()=>f});var i=o(11254),s=o(56612),r=o(17840),l=o(59350),n=o(10465),c=o(4573),a=o(58262),h=o(53127),d=o(14528),p=o(69811);o(10588);const u=["#ff4040","#ff8202","#faa83e","#ffd159","#73b566","#008977","#33e3c8","#43abeb","#4b64c9","#9868ed","#b055e6","#db5181","#e03b99","#2b2b2b","#bdbdbd","#ffffff"],g=["#ffffff","#bdbdbd","#2b2b2b","#e03b99","#db5181","#b055e6","#9868ed","#4b64c9","#43abeb","#33e3c8","#008977","#73b566","#ffd159","#faa83e","#ff8202","#ff4040"],m=class{constructor(e){(0,i.r)(this,e),this.arcgisSymbolChange=(0,i.c)(this,"arcgisSymbolChange",7),this.arcgisGraphicUpdates=(0,i.c)(this,"arcgisGraphicUpdates",7),this.arcgisLoadPanel=(0,i.c)(this,"arcgisLoadPanel",7),this.arcgisDisablePanel=(0,i.c)(this,"arcgisDisablePanel",7),this.manager=(0,d.u)(this),this.sketchLayerEditorState=(0,a.u)(),this.divNodes=[],this.symbolNodes=[],this.suggestedFillColors=[],this.savedColors=[],this.percentLabelFlip=!1,this.narrow=!1,this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.narrow=t.contentRect.width<=275,(0,i.f)(this.el)})),this.updateRotation=(0,h.d)((()=>{if(!this.rotationEl)return;clearTimeout(this.rotationValueHandle);const e=Number.parseInt(this.rotationEl.value);!e||e<this.rotationEl.min||e>this.rotationEl.max?this.rotationValueHandle=setTimeout((()=>this.handleTextPropChange(this.rotationEl,"rotation")),3e3):this.handleTextPropChange(this.rotationEl,"rotation")}),500),this.flowEl=void 0,this.symbolStylerRefElement=void 0,this.currentSketchInfo=void 0,this.symbolStylerConfig={},this.reRender=!0}async rerender(e){this.closeFontPopover(),(0,r.i)(e)&&(this.storageId=this.getStorageId(),this.recentSymbols=(0,c.g)(this.storageId,!0)),this.reRender=!this.reRender,this.sketchPopupFlowItem&&(this.flowEl.back(),this.sketchPopupFlowItem?.parentElement?.removeChild(this.sketchPopupFlowItem),this.sketchPopupFlowItem=void 0);const{tool:t}=this.currentSketchInfo;"point"===t?this.startPointEdit():"polyline"===t?this.startPolylineEdit():["circle","polygon","rectangle"].includes(t)&&this.startPolygonEdit()}async componentWillLoad(){const{sketchLayerEditorState:e}=this;this.arcgisLoadPanel.emit(!0),await this.loadAllModules(),u.forEach((e=>this.suggestedFillColors.push(new this.modules.Color(e)))),g.forEach((e=>this.savedColors.push(new this.modules.Color(e)))),this.mapView=e.mapView,this.portal=e.portal,this.flowEl||(this.flowEl=(0,r.q)(this.el,"calcite-flow"));const t=this.getStorageId(),o=(0,c.g)(t,!0);o&&(this.recentSymbols=[...o]);const i=(0,n.b)(this.el),s=new Intl.NumberFormat(this.modules.intl.getLocale(),{style:"percent"}).format(0);this.percentLabelFlip="rtl"===i?s.endsWith("%"):s.startsWith("%")}componentDidLoad(){this.arcgisLoadPanel.emit(!1),this.flowEl&&this.resizeObserver.observe(this.flowEl)}disconnectedCallback(){clearTimeout(this.fontSizeValueHandle),clearTimeout(this.rotationValueHandle),clearTimeout(this.haloSizeValueHandle),clearTimeout(this.borderLineSizeValueHandle),this.flowEl&&this.resizeObserver.unobserve(this.flowEl),this.removeResetTooltip()}render(){return this.divNodes=[],this.symbolNodes=[],(0,i.h)(i.H,{key:"ea58f829e56c93781e933244448c18d7b79a53af"},(0,i.h)("div",{key:"17e2cb278f76513c6b9757615aa549b08db46491"},this.renderFeatureInfoBlock(),this.renderStyleInfoBlock()))}renderFeatureInfoBlock(){const e=this.getFeatureInfoHeading();return(0,i.h)("calcite-block",{heading:e,open:!0,collapsible:!0},this.renderSketchTitle(),this.renderPopupBtn())}renderStyleInfoBlock(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,s=this.currentSketchInfo.graphics?.[0].geometry.type,r=this.currentSketchInfo.graphics?.every((e=>s===e.geometry.type)),l=this.currentSketchInfo.graphics?.some((e=>"text"===e.symbol?.type))&&!this.currentSketchInfo.graphics?.every((e=>"text"===e.symbol?.type)),n=!o||r&&!l;return(0,i.h)("div",{class:"style-info-wrapper"},(0,i.h)("div",{class:"style-info-block"},(0,i.h)("calcite-label",{class:"style-title"},t.style),n&&this.renderRecentSymbols(),!n&&this.renderNoStyleMessage()),n&&this.renderSymbolStyler())}renderRecentSymbols(){const{sketchLayerEditorState:e}=this,{strings:t}=e;let o;switch(this.currentSketchInfo.tool){case"polyline":const e=this.currentSketchInfo.graphics?.every((e=>!!e.geometry.curvePaths?.length));o=e?t.curve:t.line;break;case"bezier-curve":o=t.curve;break;case"polygon":case"circle":case"rectangle":o=t.polygon;break;case"text":o=t.text;break;default:o=t.point}return o=o.toLocaleLowerCase(),(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,t.recentSymbols.replace("${tool}",o)),(0,i.h)("div",{class:"recent-symbols-wrapper",ref:e=>this.recentSymbolsContainerEl=e},this.recentSymbols?.length?(0,i.h)(i.F,null,(0,i.h)("div",{class:"recent-symbols-symbol-group"},this.recentSymbols.map(((e,t)=>e?(0,i.h)("div",{key:"symbol",class:"recent-symbol",tabindex:"0",onClick:()=>this.handleRecentSymbolSelect(t),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleRecentSymbolSelect(t))},ref:o=>{o&&(this.divNodes[t]=o,this.afterCreateRecentSymbolDiv(o,e,t))}}):null))),(0,i.h)("div",{class:"recent-symbols-divider-wrapper"},(0,i.h)("div",{class:"recent-symbols-divider"})),(0,i.h)("div",{class:"recent-symbols-reset-button-wrapper"},(0,i.h)("calcite-action",{scale:"s",icon:"reset",text:t.clearRecentSymbols,onClick:()=>{const e=this.getStorageId();this.recentSymbols=[],(0,c.s)(e,this.recentSymbols,!0),(0,i.f)(this.el)},onFocus:()=>this.addResetTooltip(),onFocusout:()=>this.removeResetTooltip(),onMouseOver:()=>this.addResetTooltip(),onMouseOut:()=>this.removeResetTooltip(),ref:e=>this.resetRecentSymbolsNode=e}))):(0,i.h)("div",{key:"no-recent-symbol",class:"no-recent-symbols"},t.noRecentSymbols.replace("${tool}",o))))}renderSymbolStyler(){switch(this.currentSketchInfo.tool){case"point":return this.renderPoint();case"polyline":case"bezier-curve":return this.renderPolyline();case"polygon":case"rectangle":case"circle":return this.renderPolygon();case"text":return this.renderText();default:return(0,i.h)(i.F,null)}}renderNoStyleMessage(){const{sketchLayerEditorState:e}=this,{strings:t}=e;return(0,i.h)("calcite-label",null,t.noStyleMessage)}renderSketchTitle(){const{sketchLayerEditorState:e}=this,{strings:t}=e;return(0,i.h)("calcite-label",null,t.featureName,(0,i.h)("calcite-input-text",{alignment:"start",placeholder:t.enterFeatureNamePlaceholder,value:this.currentSketchInfo.title,onBlur:e=>{this.currentSketchInfo.title=e.target.value,this.arcgisGraphicUpdates.emit({type:"title"})}}))}renderPopupBtn(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o="rtl"===(0,n.b)(this.el),l=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1;return(0,i.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconStart:"configure-popup",iconEnd:o?"chevron-left":"chevron-right",label:t.popup,width:"full",scale:"l",class:"sketch-popup-button",onClick:e=>{if(e.stopPropagation(),!this.sketchPopupFlowItem){this.sketchPopupFlowItem=document.createElement("calcite-flow-item"),this.sketchPopupFlowItem.heading=t.sketch,this.sketchPopupFlowItem.description=t.popup;const e=document.createElement("arcgis-map-config-popup");if(e.mapView=this.mapView,e.portal=this.portal,e.layerDisplayType=s.l.mapNotes,e.mapNotesPopupTemplate=this.currentSketchInfo.popup,e.mapNotesGraphic=this.currentSketchInfo.graphics?.[0],e.calciteFlowProps={calciteFlow:this.flowEl,calciteFlowItem:this.sketchPopupFlowItem},this.sketchPopupFlowItem.addEventListener("calciteFlowItemBack",(()=>{this.flowEl.removeChild(this.sketchPopupFlowItem),this.flowEl.childNodes[this.flowEl.childNodes.length-1].selected=!0})),this.sketchPopupFlowItem.appendChild(e),this.flowEl.appendChild(this.sketchPopupFlowItem),this.flowEl.childNodes.forEach((e=>e.selected=!1)),this.sketchPopupFlowItem.selected=!0,this.sketchPopupFlowItem.addEventListener("calciteFlowItemBack",(e=>{e.stopPropagation(),this.mapView.closePopup(),this.sketchPopupFlowItem?.parentElement?.removeChild(this.sketchPopupFlowItem),this.sketchPopupFlowItem=void 0})),l){e.multiplePopupsSelected=!0,e.disableEditing=!0;const o=document.createElement("calcite-button");o.label=t.applyChanges,o.innerHTML=t.applyChanges,o.scale="l",o.slot="footer",this.sketchPopupFlowItem.append(o),o.addEventListener("click",(()=>{this.alertEl&&(this.alertEl.parentElement?.removeChild(this.alertEl),this.alertEl=void 0),e.disableEditing=!1,e.update(),o.kind="neutral",o.disabled=!0,this.alertEl=document.createElement("calcite-alert"),this.alertEl.kind="success",this.alertEl.icon="check-circle";const i=document.createElement("div");i.slot="message",i.innerHTML=t.changesApplied,this.alertEl.append(i),this.alertEl.open=!0,document.body.append(this.alertEl),this.alertEl.addEventListener("calciteAlertClose",(()=>{this.alertEl.parentElement?.removeChild(this.alertEl),this.alertEl=void 0}))})),e.addEventListener("arcgisMultiplePopupsSelected",(()=>{o.kind="brand",o.disabled=!1}))}e.addEventListener("arcgisChange",(e=>{const t=e.detail.mapNotesPopupTemplate;this.handlePopupChange(t)})),this.sketchPopupFlowItem.setFocus(),this.sketchPopupFlowItem.beforeBack=async()=>await e.done(),this.mapView.closePopup(),this.currentSketchInfo.graphics?.length&&this.currentSketchInfo.popup&&this.mapView.openPopup({features:[this.currentSketchInfo.graphics[0]],location:(0,r.d)(this.currentSketchInfo.graphics[0].geometry)})}}},t.popup)}renderPoint(){const e=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics?.[0].geometry?.type,o=this.currentSketchInfo.graphics?.every((e=>t===e.geometry?.type)),s=this.currentSketchInfo.graphics?.[0].symbol?.type,r=this.currentSketchInfo.graphics?.every((e=>s===e.symbol?.type));return(0,i.h)("arcgis-map-config-symbol-styler",{class:"symbol-styler",mode:e?"minimal":"default",key:"point-styler",initialSourceId:this.currentSketchInfo.sourceIds.pointSourceId,config:{...this.symbolStylerConfig,displaySymbolsSelectionOnly:e&&o&&!r},ref:e=>{e&&this.currentSketchInfo.symbol&&(this.pointStyler=e,this.startPointEdit())},popoverProps:this.getPopoverProps(),onArcgisEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.pointSourceId=e})}renderPolyline(){const e=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics?.[0].geometry?.type,o=this.currentSketchInfo.graphics?.every((e=>t===e.geometry?.type)),s=this.currentSketchInfo.graphics?.[0].symbol?.type,r=this.currentSketchInfo.graphics?.every((e=>s===e.symbol?.type));return(0,i.h)("arcgis-map-config-symbol-styler",{class:"symbol-styler",mode:e?"minimal":"default",key:"polyline-styler",initialSourceId:this.currentSketchInfo.sourceIds.polylineSourceId,config:{...this.symbolStylerConfig,displaySymbolsSelectionOnly:e&&o&&!r},ref:e=>{e&&this.currentSketchInfo.symbol&&(this.polylineStyler=e,this.startPolylineEdit())},popoverProps:this.getPopoverProps(),onArcgisEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polylineSourceId=e})}renderPolygon(){const e=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,t=this.currentSketchInfo.graphics?.[0].geometry?.type,o=this.currentSketchInfo.graphics?.every((e=>t===e.geometry?.type)),s=this.currentSketchInfo.graphics?.[0].symbol?.type,r=this.currentSketchInfo.graphics?.every((e=>s===e.symbol?.type));return(0,i.h)("arcgis-map-config-symbol-styler",{class:"symbol-styler",mode:e?"minimal":"default",key:"polygon-styler",initialSourceId:this.currentSketchInfo.sourceIds.polygonSourceId,config:{...this.symbolStylerConfig,displaySymbolsSelectionOnly:e&&o&&!r},ref:e=>{e&&this.currentSketchInfo.symbol&&(this.polygonStyler=e,this.startPolygonEdit())},popoverProps:this.getPopoverProps(),onArcgisEdit:({detail:{symbol:e,symbolSwitch:t}})=>this.updateSymbol(e,t),onArcgisSourceIdChange:({detail:e})=>this.currentSketchInfo.sourceIds.polygonSourceId=e})}renderText(){return(0,i.h)("div",{class:"text-content"},this.renderTextContent(),this.renderFontFamilySelection(),this.renderTextFontSize(),this.renderTextColor(),this.renderTextRotation(),this.renderTextHaloBlock(),this.renderTextBackgroundColorBlock())}renderTextContent(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=this.currentSketchInfo.symbol;let s,r;return this.textContentEl&&(s=o?.text,r=this.currentSketchInfo.graphics?.every((e=>s===e.symbol.text))),(0,i.h)("calcite-label",null,t.content,(0,i.h)("calcite-text-area",{resize:"vertical",placeholder:t.textContentPlaceholder,value:r?o?.text:"",onCalciteTextAreaInput:e=>{e.stopPropagation();const t=o?.clone();t.text=e.target.value,this.updateSymbol(t,!1,!1,"text")},ref:e=>this.textContentEl=e}))}renderFontFamilySelection(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,t.font,(0,i.h)("calcite-button",{alignment:"icon-end-space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",label:(0,l.f)(o?.font||{family:"Arial",style:"normal",weight:"normal"}),width:"full",onClick:()=>this.openFontPopover()},(0,l.f)(o?.font)))}renderTextFontSize(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,t.size,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:5,max:125,value:""+((0,r.i)(o?.font?.size)?o.font.size/.75:5),onCalciteInputNumberInput:e=>{clearTimeout(this.fontSizeValueHandle),e.stopPropagation();const t=Number.parseInt(this.fontSizeEl.value);!t||t<this.fontSizeEl.min||t>this.fontSizeEl.max?this.fontSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.fontSizeEl,"font-size")),3e3):this.handleTextPropChange(this.fontSizeEl,"font-size")},ref:e=>this.fontSizeEl=e}))}renderTextColor(){const{sketchLayerEditorState:e,modules:t}=this,{strings:o}=e,s=this.currentSketchInfo.symbol;return(0,i.h)(i.F,null,(0,i.h)("calcite-label",null,o.color,(0,i.h)("arcgis-color-input",{color:s?.color?.toHex()||"#ffffff",popoverProps:this.getPopoverProps(),storageId:"arcgis-symbol-styler-storage-colors",onArcgisChange:e=>{const o=s?.clone(),i=s?.color?.a??1;o.color=new t.Color(e.target.color),o.color.a=i,this.updateSymbol(o,!1,!1,"color",!1,!0)},onArcgisPickerClose:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.color?.a??1;e.color=new t.Color(o),e.color.a=i,this.updateSymbol(e,!1,!1,"color")}},onArcgisSwatchUpdate:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.color?.a??1;e.color=new t.Color(o),e.color.a=i,this.updateSymbol(e,!1,!1,"color")}}})),(0,i.h)("calcite-label",null,o.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.p)(s?.color?.a??1)),onArcgisValueChange:e=>{const t=e.detail,o=(0,r.t)(t),i=s?.clone();i.color.a=o,this.updateSymbol(i,!1,!1,"color-transparency")},withSteppers:!this.narrow,label:o.transparency})))}renderTextRotation(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o="rtl"===(0,n.b)(this.el),s=this.currentSketchInfo.symbol;return(0,i.h)("calcite-label",null,t.rotation,(0,i.h)("div",{class:"rotation"},(0,i.h)("calcite-slider",{min:0,max:360,value:s?.angle||0,step:1,onCalciteSliderInput:e=>this.handleTextRotationSliderValueChange(e.target.value,!0),onCalciteSliderChange:e=>this.handleTextRotationSliderValueChange(e.target.value,!1)}),(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:0,max:360,suffixText:o?"":"\xba",prefixText:o?"\xba":"",step:1,value:`${s?.angle||0}`,onCalciteInputNumberInput:this.updateRotation,ref:e=>this.rotationEl=e})))}renderTextHaloBlock(){const{modules:e,sketchLayerEditorState:t}=this,{strings:o}=t,s=this.currentSketchInfo.symbol;return(0,i.h)("calcite-block-section",{ref:e=>this.haloBlockSectionEl=e,text:o.halo,toggleDisplay:"switch",open:!!s?.haloColor,onCalciteBlockSectionToggle:t=>{t.stopPropagation();const o=s?.clone();this.haloBlockSectionEl.open?(o.haloColor=this.tempHaloColor??new e.Color("white"),o.haloSize=o?.haloSize??.75):(this.tempHaloColor=o.haloColor,o.haloColor=void 0),this.updateSymbol(o,!1,!1,"halo")}},(0,i.h)("div",{class:"halo-block"},(0,i.h)("calcite-label",null,o.color,(0,i.h)("arcgis-color-input",{color:s?.haloColor?.toHex()||"#ffffff",popoverProps:this.getPopoverProps(),storageId:"arcgis-symbol-styler-storage-colors",onArcgisChange:t=>{const o=s?.clone(),i=s?.haloColor?.a??1;o.haloColor=new e.Color(t.target.color),o.haloColor.a=i,this.updateSymbol(o,!1,!1,"halo-color")},onArcgisPickerClose:t=>{const o=t.detail;if(o){const t=s?.clone(),i=s?.haloColor?.a??1;t.haloColor=new e.Color(o),t.haloColor.a=i,this.updateSymbol(t,!1,!1,"halo-color")}},onArcgisSwatchUpdate:t=>{const o=t.detail;if(o){const t=s?.clone(),i=s?.haloColor?.a??1;t.haloColor=new e.Color(o),t.haloColor.a=i,this.updateSymbol(t,!1,!1,"halo-color")}}})),(0,i.h)("calcite-label",null,o.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.p)(s?.haloColor?.a??1)),onArcgisValueChange:e=>{const t=e.detail,o=(0,r.t)(t),i=s?.clone();i.haloColor.a=o,this.updateSymbol(i,!1,!1,"halo-color-transparency")},withSteppers:!this.narrow,label:o.transparency})),(0,i.h)("calcite-label",null,o.size,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:1,max:10,value:""+((0,r.i)(s?.haloSize)?s.haloSize/.75:0),onCalciteInputNumberInput:e=>{clearTimeout(this.haloSizeValueHandle),e.stopPropagation();const t=Number.parseInt(this.haloSizeEl.value);!t||t<this.haloSizeEl.min||t>this.haloSizeEl.max?this.haloSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.haloSizeEl,"halo-size")),3e3):this.handleTextPropChange(this.haloSizeEl,"halo-size")},ref:e=>this.haloSizeEl=e}))))}renderTextBackgroundColorBlock(){const{sketchLayerEditorState:e,modules:t}=this,{strings:o}=e,s=this.currentSketchInfo.symbol;return(0,i.h)("calcite-block-section",{ref:e=>this.backgroundColorSectionEl=e,text:o.background,toggleDisplay:"switch",open:!!s?.backgroundColor,onCalciteBlockSectionToggle:e=>{e.stopPropagation();const o=s?.clone();this.backgroundColorSectionEl.open?(o.backgroundColor=this.tempBackgroundColor||new t.Color("white"),o.borderLineColor=this.tempBorderLineColor||new t.Color("white"),o.borderLineSize=this.tempBorderLineSize??.75):(this.tempBackgroundColor=o.backgroundColor,this.tempBorderLineColor=o.borderLineColor,this.tempBorderLineSize=o.borderLineSize,o.backgroundColor=void 0,o.borderLineColor=void 0,o.borderLineSize=void 0),this.updateSymbol(o,!1,!1,"background")}},(0,i.h)("div",{class:"background-color-block"},(0,i.h)("calcite-label",null,o.color,(0,i.h)("arcgis-color-input",{color:s?.backgroundColor?.toHex()||"#ffffff",popoverProps:this.getPopoverProps(),storageId:"arcgis-symbol-styler-storage-colors",onArcgisChange:e=>{const o=s?.clone(),i=s?.backgroundColor?.a??1;o.backgroundColor=new t.Color(e.target.color),o.backgroundColor.a=i,this.updateSymbol(o,!1,!1,"background-color",!1,!0)},onArcgisPickerClose:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.backgroundColor?.a??1;e.backgroundColor=new t.Color(o),e.backgroundColor.a=i,this.updateSymbol(e,!1,!1,"background-color")}},onArcgisSwatchUpdate:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.backgroundColor?.a??1;e.backgroundColor=new t.Color(o),e.backgroundColor.a=i,this.updateSymbol(e,!1,!1,"background-color")}}})),(0,i.h)("calcite-label",null,o.transparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.p)(s?.backgroundColor?.a??1)),onArcgisValueChange:e=>{const t=e.detail,o=(0,r.t)(t),i=s?.clone();i.backgroundColor.a=o,this.updateSymbol(i,!1,!1,"background-color-transparency")},withSteppers:!this.narrow,label:o.transparency})),(0,i.h)("calcite-label",null,o.outlineColor,(0,i.h)("arcgis-color-input",{color:s?.borderLineColor?.toHex()||"#ffffff",popoverProps:this.getPopoverProps(),storageId:"arcgis-symbol-styler-storage-colors",onArcgisChange:e=>{const o=s?.clone(),i=s?.borderLineColor?.a??1;o.borderLineColor=new t.Color(e.target.color),o.borderLineColor.a=i,this.updateSymbol(o,!1,!1,"border-line-color",!1,!0)},onArcgisPickerClose:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.borderLineColor?.a??1;e.borderLineColor=new t.Color(o),e.borderLineColor.a=i,this.updateSymbol(e,!1,!1,"border-line-color")}},onArcgisSwatchUpdate:e=>{const o=e.detail;if(o){const e=s?.clone(),i=s?.borderLineColor?.a??1;e.borderLineColor=new t.Color(o),e.borderLineColor.a=i,this.updateSymbol(e,!1,!1,"border-line-color")}}})),(0,i.h)("calcite-label",null,o.outlineTransparency,(0,i.h)("arcgis-slider-input",{min:0,max:100,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,r.p)(s?.borderLineColor?.a??1)),onArcgisValueChange:e=>{const t=e.detail,o=(0,r.t)(t),i=s?.clone();i.borderLineColor.a=o,this.updateSymbol(i,!1,!1,"border-line-color-transparency")},withSteppers:!this.narrow,label:o.outlineTransparency})),(0,i.h)("calcite-label",null,o.outlineWidth,(0,i.h)("calcite-input-number",{scale:"s",inputMode:"decimal",min:0,max:18,value:""+((0,r.i)(s?.borderLineSize)?s.borderLineSize/.75:1),onCalciteInputNumberInput:e=>{clearTimeout(this.borderLineSizeValueHandle),e.stopPropagation();const t=Number.parseInt(this.borderLineSizeEl.value);Number.isNaN(t)||t<this.borderLineSizeEl.min||t>this.borderLineSizeEl.max?this.borderLineSizeValueHandle=setTimeout((()=>this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")),3e3):this.handleTextPropChange(this.borderLineSizeEl,"border-line-size")},ref:e=>this.borderLineSizeEl=e}))))}async loadAllModules(){const[e,t,o,i,s,r,l,n,c,a]=await Promise.all([(0,p.z)(),(0,p.ab)(),(0,p.am)(),(0,p.a4)(),(0,p.a8)(),(0,p.aA)(),(0,p.aI)(),(0,p.aJ)(),(0,p.aK)(),(0,p.a7)()]);this.modules={intl:e,Color:t,cimSymbolUtils:o,symbolUtils:i,CIMSymbol:s,SimpleLineSymbol:r,SimpleFillSymbol:l,PictureMarkerSymbol:n,PictureFillSymbol:c,TextSymbol:a}}createPortalProp(){return{portal:this.portal,before:async(e,t)=>{await e.load(),t.originalStylesGroupQuery2d=e.stylesGroupQuery2d,e.stylesGroupQuery2d=e.sourceJSON["2DSketchStylesGroupQuery"]},after:async(e,t)=>{e.stylesGroupQuery2d=t.originalStylesGroupQuery2d}}}getFeatureInfoHeading(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,i=this.currentSketchInfo.graphics?.[0].geometry?.type,s=this.currentSketchInfo.graphics?.every((e=>i===e.geometry?.type)),r=this.currentSketchInfo.graphics?.some((e=>"text"===e.symbol?.type))&&!this.currentSketchInfo.graphics?.every((e=>"text"===e.symbol?.type)),l=this.currentSketchInfo.graphics?.every((e=>!!e.geometry.curvePaths?.length)),n=this.currentSketchInfo.tool;if(o){if(!s||r)return t.selectedFeatures;switch(i){case"polyline":return l?t.curveFeatures:t.lineFeatures;case"polygon":return t.polygonFeatures;default:return"point"!==i||this.currentSketchInfo.graphics?.some((e=>"text"===e.symbol?.type))?t.textFeatures:t.pointFeatures}}else switch(n){case"point":return t.pointFeature;case"polyline":return l?t.curveFeature:t.lineFeature;case"bezier-curve":return t.curveFeature;case"text":return t.textFeature;default:return t.polygonFeature}}getStorageId(){return this.currentSketchInfo.tool?["circle","rectangle"].includes(this.currentSketchInfo.tool)?"arcgis-sketch-recent-polygon-symbols":["polyline","bezier-curve"].includes(this.currentSketchInfo.tool)?"arcgis-sketch-recent-polyline-symbols":`arcgis-sketch-recent-${this.currentSketchInfo.tool}-symbols`:"arcgis-sketch-recent-point-symbols"}async afterCreateRecentSymbolDiv(e,t,o){const{sketchLayerEditorState:i,modules:s}=this,{strings:r}=i;let l;if(["simple-line","simple-fill","picture-marker","picture-fill","text","cim"].includes(t.type))"text"===t.type&&(t.text=r.textPreview),l=t;else switch(t.type){case"CIMSymbolReference":l=s.CIMSymbol.fromJSON(t);break;case"esriSLS":l=s.SimpleLineSymbol.fromJSON(t);break;case"esriSFS":l=s.SimpleFillSymbol.fromJSON(t);break;case"esriPMS":l=s.PictureMarkerSymbol.fromJSON(t);break;case"esriPFS":l=s.PictureFillSymbol.fromJSON(t);break;case"esriTS":l=s.TextSymbol.fromJSON(t)}const n=l.clone();"text"===n.type&&(n.haloSize=Math.min(2,n.haloSize)),"simple-line"===n.type&&(n.width=Math.min(2,n.width));const c=this.recentSymbolsContainerEl.clientWidth-49,h={maxSize:"text"===n.type?16:20,scale:!0,size:"simple-line"===n.type?{width:c/9,height:2}:{width:"text"===n.type?16:Math.min(c/6*.75,24),height:"text"===n.type?16:Math.min(c/6*.75,24)}};n&&h.size.width>0&&await s.symbolUtils.renderPreviewHTML(n,h).then((t=>{t&&((0,a.t)(e),e.append(t),this.symbolNodes[o]=l)}))}handleRecentSymbolSelect(e){this.updateSymbol(this.symbolNodes[e],!0,!0,this.textContentEl?"recent-text":void 0),this.divNodes[0].focus()}getPopoverProps(){const e=this.flowEl?.getBoundingClientRect();return{offsetDistance:10,offsetSkidding:-3,overlayPositioning:"fixed",maxHeight:e&&e.height-65+"px",refElement:this.symbolStylerRefElement}}startPointEdit(){const{modules:e}=this,t="cim"===this.currentSketchInfo.symbol.type,o=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1;this.pointStyler?.edit(this.currentSketchInfo.symbol.clone(),{sections:{marker:{open:!0,symbolsOpen:!0,sizeOpen:!1,rotationOpen:!1,markerType:["cim:vector","custom"],keepChoice:!0,parts:{size:{autoSizeAdjust:!1},color:t&&o,transparency:t&&o}},...t&&{fill:{type:"color",optional:!0,suggestedColors:this.suggestedFillColors,savedColors:this.savedColors,open:!1,suggestedColorsOpen:!0},stroke:{optional:!0,open:!1,type:"color",suggestedColors:this.suggestedFillColors,savedColors:this.savedColors}}},marker:{size:t?e.cimSymbolUtils.getCIMSymbolSize(this.currentSketchInfo.symbol):"picture-marker"===this.currentSketchInfo.symbol.type?this.currentSketchInfo.symbol.width:25},fill:{color:t&&e.cimSymbolUtils.getCIMSymbolColor(this.currentSketchInfo.symbol)||this.suggestedFillColors[0]},stroke:t&&this.getCimOutlineProps(this.currentSketchInfo.symbol),fillEnabled:t,strokeEnabled:t,portal:this.createPortalProp()})}startPolylineEdit(){const e="cim"===this.currentSketchInfo.symbol.type,t=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1;this.polylineStyler?.edit(this.currentSketchInfo.symbol.clone(),{sections:{stroke:{type:"color",open:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!0,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:e&&t,transparency:e&&t}}},stroke:{color:this.currentSketchInfo.symbol?.color||this.savedColors[1],size:this.currentSketchInfo.symbol?.width||10,style:this.currentSketchInfo.symbol?.style||"solid",marker:this.currentSketchInfo.symbol?.marker},portal:this.createPortalProp()})}getCimOutlineProps(e){const{modules:t}=this,o=(0,a.v)(e);return{color:new t.Color(o?.color),size:o?.width??1}}startPolygonEdit(){const e="cim"===this.currentSketchInfo.symbol.type,t=this.currentSketchInfo.graphics&&this.currentSketchInfo.graphics.length>1,o=this.currentSketchInfo.graphics&&!this.currentSketchInfo.graphics.every((e=>(0,r.i)((0,a.n)(e.symbol))));this.polygonStyler?.edit(this.currentSketchInfo.symbol.clone(),{sections:{fill:{type:"color",open:!0,optional:!0,suggestedColorsOpen:!0,transparencyOpen:!1,suggestedColors:this.suggestedFillColors},stroke:{type:"color",open:!1,optional:!0,suggestedColorsOpen:!0,suggestedColors:this.suggestedFillColors,extraParts:{width:!o,autoStrokeAdjust:!1}},marker:{parts:{size:{autoSizeAdjust:!1},color:e&&t,transparency:e&&t}}},fill:{color:this.currentSketchInfo.symbol.color||this.suggestedFillColors[0]},stroke:{color:this.currentSketchInfo.symbol.outline?.color||this.suggestedFillColors[0],size:this.currentSketchInfo.symbol.outline?.width||10,style:this.currentSketchInfo.symbol.outline?.style||"solid",autoAdjusted:!1},fillEnabled:!!this.currentSketchInfo.symbol.color,strokeEnabled:!!this.currentSketchInfo.symbol?.outline,portal:this.createPortalProp()})}async openFontPopover(){this.arcgisFontPickerEl||(this.arcgisDisablePanel.emit(!0),this.arcgisFontPickerEl=document.createElement("arcgis-map-config-font-picker"),this.arcgisFontPickerEl.view=this.mapView,this.arcgisFontPickerEl.enableMapSpecificFontList=!0,this.arcgisFontPickerEl.fontMap=await(0,l.g)(this.portal),this.arcgisFontPickerEl.font=this.currentSketchInfo.symbol?.font,this.arcgisFontPickerEl.popoverProps={refElement:this.flowEl,placement:"leading",offsetDistance:-this.flowEl.getBoundingClientRect().width,overlayPositioning:"fixed"},this.arcgisFontPickerEl.addEventListener("arcgisClose",(()=>this.closeFontPopover())),this.arcgisFontPickerEl.addEventListener("arcgisChange",(e=>this.changeFont(e))),document.body.appendChild(this.arcgisFontPickerEl))}closeFontPopover(){this.arcgisFontPickerEl&&(this.arcgisDisablePanel.emit(!1),document.body.removeChild(this.arcgisFontPickerEl),this.arcgisFontPickerEl=void 0)}changeFont(e){const t=e.detail;if(t){const e=this.currentSketchInfo.symbol?.clone();e.font.family=t.family,e.font.weight=t.weight,e.font.style=t.style,this.updateSymbol(e,!1,!1,"font"),(0,i.f)(this.el)}}handleTextRotationSliderValueChange(e,t){const o=this.currentSketchInfo.symbol?.clone();o.angle=e,this.updateSymbol(o,!1,!1,"rotation",t)}handleTextPropChange(e,t){if(!e)return;let o=Number.parseInt(e.value);Number.isNaN(o)||o<e.min?o=e.min:o>e.max&&(o=e.max),e.value=`${o}`;const s=this.currentSketchInfo.symbol?.clone();switch(t){case"font-size":s.font.size=.75*o;break;case"halo-size":s.haloSize=.75*o;break;case"rotation":s.angle=o;break;default:s.borderLineSize=.75*o}this.updateSymbol(s,!1,!1,t,!1,"rotation"!==t),(0,i.f)(this.el)}updateSymbol(e,t,o,i,s,l){const{sketchLayerEditorState:n}=this,{strings:h}=n,d=this.currentSketchInfo.symbol.clone(),p=e.clone(),u=(0,a.k)(this.currentSketchInfo.symbol)!==(0,a.k)(e);if(this.currentSketchInfo.symbol=e.clone(),"recent-text"===i&&(this.currentSketchInfo.symbol.text=d.text),this.arcgisGraphicUpdates.emit({type:"symbol",symbolSwitch:t,symbolSwitchFromRecent:o,textProp:i}),s)this.arcgisSymbolChange.emit();else if((!u||t||o)&&!l){"text"===p.type&&(p.text=h.textPreview);const e=this.recentSymbols?.filter((e=>JSON.stringify(e)!==JSON.stringify(p)))??[],t=(0,r.i)(e)?[p,...e].slice(0,5):[p],o=this.getStorageId();(0,c.s)(o,t,!0),this.recentSymbols=t,this.arcgisSymbolChange.emit()}}addResetTooltip(){const{sketchLayerEditorState:e}=this,{strings:t}=e,o=document.createElement("calcite-tooltip");o.className="sketch-layer-editor-content-tooltip",o.referenceElement=this.resetRecentSymbolsNode,o.placement="left-start",o.open=!0,o.innerHTML=t.clearRecentSymbols,document.body.append(o)}removeResetTooltip(){document.querySelectorAll(".sketch-layer-editor-content-tooltip").forEach((e=>e.parentNode?.removeChild(e)))}handlePopupChange(e){this.currentSketchInfo.popup=e,this.arcgisGraphicUpdates.emit({type:"popup"})}get el(){return(0,i.a)(this)}};m.style=".style-info-wrapper {\n  background-color: var(--calcite-color-foreground-1);\n}\n\n.style-info-block {\n  padding: var(--calcite-spacing-md) var(--calcite-spacing-md) var(--calcite-spacing-xxs);\n}\n\n.style-title {\n  font-weight: var(--calcite-font-weight-medium);\n}\n\n.text-content {\n  margin: 12px;\n}\n\n.rotation {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: relative;\n\n  calcite-slider {\n    width: 50%;\n  }\n\n  calcite-input-number {\n    width: 45%;\n  }\n}\n\n.sketch-popup-button {\n  margin-bottom: 0.4em;\n}\n\n.recent-symbols-wrapper {\n  background-color: var(--calcite-color-foreground-1);\n  border: 1px solid var(--calcite-color-border-1);\n  display: flex;\n  align-items: center;\n  justify-content: space-evenly;\n}\n\n.recent-symbols-symbol-group {\n  display: flex;\n  flex-direction: row;\n  padding: 8px 0px;\n  justify-content: space-evenly;\n  width: calc(100% - 48px);\n}\n\n.recent-symbol {\n  height: 32px;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.recent-symbol:focus {\n  outline: 2px solid var(--calcite-ui-brand);\n  outline-offset: 2px;\n}\n\n.recent-symbols-divider-wrapper {\n  background-color: var(--calcite-color-border-3);\n}\n\n.recent-symbols-divider {\n  margin-block: 0.25rem;\n  display: inline-block;\n  inline-size: 1px;\n}\n\n.recent-symbols-reset-button-wrapper {\n  display: flex;\n  padding: 8px 0px;\n  justify-content: space-evenly;\n  width: 48px;\n}\n\n.no-recent-symbols {\n  min-height: 32px;\n  display: flex;\n  align-items: center;\n  padding: 8px;\n}\n\n.clear-recent-button {\n  padding-top: 8px;\n  margin: auto;\n}\n\n.symbol-styler {\n  /* enforce a horizontal scrollbar for small screens */\n  padding: 0px 1px;\n}\n\n.halo-block,\n.background-color-block {\n  padding-top: 6px;\n}\n";const y=class{constructor(e){(0,i.r)(this,e),this.arcgisClose=(0,i.c)(this,"arcgisClose",7),this.manager=(0,d.u)(this),this.refElement=void 0,this.sketchLayerEditorState=void 0,this.isOpen=!1}async reposition(){this.sketchLayerEditorShortcutsPopover?.reposition()}componentDidLoad(){this.isOpen=!0}render(){const{sketchLayerEditorState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"3292075ea021dddcaba1f812b6776258377e2e8d",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"63e4d339c9f8e274a2419b566c64c35ea19b5504",class:"popover",ref:e=>this.sketchLayerEditorShortcutsPopover=e,placement:"leading-start",open:this.isOpen,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:t.sketchShortcuts},(0,i.h)("calcite-panel",{key:"c04e073d8f2591d8f303ee93559cd0a00efb8afa",heading:t.sketchShortcuts,closable:!0,style:{width:`${Math.max(this.refElement.getBoundingClientRect().width,375)}px`},onCalcitePanelClose:()=>this.arcgisClose.emit()},(0,i.h)("div",{key:"ccd101c8c31a2dffd5fcab4eb088c13ec575a762",class:"sketch-shortcut"},(0,i.h)("calcite-chip",{key:"a9801bab5ca99237121fe705ad30f1707b7a2b58",label:"Ctrl",class:"sketch-shortcut-chip"},"Ctrl"),(0,i.h)("calcite-label",{key:"ab850f355a15d311de76e831dc4a586783d14e4d",class:"sketch-shortcut-label"},t.ctrlShortcut),(0,i.h)("calcite-chip",{key:"dfdb965942d6d10b7287b81ced38d97fa5892b14",label:"Enter",class:"sketch-shortcut-chip"},"Enter"),(0,i.h)("calcite-label",{key:"24b9090e921b96ca2daeb3e019a7414cf3e79527",class:"sketch-shortcut-label"},t.cShortcut),(0,i.h)("calcite-chip",{key:"67e8c03f8cf911abb24bfec5e3c34f0a9b059e78",label:"Z",class:"sketch-shortcut-chip"},"Z"),(0,i.h)("calcite-label",{key:"8311759bada63646b50afe4cb6c61b23b4968625",class:"sketch-shortcut-label"},t.zShortcut),(0,i.h)("calcite-chip",{key:"ddc65ab7140d501c827075c5db8863b45473c6aa",label:"R",class:"sketch-shortcut-chip"},"R"),(0,i.h)("calcite-label",{key:"4d02af8a14b6eb1b2d2eb1d2d6a4a2d34de0b016",class:"sketch-shortcut-label"},t.rShortcut),(0,i.h)("calcite-chip",{key:"4194d4104d22437b510ef2f0df56479d4edea4c3",label:"Esc",class:"sketch-shortcut-chip"},"Esc"),(0,i.h)("calcite-label",{key:"1ea570467b27ba68df68e6274926482d42f069d1",class:"sketch-shortcut-label"},t.escShortcut),(0,i.h)("calcite-chip",{key:"cc477d304957820ff074d44ed2d3816a3de08b97",label:"Tab",class:"sketch-shortcut-chip"},"Tab"),(0,i.h)("calcite-label",{key:"84a57f04668e38777865d1f71cf5688b931f2cb9",class:"sketch-shortcut-label"},t.tabShortcut)))))}get el(){return(0,i.a)(this)}};y.style=".sketch-shortcut {\n  background-color: var(--calcite-color-foreground-1);\n  display: grid;\n  grid-template-columns: 21% auto;\n  row-gap: var(--calcite-spacing-sm);\n  padding: var(--calcite-spacing-sm);\n}\n\n.sketch-shortcut-chip {\n  margin-right: var(--calcite-spacing-sm);\n}\n\n.sketch-shortcut-label {\n  align-self: center;\n}\n\n.popover {\n  --calcite-popover-z-index: 100;\n}\n\n:dir(rtl) {\n  .sketch-shortcut {\n    max-height: 40vh;\n  }\n  .sketch-shortcut-chip {\n    margin-left: var(--calcite-spacing-sm);\n    margin-right: 0;\n  }\n}\n";const b=class{constructor(e){(0,i.r)(this,e),this.arcgisCloseSnappingPopovers=(0,i.c)(this,"arcgisCloseSnappingPopovers",7),this.manager=(0,d.u)(this),this.refElement=void 0,this.sketchLayerEditorState=void 0}async reposition(){this.sketchLayerEditorSnappingPopover?.reposition()}async componentWillLoad(){await this.loadAllModules(),this.addSnappingWidget(),this.addTooltipsWidget()}componentDidLoad(){this.snappingControls.container=this.snappingControlDiv,this.sketchTooltipControls.container=this.sketchTooltipControlDiv}disconnectedCallback(){this.snappingControls?.destroy(),this.sketchTooltipControls?.destroy()}render(){const{sketchLayerEditorState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"e1f391005ef47ddd1817c5846fff5a276cddd6fe",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"d92d839e8692e9a8a28f7e071c965b6301437b9d",class:"popover",placement:"leading-start",ref:e=>this.sketchLayerEditorSnappingPopover=e,open:!0,pointerDisabled:!0,referenceElement:this.refElement,offsetDistance:-Math.round(this.refElement.getBoundingClientRect().width),offsetSkidding:0,label:t.settings},(0,i.h)("calcite-panel",{key:"4d3d5f62afe240af6659d7fb5ee95cd8bcf05288",closable:!0,headingLevel:2,heading:t.settings,style:{width:`${this.refElement.getBoundingClientRect().width}px`},onCalcitePanelClose:()=>{const{sketchLayerEditorState:e}=this,{snappingOptions:t,snappingSessionStorageIds:o,sketchTooltipOptions:i,sketchTooltipSessionStorageIds:s}=e;o?.current&&(0,a.s)(t,o.current),s?.current&&(0,a.b)(i,s.current),this.arcgisCloseSnappingPopovers.emit()}},(0,i.h)("div",{key:"42f332651c2febe81a05cf63e92785fe61e9e9a8",class:"content"},(0,i.h)("div",{key:"49ff0f92e5160beb9d61d5791d449800ba38fc47",ref:e=>this.sketchTooltipControlDiv=e}),(0,i.h)("div",{key:"75de5e440f29c0a556310348ba62eb913a189f5a",ref:e=>this.snappingControlDiv=e})))))}async loadAllModules(){const[e]=await Promise.all([(0,p.aL)()]);this.SnappingControls=e;const[t]=await Promise.all([(0,p.aM)()]);this.SketchTooltipControls=t}addSnappingWidget(){const{sketchLayerEditorState:e}=this,{mapView:t,snappingOptions:o}=e;this.snappingControls=new this.SnappingControls({view:t,snappingOptions:o,visibleElements:{header:!1}})}addTooltipsWidget(){const{sketchLayerEditorState:e}=this,{sketchTooltipOptions:t}=e;this.sketchTooltipControls=new this.SketchTooltipControls.createSketchTooltipControls({tooltipsToggle:!0,labelsToggle:!1},{tooltips:t})}get el(){return(0,i.a)(this)}};b.style=".popover.sc-arcgis-sketch-layer-editor-snapping{--calcite-popover-z-index:100}.content.sc-arcgis-sketch-layer-editor-snapping{max-height:60vh}.content.sc-arcgis-sketch-layer-editor-snapping .esri-grid-controls__tile__content.sc-arcgis-sketch-layer-editor-snapping{padding:var(--calcite-spacing-sm)}";const f=class{constructor(e){(0,i.r)(this,e),this.arcgisActionOnDrawFeatures=(0,i.c)(this,"arcgisActionOnDrawFeatures",7),this.arcgisActionOnSelectFeatures=(0,i.c)(this,"arcgisActionOnSelectFeatures",7),this.manager=(0,d.u)(this),this.refElement=void 0,this.mapNotesFeatures=void 0,this.sketchToolsToHide=[],this.activeSketchTool=void 0,this.hideSelectionTools=!1,this.activeSelectTool=void 0,this.sketchLayerEditorState=void 0,this.isOpen=!1}async reposition(){this.sketchToolsPopoverElement?.reposition()}async activateSingleSelection(){this.hideSelectionTools&&(this.hideSelectionTools=!1,(0,i.f)(this.el));const{sketchLayerEditorState:e}=this,{strings:t}=e;this.actionOnSelectFeatures(t.selectText,this.sketchSelectElement)}componentWillLoad(){const{sketchLayerEditorState:e}=this;this.sketchLayerEditorSVModel=e.sketchLayerEditorSVModel,this.isOpen=!0}componentDidLoad(){const{sketchLayerEditorState:e}=this,{strings:t}=e;if(this.mapNotesFeatures?.length){let e=[],o=[],i=[],s=[];if(this.mapNotesFeatures.forEach((t=>{switch((0,a.g)(t)){case"polyline":o=[...o,t];break;case"polygon":i=[...i,t];break;case"text":s=[...s,t];break;default:e=[...e,t]}})),this.activeSelectTool){"select"===this.activeSelectTool?this.actionOnSelectFeatures(t.selectText,this.sketchSelectElement):this.actionOnSelectFeatures(t.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")}e.length&&this.sketchLayerEditorSVModel.updatePoint(e),o.length&&this.sketchLayerEditorSVModel.updateLine(o),i.length&&this.sketchLayerEditorSVModel.updatePolygon(i),s.length&&this.sketchLayerEditorSVModel.updateText(s)}else{const e={point:this.sketchPointElement,polygon:this.sketchPolygonElement,polyline:this.sketchPolyLineElement,circle:this.sketchCircleElement,rectangle:this.sketchRectangleElement,text:this.sketchTextElement};let t,o;if(this.activeSketchTool)t=this.activeSketchTool,o=e[t];else{let i=["point","polyline","polygon","rectangle","circle","text"];i=i.filter((e=>!this.sketchToolsToHide.includes(e))),t=i.length?i[0]:"point",o=e[t]}const i=this.getActiveSketchMessage(t);this.actionOnDrawFeatures(t,i,o)}}render(){const{sketchLayerEditorState:e}=this,{strings:t}=e;return(0,i.h)(i.H,{key:"268d5d8af9ec663c7a2b02280ee4a82807394200",class:"js-app-flyout"},(0,i.h)("calcite-popover",{key:"a31da8d39e007f959fff3070411b07cbfad609c3",ref:e=>this.sketchToolsPopoverElement=e,placement:"leading-start",open:this.isOpen,referenceElement:this.refElement,offsetDistance:15,pointerDisabled:!0,focusTrapDisabled:!0,triggerDisabled:!0,label:t.sketch,class:"popover",onCalcitePopoverBeforeClose:()=>this.sketchToolsPopoverElement.open=!0},(0,i.h)("calcite-action-pad",{key:"de94ee530e0c62fab4f184a9a67a466f0fe931a4",position:"start",layout:"vertical",expandDisabled:!0},this.renderDrawFeatures(),this.renderSelectFeatures())))}renderDrawFeatures(){const{sketchLayerEditorState:e,sketchToolsToHide:t}=this,{strings:o}=e;return(0,i.h)("calcite-action-group",{label:o.drawFeatures},!t.includes("point")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPointElement=e,text:o.stamp,label:o.stamp,title:o.stamp,icon:"pin",alignment:"center",onClick:()=>this.actionOnDrawFeatures("point",o.addStamp,this.sketchPointElement)}),!t.includes("polyline")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPolyLineElement=e,text:o.line,label:o.line,title:o.line,icon:"line",alignment:"center",onClick:()=>this.actionOnDrawFeatures("polyline",o.startFinishDrawing,this.sketchPolyLineElement)}),!t.includes("bezier-curve")&&(0,i.h)("calcite-action",{ref:e=>this.sketchBezierCurveElement=e,text:o.curvedLine,label:o.curvedLine,title:o.curvedLine,icon:"curve",alignment:"center",onClick:()=>this.actionOnDrawFeatures("bezier-curve",o.startFinishDrawingBezier,this.sketchBezierCurveElement)}),!t.includes("polygon")&&(0,i.h)("calcite-action",{ref:e=>this.sketchPolygonElement=e,text:o.polygon,label:o.polygon,title:o.polygon,icon:"polygon",alignment:"center",onClick:()=>this.actionOnDrawFeatures("polygon",o.startFinishDrawing,this.sketchPolygonElement)}),!t.includes("rectangle")&&(0,i.h)("calcite-action",{ref:e=>this.sketchRectangleElement=e,text:o.rectangle,label:o.rectangle,title:o.rectangle,icon:"rectangle",alignment:"center",onClick:()=>this.actionOnDrawFeatures("rectangle",o.addRectangle,this.sketchRectangleElement)}),!t.includes("circle")&&(0,i.h)("calcite-action",{ref:e=>this.sketchCircleElement=e,text:o.circle,label:o.circle,title:o.circle,icon:"circle",alignment:"center",onClick:()=>this.actionOnDrawFeatures("circle",o.addCircle,this.sketchCircleElement)}),!t.includes("text")&&(0,i.h)("calcite-action",{ref:e=>this.sketchTextElement=e,text:o.text,label:o.text,title:o.text,icon:"text",alignment:"center",onClick:()=>this.actionOnDrawFeatures("text",o.addText,this.sketchTextElement)}))}renderSelectFeatures(){const{sketchLayerEditorState:e,hideSelectionTools:t}=this,{strings:o}=e;return(0,i.h)("calcite-action-group",{label:o.selectFeatures,class:t?"hidden":""},(0,i.h)("calcite-action",{ref:e=>this.sketchSelectElement=e,text:o.select,label:o.select,title:o.select,icon:"cursor",alignment:"center",onClick:()=>this.actionOnSelectFeatures(o.selectText,this.sketchSelectElement)}),(0,i.h)("calcite-action",{ref:e=>this.sketchRectangleSelectElement=e,text:o.rectangleSelect,label:o.rectangleSelect,title:o.rectangleSelect,icon:"cursor-marquee",alignment:"center",onClick:()=>this.actionOnSelectFeatures(o.rectangleLassoSelect,this.sketchRectangleSelectElement,"rectangle")}),(0,i.h)("calcite-action",{ref:e=>this.sketchLassoSelectElement=e,text:o.lassoSelect,label:o.lassoSelect,title:o.lassoSelect,icon:"lasso",alignment:"center",onClick:()=>this.actionOnSelectFeatures(o.rectangleLassoSelect,this.sketchLassoSelectElement,"lasso")}))}getActiveSketchMessage(e){const{sketchLayerEditorState:t}=this,{strings:o}=t;switch(e){case"point":return o.addStamp;case"polyline":case"polygon":return o.startFinishDrawing;case"rectangle":return o.addRectangle;case"circle":return o.addCircle;case"text":return o.addText;default:return""}}actionOnDrawFeatures(e,t,o){this.clearActiveSelection(),this.activeSketchTool=e,this.activeSelectTool=void 0,o.active=!0,this.arcgisActionOnDrawFeatures.emit({tool:e,sketchMessage:t})}actionOnSelectFeatures(e,t,o){const{active:i=!1}=t;this.clearActiveSelection(),t.active=!i,this.activeSketchTool=void 0,this.activeSelectTool=t.active?o??"select":void 0,this.sketchLayerEditorSVModel.cancel(),this.arcgisActionOnSelectFeatures.emit({sketchMessage:i?"":e,multipleSelectTool:!i&&o||void 0})}clearActiveSelection(){[this.sketchPointElement,this.sketchPolyLineElement,this.sketchBezierCurveElement,this.sketchPolygonElement,this.sketchRectangleElement,this.sketchCircleElement,this.sketchTextElement,this.sketchSelectElement,this.sketchRectangleSelectElement,this.sketchLassoSelectElement].forEach((e=>{e&&(e.active=!1)}))}get el(){return(0,i.a)(this)}};f.style=".popover{--calcite-popover-z-index:100}.hidden{display:none}"},53127:(e,t,o)=>{o.d(t,{a:()=>s,d:()=>i,t:()=>r});const i=(e,t)=>{let o,i="idle";const s=async(...s)=>await new Promise((r=>{switch(i){case"flushed":i="idle",o?(clearTimeout(o),r(e(...s))):r(null);break;case"invoked":clearTimeout(o),i="idle",r(e(...s));break;case"cancelled":clearTimeout(o),i="idle",r(null);break;default:o&&clearTimeout(o),i="pending",o=setTimeout((()=>{i="idle",r(e(...s))}),t)}}));return s.flush=async function(...e){return i="flushed",await s(...e)},s.invoke=async function(...e){return i="invoked",await s(...e)},s.cancel=async function(...e){return i="cancelled",await s(...e)},s.getStatus=function(){return i},s},s=(e,t)=>{let o;return async(...i)=>await new Promise((s=>{o||(o=setTimeout((()=>{clearTimeout(o),o=void 0,s(e(...i))}),t))}))};function r(e){return new Promise((t=>setTimeout(t,e)))}}}]);