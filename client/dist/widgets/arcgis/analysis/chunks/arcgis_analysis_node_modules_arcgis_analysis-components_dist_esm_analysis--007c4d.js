"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_analysis--007c4d"],{3848:(e,t,s)=>{s.r(t),s.d(t,{analysis_item_browser:()=>i.A});var i=s(68830);s(28445),s(34074),s(44345),s(55448),s(18423),s(91813),s(21255),s(588),s(54312),s(34031),s(9316),s(13661),s(43786),s(61320),s(64016),s(56451),s(6550),s(2924),s(5258),s(52373),s(33752),s(53976),s(49403),s(77462),s(23054),s(73645),s(12762),s(82567),s(28927),s(35970),s(5933),s(57295),s(72349),s(89962),s(97703),s(71802),s(32513),s(43284)},68830:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(28445),r=s(34074);const a="analysis-item-browser-modal-variables",l="analysis-item-browser-alert",o=class{constructor(e){(0,i.r)(this,e),this.analysisItemBrowserSelection=(0,i.c)(this,"analysisItemBrowserSelection",7),this.analysisItemBrowserAddToMap=(0,i.c)(this,"analysisItemBrowserAddToMap",7),this.analysisItemBrowserClose=(0,i.c)(this,"analysisItemBrowserClose",7),this.start=1,this.items=[],this.selectedItems=[],this.browsedLayerCreating=!1,this.invalidBrowsedLayers=[],this.layerLoadingFailed=!1,this.tasksLoading=!1,this.displayMode="modal",this.filter="",this.hidePreview=!1,this.hideFilters=!0,this.hideAddToMap=!1,this.q="",this.getAllowedItemTypes=()=>{let e=["layers","layers-weblayers-features","layers-weblayers-imagery","layers-weblayers-mapimage","layers-weblayers-tiledimagelayers","layers-weblayers-tables"];return this.viewIsSceneView&&(e=e.filter((e=>"layers-weblayers-tables"!==e))),e},this.getLayerFromSelection=async e=>"item"in e&&e.item.typeKeywords.includes("SubtypeGroupLayer")?this.getSubtypeLayerFromSelection(e):(0,r.n)({url:this.formatSublayerUrl(e)},e.title),this.formatSublayerUrl=e=>`${`${"item"in e?e.item.url:e.url}`}/${`${"sublayer"in e?e.sublayer?.id??0:""}`}`,this.getSubtypeLayerFromSelection=async e=>{let t;if(String(e.sublayer.id).includes("-")){const[s,,i]=String(e.sublayer.id).split("-");t=await(0,r.g)(s,Number(i))}else{const s=e.item.id,i=e.sublayer.sourceJSON.subtypeCode;t=void 0!==i?await(0,r.g)(s,Number(i)):await(0,r.g)(s)}return t},this.formatErrorMessage=()=>{let e="";return e=!0===this.layerLoadingFailed&&void 0!==this.errorStrings.layerLoadFailure?this.errorStrings.layerLoadFailure:(0,r.t)(this.strings.unsupportedLayer,{layerName:this.invalidBrowsedLayers.join(", ")}),e},this.getItemDetailsUrl=e=>{let t="";if(!(0,r.d)(e)){const{id:s}=e;t=`${(0,r.U)(this.portal)}/home/item.html?id=${s}`}return t},this.close=()=>{void 0!==this.containerRef&&(this.containerRef.open=!1)},this.onSelectButtonClick=async(e,t)=>{const s=!0===t?this.analysisItemBrowserAddToMap:this.analysisItemBrowserSelection;switch(this.selectionMode){case"single":s.emit(this.selectedItems[0]),this.close();break;case"multiple":default:s.emit(this.selectedItems),this.close();break;case"single-sublayer":case"multiple-sublayer":if("task"in this.selectedItems[0])return s.emit(this.selectedItems),void this.close();const t=e.target;t.loading=!0,this.browsedLayerCreating=!0;let i=[];try{const e=this.selectedItems.map(this.getLayerFromSelection);i=(await Promise.all(e)).filter((e=>void 0!==e)),this.invalidBrowsedLayers=await this.filterUnsupportedLayers(i),this.layerLoadingFailed=!1}catch{this.layerLoadingFailed=!0}this.browsedLayerCreating=!1,t.loading=!1,0===this.invalidBrowsedLayers.length&&!1===this.layerLoadingFailed&&(s.emit(i),this.close())}},this.onClose=()=>{this.analysisItemBrowserClose.emit()},this.onItemBrowserUpdate=e=>{this.items=e.detail.results,this.totalItems=e.detail.total,this.start=e.detail.start},this.onItemBrowserSelect=e=>{this.selectedItems=e.detail},this.onItemBrowserLoading=()=>{this.items=[],this.totalItems=void 0},this.onItemBrowserPreview=e=>{const t=e.detail;this.currentPreviewItem=t,!0===this.tasksLoading&&(this.tasksLoading=!1)}}async componentWillLoad(){let e="";({strings:this.strings,locale:e}=await(0,r.G)(this.hostElement,(0,i.g)("."))),this.errorStrings=await(0,r.H)(e)}render(){return this.renderModal()}renderModal(){return(0,i.h)("calcite-dialog",{modal:!0,open:!0,escapeDisabled:!0,outsideCloseDisabled:!0,heading:this.header??this.strings.header,class:a,onCalciteDialogClose:this.onClose,ref:e=>this.containerRef=e},this.renderItemBrowser(),(0!==this.invalidBrowsedLayers.length||!0===this.layerLoadingFailed)&&(0,i.h)("calcite-alert",{open:!0,class:l,slot:"alerts",kind:"danger",label:this.formatErrorMessage(),onCalciteAlertClose:()=>{this.invalidBrowsedLayers=[],this.layerLoadingFailed=!1}},(0,i.h)("div",{slot:"title"},this.formatErrorMessage())),(0,i.h)("calcite-button",{slot:"footer-start",appearance:"solid",kind:"neutral",onClick:this.close},this.strings.cancel),(0,i.h)("calcite-button",{slot:"footer-end",appearance:this.hideAddToMap?"solid":"outline",disabled:!0===this.browsedLayerCreating||0===this.selectedItems?.length,onClick:e=>this.onSelectButtonClick(e,!1)},this.strings.confirm),!1===this.hideAddToMap&&(0,i.h)("calcite-button",{slot:"footer-end",appearance:"solid",disabled:!0===this.browsedLayerCreating||0===this.selectedItems?.length,onClick:e=>this.onSelectButtonClick(e,!0)},this.strings.addToMap))}renderItemBrowser(){const e="single-sublayer"===this.selectionMode||"multiple-sublayer"===this.selectionMode||"none"===this.selectionMode?"top":"action";return(0,i.h)("arcgis-item-browser",{api:4,allowedGeometries:this.allowedGeometries,q:this.q,filter:this.filter,num:20,config:{baseUrl:`${(0,r.U)(this.portal)}/home/`},portal:this.portal,user:this.user,selection:this.selectionMode??"single",onArcgisItemBrowserLoading:this.onItemBrowserLoading,onArcgisItemBrowserUpdate:this.onItemBrowserUpdate,onArcgisItemBrowserSelect:this.onItemBrowserSelect,onArcgisItemBrowserPreview:this.onItemBrowserPreview},(0,i.h)("arcgis-item-browser-top-bar",{slot:"top-bar","filter-toggle":!0},(0,i.h)("arcgis-item-browser-bucket-select",{slot:"bucket",options:this.bucketOptions}),(0,i.h)("arcgis-item-browser-search",{slot:"search",term:""})),(0,i.h)("arcgis-item-browser-sort",{slot:"sort",field:"modified"}),!1===this.hideFilters&&(0,i.h)("arcgis-item-browser-filters",{slot:"filters"},(0,i.h)("arcgis-item-browser-filter-folder",null),(0,i.h)("arcgis-item-browser-filter-categories",null),(0,i.h)("arcgis-item-browser-filter-date",{property:"modified"}),(0,i.h)("arcgis-item-browser-filter-date",{property:"created"}),(0,i.h)("arcgis-item-browser-filter-item-type",{allowedItemTypes:this.getAllowedItemTypes()}),(0,i.h)("arcgis-item-browser-filter-tags",null),(0,i.h)("arcgis-item-browser-filter-sharing",null),(0,i.h)("arcgis-item-browser-filter-content-status",null),(0,i.h)("arcgis-item-browser-filter-collaborations",null)),(0,i.h)("arcgis-item-browser-content",{slot:"content"},this.items.map((t=>(0,i.h)("arcgis-item-browser-card",{key:t.id,item:t,portal:this.portal,user:this.user,name:"item-browser",preview:this.hidePreview?void 0:e,showThumbnail:!1,messageOverrides:this.cardMessageOverrides})))),(0,i.h)("div",{slot:"preview-footer"},(0,i.h)("calcite-button",{href:this.getItemDetailsUrl(this.currentPreviewItem),target:"_blank",appearance:"outline-fill",kind:"neutral",width:"full"},this.strings.viewDetails)),(0,i.h)("arcgis-item-browser-pagination",{slot:"pagination",start:this.start,num:20,total:this.totalItems}))}async filterUnsupportedLayers(e){const{filteredLayers:t}=await(0,r.E)({layers:e,layerFilterTypes:this.layerFilterType,user:this.user}),s=this.user?.orgId??void 0;return[...t,...e.filter((e=>!(0,r.O)(e,s)))].map((e=>e.title))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,i.a)(this)}};o.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.analysis-item-browser-modal-variables{--calcite-dialog-size-y:min(900px, calc(80vh + 100px));--calcite-dialog-size-x:1080px;--calcite-dialog-content-space:0px}.analysis-item-browser-alert{position:static}"}}]);