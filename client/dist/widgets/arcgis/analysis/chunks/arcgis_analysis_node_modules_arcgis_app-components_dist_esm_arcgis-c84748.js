/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c84748.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-c84748"],{931:(e,t,i)=>{i.d(t,{l:()=>r});var n=i(93814);const r=async(e,t)=>(await n.e.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},4429:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>d,c:()=>o,d:()=>c,e:()=>r,f:()=>n,g:()=>h,i:()=>g,m:()=>a,t:()=>s,u:()=>u});const n=(e,t)=>{let i,n="idle";const r=(...r)=>new Promise((o=>{switch(n){case"flushed":n="idle",i?(clearTimeout(i),o(e(...r))):o(null);break;case"invoked":clearTimeout(i),n="idle",o(e(...r));break;case"cancelled":clearTimeout(i),n="idle",o(null);break;default:i&&clearTimeout(i),n="pending",i=setTimeout((()=>(n="idle",o(e(...r)))),t)}}));return r.flush=function(...e){return n="flushed",r(...e)},r.invoke=function(...e){return n="invoked",r(...e)},r.cancel=function(...e){return n="cancelled",r(...e)},r.getStatus=function(){return n},r};function r(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function o(e){return null!=e}async function a(e,t){return await Promise.all([e,s(t)]),e}function s(e){return new Promise((t=>setTimeout(t,e)))}const l=(e,t)=>Object.fromEntries((e||[]).map((e=>{const{key:i,data:n}=t(e);return[i,n]}))),c=(e,t)=>e.length===t.length&&e.reduce(((e,i)=>e&&t.indexOf(i)>-1),!0);function u(e,t){const i=[],n={};return e.forEach((e=>{const r=t(e);null==n[r]&&(n[r]=e,i.push(e))})),i}function d(e){const t={boolean:{},number:{},string:{}},i=[];return e.filter((e=>{let n=typeof e;return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)}))}const h=(e,t)=>[...Array(Math.ceil(e.length/t))].map(((i,n)=>e.slice(t*n,t+t*n))),g=(e,t)=>e.includes(t)},16405:(e,t,i)=>{i.d(t,{g:()=>r});var n=i(64099);async function r(e){const t=await(0,n.g)(e,"arcgis-member-browser");return t&&t.length?t[0]:null}},23966:(e,t,i)=>{i.d(t,{a:()=>a,g:()=>o,o:()=>s});var n=i(37762),r=i(74174);function o(e){return(0,r.g)(e,"arcgis-member-browser")}const a=(e,t)=>{e.onChange("view",(e=>{t(e)}))};(0,n.c)({type:"member-browser",includeExternalUsers:!1});const s=(e,t)=>{e.onChange("sort",(e=>{t(e)}))}},50637:(e,t,i)=>{i.d(t,{a:()=>p,b:()=>b,c:()=>h,d:()=>m,f:()=>u,g:()=>g,i:()=>d,p:()=>y,r:()=>f});var n=i(59317),r=i(4429),o=i(931),a=i(87744);const s={},l={},c={};async function u(e,t,i,n){var r,o,a,u;const d=null===(o=null===(r=c[t])||void 0===r?void 0:r[i])||void 0===o?void 0:o.expireAt,h=!!d&&(new Date).getTime()>d;if((null===(a=s[t])||void 0===a?void 0:a[i])&&!h)return s[t][i];l[t]||(l[t]={}),l[t][i]&&!h||(l[t][i]=e());const g=await l[t][i];if(s[t]||(s[t]={}),c[t]||(c[t]={}),s[t][i]=g,n){const{expireAfter:e,getExpireAfterFromResult:r}=n,o=r||e?(new Date).getTime()+(null!==(u=null==r?void 0:r(g))&&void 0!==u?u:e):null;c[t][i]=Object.assign(Object.assign({},c[t][i]),{expireAt:o})}return g}function d(e,t){var i;return null===(i=null==s?void 0:s[e])||void 0===i?void 0:i[t]}const h=(e,t)=>{var i,n;t?(null===(i=s[e])||void 0===i||delete i[t],null===(n=l[e])||void 0===n||delete n[t]):(delete s[e],delete l[e])};function g(e){var t,i,r,o;return null!=e||(e=null===n.c||void 0===n.c?void 0:n.c.portal),(null===(t=null==e?void 0:e.credential)||void 0===t?void 0:t.token)||(null==e?void 0:e.token)||(null===(r=null===(i=null==e?void 0:e.user)||void 0===i?void 0:i.credential)||void 0===r?void 0:r.token)||(null===(o=null==e?void 0:e.portalUser)||void 0===o?void 0:o.token)||""}function m(e){var t,i;return null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null===(i=null==e?void 0:e.sourceJSON)||void 0===i?void 0:i.id}function v(e){var t;const{config:i}=n.c;return"https:"===window.location.protocol||!0===(null===(t=null==i?void 0:i.self)||void 0===t?void 0:t.allSSL)?e.replace("http:","https:"):e}async function p(e,t,i={},r){const[a]=await(0,o.l)(["esri/request"]),{api:s}=n.c;e.includes("f=")||t.append("f","json");const l=g();return l&&!t.has("token")&&t.append("token",l),new Promise(((n,o)=>{if(3===s){const s={url:!1===i.addSSL?e:v(e),form:t,timeout:i.timeout||0},l="post"===r?Object.assign({usePost:!0},i):i;a(s,l).then(n,o)}else a(e,Object.assign(Object.assign({body:t},i),{timeout:i.timeout||0,method:r||"auto"})).then((e=>{n(e.data)})).catch((e=>o(e)))}))}async function f(e,t={},i={},r,a){const[s]=await(0,o.l)(["esri/request"]),{api:l,portal:c}=n.c,{customToken:u,addTokenManually:d,addSSL:h,useProxy:g}=i,m=Object.assign({},t);if(e.includes("f=")||!0===(null==a?void 0:a.excludeJson)||(m.f="json"),u)m.token=u;else if(!1!==d){const e=await b(c,l);e&&(m.token=e)}const p=!1===h?e:v(e);if(3===l){const e=Object.assign({url:p,content:m,timeout:i.timeout||0},null==a?void 0:a.v3Request);i.withCredentials&&(e.withCredentials=i.withCredentials);return s(e,"post"===r?Object.assign({usePost:!0},i):i)}{const e=Object.assign(Object.assign(Object.assign({query:m,method:r||"auto"},i),{timeout:i.timeout||0,useProxy:g}),(null==i?void 0:i.disableIdentityLookup)?{authMode:"anonymous"}:{});return(await s(p,e)).data}}const w=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,15,15,30,30,30,30,30,30,30,30,30,30,120];const y=async(e,t,i)=>{var n,o;const a=null!==(n=null==t?void 0:t.pendingStatuses)&&void 0!==n?n:["processing","partial","Pending","InProgress","EXECUTING"],s=null!==(o=null==t?void 0:t.successStatuses)&&void 0!==o?o:["completed","Completed","COMPLETED"];let l=0;const c=async()=>{const n=await f(e,null==t?void 0:t.requestParams,{},i),o=n.status||n.jobStatus;if(a.includes(o))return await(0,r.t)((u=l++,1e3*w[u>-1&&u<w.length-1?u:w.length-1])),c();if(s.includes(o)||"failed"===o)return n;throw n;var u};try{return c()}catch(e){throw console.error(e),e}},b=async(e,t)=>{var i;if(!(null==e?void 0:e.isPortal)||!(0,a.i)(e))return g(e);if(!(null==e?void 0:e.user)&&!(null==e?void 0:e.portalUser)&&(0,a.i)(e))return;const{token:r}=await u((()=>C(e,null!=t?t:null===n.c||void 0===n.c?void 0:n.c.api)),"platformSelf",null!==(i=m(e.user))&&void 0!==i?i:e.id,{getExpireAfterFromResult:e=>e.expires_in});return r},C=async(e,t)=>{const i=await(async(e,t)=>{var i,n,r;const s=3===t,[l]=s?await(0,o.l)(["esri/IdentityManager"]):await(0,o.l)(["esri/identity/IdentityManager"]),c=await u((()=>l.getCredential((0,a.g)(e),{oAuthPopupConfirmation:!1})),"credential",m(e.user));return null!==(r=s?null===(i=c._oAuthCred)||void 0===i?void 0:i.appId:null===(n=c.oAuthState)||void 0===n?void 0:n.appId)&&void 0!==r?r:"arcgisonline"})(e,t),n={"X-Esri-Auth-Client-Id":i,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")};return f(`${(0,a.g)(e)}/oauth2/platformSelf`,{},{disableIdentityLookup:!0,headers:4===t?n:void 0,addTokenManually:!1,withCredentials:!0},"post",{v3Request:{headers:n}})}},50822:(e,t,i)=>{i.d(t,{a:()=>a,b:()=>o,c:()=>c,d:()=>u,e:()=>d,f:()=>h,g:()=>g,i:()=>s,u:()=>l});i(93814);var n=i(87744);function r(e){var t;return!!(null===(t=e.owner)||void 0===t?void 0:t.toLowerCase().includes("esri"))}function o(e){var t;return r(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Credits"))}function a(e){var t;return r(e)&&!!(null===(t=e.typeKeywords)||void 0===t?void 0:t.includes("Requires Subscription"))}function s(e,t){return e.owner===t.username}function l(e,t){return s(e,t)||function(e,t){var i;if(null!=e.isAdmin)return!!e.isAdmin;const n=e.owner,r="admin"===e.itemControl,o=["esri_livingatlas","esri_demographics","esri_boundaries"];if((null===(i=e.portal)||void 0===i?void 0:i.isPortal)&&!s(e,t)&&r&&n.includes("esri_")&&!o.includes(n))return!1;return r}(e,t)}const c=(e,t)=>!!t.orgId&&e.every((e=>e.isOrgItem)),u=(e,t)=>`${(0,n.a)(t)}item.html?id=${e}`,d=(e,t)=>`${(0,n.g)(t)}/content/users/${e}`,h=e=>e.reduce(((e,t)=>(e[t.owner]=e[t.owner]?[...e[t.owner],t.id]:[t.id],e)),{}),g=(e,t)=>`${(0,n.a)(t)}content/items/${e}`},64099:(e,t,i)=>{i.d(t,{a:()=>a,g:()=>c});var n=i(15332),r=i(81034),o=i(87849);function a(e){var t,i,o;const a=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===o?void 0:o.documentElement,s=((null==a?void 0:a.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return r.l.has(s)?r.l.get(s):r.l.has(s.slice(0,2))?r.l.get(s.slice(0,2)):"en"}const s={};function l(e,t){const i=`${e}${t}`;return s[i]||(s[i]=function(e,t){return new Promise(((i,n)=>{fetch((0,o.d)(`../arcgis-app-assets/i18n/${e}.i18n.${t}.json`)).then((e=>{e.ok?i(e.json()):n()}),(()=>n()))}))}(e,t)),s[i]}async function c(e,t){const i=t||e.tagName.toLowerCase(),o=a(e),s=function(e){var t,i,o;const a=null!==(t=(0,n.c)(e,"[lang]"))&&void 0!==t?t:null===(o=null===(i=e.shadowRoot)||void 0===i?void 0:i.ownerDocument)||void 0===o?void 0:o.documentElement,s=((null==a?void 0:a.lang)||(null===navigator||void 0===navigator?void 0:navigator.language)||"en").toLowerCase();return r.l.has(s)?r.l.get(s):r.l.has(s.slice(0,2))?s:"en"}(e);let c;try{c=await l(i,o)}catch(e){console.warn(`no locale for ${i} (${o}) loading default locale en.`),c=await l(i,"en")}return[c,o,s]}},74174:(e,t,i)=>{i.d(t,{a:()=>o,b:()=>s,g:()=>c,i:()=>r,o:()=>a});var n=i(15332);const r=e=>"item-browser"===e.state.type,o=(e,t,i)=>{t.onChange("filters",(t=>{t[e]&&t[e].value||i()}))},a=(e,t)=>{e.onChange("preview",(e=>{t()}))},s=(e,t)=>{e.onChange("groupId",(e=>{t()}))},l=new Map;function c(e,t){const i=l.get(e);if(i)return i;const r=(0,n.c)(e,t);return r?(l.set(e,r.store),r.store):null}},81034:(e,t,i)=>{i.d(t,{C:()=>s,a:()=>l,b:()=>u,f:()=>d,g:()=>a,l:()=>o,s:()=>g});var n=i(931),r=i(15332);const o=new Map([["ar","ar"],["bg","bg"],["bs","bs"],["ca","ca"],["cs","cs"],["da","da"],["de","de"],["el","el"],["en","en"],["es","es"],["et","et"],["fi","fi"],["fr","fr"],["he","he"],["hr","hr"],["hu","hu"],["id","id"],["it","it"],["ja","ja"],["ko","ko"],["lt","lt"],["lv","lv"],["nb","no"],["no","no"],["nl","nl"],["pl","pl"],["pt-br","pt-BR"],["pt-pt","pt-PT"],["ro","ro"],["ru","ru"],["sk","sk"],["sl","sl"],["sr","sr"],["sv","sv"],["th","th"],["tr","tr"],["uk","uk"],["vi","vi"],["zh-cn","zh-CN"],["zh-hk","zh-HK"],["zh-tw","zh-TW"]]);function a(e){return function(e,t,i){const n=(0,r.c)(e,`[${t}]`);return n?n.getAttribute(t):i}(e,"dir","ltr")}const s={rtl:"arcgis--rtl"};async function l(e,t){const{api:i,type:r,places:o}=t||{};if(4===i){const[t]=await(0,n.l)(["esri/intl"]),i=t.convertNumberFormatToIntlOptions({places:o,style:r,digitSeparator:!0});return t.formatNumber(e,Object.assign(Object.assign({},i),{style:r}))}const[a]=await(0,n.l)(["dojo/number"]);return a.format(e,{type:r,places:o,pattern:null==t?void 0:t.pattern})}const c={};function u(e,t){let i=document.documentElement.lang;const n="bs"===i;if(n&&(i="hr"),t){const t=`${i}-full`,n={dateStyle:"full",timeStyle:"long"};return c[t]||(c[t]=new Intl.DateTimeFormat(i,n)),c[t].format(e)}const r={year:"numeric",month:n?"numeric":"short",day:"numeric"};return c[i]||(c[i]=new Intl.DateTimeFormat(i,r)),c[i].format(e)}function d(e,t,i,n){const r=null!=e?e:"en";let o=t.unknown;return(1===i||["id","ja","ko","th","vi","zh-cn","zh-hk","zh-tw"].includes(r))&&(o=t.single),1!==i&&["en","ca","da","de","el","es","et","fi","hi","hu","it","nb","nl","pt-pt","sv","tr"].includes(r)&&(o=t.multiple),g(o,Object.assign(Object.assign({},n),{number:i}))}const h=/\$\{([^}]+)\}/g;function g(e,t,i=h){let n=e;try{n=e.replace(i,((e,i)=>function(e,t){const i=e.split(".").reduce(((e,t)=>e[t]),t);return"string"==typeof i||"number"==typeof i?i:e}(i,t).toString()))}catch(e){console.error(e)}return n}},84411:(e,t,i)=>{i.r(t),i.d(t,{arcgis_member_browser_filter_categories:()=>d});var n=i(87849),r=i(38295),o=i(37362),a=i(59317),s=i(56175),l=i(74174),c=i(16405),u=i(23966);i(50637),i(931),i(93814),i(87744),i(51102),i(37762),i(50822),i(15332),i(64099),i(81034);const d=class{constructor(e){(0,n.r)(this,e),this.arcgisMemberBrowserFilter=(0,n.c)(this,"arcgisMemberBrowserFilter",7),this.arcgisMemberBrowserCategorySchemaUpdate=(0,n.c)(this,"arcgisMemberBrowserCategorySchemaUpdate",7),this.arcgisMemberBrowserCategoryEditSuccess=(0,n.c)(this,"arcgisMemberBrowserCategoryEditSuccess",7),this.arcgisMemberBrowserCategoryEditRowWarningClick=(0,n.c)(this,"arcgisMemberBrowserCategoryEditRowWarningClick",7),this.refetchCategories=async()=>{(null===a.c||void 0===a.c?void 0:a.c.portal)&&await this.fetchMemberCategories(a.c.portal,!1)},this.setSchema=e=>{this.schema=e,this.arcgisMemberBrowserCategorySchemaUpdate.emit(e)},this.renderSchemaEditor=()=>{const{allowEdit:e,isEditing:t,handleEditSchemaComplete:i,setSchema:r,defaultCategories:o}=this,{user:s,portal:l}=a.c;return e?(0,n.h)("arcgis-tunnel",{reference:this.el},(0,n.h)("arcgis-member-category-schema-editor",{isActive:t,user:s,config:a.c.config,portal:l,defaultMemberCategories:o,onArcgisMemberCategoryEditorRowWarningClick:()=>this.arcgisMemberBrowserCategoryEditRowWarningClick.emit(),onWorkflowCancel:async e=>{e.detail?(i(e.detail.hasChangeSinceLastOpen),e.detail.hasChangeSinceLastOpen&&this.arcgisMemberBrowserCategoryEditSuccess.emit()):this.isEditing=!1},onNewSchemaWorkflowComplete:async({detail:e})=>{this.isEditing=!1,r(e.newSchema),this.arcgisMemberBrowserCategoryEditSuccess.emit()},onDeleteAllSchema:async()=>{i(!0),this.arcgisMemberBrowserCategoryEditSuccess.emit()}})):null},this.handleEditSchemaComplete=async e=>{this.isEditing=!1,e&&await this.refetchCategories();const{category:t,schema:i,clearFilter:n,checkSchemaFilterStillValid:r}=this;!t||"null"===t||i&&r(i,t,o.U)||n()},this.checkSchemaFilterStillValid=(e,t,i)=>e.some((e=>{var n;const r=(0,o.b)(i,e,!1);return r===t||!!(null===(n=e.categories)||void 0===n?void 0:n.length)&&this.checkSchemaFilterStillValid(e.categories,t,r)})),this.clearFilter=()=>{this.category=null,this.emitFilterEvent()},this.category=void 0,this.expanded=void 0,this.allowEdit=void 0,this.defaultCategories=[],this.loading=void 0,this.schema=[],this.categoriesCount={},this.isEditing=!1,this.tooltipReferenceElement=void 0}async componentWillLoad(){var e;this.store=(0,u.g)(this.el),this.i18n=null===(e=await(0,c.g)(this.el))||void 0===e?void 0:e.filterCategories,(null===a.c||void 0===a.c?void 0:a.c.portal)?await this.fetchMemberCategories(a.c.portal):(0,a.o)("portal",(e=>{this.fetchMemberCategories(e)})),(0,l.a)("categories",this.store,(()=>this.category=null))}async componentDidLoad(){this.category&&this.emitFilterEvent()}async fetchMemberCategories(e,t=!1){var i,n;const o=await(0,r.c)(e,null===a.c||void 0===a.c?void 0:a.c.user,t),s=null===(n=null===(i=null==o?void 0:o.memberCategorySchema)||void 0===i?void 0:i[0])||void 0===n?void 0:n.categories;this.setSchema(s),this.loading=!1}emitFilterEvent(){const{category:e,i18n:t}=this,i="null"===e?"null":e?[e]:"",n=t.label.replace("${name}","null"===e?t.noCategoriesAssigned:null==e?void 0:e.replace(`${o.U}/`,""));this.arcgisMemberBrowserFilter.emit({id:"categories",param:"categories",value:i,label:n,category:e})}renderNestedCategories(e,t){return e.map((e=>{var i;const r=t?`${t}/${e.title}`:`${o.U}/${e.title}`,a=!!(null===(i=e.categories)||void 0===i?void 0:i.length);return(0,n.h)("calcite-tree-item",{"data-value":r,"data-children":a,selected:this.category===r,key:`${r}--${a}`},(0,n.h)("a",null,e.displayName||e.title),a&&(0,n.h)("calcite-tree",{slot:"children",selectionMode:"children"},this.renderNestedCategories(e.categories,r)))}))}render(){const{loading:e,schema:t,i18n:i,allowEdit:r}=this,o=(null==t?void 0:t.length)>0;return this.store.state.groupId&&!this.store.state.myOrgView||!o&&!r||e||(0,s.b)(a.c.user)||this.store.state.includeExternalUsers?null:(0,n.h)(n.F,null,(0,n.h)("arcgis-browser-filter",{heading:this.i18n.title,expanded:this.expanded,active:!!this.category,filterID:"categories",onArcgisBrowserFilterRemove:()=>{this.category=null}},o?(0,n.h)("calcite-tree",{selectionMode:"children",onCalciteTreeSelect:e=>{var t,i;const n=e.target,r=null===(i=null===(t=null==n?void 0:n.selectedItems)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataset,o=(null==r?void 0:r.value)||"";this.category===o?this.category=null:this.category=o,this.emitFilterEvent()}},(0,n.h)("calcite-tree-item",{"data-value":"null",selected:"null"===this.category},(0,n.h)("a",null,i.noCategoriesAssigned)),this.renderNestedCategories(t)):(0,n.h)("div",null,(0,n.h)("p",{class:"no-category-title"},i.noCategoriesTitle),(0,n.h)("p",{class:"no-category-description"},i.noCategories),r&&(0,n.h)("calcite-button",{class:"add-category-button",appearance:"outline-fill",onClick:()=>this.isEditing=!0},i.setupCategories)),o&&r&&(0,n.h)(n.F,null,(0,n.h)("calcite-button",{iconStart:"pencil",appearance:"transparent",kind:"neutral",slot:"action","aria-label":i.configureCategories,onClick:()=>this.isEditing=!0,ref:e=>this.tooltipReferenceElement=e}),(0,n.h)("calcite-tooltip",{referenceElement:this.tooltipReferenceElement},i.configureCategories))),this.renderSchemaEditor())}get el(){return(0,n.a)(this)}};d.style=".no-category-title{margin-bottom:0.75rem;margin-top:1rem;font-size:1rem;font-weight:400}.no-category-description{overflow-wrap:break-word}.no-category-description:not(:last-child){margin-bottom:1rem;margin-top:0px}.add-category-button{margin-bottom:1rem;max-width:100%;overflow-wrap:break-word}"}}]);