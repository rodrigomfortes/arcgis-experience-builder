/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--ed02e1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--ed02e1"],{10465:(e,t,n)=>{n.d(t,{D:()=>r,a:()=>g,b:()=>l,c:()=>o,g:()=>b,s:()=>I});class r{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}const a=(e,t,n)=>(0,s(t).subscribe)((t=>{const r=t.some((t=>((e,t)=>{let n=e;for(;n;){if(n===t)return!0;if(!n.parentNode)return!1;n=n.parentNode instanceof ShadowRoot?n.parentNode.host:n.parentNode}return!1})(e,t.target)));r&&n()})),i={},s=e=>{const t=e.join(","),n=i[t];if(void 0!==n)return n;const r=new Set,a=new MutationObserver((e=>r.forEach((t=>t(e)))));globalThis.document&&a.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const s={subscribe:e=>(r.add(e),()=>{r.delete(e),0===r.size&&(a.disconnect(),i[t]=void 0)})};return i[t]=s,s},o=(e,t)=>{let n=e;for(;n;){const e=n.closest?.(t);if(e)return e;const r=n.getRootNode?.();if(r===globalThis.document)return null;n=r.host}return null},l=e=>c(e,"dir","ltr"),c=(e,t,n)=>{const r=o(e,`[${t}]`);return r?.getAttribute(t)??n},d=e=>{let t="";for(let n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},g=()=>[d(2),d(1),d(1),d(1),d(3)].join("-"),u="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),h=new Set(u),f="en",y={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},m={},p=async(e,t)=>{const n=`${t}${e}.json`;try{const e=await fetch(n);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===f?{}:await p(f,t)},b=e=>{const t=c(e,"lang",globalThis.navigator?.language||f);return{lang:t,t9nLocale:L(t)}},L=e=>{const[t,n]=e.split("-"),r=t.toLowerCase();let a=r;return n&&(a=`${r}-${n.toUpperCase()}`),a=y[a]??a,h.has(a)?a:n?L(r):f},I=(e,t,n,r)=>{let i;const s=()=>v(e,t(),r).then((e=>{i?.lang===e.lang&&i.t9nLocale===e.t9nLocale&&i.t9nStrings===e.t9nStrings||n(e),i=e})).catch(console.error);return queueMicrotask(s),a(e,["lang"],s)},v=async(e,t,n=e.localName.split("-").slice(1).join("-"))=>{const{lang:r,t9nLocale:a}=b(e),i=`${t}/${n}/t9n`,s=null===n?{}:await(async(e,t,n="")=>{const r=`${t}/${n}`,a=`${r}${e}.json`;return m[a]??(m[a]=p(e,r)),await m[a]})(a,i,"messages.");return{lang:r,t9nLocale:a,t9nStrings:s}}},54188:(e,t,n)=>{n.r(t),n.d(t,{arcgis_floor_configuration:()=>l});var r=n(11254),a=n(14528),i=n(84260),s=n(84792),o=n(69811);n(10465);const l=class{constructor(e){(0,r.r)(this,e),this.floorInfoChange=(0,r.c)(this,"floorInfoChange",7),this.arcgisChange=(0,r.c)(this,"arcgisChange",7),this.manager=(0,a.u)(this),this.strings=(0,i.u)({blocking:!0}),this.closedOnLoad=!1,this.disabled=!1,this.layer=void 0,this.open=!0,this.view=void 0}async componentWillLoad(){console.warn("%cmap-config-components","background: #007AC2; color: #fff; border-radius: 4px; padding: 2px 4px;",'[arcgis-floor-configuration] component in @arcgis/map-config-components is deprecated and will be removed soon. Use "arcgis-map-config-floor" instead.'),this.reactiveUtils=await(0,o.l)(),this.disabled=this.disabled||await this.getDisabled()}render(){const{closedOnLoad:e,strings:t,disabled:n}=this;return(0,r.h)(r.H,{key:"8c5cc540b8cbf41d5563989813e48537a66b6d91"},(0,r.h)("calcite-block",{key:"2dee5a415abee6162641a470e94620d4717ae05a",class:"container",heading:t.heading,collapsible:!0,disabled:n,open:!e&&!n},this.renderFloorConfiguration()))}renderFloorConfiguration(){const{strings:e,view:t}=this,n=t.map,a=!!n?.floorInfo;return(0,r.h)("calcite-block-section",{text:e.enable,open:a,"toggle-display":"switch",onCalciteBlockSectionToggle:e=>e.currentTarget.open?this.addMapFloorInfo():this.removeFloorInfo()},(0,r.h)("calcite-label",{class:"layer-select-message"},e.summary),this.renderLayerPicker("siteLayer"),this.renderLayerPicker("facilityLayer"),this.renderLayerPicker("levelLayer"),this.renderAdditionalLayers())}renderLayerPicker(e){const t=(0,s.g)(e,this.view),n=(0,s.a)(e);return(0,r.h)("arcgis-floor-configuration-layer-picker",{view:this.view,label:this.strings[e],selectedLayer:t,requiredFields:n,strings:this.strings,onArcgisListChange:t=>this.updateFloorInfo({layer:t?.detail?t?.detail[0]:null,name:e})})}renderAdditionalLayers(){return(0,r.h)("calcite-block-section",{text:this.strings.additionalLayers,open:!0},(0,r.h)("arcgis-floor-configuration-additional-layers",{view:this.view,strings:this.strings,onArcgisDisable:e=>this.disableContainer(e)}))}addMapFloorInfo(){(0,s.s)(this.view),this.floorInfoChange.emit(),this.arcgisChange.emit()}disableContainer(e){const{detail:t}=e,n=this.el.closest("calcite-flow-item");n&&(n.disabled=t)}async getDisabled(){const e=this.view;await(this.reactiveUtils?.whenOnce((()=>e.allLayerViews.every((e=>!e.updating)))));const t=await(0,s.b)(e),n=["facilityLayer","levelLayer"].filter((e=>t.filter((t=>this.hasRequiredFields(t,(0,s.a)(e))))?.length));return!n?.length}hasRequiredFields(e,t){if(e){const{fieldsIndex:n}=e;return n&&t.every((e=>!!n.get(e)))||!1}return!1}removeFloorInfo(){(0,s.r)(this.view),this.floorInfoChange.emit(),this.arcgisChange.emit()}updateFloorInfo(e){(0,s.u)(e,this.view),this.floorInfoChange.emit(),this.arcgisChange.emit()}static get assetsDirs(){return["assets"]}get el(){return(0,r.a)(this)}};l.style=".layer-select-message{margin:14px 0}"},84260:(e,t,n)=>{n.d(t,{u:()=>s});var r=n(11254),a=n(10465),i=n(14528);function s({propertyName:e="strings",name:t}){let n=(0,i.r)();const s=(0,a.g)(n.el),l=new a.D,c={_lang:s.lang,_t9nLocale:s.t9nLocale};n.manager.onLoad((()=>l.promise));const d=new WeakRef(n);function g(){const e=d.deref();return e||h?.(),e}n=void 0;const u=o((()=>g()?.el)),h=(0,a.s)(u,(()=>(0,r.g)("./assets")),(({t9nLocale:t,t9nStrings:n,lang:r})=>{const a=g();if(!a)return;a[e]={...n,_lang:r,_t9nLocale:t},l.resolve()}),t);return c}const o=e=>new Proxy({},{get(t,n){const r=e();if(!r)return;const a=Reflect.get(r,n,r);return"function"==typeof a?a.bind(r):a}})},84792:(e,t,n)=>{n.d(t,{a:()=>d,b:()=>u,c:()=>g,d:()=>y,g:()=>f,r:()=>l,s:()=>s,u:()=>o});const r={facilityLayer:{facilityIdField:"FACILITY_ID",siteIdField:"SITE_ID",nameField:"NAME"},levelLayer:{levelIdField:"LEVEL_ID",facilityIdField:"FACILITY_ID",longNameField:"NAME",shortNameField:"NAME_SHORT",levelNumberField:"LEVEL_NUMBER",verticalOrderField:"VERTICAL_ORDER"},siteLayer:{siteIdField:"SITE_ID",nameField:"NAME"}};let a;const i=e=>{const t=e?.map;return a=a||t?.floorInfo||{...r},a.siteLayer=a?.siteLayer?.layerId?a.siteLayer:null,a},s=e=>{const t=e?.map,n=i(e);t&&c(n)?t.set("floorInfo",n):l(e)},o=(e,t)=>{const n=i(t),{name:a}=e,o=e.layer;if(o){const e="sublayer"===o.type;n[a]={...r[a]},n[a]&&(n[a].layerId=e?o.layer?.id:o.id,n[a].sublayerId=e?o.id:void 0)}else n[a]=void 0;s(t)},l=e=>{const t=e?.map;t&&(t.floorInfo=null)},c=e=>!(!e?.facilityLayer?.layerId||!e?.levelLayer?.layerId||e?.siteLayer&&!e?.siteLayer.layerId),d=e=>{const t=r[e];return Object.values(t)},g=e=>{const{map:t}=e,n=t?.allLayers;let r=[];return n?.forEach((e=>{const{type:t,floorInfo:n}=e;"map-image"===t?r=r.concat(e.allSublayers.filter((e=>e.fieldsIndex&&!e?.floorInfo)).toArray()):!n&&["feature","oriented-imagery"].includes(t)&&r.push(e)})),r},u=async e=>{const{map:t}=e,n=t?.allLayers,r=n?.map((async e=>await h(e))).filter((e=>"failed"!==e?.loadStatus)),a=r?await Promise.all(r):[];let i=[];return a.forEach((e=>{const{type:t,geometryType:n}=e;"map-image"===t?i=i.concat(e.allSublayers.filter((e=>e.fieldsIndex&&"esriGeometryPolygon"===e.sourceJSON?.geometryType)).toArray()):"feature"===t&&"polygon"===n&&i.push(e)})),i},h=async e=>(void 0!==e.loadAll?await e.loadAll():await e.load(),e),f=(e,t)=>{const n=t.map,r=n?.allLayers,a=i(t),s=a?.[e]?.layerId,o=a?.[e]?.sublayerId;let l=s?r?.find((e=>e.id===s)):null;return"map-image"===l?.type&&(l=l.allSublayers.find((e=>e.id===o))),l},y=e=>{const{layer:t}=e;let n;if(n="arcgis-field-list"===e?.localName||"arcgis-floor-configuration-field-list"===e?.localName?e.selection.values().next().value:e?.field,n){const e=t.floorInfo||{};e.floorField=n.name,t.set("floorInfo",e)}}}}]);