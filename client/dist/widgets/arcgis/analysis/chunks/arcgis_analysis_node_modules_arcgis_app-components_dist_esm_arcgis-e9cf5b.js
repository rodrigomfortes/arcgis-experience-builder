/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e9cf5b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-e9cf5b"],{86562:(e,t,s)=>{s.d(t,{g:()=>n});var i=s(15332);function n(e){const{el:t,tag:s,cache:n}=e,r=(0,i.c)(t,s),l=n.get(r);return l||(r?(n.set(r,r.store),r.store):null)}},89209:(e,t,s)=>{s.d(t,{D:()=>i,M:()=>n});const i=14,n=5},92452:(e,t,s)=>{s.r(t),s.d(t,{arcgis_delete_items_composite_disclaimer:()=>d,arcgis_delete_items_permanent:()=>m,arcgis_delete_items_recycle:()=>u});var i=s(87849),n=s(86562),r=s(89209),l=s(4429),o=s(80021);s(15332),s(93814),s(59317),s(37762),s(90310),s(50637),s(931),s(87744),s(50822),s(83929),s(68194);const a=new Map;function c(e){return(0,n.g)({el:e,tag:"arcgis-delete-items",cache:a})}const d=class{constructor(e){(0,i.r)(this,e),this.totalItems=0,this.renderAdditionalCompositeSummary=()=>(0,i.h)("arcgis-items-summary",null,(0,i.h)("div",{slot:"title"},(0,i.h)("span",null,this.i18n.compositeDeleteDisclaimer.additional),(0,i.h)("arcgis-items-summary-bucket",{popoverId:"protected-bucket",summaryGroups:this.additionalSummaryGroups,totalItems:this.totalItems,relatedItemsDescription:this.i18n.summary.includesDependentItems}))),this.buckets=void 0,this.additionalDependentItemsTotal=0,this.additionalSummaryGroups=void 0}async componentWillLoad(){var e;this.store=c(this.el),this.i18n=this.store.state.i18n,this.mode="manyToMany";const{selectedCompositeItems:t}=this.buckets;this.compositeSourceItems=null===(e=this.buckets)||void 0===e?void 0:e.unprotectedItems.filter((e=>e.relatedItems.isComposite&&e.relatedItems.resultData.count>0)),1===this.compositeSourceItems.length&&(this.singleSourceItem=this.compositeSourceItems[0],this.mode="oneToMany"),this.additionalSummaryGroups=this.compositeSourceItems.map((e=>{const{additionalItems:s,additionalItemCount:i,truncatedItemCount:n}=(e=>{var t,s,i,n;const{compositeSourceItem:l,selectedCompositeItems:o}=e,a=o.filter((e=>{var t;return(null===(t=e.relatedItems)||void 0===t?void 0:t.sourceData.id)===l.item.id})).map((e=>e.item)),c=null!==(i=null===(s=null===(t=l.relatedItems)||void 0===t?void 0:t.resultData)||void 0===s?void 0:s.items.map((e=>({item:e}))).filter((e=>!a.some((t=>t.id===e.item.id)))))&&void 0!==i?i:[],d=(null===(n=l.relatedItems)||void 0===n?void 0:n.resultData.count)-a.length;return{additionalItems:c,additionalItemCount:d,truncatedItemCount:d-r.M}})({compositeSourceItem:e,selectedCompositeItems:t});return this.totalItems+=i,{heading:`${this.i18n.compositeDeleteDisclaimer.dependentOn} ${e.item.title} (${i})`,items:s.slice(0,r.M),truncatedItemCount:n}})).filter((e=>e.items.length>0))}render(){var e,t,s;return(0,i.h)(i.H,{key:"0f6eb0282ada8f634bb95a070cb1cb5545f38f3f"},(0,i.h)("span",{key:"85a85d3e3ca5957c268be6a350ad4741bf983196",class:"message",innerHTML:this.i18n.compositeDeleteDisclaimer[this.mode].replace("${item}",null===(e=this.singleSourceItem)||void 0===e?void 0:e.item.title).replace("${dependentItem}",null===(s=null===(t=this.singleSourceItem)||void 0===t?void 0:t.relatedItems.resultData.items)||void 0===s?void 0:s[0].title)}),this.renderAdditionalCompositeSummary())}get el(){return(0,i.a)(this)}};d.style=":host{display:flex;flex-direction:column;font-size:0.875rem}.message{margin-bottom:1rem}";const m=class{constructor(e){(0,i.r)(this,e),this.renderProtectedItem=e=>{const{item:t}=e;return(0,i.h)("div",{class:"protected-item",key:t.id},(0,i.h)("arcgis-item-type",{item:t,showText:!1,showHosted:!0,class:"protected-item__icon"}),(0,i.h)("calcite-link",{href:`./item.html?id=${t.id}`,class:"protected-item__link",target:"_blank"},t.title))},this.renderDeleteContent=()=>{const{unprotectedItems:e,protectedItems:t}=this.buckets;switch(this.mode){case"PROTECTED":case"PROTECTED_UNPROTECTED":const s=t.filter((e=>!["CONT_00481","CONT_0048"].includes(e.error.messageCode))).length<=0;return(0,i.h)(i.F,null,(0,i.h)("span",null,s?this.i18n.cantDelete:this.i18n.summary.cannotDelete),t.map(this.renderProtectedItem),e.length>0&&(0,i.h)("span",null,this.i18n.proceed));case"UNRECYCLABLE":return(0,i.h)("span",null,this.i18n.areYouSurePermanent[this.buckets.unrecyclableItems.length>1?"multiple":"single"]);default:return(0,i.h)("span",null,this.i18n.areYouSure[this.buckets.unprotectedItems.length>1?"multiple":"single"])}},this.buckets=void 0,this.mode=void 0}async componentWillLoad(){this.store=c(this.el),this.i18n=this.store.state.i18n}render(){return(0,i.h)(i.H,{key:"0c2b71d85df18a62a10adc744d363bac397610c0"},this.renderDeleteContent())}get el(){return(0,i.a)(this)}};m.style=":host{display:flex;flex-direction:column;font-size:var(--calcite-font-size--1)}.protected-item{display:flex;align-items:center;padding-left:0px;padding-right:0px;padding-top:0.5rem;padding-bottom:0.5rem}.protected-item__link{min-width:0px;overflow-wrap:break-word}.protected-item__icon{margin-inline-end:0.5rem;flex-grow:0}";const u=class{constructor(e){(0,i.r)(this,e),this.arcgisDeleteItemsPermanentlyDeleteOverride=(0,i.c)(this,"arcgisDeleteItemsPermanentlyDeleteOverride",7),this.arcgisDeleteItemsPermanentlyDeleteBucketToggle=(0,i.c)(this,"arcgisDeleteItemsPermanentlyDeleteBucketToggle",7),this.unrecyclableItemsGroups=new Map,this.protectedSummaryGroups=new Map,this.offendingItems=[],this.deleteOverriddenBucket=[],this.additionalDependentItemsTotal=0,this.itemHasRelatedItemsInRecycleBin=e=>{var t,s,i,n;return null!==(n=null===(i=null===(s=null===(t=e.relatedItems)||void 0===t?void 0:t.resultData)||void 0===s?void 0:s.items)||void 0===i?void 0:i.some((e=>e.inRecycleBin)))&&void 0!==n&&n},this.getUnrecyclableMessage=()=>{const{i18n:e,unrecyclableItemsGroups:t}=this,s=t.has("distributedCollaborationFeatureLayer")&&!t.has("notSupported"),i=t.has("notSupported")&&t.has("distributedCollaborationFeatureLayer");let n;return n=s?e.summary.permanentDelete.unsynchronized:i?e.summary.permanentDelete.notSupportedAndUnsynchronized:e.summary.permanentDelete.notSupported[this.buckets.unrecyclableItems.length>1?"multiple":"single"],n},this.renderUnrecyclableBucket=()=>{const{i18n:e,getUnrecyclableMessage:t,isPermanentlyDeleteBucketDisabled:s,help:n,allowPermanentlyDeleteDeselect:r,disableLinks:l}=this,{protectedItems:o,unprotectedItems:a,unrecyclableItems:c}=this.buckets,d=`${n.base}${n.map[120004692]||""}`;return(0,i.h)(i.F,null,(0,i.h)("arcgis-items-summary",{icon:"trash",disabled:s},(0,i.h)("div",{slot:"title"},(0,i.h)("span",null,e.summary.permanentlyDelete),(0,i.h)("arcgis-items-summary-bucket",{popoverId:"unrecyclable-bucket",summaryGroups:[{items:c,heading:e.summary.permanentDelete.group.notSupported}],disableLinks:l})),(0,i.h)("div",{slot:"description",innerHTML:t()})),(0,i.h)("div",{class:"bucket-end"},r&&!(0===a.length&&0===o.length)&&(0,i.h)("div",{class:"bucket-end__button-container enabled"},(0,i.h)("calcite-button",{scale:"s",appearance:"outline",onClick:()=>{this.isPermanentlyDeleteBucketDisabled=!s,this.arcgisDeleteItemsPermanentlyDeleteBucketToggle.emit(!s)}},s?e.summary.select:e.summary.deselect)),(0,i.h)("calcite-link",{iconEnd:"launch",href:d,target:"_blank"},e.learnMore)),"unrecyclableItems"===this.primaryBucket&&(a.length>0||o.length>0)&&(0,i.h)("hr",{class:"divider"}))},this.renderUnprotectedBucket=()=>{var e;const{i18n:t,disableLinks:s,help:n}=this,{protectedItems:l,unprotectedItems:a,unrecyclableItems:c}=this.buckets,d=1===a.length&&"Delete discouraged"===(null===(e=a[0].error)||void 0===e?void 0:e.message),m=`${n.base}${n.map[120001208]||""}`;return(0,i.h)(i.F,null,(0,i.h)("arcgis-items-summary",{icon:"recycle-bin"},(0,i.h)("div",{slot:"title"},(0,i.h)("span",null,t.summary.willBeRecycled),(0,i.h)("arcgis-items-summary-bucket",{popoverId:"unprotected-bucket",relatedItemsDescription:t.summary.includesDependentItems,summaryGroups:[{items:a}],disableLinks:s})),(0,i.h)("div",{slot:"description"},t.summary.canBeRecovered[1!==a.length||(0,o.i)(a)?"multiple":"single"].replace("${days}",`${r.D}`))),d&&(0,i.h)("div",{class:"text-group"},(0,i.h)("span",{class:"description"},t.summary.unprotectedGroup.deleteDiscouraged.message),(0,i.h)("calcite-link",{class:"text-group__link",href:m,target:"_blank","icon-end":"launch"},t.summary.unprotectedGroup.deleteDiscouraged.learnMore)),"unprotectedItems"===this.primaryBucket&&(l.length>0||c.length>0)&&(0,i.h)("hr",{class:"divider"}))},this.renderProtectedBucket=()=>{const{i18n:e,items:t,offendingItems:s,protectedSummaryGroups:n,disableLinks:r}=this,{protectedItems:l,unprotectedItems:o,unrecyclableItems:a}=this.buckets,c=1===t.length,d=()=>{let t="multiple";if(1===l.length){const{offendingItems:e}=l[0].error;t=e.length>1?"singleMultipleDependentItems":"singleOneDependentItem"}return e.summary.protectedGroup.hasDependentItemsDescription[t]};return(0,i.h)(i.F,null,(0,i.h)("arcgis-items-summary",{icon:"security"},(0,i.h)("div",{slot:"title"},(0,i.h)("span",null,!c||(n.has("deleteProtected")||n.has("compositeDelete")||n.has("uncaught"))&&!n.has("hasDependent")?e.summary.cannotDelete:e.summary.hasDependentItems),(0,i.h)("arcgis-items-summary-bucket",{popoverId:"protected-bucket",summaryGroups:[...n.values()],disableLinks:r})),(0,i.h)("div",{slot:"description"},(()=>{if(!c||n.has("deleteProtected")||n.has("uncaught")){let t="";return n.has("deleteProtected")&&n.has("hasDependent")?t=e.summary.protectedGroup.protectedAndDependentDescription:n.has("hasDependent")?t=d():n.has("compositeDelete")?t=e.summary.protectedGroup.compositeDeleteDescription:n.has("deleteProtected")&&(t=e.summary.protectedGroup.deleteProtectedDescription),(0,i.h)("span",null,t)}return(0,i.h)(i.F,null,(0,i.h)("span",null,n.has("compositeDelete")?e.summary.protectedGroup.compositeDelete:e.summary.protectedGroup.dependentItems[1===s.length?"single":"multiple"]),(0,i.h)("arcgis-items-summary-bucket",{popoverId:"offending-bucket",summaryGroups:[{items:s.map((e=>({item:e})))}],recycleDescription:e.recycleBin}))})())),c&&(()=>this.isSingleDiscouragedItem?(0,i.h)("span",{class:"description"},e.summary.protectedGroup.deleteDiscouragedDescription.single):c&&n.has("hasDependent")&&(0,i.h)("span",{class:"description"},d()))(),"protectedItems"===this.primaryBucket&&(o.length>0||a.length>0)&&(0,i.h)("hr",{class:"divider"}))},this.renderPermanentlyDeleteAllOverride=()=>{const{i18n:e,disableLinks:t}=this,{deleteOverriddenBucket:s}=this;return(0,i.h)("div",{class:"text-group"},(0,i.h)("span",{class:"override__description"},e.deleteOverride[1!==s.length||(0,o.i)(s)?"multiple":"single"]),(0,i.h)("arcgis-items-summary",{icon:"trash"},(0,i.h)("div",{slot:"title"},(0,i.h)("span",null,e.summary.permanentlyDelete),(0,i.h)("arcgis-items-summary-bucket",{label:e.summary.permanentlyDelete,popoverId:"permanently-delete-override-bucket",summaryGroups:[{items:s}],relatedItemsDescription:e.summary.includesDependentItems,disableLinks:t}))))},this.renderMoreOptions=()=>{const{i18n:e,isMoreOptionsExpanded:t,isAllSameDeleteMode:s,items:n,mode:r,primaryAction:l,arcgisDeleteItemsPermanentlyDeleteOverride:o}=this;return"PROTECTED"===r||"PERMANENTLY_DELETE"===l||this.deleteOverriddenBucket.length<=0?null:(0,i.h)("div",{class:"more-options__container"},(0,i.h)("calcite-button",{class:"more-options__button",scale:"s",iconEnd:t?"minus":"plus",appearance:"transparent",onClick:()=>{this.isMoreOptionsExpanded=!t},onKeyDown:e=>{["Enter"," "].includes(e.key)&&(this.isMoreOptionsExpanded=!t)}},t?e.showLess:e.showMore),t&&(0,i.h)("calcite-button",{kind:"danger",appearance:"outline-fill",iconStart:"trash",onClick:()=>{this.permanentlyDeleteOverridden=!0,o.emit()}},s?e.deletePermanently:e.summary.deleteXPermanently.replace("${subset}",`${this.deleteOverriddenBucket.length+this.buckets.selectedCompositeItems.length+this.additionalDependentItemsTotal}`).replace("${total}",`${n.length+this.additionalDependentItemsTotal}`)))},this.renderPrioritizedBuckets=()=>(0,l.b)([this.primaryBucket,"unrecyclableItems","unprotectedItems","protectedItems"]).map((e=>this.renderBucket(e))),this.renderBucket=e=>{const{renderUnrecyclableBucket:t,renderUnprotectedBucket:s,renderProtectedBucket:i}=this,{unrecyclableItems:n,unprotectedItems:r,protectedItems:l}=this.buckets;switch(e){case"unrecyclableItems":return n.length>0&&t();case"unprotectedItems":return r.length>0&&s();case"protectedItems":return l.length>0&&i()}},this.items=void 0,this.buckets=void 0,this.mode=void 0,this.primaryBucket="unrecyclableItems",this.primaryAction=void 0,this.allowPermanentlyDeleteDeselect=!0,this.permanentlyDeleteOverridden=void 0,this.showSelectedItemsCount=!0,this.disableLinks=void 0,this.isPermanentlyDeleteBucketDisabled=void 0,this.isMoreOptionsExpanded=void 0}async componentWillLoad(){var e,t;if(this.store=c(this.el),!this.store)return;this.i18n=this.store.state.i18n;const{portal:s,locale:i}=this.store.state;this.help={base:null!==(t=null===(e=s.sourceJSON)||void 0===e?void 0:e.helpBase)&&void 0!==t?t:s.helpBase,map:await(0,o.g)(s,i)};this.isAllSameDeleteMode=["PROTECTED","UNPROTECTED","UNRECYCLABLE"].includes(this.mode),this.analyzeBuckets()}analyzeBuckets(){this.analyzeUnrecyclableItems(),this.setProtectedItemsGroups(),this.additionalDependentItemsTotal=this.countDependentItems()-this.buckets.selectedCompositeItems.length,this.updateDeleteOverriddenBucket()}updateDeleteOverriddenBucket(){const{unrecyclableItems:e,unprotectedItems:t}=this.buckets;this.deleteOverriddenBucket=t.filter((e=>!this.itemHasRelatedItemsInRecycleBin(e))),this.isPermanentlyDeleteBucketDisabled||this.deleteOverriddenBucket.push(...e)}analyzeUnrecyclableItems(){const{unrecyclableItems:e}=this.buckets,t=e.filter((e=>!(0,o.f)(e))),s=e.filter((e=>(0,o.f)(e)));t.length>0&&this.unrecyclableItemsGroups.set("notSupported",{items:t}),s.length>0&&this.unrecyclableItemsGroups.set("distributedCollaborationFeatureLayer",{items:s})}countDependentItems(){const{unprotectedItems:e}=this.buckets;return e.reduce(((e,t)=>{var s,i,n;return e+((null===(s=t.relatedItems)||void 0===s?void 0:s.isComposite)&&(null===(n=null===(i=t.relatedItems)||void 0===i?void 0:i.resultData)||void 0===n?void 0:n.count)||0)}),0)}setProtectedItemsGroups(){var e,t;const{items:s,i18n:i,protectedSummaryGroups:n}=this,{protectedItems:r}=this.buckets,l=[],o=[],a=[],c=[],d=[];for(const s of r)switch(null===(e=s.error)||void 0===e?void 0:e.messageCode){case"CONT_00481":l.push(s);break;case"CONT_0048":o.push(s);break;case"CONT_0298":c.push(s);break;default:"Delete discouraged"===(null===(t=s.error)||void 0===t?void 0:t.message)?a.push(s):d.push(s)}const m=1===s.length,u=l.length>0||a.length>0,h=o.length>0,p=c.length>0,y=d.length>0;this.isSingleDiscouragedItem=m&&1===a.length,u&&n.set("hasDependent",{items:[...l,...a],heading:i.summary.protectedGroup.hasDependentItems}),h&&n.set("deleteProtected",{items:o,heading:i.summary.protectedGroup.deleteProtected}),p&&n.set("compositeDelete",{items:c,heading:i.summary.protectedGroup.compositeDelete}),y&&n.set("uncaught",{items:d,heading:i.summary.cannotDelete.replace(":","")}),m&&(u||p)&&(this.offendingItems=r[0].error.offendingItems.map((e=>{var t;const{title:s,type:i,inRecycleBin:n}=e;return{id:null!==(t=e.itemId)&&void 0!==t?t:e.id,title:s,type:i,inRecycleBin:n}})))}render(){const{i18n:e,items:t,isPermanentlyDeleteBucketDisabled:s,permanentlyDeleteOverridden:n,isAllSameDeleteMode:r,showSelectedItemsCount:l,renderPermanentlyDeleteAllOverride:o,renderMoreOptions:a}=this,{unrecyclableItems:c}=this.buckets;return(0,i.h)(i.H,{key:"f17cffb33dc02e265ff0418158bc59a7f20864c1"},n?o():(0,i.h)(i.F,null,l&&(!r||this.additionalDependentItemsTotal>0)&&(0,i.h)("div",{class:"selected-items"},(0,i.h)("span",{class:"selected-items__selected"},`${e.summary.selectedItems} ${t.length-(s?c.length:0)}`),this.additionalDependentItemsTotal>0?(0,i.h)("span",{class:"selected-items__additional"},`+ ${e.summary.additionalDependentItems} ${this.additionalDependentItemsTotal}`):null),this.renderPrioritizedBuckets(),a()))}get el(){return(0,i.a)(this)}static get watchers(){return{bucket:["analyzeBuckets"],isPermanentlyDeleteBucketDisabled:["updateDeleteOverriddenBucket"]}}};u.style=":host{display:flex;flex-direction:column;font-size:var(--calcite-font-size--1)}.selected-items{margin-bottom:2rem;display:flex;flex-direction:column}.selected-items__selected{font-size:var(--calcite-font-size-0);color:var(--calcite-color-text-1)}.selected-items__additional{font-size:var(--calcite-font-size--1);color:var(--calcite-color-text-3)}.divider{margin-left:0px;margin-right:0px;margin-top:1rem;margin-bottom:0px;border-style:none;border-top:1px solid #ccc}.more-options__container{display:flex;flex-direction:column;align-items:flex-start}.more-options__button{margin-top:2rem;margin-bottom:1rem}.text-group{display:flex;flex-direction:column}.text-group__link{margin-top:1rem}.override__description{margin-bottom:1rem}arcgis-items-summary:not(:first-of-type){margin-top:2rem}.description{font-size:var(--calcite-font-size-0);margin-top:2rem}.bucket-end{margin-inline-start:2.6rem;display:inline-flex;padding-top:0.25rem}.bucket-end__button-container{min-width:5rem}"}}]);