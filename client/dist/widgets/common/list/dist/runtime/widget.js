System.register(["jimu-core","jimu-ui/basic/sql-expression-runtime","jimu-ui","jimu-layouts/layout-runtime","jimu-theme","jimu-core/react"],(function(e,t){var o={},i={},n={},s={},l={},r={};return{setters:[function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.CONSTANTS=e.CONSTANTS,o.DataRecordsSelectionChangeMessage=e.DataRecordsSelectionChangeMessage,o.DataSourceComponent=e.DataSourceComponent,o.DataSourceFilterChangeMessage=e.DataSourceFilterChangeMessage,o.DataSourceManager=e.DataSourceManager,o.DataSourceStatus=e.DataSourceStatus,o.DynamicStyleResolverComponent=e.DynamicStyleResolverComponent,o.ExpressionResolverComponent=e.ExpressionResolverComponent,o.Immutable=e.Immutable,o.LayoutItemType=e.LayoutItemType,o.LayoutType=e.LayoutType,o.LinkType=e.LinkType,o.MessageManager=e.MessageManager,o.PageMode=e.PageMode,o.React=e.React,o.ReactRedux=e.ReactRedux,o.ReactResizeDetector=e.ReactResizeDetector,o.RepeatedDataSourceProvider=e.RepeatedDataSourceProvider,o.appActions=e.appActions,o.appConfigUtils=e.appConfigUtils,o.classNames=e.classNames,o.css=e.css,o.dataSourceUtils=e.dataSourceUtils,o.defaultMessages=e.defaultMessages,o.esri=e.esri,o.focusElementInKeyboardMode=e.focusElementInKeyboardMode,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jimuHistory=e.jimuHistory,o.jsx=e.jsx,o.lodash=e.lodash,o.polished=e.polished,o.urlUtils=e.urlUtils,o.utils=e.utils},function(e){i.SqlExpressionRuntime=e.SqlExpressionRuntime,i.updateSQLExpressionByVersion=e.updateSQLExpressionByVersion},function(e){n.Alert=e.Alert,n.Button=e.Button,n.DataActionList=e.DataActionList,n.DataActionListStyle=e.DataActionListStyle,n.DistanceUnits=e.DistanceUnits,n.Dropdown=e.Dropdown,n.DropdownButton=e.DropdownButton,n.DropdownItem=e.DropdownItem,n.DropdownMenu=e.DropdownMenu,n.Link=e.Link,n.LinkTip=e.LinkTip,n.ListGroupItem=e.ListGroupItem,n.Pagination=e.Pagination,n.Popper=e.Popper,n.TextAlignValue=e.TextAlignValue,n.TextInput=e.TextInput,n.Tooltip=e.Tooltip,n.WidgetPlaceholder=e.WidgetPlaceholder,n.defaultMessages=e.defaultMessages,n.getFocusableElements=e.getFocusableElements,n.hooks=e.hooks,n.styleUtils=e.styleUtils,n.utils=e.utils},function(e){s.LayoutEntry=e.LayoutEntry,s.LayoutItemSizeModes=e.LayoutItemSizeModes,s.searchUtils=e.searchUtils},function(e){l.useTheme=e.useTheme},function(e){r.Fragment=e.Fragment,r.PureComponent=e.PureComponent,r.createElement=e.createElement,r.useEffect=e.useEffect}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=l},4583:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 17"><path fill="#000" fill-rule="evenodd" d="M0 12v-1.5h1V12h1.5v1H1a1 1 0 0 1-1-1M1 1h1.5v1H1v1.5H0V2a1 1 0 0 1 1-1m0 7.5H0v-3h1zM4.5 2V1h3v1zm5 0V1H11a1 1 0 0 1 1 1v1.5h-1V2zm4.813 14.02-3.535-3.535-3.536 3.535-.707-.707 3.536-3.535-3.536-3.536.707-.707 3.536 3.536 3.535-3.536.707.707-3.535 3.536 3.535 3.535z" clip-rule="evenodd"></path></svg>'},4651:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2m5 1a1 1 0 1 1 2 0 1 1 0 0 1-2 0m6 0a1 1 0 1 1 2 0 1 1 0 0 1-2 0" clip-rule="evenodd"></path></svg>'},7835:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M.438 1C.196 1 0 1.224 0 1.5s.196.5.438.5h15.125c.241 0 .437-.224.437-.5s-.196-.5-.437-.5zM0 7.5c0-.276.196-.5.438-.5h15.125c.241 0 .437.224.437.5s-.196.5-.437.5H.438C.196 8 0 7.776 0 7.5M0 13.5c0-.276.196-.5.438-.5h15.125c.241 0 .437.224.437.5s-.196.5-.437.5H.438C.196 14 0 13.776 0 13.5"></path></svg>'},14321:e=>{"use strict";e.exports=n},20904:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M15.88 2.825a.5.5 0 0 0-.759-.65l-2.323 2.71-1.265-1.265a.5.5 0 1 0-.707.707l1.265 1.265a1 1 0 0 0 1.466-.056zm0 8a.5.5 0 0 0-.759-.65l-2.323 2.71-1.265-1.265a.5.5 0 1 0-.707.708l1.265 1.264a1 1 0 0 0 1.466-.056zM9 4.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5M8.5 13a.5.5 0 0 0 0-1h-8a.5.5 0 0 0 0 1z" clip-rule="evenodd"></path></svg>'},21935:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M7.986 1a6.99 6.99 0 0 1 5.723 2.969l-2.551-.938a.5.5 0 1 0-.345.938l4.228 1.555.163-.944.013-.005-.009-.019.6-3.471a.5.5 0 1 0-.985-.17l-.403 2.33A8 8 0 0 0 0 7.5c-.016.277.21.501.486.501a.53.53 0 0 0 .517-.5A7 7 0 0 1 7.986 1M8.015 15a6.99 6.99 0 0 1-5.724-2.969l2.551.938a.497.497 0 0 0 .642-.296.5.5 0 0 0-.297-.642L.96 10.476l-.163.944-.013.005.009.019-.6 3.471a.5.5 0 1 0 .985.17l.403-2.33A8 8 0 0 0 16 8.5a.477.477 0 0 0-.485-.501.53.53 0 0 0-.518.5A7 7 0 0 1 8.015 15"></path></svg>'},27964:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M16 4.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5M16 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 .5.5M5.146 2.12a.5.5 0 0 1 .055.705l-2.324 2.71a1 1 0 0 1-1.466.057L.146 4.327a.5.5 0 0 1 .708-.707l1.264 1.265 2.323-2.71a.5.5 0 0 1 .705-.055M5.146 10.12a.5.5 0 0 1 .055.705l-2.324 2.71a1 1 0 0 1-1.466.057L.146 12.328a.5.5 0 1 1 .708-.708l1.264 1.265 2.323-2.71a.5.5 0 0 1 .705-.055" clip-rule="evenodd"></path></svg>'},28996:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M8 2.125 14.334 14H1.667zm-.882-.47a1 1 0 0 1 1.765 0l6.333 11.874A1 1 0 0 1 14.334 15H1.667a1 1 0 0 1-.882-1.47zM8 4.874a.905.905 0 0 0-.9.995l.35 3.507a.552.552 0 0 0 1.1 0L8.9 5.87a.905.905 0 0 0-.9-.995m1 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0" clip-rule="evenodd"></path></svg>'},29435:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M14.938 8A7 7 0 0 1 1.01 9H0a8.001 8.001 0 0 0 15.938-1A8 8 0 0 0 1.02 3.98L1 .702a.5.5 0 1 0-1 .006L.031 5.9l5.128-.826a.5.5 0 0 0-.16-.987L1.819 4.6A7 7 0 0 1 14.938 8"></path></svg>'},30655:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M2.146 4.653a.485.485 0 0 1 .708 0L8 10.24l5.146-5.587a.485.485 0 0 1 .708 0 .54.54 0 0 1 0 .738l-5.5 5.956a.485.485 0 0 1-.708 0l-5.5-5.956a.54.54 0 0 1 0-.738" clip-rule="evenodd"></path></svg>'},37568:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M11.347 2.146a.485.485 0 0 1 0 .708L5.76 8l5.587 5.146a.486.486 0 0 1 0 .708.54.54 0 0 1-.738 0l-5.956-5.5a.485.485 0 0 1 0-.708l5.956-5.5a.54.54 0 0 1 .738 0" clip-rule="evenodd"></path></svg>'},41496:e=>{"use strict";e.exports=s},45508:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M8 5.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6.5 7.5A.5.5 0 0 1 7 7h1.5v4.5h1a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1h1V8H7a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16m0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14" clip-rule="evenodd"></path></svg>'},47569:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M18.5.995c0-.55-.43-.995-.96-.995H2.46a.94.94 0 0 0-.605.223 1.02 1.02 0 0 0-.14 1.4L6.5 7.72c.122.156.196.347.212.548l.835 10.815q.011.139.058.27a.95.95 0 0 0 1.237.582l2.112-.82a.99.99 0 0 0 .615-.797l1.325-10.062c.025-.193.105-.374.228-.52l5.141-6.087c.154-.181.238-.414.238-.655M2.5 1h14.999l-5.141 6.09-.117.153a2 2 0 0 0-.34.883l-1.325 10.062-2.035.792-.833-10.788-.02-.169a2 2 0 0 0-.402-.92L2.502 1.006z" clip-rule="evenodd"></path></svg>'},50170:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-1.27 4.936a6.5 6.5 0 1 1 .707-.707l4.136 4.137a.5.5 0 1 1-.707.707z" clip-rule="evenodd"></path></svg>'},51879:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M6 0a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1" clip-rule="evenodd"></path><path fill="#000" d="M10.5 2a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1zM10 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5"></path><path fill="#000" fill-rule="evenodd" d="M6 12a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2zm0 1H2a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1" clip-rule="evenodd"></path><path fill="#000" d="M10 14.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M10.5 17a.5.5 0 0 0 0 1h9a.5.5 0 0 0 0-1z"></path></svg>'},52943:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M4.653 13.854a.485.485 0 0 1 0-.708L10.24 8 4.653 2.854a.485.485 0 0 1 0-.708.54.54 0 0 1 .738 0l5.956 5.5a.485.485 0 0 1 0 .708l-5.956 5.5a.54.54 0 0 1-.738 0" clip-rule="evenodd"></path></svg>'},62838:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="m8.745 8 6.1 6.1a.527.527 0 1 1-.745.746L8 8.746l-6.1 6.1a.527.527 0 1 1-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 0 1 .746-.746l6.1 6.1 6.1-6.1a.527.527 0 0 1 .746.746z"></path></svg>'},68972:e=>{"use strict";e.exports=r},70778:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#FFF" fill-rule="nonzero" d="M2 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4m5-3a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4m0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4m0 7a1 1 0 0 0 0 2h7a1 1 0 0 0 0-2zm0-1h7a2 2 0 1 1 0 4H7a2 2 0 1 1 0-4M2 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4m0 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 1a2 2 0 1 1 0-4 2 2 0 0 1 0 4"></path></svg>'},76117:e=>{"use strict";e.exports=i},76219:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M6 1.5a.5.5 0 1 0-1 0v12.158L1.207 9.06a.5.5 0 1 0-.76.652l4.146 5.008A.8.8 0 0 0 6 14.2zm4 13a.5.5 0 1 0 1 0V2.342l3.794 4.598a.5.5 0 1 0 .759-.652L11.407 1.28A.8.8 0 0 0 10 1.8z" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=o},94064:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M13.854 11.347a.486.486 0 0 1-.708 0L8 5.76l-5.146 5.587a.485.485 0 0 1-.708 0 .54.54 0 0 1 0-.738l5.5-5.956a.485.485 0 0 1 .708 0l5.5 5.956a.54.54 0 0 1 0 .738" clip-rule="evenodd"></path></svg>'},96300:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" d="M15 7.5a.52.52 0 0 1-.516.527H2.976L6.473 11.6a.535.535 0 0 1 0 .746.51.51 0 0 1-.73 0L1 7.5l4.743-4.846a.51.51 0 0 1 .73 0 .535.535 0 0 1 0 .746L2.976 6.973h11.508c.285 0 .516.236.516.527"></path></svg>'}},t={};function a(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var c={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(c),a.d(c,{__set_webpack_public_path__:()=>Vi,default:()=>Gi});var e,t=a(79244),o=a(76117);!function(e){e.AUTO="Auto",e.CUSTOM="Custom"}(e||(e={}));const i=20,n=42;var s,l,r,d,u,p,h,g,f,m,v;!function(e){e.None="NONE",e.Arrangement="ARRANGEMENT",e.States="STATES",e.Tools="TOOLS"}(s||(s={})),function(e){e.None="NONE",e.Single="SINGLE",e.Multiple="MULTIPLE"}(l||(l={})),function(e){e.Scroll="SCROLL",e.MultiPage="MULTIPAGE"}(r||(r={})),function(e){e.Start="FLEX-START",e.Center="CENTER",e.End="FLEX-END"}(d||(d={})),function(e){e.Horizon="HORIZON",e.Vertical="VERTICAL"}(u||(u={})),function(e){e.Row="ROW",e.Column="COLUMN",e.GRID="GRID"}(p||(p={})),function(e){e.Glide="GLIDE",e.Fade="FADE",e.Float="FLOAT"}(h||(h={})),function(e){e.Hover0="HOVER0",e.Hover1="HOVER1",e.Hover2="HOVER2",e.Hover3="HOVER3"}(g||(g={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3"}(f||(f={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3",e.Style4="STYLE4",e.Style5="STYLE5",e.Style6="STYLE6",e.Style7="STYLE7",e.Style8="STYLE8",e.Style9="STYLE9",e.Style10="STYLE10",e.Style11="STYLE11",e.Style12="STYLE12"}(m||(m={})),function(e){e.Default="DEFAULT",e.Selected="SELECTED",e.Hover="HOVER"}(v||(v={}));var S=function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function l(e){try{a(i.next(e))}catch(e){s(e)}}function r(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,r)}a((i=i.apply(e,t||[])).next())}))};const y=function(e,o){return S(this,void 0,void 0,(function*(){var e,i,n,s;let l;const r=null===(s=null===(n=null===(i=null===(e=(0,t.getAppStore)().getState())||void 0===e?void 0:e.appConfig)||void 0===i?void 0:i.widgets[o])||void 0===n?void 0:n.useDataSources)||void 0===s?void 0:s[0],a=t.DataSourceManager.getInstance();return r&&(l=a.createDataSourceByUseDataSource(Object.assign({},r,{mainDataSourceId:r.mainDataSourceId}),"localId")),yield Promise.resolve(l)}))};class w extends t.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.1.0",description:"",upgrader:(e,t)=>S(this,void 0,void 0,(function*(){const i=e.filter;return yield y(0,t).then((t=>{let n=e;const s=i?(0,o.updateSQLExpressionByVersion)(i,"1.1.0",t):null;return n=n.set("filter",s),n}),(t=>e))}))},{version:"1.5.0",description:"1.5.0",upgrader:(e,t)=>S(this,void 0,void 0,(function*(){e.filter;return yield y(0,t).then((t=>{if(!t)return e;let o=e;if("boolean"!=typeof(null==e?void 0:e.isShowAutoRefresh)){const e=!!(i=t)&&((null==i?void 0:i.getAutoRefreshInterval())||0)>0;o=o.set("isShowAutoRefresh",e)}var i;return o}),(t=>e))}))},{version:"1.8.0",description:"1.8.0",upgrader:(e,t)=>{let o=e;if((null==e?void 0:e.direction)&&!(null==e?void 0:e.layoutType)){const t=(null==e?void 0:e.direction)===u.Horizon?p.Column:p.Row;o=o.set("layoutType",t).set("keepAspectRatio",!1)}return o}},{version:"1.13.0",description:"1.13.0",upgrader:(e,t)=>{let o=e;if((null==e?void 0:e.searchFields)&&"string"==typeof(null==e?void 0:e.searchFields)){const t=e.searchFields.split(",")||[];o=o.set("searchFields",t)}return o}},{version:"1.16.0",description:"1.16.0",upgrader:(e,t)=>{let o=e;return(null==o?void 0:o.pageStyle)===r.MultiPage&&(o=o.set("hidePageTotal",!1)),o}},{version:"1.18.0",description:"1.18.0",upgrader:(e,t)=>(e=>{let t=e;const o=e.cardConfigs,i=o[v.Default].cardSize;return Object.keys(o).forEach((e=>{const n=o[e].cardSize;e!==v.Default&&Object.keys(n).forEach((o=>{const s=n[o],l=i[o];s&&l&&((null==s?void 0:s.width)!==(null==l?void 0:l.width)||(null==s?void 0:s.height)!==(null==l?void 0:l.height))&&(t=t.setIn(["cardConfigs",e,"cardSize",o],l))}))})),t})(e)}]}}const b=new w,x={page:1,pageSize:1,dataSource:null,widgetRect:{width:i,height:i},currentCardSize:{width:i,height:i},scrollStatus:"start",isResizingCard:!1,records:[],isShowEditingMask:!1,queryStatus:null,dsInfo:null,showWidgetLoading:!0,showLoading:!1,hasDsLoadedRecord:!1,lastRefreshTime:null,searchText:null,showSelectionOnly:!1,filterApplied:!1,currentFilter:null,sortOptionName:null,showSortString:!1,firstItemIndexInViewport:0},I=(e,t)=>{switch(t.type){case"SET_PAGE":return Object.assign(Object.assign({},e),{page:t.value});case"SET_PAGE_SIZE":return Object.assign(Object.assign({},e),{pageSize:t.value});case"SET_DATA_SOURCE":return Object.assign(Object.assign({},e),{dataSource:t.value});case"SET_WIDGET_RECT":return Object.assign(Object.assign({},e),{widgetRect:t.value});case"SET_CURRENT_CARD_SIZE":return Object.assign(Object.assign({},e),{currentCardSize:t.value});case"SET_SCROLL_STATUS":return Object.assign(Object.assign({},e),{scrollStatus:t.value});case"SET_IS_RESIZING_CARD":return Object.assign(Object.assign({},e),{isResizingCard:t.value});case"SET_FIRST_ITEM_INDEX_IN_VIEWPORT":return Object.assign(Object.assign({},e),{firstItemIndexInViewport:t.value});case"SET_RECORDS":return Object.assign(Object.assign({},e),{records:t.value});case"SET_IS_SHOW_EDITING_MASK":return Object.assign(Object.assign({},e),{isShowEditingMask:t.value});case"SET_SEARCH_TEXT":return Object.assign(Object.assign({},e),{searchText:t.value});case"SET_SHOW_SELECTION_ONLY":return Object.assign(Object.assign({},e),{showSelectionOnly:t.value});case"SET_QUERY_STATUS":return Object.assign(Object.assign({},e),{queryStatus:t.value});case"SET_DS_INFO":return Object.assign(Object.assign({},e),{dsInfo:t.value});case"SET_FILTER_APPLIED":return Object.assign(Object.assign({},e),{filterApplied:t.value});case"SET_CURRENT_FILTRE":return Object.assign(Object.assign({},e),{currentFilter:t.value});case"SET_SORT_OPTION_NAME":return Object.assign(Object.assign({},e),{sortOptionName:t.value});case"SET_SHOW_SORT_STRING":return Object.assign(Object.assign({},e),{showSortString:t.value});case"SET_SHOW_WIDGET_LOADING":return Object.assign(Object.assign({},e),{showWidgetLoading:t.value});case"SET_HAS_DS_LOADED_RECORD":return Object.assign(Object.assign({},e),{hasDsLoadedRecord:t.value});case"SET_SHOW_LOADING":return Object.assign(Object.assign({},e),{showLoading:t.value});case"LAST_REFRESH_TIME":return Object.assign(Object.assign({},e),{lastRefreshTime:t.value});case"SET_LIST_RUNTIME_STATE":return Object.assign(Object.assign({},e),t.value);default:return e}},C=t.React.createContext(void 0),T=t.React.createContext(void 0),R=t.React.createContext(void 0),O=e=>{const{defaultState:o,children:i}=e,[n,s]=t.React.useReducer(I,o||x);return t.React.createElement(C.Provider,{value:n},t.React.createElement(T.Provider,{value:s},t.React.createElement(R.Provider,{value:{state:n,dispatch:s}},i)))},E=()=>t.React.useContext(C),M=()=>t.React.useContext(T);var j=a(14321);const D=t.utils.memoize((function(e){const{showTopTools:o,bottomToolH:i,pageStyle:s,scrollBarOpen:l,appMode:a,theme:c,isHeightAuto:d,isWidthAuto:h,listTemplateDefaultCardSize:g,layoutType:f,listLeftPadding:m}=e,v=o?n:0,S=f===p.Column?u.Horizon:u.Vertical,y=f===p.Column,w=f===p.Column?"column":"row";return t.css`
    &.list-container {
      /* position: ${d?"absolute":"relative"}; */
      position: relative;
      z-index: 0;
      overflow: hidden;
      .bottom-boundary {
        height: 2px;
        width: 2px;
        position: absolute;
        bottom: 0;
        right: 0;
        opacity: 0;
      }
      ${S===u.Horizon?`\n          margin-left: 0px;\n          height: ${d?"auto":"calc(100% - 1px)"};\n          width: ${h?"auto":"calc(100% - 0px)"};\n        `:`\n          margin-top: 0px;\n          width: ${h?"auto":"calc(100% - 1px)"};\n          height: ${d?"auto":"calc(100% - 0px)"};\n        `}
      .empty-con {
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        z-index: 10;
        transform: translateY(-50%);
        padding-top: ${v}px;
        .jimu-icon {
          color: ${c.sys.color.warning.dark};
        }
        .discribtion {
          margin: ${t.polished.rem(9)} 0 ${t.polished.rem(8)} 0;
          font-size: ${t.polished.rem(14)};
          color: ${c.ref.palette.black}
        }
        .clear-message-action-button {
          width: ${t.polished.rem(65)};
        }
      }

      .bottom-tools {
        position: relative;
        padding-top: ${t.polished.rem(14)};
        min-height: ${t.polished.rem(40)};
        .scroll-navigator {
          .btn {
            border-radius: 50%;
          }
        }
      }
      .widget-list-link-con {
        height: ${d?"auto":`calc(100% - ${v}px - ${i}px)`} !important;
        width: ${h?"auto":"100%"} !important;
        ${L(s,y,e.mexSize,v,i)}
      }
      .widget-list-list:focus {
        outline: none;
      }
      .widget-list-list {
        & {
          padding: 0;
          position: relative;
          padding-left: ${`${m}px`};
          display: flex;
          width: ${h?"auto":"100%"} !important;
          height: ${d?"auto":"100%"} !important;
        }
        &>div {
          position: relative;
          flex: 1;
          box-sizing: content-box;
        }
        /* box-sizing: border-box; */
        ${window.jimuConfig.isInBuilder&&a===t.AppMode.Design?"overflow: hidden !important;":`overflow-${y?"y":"x"}: hidden !important;`}

        ${`flex-direction: ${w}`};
        ${d&&`min-height: ${g.height}px;`};
        ${h&&`min-width: ${g.width}px;`};
        ${d&&L(s,y,e.mexSize,v,i)}
      }
      .hide-list {
        overflow: hidden !important;
      }
      .hide-will-change {
        will-change: auto !important;
      }
      ${s!==r.Scroll||l?"":"\n          .widget-list-list::-webkit-scrollbar {\n            display: none; //Safari and Chrome\n          }\n          .widget-list-list {\n              -ms-overflow-style: none; //IE 10+\n              overflow: -moz-scrollbars-none; //Firefox\n              scrollbar-width: none; /* Firefox */\n          }\n        "}
      .placeholder-alert-con {
        position: absolute;
        bottom: ${t.polished.rem(8)};
        right: ${t.polished.rem(8)};
        z-index: 11;
      }
    }
  `}));function L(e,t,o,i,n){return e===r.MultiPage?null:t?`max-width: ${o.maxWidth};`:`max-height: calc(${o.maxHeight} - ${i}px - ${n}px);`}function k(e,o,i){var n,s,l,r,a,c,d,p,h,g;const{config:f,id:m,appMode:v,isHeightAuto:S,isWidthAuto:y,theme:w}=e;return t.css`
    ${"&.list-widget-"+m} {
      overflow: visible;
      background-color: transparent;
      border: ${t.polished.rem(0)} solid ${t.polished.rgba(w.ref.palette.black,window.jimuConfig.isInBuilder&&o?.2:0)};
      height: ${S?"auto":"100%"};
      width: ${y?"auto":"100%"};
      .list-auto-refresh-button {
        padding: 0;
        svg {
          margin: 0;
        }
      }
      .list-with-mask {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        background-color: ${t.polished.rgba(w.ref.palette.black,0)};
        z-index: 1;
      }
      .list-toggle-button {
        background: none;
      }
      .list-loading-con {
        min-height: ${t.polished.rem(120)};
        min-width: ${t.polished.rem(160)};
      }
      .list-error-con {
        .alert-panel-of-list {
          border-radius: 0;
          text-align: left;
          left: ${t.polished.rem(4)};
          right: ${t.polished.rem(4)};
          bottom: ${t.polished.rem(4)};
          width: auto;
        }
      }
      .refresh-loading-con {
        right: 0;
        bottom:${i?t.polished.rem(40):0};
        align-items: center;
        height: ${t.polished.rem(18)};
        .auto-refresh-loading {
          background: ${null===(s=null===(n=null==w?void 0:w.ref.palette)||void 0===n?void 0:n.neutral)||void 0===s?void 0:s[200]};
          color: ${null===(l=w.ref.palette)||void 0===l?void 0:l.black};
          font-size: ${t.polished.rem(12)};
          line-height: ${t.polished.rem(18)};
          padding: 0 ${t.polished.rem(5)};
          .auto-refresh-string-con {
            padding: 0 ${t.polished.rem(2)};
          }
        }
        &.horizon-loading {
          bottom:${i?t.polished.rem(46):t.polished.rem(6)};
        }
        &.vertical-loading {
          right: ${t.polished.rem(6)};
        }
      }
      .loading-con {
        @keyframes loading {
          0% {transform: rotate(0deg); };
          100% {transform: rotate(360deg)};
        }
        width: ${t.polished.rem(16)};
        height: ${t.polished.rem(16)};
        border: 1px solid ${null===(a=null===(r=null==w?void 0:w.ref.palette)||void 0===r?void 0:r.neutral)||void 0===a?void 0:a[800]};
        border-radius: 50%;
        border-top: 1px solid ${null===(d=null===(c=null==w?void 0:w.ref.palette)||void 0===c?void 0:c.neutral)||void 0===d?void 0:d[1100]};
        box-sizing: border-box;
        animation:loading 2s infinite linear;
        margin-right: ${t.polished.rem(4)};
      }
      .widget-list {
        overflow: ${window.jimuConfig.isInBuilder&&v===t.AppMode.Design?"hidden":"auto"};
        height: ${S?"auto":"100%"};
        width: ${y?"auto":"100%"};
        /* align-items: ${f.alignType};
        justify-content: ${f.alignType}; */
        ${f.direction===u.Horizon?"\n            overflow-y: hidden;\n          ":"\n            overflow-x: hidden;\n          "}
      }
      .data-count {
        left: 0;
        bottom: 0;
        background: ${null===(h=null===(p=null==w?void 0:w.ref.palette)||void 0===p?void 0:p.neutral)||void 0===h?void 0:h[200]};
        color: ${null===(g=w.ref.palette)||void 0===g?void 0:g.black};
        font-size: ${t.polished.rem(12)};
        line-height: ${t.polished.rem(18)};
        padding: 0 ${t.polished.rem(5)};
      }
    }

  `}function z(e){return t.css`
    & {
      padding: ${t.polished.rem(6)} ${t.polished.rem(11)};
      height: ${t.polished.rem(40)};
    }
    .list-toggle-button {
      background: none;
    }
    .list-sort-con, .list-search-icon {
      margin-right: ${t.polished.rem(4)};
    }
    .ds-tools-line {
      width: 100%;
      height: 1px;
      background-color: ${e.ref.palette.neutral[500]};
    }
    .ds-tools-line-blue {
      background-color: ${e.sys.color.info.main};
    }
    .close-search {
      margin-top: ${t.polished.rem(-6)};
    }
    .list-search-div {
      svg {
        color: var(--ref-palette-neutral-1100) !important;
      }
    }
    div.list-sort-con {
      margin-left: 0;
    }
  `}function N(e){return t.css`
    .close-search {
      border: 1px solid ${e.ref.palette.neutral[500]};
      box-sizing: border-box;
      background-color: ${e.ref.palette.white};
    }
    .search-box-content {
      flex-direction: column;
      align-items: flex-start;
    }
  `}function P(e,o,i,s=!1){return t.css`
    .list-data-action {
      & {
        padding-left: ${t.polished.rem(4)};
      }
      &::after {
        content: '';
        position: absolute;
        left: 0;
        top: 50%;
        transform: translateY(-50%);
        height: ${t.polished.rem(16)};
        border-left: 1px solid ${e?"var(--ref-palette-neutral-500)":"transparent"}
      }
    }
    .top-right-tools-size-0 .list-sort-con{
      max-width: 90px;
    }
    .m-left {
      margin-left: ${t.polished.rem(4)};
    }
    &.datasource-tools {
      position: relative;
      height: ${t.polished.rem(n)};
      padding: ${t.polished.rem(4)} ${t.polished.rem(4)} ${t.polished.rem(14)} ${t.polished.rem(4)};
      .list-sort-con {
        margin-right: ${t.polished.rem(4)};
      }
      .sort-fields-input {
        width: 200px;
        margin-left: 8px;
        margin-right: 16px;
      }

      .tool-row {
        height: ${28}px;
      }
      .tools-con-max-size {
        width: ${s?"calc(100% - 40px)":"100%"};
      }
      .ds-tools-line {
        width: 100%;
        height: 1px;
        margin-top: ${t.polished.rem(3)};
        background-color: ${o.ref.palette.neutral[500]};
      }
      .ds-tools-line-blue {
        background-color: ${o.sys.color.info.main};
      }
      .list-search-div {
        width: calc(100% - ${i}px);
        .list-search {
          margin-bottom: -4px;
          width: 100%;
        }
      }
      .top-right-tools-size-3 {
        max-width: 73%;
      }
      .top-right-tools-size-2 {
        max-width: 65%;
      }
      .top-right-tools-size-1 {
        max-width: 55%;
      }
      .top-right-tools-size-0 {
        max-width: 85%;
      }
    }
    .tools-menu {
      color: var(--ref-palette-black);
      margin-top: 1px;
    }
    .tools-menu:hover {
      color: ${o.sys.color.info.main};
    }
  `}var A=a(41496);function _(e,t){return Math.abs(e-t)<1e-4}function $(e,t,o,i){if(!t||!o||!e)return!1;const n=null==e?void 0:e.haveMorePages(t,o),s=!n;let l=!1;if("unknown"===n){l=i>=(null==e?void 0:e.count)}else l=s;return l}function B(e,t,o,n){const s=F(e,t,o),l=j.utils.toLinearUnit(s.width);let r=W(j.utils.toLinearUnit(s.width),n.width+e.horizontalSpace-8);l.unit===j.DistanceUnits.PERCENTAGE&&(r=r-e.horizontalSpace>0?r-e.horizontalSpace:i);let a=W(j.utils.toLinearUnit(s.height),n.height);e.keepAspectRatio&&(null==e?void 0:e.layoutType)===p.GRID&&(null==e?void 0:e.gridItemSizeRatio)&&(a=r*(null==e?void 0:e.gridItemSizeRatio));return{width:r,height:a}}function F(e,t,o){var i;let n=null==e?void 0:e.asMutable({deep:!0}).cardConfigs[t];n&&n.cardSize||(n=null==e?void 0:e.asMutable({deep:!0}).cardConfigs[v.Default]);let s=null===(i=null==n?void 0:n.cardSize)||void 0===i?void 0:i[o];return s||(s=n.cardSize[Object.keys(n.cardSize)[0]]),s}function H(e,t,o){const n=F(e,t,o),s=j.utils.toLinearUnit(n.width);s.unit===j.DistanceUnits.PERCENTAGE&&(s.distance=s.distance-e.horizontalSpace>0?s.distance-e.horizontalSpace:i);return{width:s,height:j.utils.toLinearUnit(n.height)}}function W(e,t){return e.unit===j.DistanceUnits.PERCENTAGE?e.distance/100*t:e.distance}function U(e,t){let o=40;return e&&(o=e.clientHeight),o=t?o:0,o}function G(e,t,o){const i=o?n:0;if(!e)return 0;const s=e.height-i-t;return s<0?0:s}function V(e,t){return!(!t||e.pageStyle===r.Scroll&&!e.navigatorOpen)}function q(e,t,o){return K(t)||Y(e,t,o)}function K(e){return Q(e)||J(e)||ee(e)||X(e)||Z(e)||(null==e?void 0:e.showRefresh)}function Y(e,o,i){var n,s,l;const r=null===(s=null===(n=(0,t.getAppStore)())||void 0===n?void 0:n.getState())||void 0===s?void 0:s.appConfig,a=null===(l=null==r?void 0:r.widgets)||void 0===l?void 0:l[e];return(void 0===(null==a?void 0:a.enableDataAction)||(null==a?void 0:a.enableDataAction))&&function(e){return!!e&&!!e[0]}(i)&&o.isItemStyleConfirm}function Q(e){if(!e.sortOpen||!e.sorts||e.sorts.length<1)return!1;const t=e.sorts;let o=!1;return t.some((e=>(e.rule&&e.rule.some((e=>(e&&e.jimuFieldName&&(o=!0),o))),o))),o}function Z(e){return e.searchOpen&&!!e.searchFields}function X(e){return e.filterOpen&&!!e.filter}function J(e){return e.showSelectedOnlyOpen&&e.cardConfigs[v.Selected].selectionMode!==l.None}function ee(e){return e.showClearSelected&&e.cardConfigs[v.Selected].selectionMode!==l.None}function te(e,o){var i,n,s,l,r,a,c,d;if(null==o?void 0:o.background){const t=(null===(i=null==e?void 0:e.background)||void 0===i?void 0:i.asMutable({deep:!0}))||{},s=(null===(n=null==o?void 0:o.background)||void 0===n?void 0:n.asMutable({deep:!0}))||{};(null==s?void 0:s.color)&&(t.color=null==s?void 0:s.color),(null==s?void 0:s.fillType)&&(t.fillType=null==s?void 0:s.fillType),(null==s?void 0:s.image)&&(t.image=null==s?void 0:s.image),e=e.set("background",t)}if(null==o?void 0:o.borderRadius){const t=j.styleUtils.mixinBorderRadiusWithDynamicStyle(null===(s=null==o?void 0:o.borderRadius)||void 0===s?void 0:s.asMutable({deep:!0}),null===(l=null==e?void 0:e.borderRadius)||void 0===l?void 0:l.asMutable({deep:!0}));e=e.set("borderRadius",t)}if(null==o?void 0:o.border){const i=(null===(r=null==e?void 0:e.border)||void 0===r?void 0:r.color)?{border:null===(a=null==e?void 0:e.border)||void 0===a?void 0:a.asMutable({deep:!0})}:null===(c=null==e?void 0:e.border)||void 0===c?void 0:c.asMutable({deep:!0}),n=j.styleUtils.mixinBorderWithDynamicStyle(null===(d=null==o?void 0:o.border)||void 0===d?void 0:d.asMutable({deep:!0}),i);e=(0,t.Immutable)(Object.assign(Object.assign({},e),n))}if(null==e?void 0:e.border){const o=["border","borderLeft","borderRight","borderTop","borderBottom"];Object.keys(null==e?void 0:e.border).some((e=>o.includes(e)))&&(e=(0,t.Immutable)(Object.assign(Object.assign({},e),e.border)))}return e}const oe=(e,o,i,n)=>{if(!window.jimuConfig.isInBuilder)return!1;const s=e===t.AppMode.Design;return(i||n)&&window.jimuConfig.isInBuilder&&s&&o.isItemStyleConfirm};function ie(e,t){const o=e,i=Math.floor(o/t);return 0===o%t?i:i+1}function ne(e){return(null==e?void 0:e.showRecordCount)?null==e?void 0:e.showRecordCount:(null==e?void 0:e.pageStyle)===r.MultiPage&&!1===(null==e?void 0:e.hidePageTotal)}const se=(e,o)=>{var i,n,s,l,r;const a=(0,t.getAppStore)().getState().appConfig,{layouts:c}=a,d=re(e,o),u=null===(i=null==d?void 0:d[0])||void 0===i?void 0:i.layoutId,p=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.layoutItemId;return null===(r=null===(l=null===(s=null==c?void 0:c[u])||void 0===s?void 0:s.content)||void 0===l?void 0:l[p])||void 0===r?void 0:r.setting},le=e=>Number(e)?`${e}px`:"string"!=typeof e||(null==e?void 0:e.includes("px"))||(null==e?void 0:e.includes("rem"))?e:(null==e?void 0:e.includes("%"))?"100%":void 0,re=(e,o)=>{const i=(0,t.getAppStore)().getState().appConfig,n=A.searchUtils.getWidgetIdThatUseTheLayoutId(i,e);return A.searchUtils.getContentLayoutInfosInOneSizeMode(i,n,t.LayoutItemType.Widget,o)},ae=()=>({scrollWidth:document.documentElement.scrollWidth,scrollHeight:document.documentElement.scrollHeight,clientWidth:document.documentElement.clientWidth,clientHeight:document.documentElement.clientHeight}),ce=(e,t)=>{const o=(null==e?void 0:e.layoutType)===p.Column,i=(null==e?void 0:e.layoutType)===p.GRID?null==e?void 0:e.verticalSpace:null==e?void 0:e.space,n=t.width+i,s=t.height+i;return o?n:s},de=(e,t,o)=>{let n=t&&t.width||i;n-=8;const s=o.width+(null==e?void 0:e.horizontalSpace);return Math.floor((n-o.width)/s+1)||1},ue=(e,t,o,i)=>Math.ceil(e/de(t,o,i))||1,pe=e=>{const{rowIndex:t,columnIndex:o,config:i,widgetRect:n,currentCardSize:s}=e;return t*de(i,n,s)+o},he=(e,t,o)=>ge(e,t,o,"left"),ge=(e,t,o,n)=>{const s=t&&t.width||i,l=de(e,t,o)*(o.width+(null==e?void 0:e.horizontalSpace))-(null==e?void 0:e.horizontalSpace);let r;const a=s-l-8;switch(null==e?void 0:e.gridAlignment){case j.TextAlignValue.LEFT:r="left"===n?0:a;break;case j.TextAlignValue.RIGHT:r="left"===n?a:0;break;default:r=(s-l-8)/2}return(null==e?void 0:e.layoutType)===p.GRID&&r>0?r:0};function fe(e){const{lastScrollOffset:t,config:o,currentCardSize:i,columnCount:n,completelyVisibleItem:s}=e,l=ce(o,i),r=1*t/l;let a=s?Math.ceil(r):Math.floor(r);const c=s?0:(r-a)*l,d=(null==o?void 0:o.layoutType)===p.GRID?null==o?void 0:o.verticalSpace:null==o?void 0:o.space;return a=(null==o?void 0:o.layoutType)===p.GRID?a*n:a,c>l-d&&(a=(null==o?void 0:o.layoutType)===p.GRID?a+n:a+1),a}const me={_widgetLabel:"List",_widgetDescription:"A widget to display data in a list view.",_action_filter_label:"Filter",_layout_REGULAR_label:"Regular",_layout_DEFAULT_label:"Default",_layout_HOVER_label:"Hover",_layout_SELECTED_label:"Selected",applyTo:"Apply to {status}",listLoading:"Loading",pleaseSelect:"Please select",listNoData:"No data",selectSortFields:"Select sorting fields",clearFilter:"Clear filter",isolate:"Isolate",linkedToAnd:"Linked to {where1} and {where2}",linkedTo:"Linked to {where}",placeHolderTip:"Please select a list template.",showSelected:"Show selected",clearSelected:"Clear selected",listSorting:"Sorting",listSort:"Sort",guideStep2Title:"Template",guideStep2Content:"Click on a template and click start.",guideStep3Title:"Data",guideStep3Content:"Click on select data to add a data source.",guideStep4Title:"Add new data",guideStep4Content:"Click add new data to select a web map.",guideStep5Title:"Select data",guideStep5Content:"Click the feature layer in the select data panel and close the panel.",guideStep6Title:"Data",guideStep6Content:"Specifies the data source, allows you to filter the data and limit the number of features that appear in the list.",guideStep7Title:"Arrangement",guideStep7Content:"Click the expand icon to explore the Arrangement section. In here, it allows you to define the direction, height, spacing, and paging style for your list.",guideStep8Title:"States",guideStep8Content:"Click the expand icon to explore the available States. In this section, it provides a visual representation to communicate the state of the list items. There are three states: regular, selected, and hover. By default, the selected state is always on.",guideStep9Title:"Tools",guideStep9Content:"Click the expand icon to explore the available Tools. In here, you can include search, sort, filter, and show selected tools in your list.",guideStep10Title:"Select image",guideStep10Content:"Click the image widget to configure it in the content panel.",guideStep10Title2:"Image settings",guideStep10Content2:"Allows you to select the image source and other settings for your widget.",guideStep11Title:"Select text",guideStep11Content:"Click the text widget to add attributes in the widget toolbar.",guideStep11Title2:"Text settings",guideStep11Content2:"Provides the configurations and style, including adding dynamic content from the widget toolbar. ",guideStep12Title:"End of tour",guideStep12Content:"Add other widgets to enhance your experience.",clearSearch:"Clear search",minimize:"Minimize",topToolBack:"Back",showAllListRecords:"Show all records",listDataActionLabel:"{layer} list selection",searchResult:"Search result",describeMessage:"List item",listArea:"list area"};var ve=a(1888),Se=function(e,t,o,i){return new(o||(o=Promise))((function(n,s){function l(e){try{a(i.next(e))}catch(e){s(e)}}function r(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(l,r)}a((i=i.apply(e,t||[])).next())}))};function ye(e,t,o,i){var n,s;let l,r=[];if(!1===i)return r;if(t&&e&&(l=e.find((e=>e.ruleOptionName===o)),l=l||e[0],(null===(s=null===(n=null==l?void 0:l.rule)||void 0===n?void 0:n[0])||void 0===s?void 0:s.jimuFieldName)||(l=void 0),l)){const e=[];l.rule.forEach((t=>{t.jimuFieldName&&e.push(`${t.jimuFieldName} ${t.order}`)})),r=e}return r}var we=a(62838),be=a.n(we),xe=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Ie=e=>{const o=window.SVG,{className:i}=e,n=xe(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:be()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Ce=a(50170),Te=a.n(Ce),Re=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Oe=e=>{const o=window.SVG,{className:i}=e,n=Re(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Te()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Ee=a(96300),Me=a.n(Ee),je=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const De=e=>{const o=window.SVG,{className:i}=e,n=je(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Me()},n)):t.React.createElement("svg",Object.assign({className:s},n))},Le=new(0,t.esri.Sanitizer);class ke extends t.React.PureComponent{constructor(e){super(e),this.handleChange=e=>{this.setState({searchText:e,isShowSuggestion:(null==e?void 0:e.length)>2},(()=>{const{onSearchTextChange:t}=this.props;t&&t(e)}))},this.handleSubmit=(e,t=!1)=>{const{onSubmit:o}=this.props;o&&o(e,t)},this.onKeyUp=e=>{if(!e||!e.target)return;const{isShowSuggestion:o}=this.state;if("Enter"===e.key&&(this.setState({isShowSuggestion:!1}),this.handleSubmit(e.target.value,!0)),o){const o=this.getMenuItems()||[],i=(null==o?void 0:o.length)-1;"ArrowUp"===e.key?setTimeout((()=>{(0,t.focusElementInKeyboardMode)(o[i],!0)})):"ArrowDown"===e.key&&setTimeout((()=>{(0,t.focusElementInKeyboardMode)(this.containerRef,!0),(0,t.focusElementInKeyboardMode)(o[0],!0)}))}},this.onSuggestionConfirm=e=>{this.setState({searchText:e,isShowSuggestion:!1},(()=>{var t;this.handleSubmit(e),null===(t=this.props)||void 0===t||t.toggleSearchBoxVisible(!0)}))},this.handleClear=e=>{this.setState({searchText:""}),e.stopPropagation()},this.getStyle=()=>{var e,o,i,n,s,l;const{theme:r}=this.props;return t.css`
      position: relative;
      .search-input {
        margin-bottom: 2px;
        padding-left: 3px;
        border: 0;
        // border-bottom-width: 1px;
        // border-bottom-style: solid;
        // border-color: ${r.sys.color.primary.main};
        background: transparent;
        height: ${t.polished.rem(26)};
        min-width: 0;
        .input-wrapper {
          background: transparent;
          border: none;
          padding: 0;
          height: 100%;
        }
      }
      .search-input:focus {
        background: transparent;
      }
      .search-loading-con {
        @keyframes loading {
          0% {transform: rotate(0deg); };
          100% {transform: rotate(360deg)};
        }
        width: ${t.polished.rem(13)};
        height: ${t.polished.rem(13)};
        min-width: ${t.polished.rem(13)};
        border: 2px solid ${null===(o=null===(e=null==r?void 0:r.sys.color)||void 0===e?void 0:e.secondary)||void 0===o?void 0:o.light};
        border-radius: 50%;
        border-top: 2px solid ${null===(n=null===(i=null==r?void 0:r.sys.color)||void 0===i?void 0:i.primary)||void 0===n?void 0:n.main};
        box-sizing: border-box;
        animation:loading 2s infinite linear;
        margin-right: ${t.polished.rem(4)};
      }
      .clear-search, .search-back {
        cursor: pointer;
        padding: ${t.polished.rem(6)};
        background: none;
        border: none;
        color: ${null===(l=null===(s=null==r?void 0:r.ref.palette)||void 0===s?void 0:s.neutral)||void 0===l?void 0:l[1100]}
      }
      .search-back {
        margin-left: ${t.polished.rem(-6)};
      }
      .clear-search:hover {
        background: none;
      }
    `},this.getSuggestionListStyle=()=>{const{suggestionWidth:e}=this.props;return t.css`
      & {
        max-height: ${t.polished.rem(300)};
        min-width: ${t.polished.rem(e)};
        overflow: auto;
      }
      button {
        display: block;
        width: 100%;
        text-align: left;
        border: none;
        border-radius: 0;
      }
      .suggestion-item:focus {
        background: var(--sys-color-primary-main);
        color: var(--ref-palette-white);
      }
      button:hover {
        border: none;
      }
    `},this.clearSearchText=()=>{const{searchText:e}=this.state;e&&(this.handleChange(""),this.setState({isShowSuggestion:!1}))},this.getMenuItems=()=>this.containerRef?Array.prototype.slice.call(this.containerRef.querySelectorAll('[role="button"]')).filter((e=>!e.disabled)):[],this.getTextInputSuffixElement=()=>{const{theme:e,showLoading:o,formatMessage:i}=this.props,{searchText:n}=this.state;return(0,t.jsx)("div",{className:"d-flex align-items-center"},o&&(0,t.jsx)("div",{className:"search-loading-con"}),n&&(0,t.jsx)(j.Button,{className:"clear-search",icon:!0,size:"sm",onClick:this.clearSearchText,title:i("clearSearch"),"aria-label":i("clearSearch")},(0,t.jsx)(Ie,{size:14,color:e.ref.palette.neutral[1100]})))},this.getTextInputPrefixElement=()=>{const{theme:e,formatMessage:o}=this.props;return(0,t.jsx)(j.Button,{type:"tertiary",icon:!0,size:"sm",title:o("SearchLabel"),"aria-label":o("SearchLabel"),onClick:e=>{this.handleSubmit(this.state.searchText)}},(0,t.jsx)(Oe,{size:16,color:e.ref.palette.neutral[700]}))},this.handlePopperKeyDown=e=>{const{isShowSuggestion:o}=this.state;if(!o)return;const i="button"===e.target.getAttribute("role");if(["Tab","ArrowUp","ArrowDown"].includes(e.key)&&((e.which>=48&&e.which<=90||"Tab"===e.key)&&e.preventDefault(),o&&i))if("Escape"===e.key)this.handleEscEvent(e);else if(["ArrowUp","ArrowDown"].includes(e.key)||["n","p"].includes(e.key)&&e.ctrlKey){const o=this.getMenuItems();let i=o.indexOf(e.target),n=!1;"ArrowUp"===e.key||"p"===e.key&&e.ctrlKey?(i=0!==i?i-1:o.length-1,n=!0):("ArrowDown"===e.key||"n"===e.key&&e.ctrlKey)&&(n=!1,i=i===o.length-1?0:i+1);const s=0===i&&!n,l=i===o.length-1&&n;clearTimeout(this.focusTimeout),this.focusTimeout=s||l?setTimeout((()=>{(0,t.focusElementInKeyboardMode)(this.searchInputRef,!0)})):setTimeout((()=>{(0,t.focusElementInKeyboardMode)(this.containerRef,!0),(0,t.focusElementInKeyboardMode)(o[i],!0)}))}else if("End"===e.key){const e=this.getMenuItems();(0,t.focusElementInKeyboardMode)(e[e.length-1],!0)}else if("Home"===e.key){const e=this.getMenuItems();(0,t.focusElementInKeyboardMode)(e[0],!0)}else if(e.which>=48&&e.which<=90){const o=this.getMenuItems(),i=String.fromCharCode(e.which).toLowerCase();for(let e=0;e<o.length;e+=1){if((o[e].textContent&&o[e].textContent[0].toLowerCase())===i){(0,t.focusElementInKeyboardMode)(o[e],!0);break}}}},this.handleEscEvent=e=>{const{isShowSuggestion:o}=this.state;e.preventDefault(),this.setState({isShowSuggestion:!o}),(0,t.focusElementInKeyboardMode)(this.searchInputRef)},this.setInputRef=e=>{const{inputRef:t}=this.props;this.searchInputRef=e,t&&t(e)},this.state={searchText:e.searchText||"",isShowSuggestion:!1}}componentDidUpdate(e){var o;if(this.props.searchText!==e.searchText&&this.props.searchText!==this.state.searchText){const{searchText:e}=this.props;this.setState({searchText:e})}(null===(o=this.props)||void 0===o?void 0:o.appMode)===t.AppMode.Design&&this.state.isShowSuggestion&&this.setState({isShowSuggestion:!1,searchText:""})}render(){const{placeholder:e,className:o,showClear:i,hideSearchIcon:n,onFocus:s,onBlur:l,theme:r,searchSuggestion:a,formatMessage:c,isShowBackButton:d}=this.props,{searchText:u,isShowSuggestion:p}=this.state;return(0,t.jsx)("div",{className:"w-100",ref:e=>{this.reference=e}},(0,t.jsx)("div",{css:this.getStyle(),className:`d-flex align-items-center ${o}`},d&&(0,t.jsx)(j.Button,{className:"search-back",icon:!0,size:"sm",onClick:e=>{var t;null===(t=this.props)||void 0===t||t.toggleSearchBoxVisible(!1)},title:c("topToolBack"),"aria-label":c("topToolBack")},(0,t.jsx)(De,{size:20,color:r.ref.palette.neutral[1100]})),(0,t.jsx)(j.TextInput,{className:"search-input flex-grow-1",ref:e=>{this.setInputRef(e)},placeholder:e,"aria-label":e,onChange:e=>{this.handleChange(e.target.value)},onBlur:l,onFocus:s,title:u||e,value:u||"",onKeyDown:e=>{this.onKeyUp(e)},prefix:!n&&!d&&this.getTextInputPrefixElement(),suffix:this.getTextInputSuffixElement()}),i&&(0,t.jsx)(j.Button,{id:"test-focus",icon:!0,size:"sm",onClick:this.handleSubmit,"aria-label":c("clearSearch")},(0,t.jsx)(Ie,{size:12,color:r.ref.palette.neutral[1100]}))),(0,t.jsx)("div",null,(0,t.jsx)(j.Popper,{css:this.getSuggestionListStyle(),placement:"bottom-start",reference:this.reference,offsetOptions:8,open:p,autoFocus:!1,hideOptions:!1,toggle:e=>{this.setState({isShowSuggestion:!p})}},(0,t.jsx)("div",{ref:e=>{this.containerRef=e},onKeyDown:this.handlePopperKeyDown},a.map(((e,o)=>{const i=Le.sanitize(e.suggestionHtml);return(0,t.jsx)(j.Button,{key:o,type:"secondary",size:"sm",role:"button",title:null==e?void 0:e.suggestion,"aria-label":null==e?void 0:e.suggestion,className:"suggestion-item",onClick:()=>{this.onSuggestionConfirm(e.suggestion)}},(0,t.jsx)("div",{className:"w-100",dangerouslySetInnerHTML:{__html:i}}))}))))))}}var ze=a(76219),Ne=a.n(ze),Pe=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Ae=e=>{const o=window.SVG,{className:i}=e,n=Pe(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Ne()},n)):t.React.createElement("svg",Object.assign({className:s},n))};class _e extends t.React.PureComponent{constructor(e){super(e),this.onDropDownToggle=e=>{e.stopPropagation();const{isDropDownOpen:t,onDropDownOpenChange:o}=this.props;if(void 0!==t)o&&o(!t);else{const{isOpen:e}=this.state;this.setState({isOpen:!e})}},this.onItemClick=(e,t)=>{const{isDropDownOpen:o,onDropDownOpenChange:i}=this.props;void 0!==o?i&&i(!1):this.setState({isOpen:!1}),t.event(e,t),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.onDropDownMouseClick=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.getStyle=()=>{var e,o,i,n;const{theme:s}=this.props;return t.css`
      & button {
        padding: 0;
      }
      .list-toggle-button {
        background: ${null===(o=null===(e=null==s?void 0:s.ref.palette)||void 0===e?void 0:e.neutral)||void 0===o?void 0:o[500]};
        border: none;
        &:hover, &[aria-expanded="true"] {
          background: ${null===(n=null===(i=null==s?void 0:s.ref.palette)||void 0===i?void 0:i.neutral)||void 0===n?void 0:n[700]};
        }
      }
    `},this.state={isOpen:!1};const{withBuilderTheme:o}=e;this.MyDropdown=o?o(j.Dropdown):j.Dropdown,this.MyDropdownButton=o?o(j.DropdownButton):j.DropdownButton,this.MyDropdownMenu=o?o(j.DropdownMenu):j.DropdownMenu,this.MyDropdownItem=o?o(j.DropdownItem):j.DropdownItem}render(){const{items:e,toggleContent:o,toggleType:i,toggleArrow:n,menuContent:s,appMode:l,modifiers:r,toggleIsIcon:a,theme:c,isDropDownOpen:d,size:u,appendToBody:p,toggleTitle:h,direction:g,menuCss:f,className:m,showActive:v,activeLabel:S,fluid:y,activeIcon:w}=this.props;let{isOpen:b}=this.state;b=void 0===d?b:d;const{MyDropdown:x,MyDropdownButton:I,MyDropdownMenu:C,MyDropdownItem:T}=this;return(0,t.jsx)(x,{size:u,toggle:this.onDropDownToggle,direction:g,fluid:y,isOpen:b&&l!==t.AppMode.Design,className:`my-dropdown ${m}`,css:this.getStyle(),activeIcon:w,menuRole:"listbox"},o&&(0,t.jsx)(I,{icon:a,title:h,size:u,type:i,className:"list-toggle-button",arrow:n,role:"combobox"},o&&o(c)),(0,t.jsx)(C,{appendToBody:p,modifiers:r,css:f&&f(c),referenceHiddenVisibility:!0},s?s(c):e&&e.asMutable().map(((e,o)=>!e.hide&&(0,t.jsx)(T,{key:o,className:"no-user-select",title:e.label,active:v&&e.label===S,onClick:t=>{this.onItemClick(t,e)}},e.label)))))}}const{useEffect:$e,useState:Be,useRef:Fe}=t.React,{useSelector:He}=t.ReactRedux,We=t.css`
  & {
    max-width: 150px;
  }
  .list-toggle-button:hover, .list-toggle-button {
    background: none !important;
  }
  .dropdown-btn-con {
    color: var(--ref-palette-black);
    padding-left: ${t.polished.rem(7)};
    padding-right: ${t.polished.rem(7)};
    svg {
      margin-right: ${t.polished.rem(4)} !important;
    }
  }
  .dropdown-btn-con:hover {
    color: var(--sys-color-primary-main);
  }
`,Ue=e=>{const o=(0,ve.useTheme)(),i=He((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),n=He((e=>null==e?void 0:e.widgetsState)),s=Fe(null),l=Fe(null),r=t.hooks.useTranslation(me,j.defaultMessages,t.defaultMessages),{handleSortOptionChange:a,sorts:c,dataSource:d,sortOptionName:u,id:p,showSortString:h}=e,[g,f]=Be(null);$e((()=>{S()}),[c]),$e((()=>{v()}),[]);const m=(e,t)=>{a(null==t?void 0:t.label),v()},v=()=>{var e,o;for(const i in n)if((null===(e=n[i])||void 0===e?void 0:e.listWidget)&&(null===(o=n[i])||void 0===o?void 0:o.dsId)===(null==d?void 0:d.id)){const e=p===i;(0,t.getAppStore)().dispatch(t.appActions.widgetStatePropChange(i,"activeSort",e))}},S=()=>{const e=[];c&&c.forEach((t=>{t.rule&&t.rule.forEach((o=>{o&&o.jimuFieldName&&e.push({label:t.ruleOptionName,event:m})}))})),s.current=(0,t.Immutable)(e),f((0,t.Immutable)(e))},y=t.hooks.useEventCallback((e=>{var o,i;let n;return n=h?r("listSort"):e||(null===(i=null===(o=s.current)||void 0===o?void 0:o[0])||void 0===i?void 0:i.label),l.current=n,(0,t.jsx)("div",{className:"d-flex align-items-center dropdown-btn-con",title:n,"aria-label":n},(0,t.jsx)(Ae,null),(0,t.jsx)("span",{className:"flex-grow-1 w-100 text-truncate"},n))}));return(0,t.jsx)("div",{className:"list-sort-con d-flex align-items-center flex-grow-1 w-100",css:We},(0,t.jsx)(_e,{theme:o,items:g,appMode:i,toggleType:"tertiary",toggleArrow:!1,toggleContent:e=>y(u),size:"sm",showActive:!0,activeIcon:!0,activeLabel:l.current,className:"w-100"}))};var Ge=a(68972),Ve=a(47569),qe=a.n(Ve),Ke=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Ye=e=>{const o=window.SVG,{className:i}=e,n=Ke(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:qe()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Qe=a(29435),Ze=a.n(Qe),Xe=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Je=e=>{const o=window.SVG,{className:i}=e,n=Xe(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Ze()},n)):t.React.createElement("svg",Object.assign({className:s},n))},et={boundary:document.body,fallbackPlacements:["bottom-start","right-end","top-start","left-start"]};class tt extends t.React.PureComponent{constructor(e){super(e),this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.onPopperToggle=e=>{const{filter:o}=this.props,{isOpen:i}=this.state;i||this.setState({currentFilter:o}),this.setState({isOpen:!i}),i&&(0,t.focusElementInKeyboardMode)(this.toggleRef.current)},this.onItemClick=(e,t)=>{this.closePopper(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.handleFilterChange=e=>{this.setState({currentFilter:e})},this.handleApplyClick=e=>{const{currentFilter:t}=this.state,{handleFilterApplyChange:o,handleFilterChange:i}=this.props;i(t),o(!0),this.closePopper()},this.closePopper=()=>{this.setState({isOpen:!1}),(0,t.focusElementInKeyboardMode)(this.toggleRef.current)},this.handleResetClick=e=>{const{handleFilterApplyChange:t,handleFilterChange:o}=this.props;t(!1),o(this.props.filterInConfig),this.setState({currentFilter:this.props.filterInConfig})},this.handleClearClick=e=>{const{handleFilterApplyChange:t}=this.props;t(!1),this.closePopper()},this.getStyle=()=>{const{theme:e}=this.props;return t.css`
      position: relative;
      .dot {
        position: absolute;
        width: 6px;
        height: 6px;
        right: -2px;
        top: 0px;
        .dot-bottom {
          width: 6px;
          height: 6px;
          background-color: transparent;
          .dot-top {
            width: 4px;
            height: 4px;
            background-color: ${e.ref.palette.neutral[1e3]};
          }
        }
      }
      :hover {
        .dot-top {
          background-color: ${e.sys.color.primary.main};
        }
      }
      & .active {
        .dot-top {
          background-color: ${e.ref.palette.white};
        }
        :hover {
          .dot-top {
            background-color: ${e.ref.palette.white};
          }
        }
      }
    `},this.getPopperStyle=()=>t.css`
      & .popper-box{
        max-height: ${document.documentElement.clientHeight}px;
        overflow: auto;
      }
      .filter-button-con  {
        & {
          text-align: right;
        }
        button {
          max-width: ${t.polished.rem(92)};
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
        button svg {
          margin-right: 0 !important;
        }
        .reset-button {
          padding-left: ${t.polished.rem(5)};
          padding-right: ${t.polished.rem(5)};
        }
      }
      .clear-button, .reset-button {
        margin-left: ${t.polished.rem(8)};
      }
    `,this.toggleRef=t.React.createRef(),this.state={isOpen:!1,currentFilter:e.filter}}componentDidUpdate(e){const{filter:o,appMode:i}=this.props;o!==e.filter&&this.setState({currentFilter:o}),i!==e.appMode&&i===t.AppMode.Design&&this.setState({isOpen:!1})}render(){const{filter:e,selectedDs:i,widgetId:n,title:s,applied:l}=this.props,{isOpen:r,currentFilter:a}=this.state,c=l&&(null==e?void 0:e.sql)===(null==a?void 0:a.sql);return(0,t.jsx)(Ge.Fragment,null,(0,t.jsx)(j.Button,{css:this.getStyle(),size:"sm",type:"tertiary",icon:!0,title:s,"aria-label":s,ref:this.toggleRef,onClick:this.onPopperToggle,"aria-haspopup":"dialog","aria-expanded":r},(0,t.jsx)(Ye,{size:16}),l&&(0,t.jsx)("div",{className:"dot align-items-center justify-content-center"},(0,t.jsx)("div",{className:"dot-bottom rounded-circle"},(0,t.jsx)("div",{className:"dot-top rounded-circle"})))),(0,t.jsx)(j.Popper,{placement:"bottom-start",reference:this.toggleRef.current,offsetOptions:5,toggle:this.onPopperToggle,css:this.getPopperStyle(),open:r,flipOptions:et,hideOptions:!1},(0,t.jsx)("div",{style:{padding:t.polished.rem(20),width:t.polished.rem(250)}},(0,t.jsx)("div",null,(0,t.jsx)(o.SqlExpressionRuntime,{widgetId:n,dataSource:i,expression:a,onChange:this.handleFilterChange})),(0,t.jsx)("div",{className:"w-100 mt-4 filter-button-con"},(0,t.jsx)(j.Button,{disabled:c,onClick:this.handleApplyClick,type:"primary",title:this.formatMessage("apply"),size:"sm"},this.formatMessage("apply")),(0,t.jsx)(j.Button,{disabled:!l,onClick:this.handleClearClick,title:this.formatMessage("commonModalCancel"),className:"clear-button",size:"sm"},this.formatMessage("commonModalCancel")),(0,t.jsx)(j.Button,{onClick:this.handleResetClick,title:this.formatMessage("resetFilters"),className:"reset-button",size:"sm"},(0,t.jsx)(Je,{size:"s"}))))))}}var ot=a(7835),it=a.n(ot),nt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const st=e=>{const o=window.SVG,{className:i}=e,n=nt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:it()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var lt=a(27964),rt=a.n(lt),at=a(20904),ct=a.n(at),dt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const ut=e=>{const o=window.SVG,{className:i}=e,n=dt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component has-rtl-svg",i);return o?t.React.createElement(o,Object.assign({className:s,src:rt(),srcRTL:ct()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var pt=a(4583),ht=a.n(pt),gt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const ft=e=>{const o=window.SVG,{className:i}=e,n=gt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:ht()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var mt=a(4651),vt=a.n(mt),St=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const yt=e=>{const o=window.SVG,{className:i}=e,n=St(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:vt()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var wt=a(21935),bt=a.n(wt),xt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const It=e=>{const o=window.SVG,{className:i}=e,n=xt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:bt()},n)):t.React.createElement("svg",Object.assign({className:s},n))},{useState:Ct,useRef:Tt,useEffect:Rt}=t.React,Ot=e=>{var o;const n=Tt(null),s=Tt(null),l=Tt(null),r=Tt(null),a=Tt(null),c=(0,ve.useTheme)(),d=M(),u=t.hooks.useTranslation(me,j.defaultMessages,t.defaultMessages),p=E(),{searchText:h,dataSource:g,showSelectionOnly:f,widgetRect:m,queryStatus:v,filterApplied:S,currentFilter:y,showSortString:w,sortOptionName:b,showLoading:x}=E(),I=t.ReactRedux.useSelector((e=>null==e?void 0:e.browserSizeMode)),C=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),T=t.ReactRedux.useSelector((t=>{var o,i;return null===(i=null===(o=null==t?void 0:t.appConfig.widgets)||void 0===o?void 0:o[e.id])||void 0===i?void 0:i.enableDataAction})),{selectRecords:R,id:O,config:D,useDataSources:L}=e,{isEditing:k,scrollToIndex:_,handleRefreshList:$,selectRecordsAndPublishMessageAction:B,updateTopToolsContainer:F}=e,[H,W]=Ct(null),[U,G]=Ct(null),[V,q]=Ct(null),[te,oe]=Ct([]),[ie,ne]=Ct(!1),[se,le]=Ct(!1),[re,ae]=Ct(!1),[ce,de]=Ct(!1);Rt((()=>{var e,t;d({type:"SET_SORT_OPTION_NAME",value:null===(t=null===(e=null==D?void 0:D.sorts)||void 0===e?void 0:e[0])||void 0===t?void 0:t.ruleOptionName})}),[]),Rt((()=>{const e=u("listDataActionLabel",{layer:(null==g?void 0:g.getLabel())||""});G(e)}),[g]),Rt((()=>{const e=Y(O,D,null==L?void 0:L.asMutable({deep:!0}));de(e)}),[O,D,L,T]),Rt((()=>{ne(K(D)),ue(D),pe(D),a.current=D}),[D]),Rt((()=>{q(ce?250:175)}),[ce]),Rt((()=>{W((null==m?void 0:m.width)||620)}),[m]),Rt((()=>{C!==t.AppMode.Design&&(d({type:"SET_SEARCH_TEXT",value:void 0}),d({type:"SET_FILTER_APPLIED",value:void 0}))}),[C]);const ue=e=>{var t;if(e.filterOpen){e.filter!==(null===(t=a.current)||void 0===t?void 0:t.filter)&&(d({type:"SET_FILTER_APPLIED",value:!1}),d({type:"SET_CURRENT_FILTRE",value:void 0}))}},pe=e=>{var t;if(e.sortOpen){e.sorts!==(null===(t=a.current)||void 0===t?void 0:t.sorts)&&(d({type:"showSortString",value:!1}),d({type:"SET_SORT_OPTION_NAME",value:void 0}))}},he=t.hooks.useEventCallback((()=>{d({type:"SET_SHOW_SELECTION_ONLY",value:!f})})),ge=()=>{d({type:"SET_SHOW_SELECTION_ONLY",value:!1}),B([])},fe=t.hooks.useEventCallback((e=>{const t=Object.assign(Object.assign({},p),{sortOptionName:e,showSortString:!1,page:1,scrollStatus:"start"});d({type:"SET_LIST_RUNTIME_STATE",value:t}),_(0)})),ye=(e=!1)=>{le(e);H<(ce?250:175)&&(clearTimeout(l.current),l.current=setTimeout((()=>{ae(!0)})))},we=e=>{""!==e&&e||xe(void 0,!1),oe([]),clearTimeout(r.current),r.current=setTimeout((()=>{be(e)}),200)},be=e=>{if((null==e?void 0:e.length)<3)return!1;(function(e,o,i){return Se(this,void 0,void 0,(function*(){var n;const s={searchText:e,searchFields:(null===(n=null==o?void 0:o.searchFields)||void 0===n?void 0:n.asMutable({deep:!0}))||[],dataSource:i,exact:null==o?void 0:o.searchExact};return t.dataSourceUtils.querySuggestions(s)}))})(e,D,g).then((e=>{oe(e)}))},xe=(e,o=!1)=>{(h!==e||o)&&(d({type:"SET_PAGE",value:1}),d({type:"SET_SEARCH_TEXT",value:e}),t.MessageManager.getInstance().publishMessage(new t.DataSourceFilterChangeMessage(O,[g.id])))},Ie=()=>{const e=m&&m.width||i;return e>580?"top-right-tools-size-3":e>480?"top-right-tools-size-2":e>370?"top-right-tools-size-1":"top-right-tools-size-0"},Ce=e=>{d({type:"SET_CURRENT_FILTRE",value:e}),d({type:"SET_PAGE",value:1}),t.MessageManager.getInstance().publishMessage(new t.DataSourceFilterChangeMessage(O,[g.id]))},Te=e=>{d({type:"SET_FILTER_APPLIED",value:e}),t.MessageManager.getInstance().publishMessage(new t.DataSourceFilterChangeMessage(O,[g.id]))},Re=(e,o)=>{const i=e&&e.getSelectedRecords(),n=i&&i.length>0;return(0,t.jsx)("div",{className:(0,t.classNames)("d-flex align-items-center mr-1",Ie()),ref:e=>{s.current=e,F(e)}},Q(D)&&(0,t.jsx)(Ue,{sortOptionName:b,dataSource:e,sorts:D.sorts,handleSortOptionChange:fe,id:O,showSortString:w}),(0,t.jsx)("div",{className:"flex-grow-1 d-flex align-items-center"},X(D)&&(0,t.jsx)(tt,{filter:y||D.filter,filterInConfig:D.filter,appMode:C,applied:S,title:u("filter"),selectedDs:e,handleFilterChange:Ce,handleFilterApplyChange:Te,formatMessage:u,theme:c,widgetId:O}),(null==D?void 0:D.showRefresh)&&(0,t.jsx)(j.Button,{type:"tertiary",title:u("refresh"),icon:!0,size:"sm",onClick:()=>{$(e)}},(0,t.jsx)(It,{size:16})),J(D)&&(0,t.jsx)(j.Button,{disabled:!n,type:"tertiary",title:u(f?"showAll":"showSelection"),icon:!0,size:"sm",onClick:he},(0,t.jsx)(st,{className:(0,t.classNames)({"sr-only":!f}),size:16}),(0,t.jsx)(ut,{className:(0,t.classNames)({"sr-only":f}),size:16})),ee(D)&&(0,t.jsx)(j.Button,{disabled:!n,type:"tertiary",title:u("clearSelection"),icon:!0,size:"sm",onClick:ge},(0,t.jsx)(ft,{size:16}))))},Ee=(e,o)=>{const i=k||!e||o!==t.DataSourceStatus.Loaded,n=H<360?"ds-tools-line-blue":"",s=(null==D?void 0:D.searchHint)||u("search"),l=H<360&&se;return(0,t.jsx)("div",{className:"list-search-div flex-grow-1 h-100",css:N(c)},Z(D)&&(0,t.jsx)("div",{className:"d-flex search-box-content"},(H>=360||se)&&(0,t.jsx)("div",{className:"flex-grow-1 w-100"},(0,t.jsx)(ke,{theme:c,placeholder:s,searchText:h,onSearchTextChange:we,onSubmit:xe,disabled:i,searchSuggestion:te,suggestionWidth:H,showLoading:x,formatMessage:u,isShowBackButton:l,toggleSearchBoxVisible:ye,className:"list-search",appMode:C}),(0,t.jsx)("div",{className:(0,t.classNames)("ds-tools-line",n)})),H<360&&!se&&(0,t.jsx)(j.Button,{type:"tertiary",icon:!0,size:"sm",onClick:e=>{ye(!0)},className:"list-search-icon",title:u("search"),"aria-label":u("search")},(0,t.jsx)(Oe,{size:16,color:c.ref.palette.neutral[700]}))))},Me=g&&ce;return(0,t.jsx)("div",{className:"datasource-tools w-100",css:P(ie,c,(null===(o=s.current)||void 0===o?void 0:o.clientWidth)||0,Me)},(0,t.jsx)("div",{className:"d-flex align-items-center"},(0,t.jsx)("div",{className:"flex-grow-1 tool-row tools-con-max-size"},ie&&(0,t.jsx)("div",{className:"w-100"},H>=V&&(0,t.jsx)("div",{className:"tool-row row1 d-flex w-100 align-items-center justify-content-between"},Ee(g,v),(!se||H>=360)&&Re(g)),H<V&&(0,t.jsx)("div",{className:"float-right",ref:e=>{n.current=e}},(0,t.jsx)(j.Button,{type:"tertiary",icon:!0,size:"sm",className:"tools-menu",title:u("guideStep9Title"),onClick:e=>{ae(!re)}},(0,t.jsx)(yt,{size:16})),((e,o)=>{const i=k,s=((null==m?void 0:m.width)||620)<(ce?250:175)&&re&&!i;return(0,t.jsx)("div",null,(0,t.jsx)(j.Popper,{placement:"bottom-start",reference:n.current,offsetOptions:[-10,0],open:s,arrowOptions:!0,hideOptions:!1,toggle:e=>{ae(!s)}},(0,t.jsx)("div",{className:"tool-row row1 d-flex align-items-center justify-content-between",css:z(c)},Ee(e,o),!se&&Re(e))))})(g,v)))),Me&&(0,t.jsx)("div",{className:(0,t.classNames)("list-data-action position-relative",{"m-left":H<V}),"data-testid":"data-action"},(0,t.jsx)(j.DataActionList,{widgetId:O,dataSets:[{dataSource:g,records:R,name:U,type:"selected",fields:(()=>{var e,o,i;const n=null===(e=(0,t.getAppStore)().getState())||void 0===e?void 0:e.appConfig,s=(null===(i=null===(o=null==n?void 0:n.widgets)||void 0===o?void 0:o[O])||void 0===i?void 0:i.layouts)||{};let l=Object.keys(s).map((e=>s[e][I]))||[];l=Array.from(new Set(l));let r=[];l.forEach((e=>{const o=A.searchUtils.getContentsInLayoutWithRecursiveLayouts(n,e,t.LayoutItemType.Widget,I)||[];r=r.concat(o)})),r=Array.from(new Set(r));let a=[];return r.forEach((e=>{var t,o,i;const s=(null===(i=null===(o=null===(t=n.widgets[e])||void 0===t?void 0:t.useDataSources)||void 0===o?void 0:o[0])||void 0===i?void 0:i.fields)||[];a=a.concat(s)})),Array.from(new Set(a))})()}],listStyle:j.DataActionListStyle.Dropdown,buttonType:"tertiary",buttonSize:"sm"}))))};var Et=a(37568),Mt=a.n(Et),jt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Dt=e=>{const o=window.SVG,{className:i}=e,n=jt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Mt()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Lt=a(94064),kt=a.n(Lt),zt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Nt=e=>{const o=window.SVG,{className:i}=e,n=zt(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:kt()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Pt=a(52943),At=a.n(Pt),_t=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const $t=e=>{const o=window.SVG,{className:i}=e,n=_t(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:At()},n)):t.React.createElement("svg",Object.assign({className:s},n))};var Bt=a(30655),Ft=a.n(Bt),Ht=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const Wt=e=>{const o=window.SVG,{className:i}=e,n=Ht(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Ft()},n)):t.React.createElement("svg",Object.assign({className:s},n))},{useState:Ut,useEffect:Gt,useRef:Vt}=t.React;function qt(e){const o=Vt(1),i=Vt(null),n=Vt(null),{isScrollEnd:s,hidePageTotal:l,config:a}=e,{handleScrollDown:c,handleScrollUp:d,updatePage:u}=e,h=t.hooks.useTranslation(me,j.defaultMessages,t.defaultMessages),{page:g,scrollStatus:f,records:m,dataSource:v,dsInfo:S,pageSize:y,showLoading:w}=E(),b=M(),x=t.ReactRedux.useSelector((e=>e.appContext.isRTL)),[I,C]=Ut(!1),[T,R]=Ut(0),[O,D]=Ut(0);Gt((()=>{var e;(null===(e=n.current)||void 0===e?void 0:e.id)!==(null==v?void 0:v.id)&&(o.current=1),N(v,null==S?void 0:S.status,g),P(v),A(v,null==S?void 0:S.status,a),n.current=v}),[v,S,a,g]),Gt((()=>{var e,t;const n=null===(e=i.current)||void 0===e?void 0:e.pageStyle,s=(null==a?void 0:a.pageStyle)!==n,l=(null==a?void 0:a.hidePageTotal)!==(null===(t=i.current)||void 0===t?void 0:t.hidePageTotal);(s||l)&&(o.current=1),i.current=a}),[a]),Gt((()=>{const e=null==m?void 0:m.length;L(v,g,y,e),k(v,O,a,g,e)}),[v,y,S,m,a,O,g]);const L=(e,t,o,i)=>{const n=$(e,t,o,i),s=$(e,t+1,o,i);C(n||s)},k=(e,t,i,n,s)=>{const l=$(e,n,y,s);let r;!1===(null==i?void 0:i.hidePageTotal)?r=ie(t,i.itemsPerPage):l||s<y?(o.current=n,r=n):r=n===o.current?o.current+1:o.current,R(r)},z=t.hooks.useEventCallback(((e,t,i)=>{if(!e)return!1;return!$(v,o.current,i,t)&&t>=i})),N=(e,i,n)=>{i===t.DataSourceStatus.Loaded&&i&&n>o.current&&(o.current=n)},P=t.hooks.useEventCallback((e=>{const t=null==m?void 0:m.length;if(o.current<2)return;const i=$(e,o.current,y,t),n=$(e,o.current-1,y,t);i&&n&&b({type:"SET_PAGE",value:1})})),A=(e,o,i)=>{if(!ne(i))return;const n=null==e?void 0:e.count;o===t.DataSourceStatus.Loaded&&null!==n&&D(n)},_=t.hooks.useEventCallback((e=>{const t=ie(O,a.itemsPerPage);t&&(e<1||e>t)||u(e,!0)}));return t.React.createElement("div",{className:"bottom-tools w-100 d-flex align-items-center justify-content-center pl-2 pr-2"},a.pageStyle===r.MultiPage&&t.React.createElement(j.Pagination,{size:"sm",totalPage:T,current:g,onChangePage:_,disabled:w,showEndEllipsis:z(l,null==m?void 0:m.length,y),isLastPage:I}),a.pageStyle!==r.MultiPage&&t.React.createElement("div",{className:"d-flex scroll-navigator"},t.React.createElement(j.Button,{title:h("previous"),disabled:"start"===f||(null==m?void 0:m.length)<=y,type:"secondary",size:"sm",icon:!0,onClick:d},a.layoutType===p.Column?t.React.createElement(Dt,{size:12}):t.React.createElement(Nt,{size:12})),t.React.createElement(j.Button,{title:h("next"),disabled:"end"===f||s,type:"secondary",size:"sm",style:x?{marginRight:t.polished.rem(10)}:{marginLeft:t.polished.rem(10)},icon:!0,onClick:c},a.layoutType===p.Column?t.React.createElement($t,null):t.React.createElement(Wt,null))))}function Kt(){return Kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)({}).hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},Kt.apply(null,arguments)}function Yt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qt(e,t){return Qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qt(e,t)}function Zt(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Qt(e,t)}var Xt=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Jt(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(i=e[o],n=t[o],!(i===n||Xt(i)&&Xt(n)))return!1;var i,n;return!0}const eo=function(e,t){var o;void 0===t&&(t=Jt);var i,n=[],s=!1;return function(){for(var l=[],r=0;r<arguments.length;r++)l[r]=arguments[r];return s&&o===this&&t(l,n)||(i=e.apply(this,l),s=!0,o=this,n=l),i}};var to="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()};function oo(e){cancelAnimationFrame(e.id)}function io(e,t){var o=to();var i={id:requestAnimationFrame((function n(){to()-o>=t?e.call(null):i.id=requestAnimationFrame(n)}))};return i}var no=-1;function so(e){if(void 0===e&&(e=!1),-1===no||e){var t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",document.body.appendChild(t),no=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return no}var lo=null;function ro(e){if(void 0===e&&(e=!1),null===lo||e){var t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";var i=document.createElement("div"),n=i.style;return n.width="100px",n.height="100px",t.appendChild(i),document.body.appendChild(t),t.scrollLeft>0?lo="positive-descending":(t.scrollLeft=1,lo=0===t.scrollLeft?"negative":"positive-ascending"),document.body.removeChild(t),lo}return lo}var ao=function(e){var t=e.columnIndex;e.data;return e.rowIndex+":"+t};function co(e){var t,o=e.getColumnOffset,i=e.getColumnStartIndexForOffset,n=e.getColumnStopIndexForStartIndex,s=e.getColumnWidth,l=e.getEstimatedTotalHeight,r=e.getEstimatedTotalWidth,a=e.getOffsetForColumnAndAlignment,c=e.getOffsetForRowAndAlignment,d=e.getRowHeight,u=e.getRowOffset,p=e.getRowStartIndexForOffset,h=e.getRowStopIndexForStartIndex,g=e.initInstanceProps,f=e.shouldResetStyleCacheOnItemSizeChange,m=e.validateProps;return(t=function(e){function t(t){var i;return(i=e.call(this,t)||this)._instanceProps=g(i.props,Yt(i)),i._resetIsScrollingTimeoutId=null,i._outerRef=void 0,i.state={instance:Yt(i),isScrolling:!1,horizontalScrollDirection:"forward",scrollLeft:"number"==typeof i.props.initialScrollLeft?i.props.initialScrollLeft:0,scrollTop:"number"==typeof i.props.initialScrollTop?i.props.initialScrollTop:0,scrollUpdateWasRequested:!1,verticalScrollDirection:"forward"},i._callOnItemsRendered=void 0,i._callOnItemsRendered=eo((function(e,t,o,n,s,l,r,a){return i.props.onItemsRendered({overscanColumnStartIndex:e,overscanColumnStopIndex:t,overscanRowStartIndex:o,overscanRowStopIndex:n,visibleColumnStartIndex:s,visibleColumnStopIndex:l,visibleRowStartIndex:r,visibleRowStopIndex:a})})),i._callOnScroll=void 0,i._callOnScroll=eo((function(e,t,o,n,s){return i.props.onScroll({horizontalScrollDirection:o,scrollLeft:e,scrollTop:t,verticalScrollDirection:n,scrollUpdateWasRequested:s})})),i._getItemStyle=void 0,i._getItemStyle=function(e,t){var n,l=i.props,r=l.columnWidth,a=l.direction,c=l.rowHeight,p=i._getItemStyleCache(f&&r,f&&a,f&&c),h=e+":"+t;if(p.hasOwnProperty(h))n=p[h];else{var g=o(i.props,t,i._instanceProps),m="rtl"===a;p[h]=n={position:"absolute",left:m?void 0:g,right:m?g:void 0,top:u(i.props,e,i._instanceProps),height:d(i.props,e,i._instanceProps),width:s(i.props,t,i._instanceProps)}}return n},i._getItemStyleCache=void 0,i._getItemStyleCache=eo((function(e,t,o){return{}})),i._onScroll=function(e){var t=e.currentTarget,o=t.clientHeight,n=t.clientWidth,s=t.scrollLeft,l=t.scrollTop,r=t.scrollHeight,a=t.scrollWidth;i.setState((function(e){if(e.scrollLeft===s&&e.scrollTop===l)return null;var t=i.props.direction,c=s;if("rtl"===t)switch(ro()){case"negative":c=-s;break;case"positive-descending":c=a-n-s}c=Math.max(0,Math.min(c,a-n));var d=Math.max(0,Math.min(l,r-o));return{isScrolling:!0,horizontalScrollDirection:e.scrollLeft<s?"forward":"backward",scrollLeft:c,scrollTop:d,verticalScrollDirection:e.scrollTop<l?"forward":"backward",scrollUpdateWasRequested:!1}}),i._resetIsScrollingDebounced)},i._outerRefSetter=function(e){var t=i.props.outerRef;i._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},i._resetIsScrollingDebounced=function(){null!==i._resetIsScrollingTimeoutId&&oo(i._resetIsScrollingTimeoutId),i._resetIsScrollingTimeoutId=io(i._resetIsScrolling,150)},i._resetIsScrolling=function(){i._resetIsScrollingTimeoutId=null,i.setState({isScrolling:!1},(function(){i._getItemStyleCache(-1)}))},i}Zt(t,e),t.getDerivedStateFromProps=function(e,t){return uo(e,t),m(e),null};var v=t.prototype;return v.scrollTo=function(e){var t=e.scrollLeft,o=e.scrollTop;void 0!==t&&(t=Math.max(0,t)),void 0!==o&&(o=Math.max(0,o)),this.setState((function(e){return void 0===t&&(t=e.scrollLeft),void 0===o&&(o=e.scrollTop),e.scrollLeft===t&&e.scrollTop===o?null:{horizontalScrollDirection:e.scrollLeft<t?"forward":"backward",scrollLeft:t,scrollTop:o,scrollUpdateWasRequested:!0,verticalScrollDirection:e.scrollTop<o?"forward":"backward"}}),this._resetIsScrollingDebounced)},v.scrollToItem=function(e){var t=e.align,o=void 0===t?"auto":t,i=e.columnIndex,n=e.rowIndex,s=this.props,d=s.columnCount,u=s.height,p=s.rowCount,h=s.width,g=this.state,f=g.scrollLeft,m=g.scrollTop,v=so();void 0!==i&&(i=Math.max(0,Math.min(i,d-1))),void 0!==n&&(n=Math.max(0,Math.min(n,p-1)));var S=l(this.props,this._instanceProps),y=r(this.props,this._instanceProps)>h?v:0,w=S>u?v:0;this.scrollTo({scrollLeft:void 0!==i?a(this.props,i,o,f,this._instanceProps,w):f,scrollTop:void 0!==n?c(this.props,n,o,m,this._instanceProps,y):m})},v.componentDidMount=function(){var e=this.props,t=e.initialScrollLeft,o=e.initialScrollTop;if(null!=this._outerRef){var i=this._outerRef;"number"==typeof t&&(i.scrollLeft=t),"number"==typeof o&&(i.scrollTop=o)}this._callPropsCallbacks()},v.componentDidUpdate=function(){var e=this.props.direction,t=this.state,o=t.scrollLeft,i=t.scrollTop;if(t.scrollUpdateWasRequested&&null!=this._outerRef){var n=this._outerRef;if("rtl"===e)switch(ro()){case"negative":n.scrollLeft=-o;break;case"positive-ascending":n.scrollLeft=o;break;default:var s=n.clientWidth,l=n.scrollWidth;n.scrollLeft=l-s-o}else n.scrollLeft=Math.max(0,o);n.scrollTop=Math.max(0,i)}this._callPropsCallbacks()},v.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&oo(this._resetIsScrollingTimeoutId)},v.render=function(){var e=this.props,t=e.children,o=e.className,i=e.columnCount,n=e.direction,s=e.height,a=e.innerRef,c=e.innerElementType,d=e.innerTagName,u=e.itemData,p=e.itemKey,h=void 0===p?ao:p,g=e.outerElementType,f=e.outerTagName,m=e.rowCount,v=e.style,S=e.useIsScrolling,y=e.width,w=this.state.isScrolling,b=this._getHorizontalRangeToRender(),x=b[0],I=b[1],C=this._getVerticalRangeToRender(),T=C[0],R=C[1],O=[];if(i>0&&m)for(var E=T;E<=R;E++)for(var M=x;M<=I;M++)O.push((0,Ge.createElement)(t,{columnIndex:M,data:u,isScrolling:S?w:void 0,key:h({columnIndex:M,data:u,rowIndex:E}),rowIndex:E,style:this._getItemStyle(E,M)}));var j=l(this.props,this._instanceProps),D=r(this.props,this._instanceProps);return(0,Ge.createElement)(g||f||"div",{className:o,onScroll:this._onScroll,ref:this._outerRefSetter,style:Kt({position:"relative",height:s,width:y,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:n},v)},(0,Ge.createElement)(c||d||"div",{children:O,ref:a,style:{height:j,pointerEvents:w?"none":void 0,width:D}}))},v._callPropsCallbacks=function(){var e=this.props,t=e.columnCount,o=e.onItemsRendered,i=e.onScroll,n=e.rowCount;if("function"==typeof o&&t>0&&n>0){var s=this._getHorizontalRangeToRender(),l=s[0],r=s[1],a=s[2],c=s[3],d=this._getVerticalRangeToRender(),u=d[0],p=d[1],h=d[2],g=d[3];this._callOnItemsRendered(l,r,u,p,a,c,h,g)}if("function"==typeof i){var f=this.state,m=f.horizontalScrollDirection,v=f.scrollLeft,S=f.scrollTop,y=f.scrollUpdateWasRequested,w=f.verticalScrollDirection;this._callOnScroll(v,S,m,w,y)}},v._getHorizontalRangeToRender=function(){var e=this.props,t=e.columnCount,o=e.overscanColumnCount,s=e.overscanColumnsCount,l=e.overscanCount,r=e.rowCount,a=this.state,c=a.horizontalScrollDirection,d=a.isScrolling,u=a.scrollLeft,p=o||s||l||1;if(0===t||0===r)return[0,0,0,0];var h=i(this.props,u,this._instanceProps),g=n(this.props,h,u,this._instanceProps),f=d&&"backward"!==c?1:Math.max(1,p),m=d&&"forward"!==c?1:Math.max(1,p);return[Math.max(0,h-f),Math.max(0,Math.min(t-1,g+m)),h,g]},v._getVerticalRangeToRender=function(){var e=this.props,t=e.columnCount,o=e.overscanCount,i=e.overscanRowCount,n=e.overscanRowsCount,s=e.rowCount,l=this.state,r=l.isScrolling,a=l.verticalScrollDirection,c=l.scrollTop,d=i||n||o||1;if(0===t||0===s)return[0,0,0,0];var u=p(this.props,c,this._instanceProps),g=h(this.props,u,c,this._instanceProps),f=r&&"backward"!==a?1:Math.max(1,d),m=r&&"forward"!==a?1:Math.max(1,d);return[Math.max(0,u-f),Math.max(0,Math.min(s-1,g+m)),u,g]},t}(Ge.PureComponent)).defaultProps={direction:"ltr",itemData:void 0,useIsScrolling:!1},t}var uo=function(e,t){e.children,e.direction,e.height,e.innerTagName,e.outerTagName,e.overscanColumnsCount,e.overscanCount,e.overscanRowsCount,e.width,t.instance},po=function(e,t){var o=e.rowCount,i=t.rowMetadataMap,n=t.estimatedRowHeight,s=t.lastMeasuredRowIndex,l=0;if(s>=o&&(s=o-1),s>=0){var r=i[s];l=r.offset+r.size}return l+(o-s-1)*n},ho=function(e,t){var o=e.columnCount,i=t.columnMetadataMap,n=t.estimatedColumnWidth,s=t.lastMeasuredColumnIndex,l=0;if(s>=o&&(s=o-1),s>=0){var r=i[s];l=r.offset+r.size}return l+(o-s-1)*n},go=function(e,t,o,i){var n,s,l;if("column"===e?(n=i.columnMetadataMap,s=t.columnWidth,l=i.lastMeasuredColumnIndex):(n=i.rowMetadataMap,s=t.rowHeight,l=i.lastMeasuredRowIndex),o>l){var r=0;if(l>=0){var a=n[l];r=a.offset+a.size}for(var c=l+1;c<=o;c++){var d=s(c);n[c]={offset:r,size:d},r+=d}"column"===e?i.lastMeasuredColumnIndex=o:i.lastMeasuredRowIndex=o}return n[o]},fo=function(e,t,o,i){var n,s;return"column"===e?(n=o.columnMetadataMap,s=o.lastMeasuredColumnIndex):(n=o.rowMetadataMap,s=o.lastMeasuredRowIndex),(s>0?n[s].offset:0)>=i?mo(e,t,o,s,0,i):vo(e,t,o,Math.max(0,s),i)},mo=function(e,t,o,i,n,s){for(;n<=i;){var l=n+Math.floor((i-n)/2),r=go(e,t,l,o).offset;if(r===s)return l;r<s?n=l+1:r>s&&(i=l-1)}return n>0?n-1:0},vo=function(e,t,o,i,n){for(var s="column"===e?t.columnCount:t.rowCount,l=1;i<s&&go(e,t,i,o).offset<n;)i+=l,l*=2;return mo(e,t,o,Math.min(i,s-1),Math.floor(i/2),n)},So=function(e,t,o,i,n,s,l){var r="column"===e?t.width:t.height,a=go(e,t,o,s),c="column"===e?ho(t,s):po(t,s),d=Math.max(0,Math.min(c-r,a.offset)),u=Math.max(0,a.offset-r+l+a.size);switch("smart"===i&&(i=n>=u-r&&n<=d+r?"auto":"center"),i){case"start":return d;case"end":return u;case"center":return Math.round(u+(d-u)/2);default:return n>=u&&n<=d?n:u>d||n<u?u:d}},yo=co({getColumnOffset:function(e,t,o){return go("column",e,t,o).offset},getColumnStartIndexForOffset:function(e,t,o){return fo("column",e,o,t)},getColumnStopIndexForStartIndex:function(e,t,o,i){for(var n=e.columnCount,s=e.width,l=go("column",e,t,i),r=o+s,a=l.offset+l.size,c=t;c<n-1&&a<r;)c++,a+=go("column",e,c,i).size;return c},getColumnWidth:function(e,t,o){return o.columnMetadataMap[t].size},getEstimatedTotalHeight:po,getEstimatedTotalWidth:ho,getOffsetForColumnAndAlignment:function(e,t,o,i,n,s){return So("column",e,t,o,i,n,s)},getOffsetForRowAndAlignment:function(e,t,o,i,n,s){return So("row",e,t,o,i,n,s)},getRowOffset:function(e,t,o){return go("row",e,t,o).offset},getRowHeight:function(e,t,o){return o.rowMetadataMap[t].size},getRowStartIndexForOffset:function(e,t,o){return fo("row",e,o,t)},getRowStopIndexForStartIndex:function(e,t,o,i){for(var n=e.rowCount,s=e.height,l=go("row",e,t,i),r=o+s,a=l.offset+l.size,c=t;c<n-1&&a<r;)c++,a+=go("row",e,c,i).size;return c},initInstanceProps:function(e,t){var o=e,i={columnMetadataMap:{},estimatedColumnWidth:o.estimatedColumnWidth||50,estimatedRowHeight:o.estimatedRowHeight||50,lastMeasuredColumnIndex:-1,lastMeasuredRowIndex:-1,rowMetadataMap:{}};return t.resetAfterColumnIndex=function(e,o){void 0===o&&(o=!0),t.resetAfterIndices({columnIndex:e,shouldForceUpdate:o})},t.resetAfterRowIndex=function(e,o){void 0===o&&(o=!0),t.resetAfterIndices({rowIndex:e,shouldForceUpdate:o})},t.resetAfterIndices=function(e){var o=e.columnIndex,n=e.rowIndex,s=e.shouldForceUpdate,l=void 0===s||s;"number"==typeof o&&(i.lastMeasuredColumnIndex=Math.min(i.lastMeasuredColumnIndex,o-1)),"number"==typeof n&&(i.lastMeasuredRowIndex=Math.min(i.lastMeasuredRowIndex,n-1)),t._getItemStyleCache(-1),l&&t.forceUpdate()},i},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.columnWidth,e.rowHeight}}),wo=function(e,t){return e};function bo(e){var t,o=e.getItemOffset,i=e.getEstimatedTotalSize,n=e.getItemSize,s=e.getOffsetForIndexAndAlignment,l=e.getStartIndexForOffset,r=e.getStopIndexForStartIndex,a=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=function(e){function t(t){var i;return(i=e.call(this,t)||this)._instanceProps=a(i.props,Yt(i)),i._outerRef=void 0,i._resetIsScrollingTimeoutId=null,i.state={instance:Yt(i),isScrolling:!1,scrollDirection:"forward",scrollOffset:"number"==typeof i.props.initialScrollOffset?i.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},i._callOnItemsRendered=void 0,i._callOnItemsRendered=eo((function(e,t,o,n){return i.props.onItemsRendered({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:o,visibleStopIndex:n})})),i._callOnScroll=void 0,i._callOnScroll=eo((function(e,t,o){return i.props.onScroll({scrollDirection:e,scrollOffset:t,scrollUpdateWasRequested:o})})),i._getItemStyle=void 0,i._getItemStyle=function(e){var t,s=i.props,l=s.direction,r=s.itemSize,a=s.layout,d=i._getItemStyleCache(c&&r,c&&a,c&&l);if(d.hasOwnProperty(e))t=d[e];else{var u=o(i.props,e,i._instanceProps),p=n(i.props,e,i._instanceProps),h="horizontal"===l||"horizontal"===a,g="rtl"===l,f=h?u:0;d[e]=t={position:"absolute",left:g?void 0:f,right:g?f:void 0,top:h?0:u,height:h?"100%":p,width:h?p:"100%"}}return t},i._getItemStyleCache=void 0,i._getItemStyleCache=eo((function(e,t,o){return{}})),i._onScrollHorizontal=function(e){var t=e.currentTarget,o=t.clientWidth,n=t.scrollLeft,s=t.scrollWidth;i.setState((function(e){if(e.scrollOffset===n)return null;var t=i.props.direction,l=n;if("rtl"===t)switch(ro()){case"negative":l=-n;break;case"positive-descending":l=s-o-n}return l=Math.max(0,Math.min(l,s-o)),{isScrolling:!0,scrollDirection:e.scrollOffset<l?"forward":"backward",scrollOffset:l,scrollUpdateWasRequested:!1}}),i._resetIsScrollingDebounced)},i._onScrollVertical=function(e){var t=e.currentTarget,o=t.clientHeight,n=t.scrollHeight,s=t.scrollTop;i.setState((function(e){if(e.scrollOffset===s)return null;var t=Math.max(0,Math.min(s,n-o));return{isScrolling:!0,scrollDirection:e.scrollOffset<t?"forward":"backward",scrollOffset:t,scrollUpdateWasRequested:!1}}),i._resetIsScrollingDebounced)},i._outerRefSetter=function(e){var t=i.props.outerRef;i._outerRef=e,"function"==typeof t?t(e):null!=t&&"object"==typeof t&&t.hasOwnProperty("current")&&(t.current=e)},i._resetIsScrollingDebounced=function(){null!==i._resetIsScrollingTimeoutId&&oo(i._resetIsScrollingTimeoutId),i._resetIsScrollingTimeoutId=io(i._resetIsScrolling,150)},i._resetIsScrolling=function(){i._resetIsScrollingTimeoutId=null,i.setState({isScrolling:!1},(function(){i._getItemStyleCache(-1,null)}))},i}Zt(t,e),t.getDerivedStateFromProps=function(e,t){return xo(e,t),d(e),null};var u=t.prototype;return u.scrollTo=function(e){e=Math.max(0,e),this.setState((function(t){return t.scrollOffset===e?null:{scrollDirection:t.scrollOffset<e?"forward":"backward",scrollOffset:e,scrollUpdateWasRequested:!0}}),this._resetIsScrollingDebounced)},u.scrollToItem=function(e,t){void 0===t&&(t="auto");var o=this.props,i=o.itemCount,n=o.layout,l=this.state.scrollOffset;e=Math.max(0,Math.min(e,i-1));var r=0;if(this._outerRef){var a=this._outerRef;r="vertical"===n?a.scrollWidth>a.clientWidth?so():0:a.scrollHeight>a.clientHeight?so():0}this.scrollTo(s(this.props,e,t,l,this._instanceProps,r))},u.componentDidMount=function(){var e=this.props,t=e.direction,o=e.initialScrollOffset,i=e.layout;if("number"==typeof o&&null!=this._outerRef){var n=this._outerRef;"horizontal"===t||"horizontal"===i?n.scrollLeft=o:n.scrollTop=o}this._callPropsCallbacks()},u.componentDidUpdate=function(){var e=this.props,t=e.direction,o=e.layout,i=this.state,n=i.scrollOffset;if(i.scrollUpdateWasRequested&&null!=this._outerRef){var s=this._outerRef;if("horizontal"===t||"horizontal"===o)if("rtl"===t)switch(ro()){case"negative":s.scrollLeft=-n;break;case"positive-ascending":s.scrollLeft=n;break;default:var l=s.clientWidth,r=s.scrollWidth;s.scrollLeft=r-l-n}else s.scrollLeft=n;else s.scrollTop=n}this._callPropsCallbacks()},u.componentWillUnmount=function(){null!==this._resetIsScrollingTimeoutId&&oo(this._resetIsScrollingTimeoutId)},u.render=function(){var e=this.props,t=e.children,o=e.className,n=e.direction,s=e.height,l=e.innerRef,r=e.innerElementType,a=e.innerTagName,c=e.itemCount,d=e.itemData,u=e.itemKey,p=void 0===u?wo:u,h=e.layout,g=e.outerElementType,f=e.outerTagName,m=e.style,v=e.useIsScrolling,S=e.width,y=this.state.isScrolling,w="horizontal"===n||"horizontal"===h,b=w?this._onScrollHorizontal:this._onScrollVertical,x=this._getRangeToRender(),I=x[0],C=x[1],T=[];if(c>0)for(var R=I;R<=C;R++)T.push((0,Ge.createElement)(t,{data:d,key:p(R,d),index:R,isScrolling:v?y:void 0,style:this._getItemStyle(R)}));var O=i(this.props,this._instanceProps);return(0,Ge.createElement)(g||f||"div",{className:o,onScroll:b,ref:this._outerRefSetter,style:Kt({position:"relative",height:s,width:S,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:n},m)},(0,Ge.createElement)(r||a||"div",{children:T,ref:l,style:{height:w?"100%":O,pointerEvents:y?"none":void 0,width:w?O:"100%"}}))},u._callPropsCallbacks=function(){if("function"==typeof this.props.onItemsRendered&&this.props.itemCount>0){var e=this._getRangeToRender(),t=e[0],o=e[1],i=e[2],n=e[3];this._callOnItemsRendered(t,o,i,n)}if("function"==typeof this.props.onScroll){var s=this.state,l=s.scrollDirection,r=s.scrollOffset,a=s.scrollUpdateWasRequested;this._callOnScroll(l,r,a)}},u._getRangeToRender=function(){var e=this.props,t=e.itemCount,o=e.overscanCount,i=this.state,n=i.isScrolling,s=i.scrollDirection,a=i.scrollOffset;if(0===t)return[0,0,0,0];var c=l(this.props,a,this._instanceProps),d=r(this.props,c,a,this._instanceProps),u=n&&"backward"!==s?1:Math.max(1,o),p=n&&"forward"!==s?1:Math.max(1,o);return[Math.max(0,c-u),Math.max(0,Math.min(t-1,d+p)),c,d]},t}(Ge.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var xo=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},Io=function(e,t,o){var i=e.itemSize,n=o.itemMetadataMap,s=o.lastMeasuredIndex;if(t>s){var l=0;if(s>=0){var r=n[s];l=r.offset+r.size}for(var a=s+1;a<=t;a++){var c=i(a);n[a]={offset:l,size:c},l+=c}o.lastMeasuredIndex=t}return n[t]},Co=function(e,t,o,i,n){for(;i<=o;){var s=i+Math.floor((o-i)/2),l=Io(e,s,t).offset;if(l===n)return s;l<n?i=s+1:l>n&&(o=s-1)}return i>0?i-1:0},To=function(e,t,o,i){for(var n=e.itemCount,s=1;o<n&&Io(e,o,t).offset<i;)o+=s,s*=2;return Co(e,t,Math.min(o,n-1),Math.floor(o/2),i)},Ro=function(e,t){var o=e.itemCount,i=t.itemMetadataMap,n=t.estimatedItemSize,s=t.lastMeasuredIndex,l=0;if(s>=o&&(s=o-1),s>=0){var r=i[s];l=r.offset+r.size}return l+(o-s-1)*n},Oo=bo({getItemOffset:function(e,t,o){return Io(e,t,o).offset},getItemSize:function(e,t,o){return o.itemMetadataMap[t].size},getEstimatedTotalSize:Ro,getOffsetForIndexAndAlignment:function(e,t,o,i,n,s){var l=e.direction,r=e.height,a=e.layout,c=e.width,d="horizontal"===l||"horizontal"===a?c:r,u=Io(e,t,n),p=Ro(e,n),h=Math.max(0,Math.min(p-d,u.offset)),g=Math.max(0,u.offset-d+u.size+s);switch("smart"===o&&(o=i>=g-d&&i<=h+d?"auto":"center"),o){case"start":return h;case"end":return g;case"center":return Math.round(g+(h-g)/2);default:return i>=g&&i<=h?i:i<g?g:h}},getStartIndexForOffset:function(e,t,o){return function(e,t,o){var i=t.itemMetadataMap,n=t.lastMeasuredIndex;return(n>0?i[n].offset:0)>=o?Co(e,t,n,0,o):To(e,t,Math.max(0,n),o)}(e,o,t)},getStopIndexForStartIndex:function(e,t,o,i){for(var n=e.direction,s=e.height,l=e.itemCount,r=e.layout,a=e.width,c="horizontal"===n||"horizontal"===r?a:s,d=Io(e,t,i),u=o+c,p=d.offset+d.size,h=t;h<l-1&&p<u;)h++,p+=Io(e,h,i).size;return h},initInstanceProps:function(e,t){var o={itemMetadataMap:{},estimatedItemSize:e.estimatedItemSize||50,lastMeasuredIndex:-1};return t.resetAfterIndex=function(e,i){void 0===i&&(i=!0),o.lastMeasuredIndex=Math.min(o.lastMeasuredIndex,e-1),t._getItemStyleCache(-1),i&&t.forceUpdate()},o},shouldResetStyleCacheOnItemSizeChange:!1,validateProps:function(e){e.itemSize}});class Eo extends t.React.Component{constructor(){super(...arguments),this.shouldComponentUpdateExcept=(e,t,o,i=[])=>{let n=!1;return this.props&&Object.keys(this.props).some((t=>!o.includes(t)&&(this.props[t]!==e[t]&&(n=!0,!0)))),this.state&&Object.keys(this.state).some((e=>!i.includes(e)&&(this.state[e]!==t[e]&&(n=!0,!0)))),n},this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.getStyle=e=>{const{widgetId:o,config:i,appMode:n}=this.props,s=i.cardConfigs[v.Selected].selectionMode!==l.None,r=this.checkIsBackgroundTransparent(e);return t.css`
      ${"&.list-card-"+o} {
        padding: 0;
        border: 0;
        background-color: transparent;
        .list-card-content {
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
      }
      .flex-row-layout {
        width: 100%;
      }
      &.surface-1 {
        border: none !important;
        background: ${r&&"none !important"};
      }
      .list-item-con {
        overflow: hidden;
      }
      ${"&.list-card-"+o}:hover {
        ${window.jimuConfig.isInBuilder&&n===t.AppMode.Design||!s?"":"cursor: pointer;"}
      }
      .card-editor-mask {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 100;
      }
      .jimu-link {
        text-align: left;
      }
    `}}checkIsBackgroundTransparent(e){var t,o,i,n;const{config:s}=this.props;return"rgba(0,0,0,0)"===(null===(n=null===(i=null===(o=null===(t=null==s?void 0:s.cardConfigs)||void 0===t?void 0:t[e])||void 0===o?void 0:o.backgroundStyle)||void 0===i?void 0:i.background)||void 0===n?void 0:n.color)}}class Mo extends Eo{constructor(e){super(e),this.handleItemChange=e=>{const{onChange:t,active:o,record:i}=this.props;if(o){this.checkIsClickItemButtonOrA(e)||"linkClick"===e.exbEventType||t(i)}else t(i);"linkClick"===e.exbEventType&&delete e.exbEventType},this.handleContentClick=e=>{const{updateCanClickLinkWhenClickItem:t,active:o,record:i}=this.props;if(o){this.checkIsClickItemButtonOrA(e)||"linkClick"===e.exbEventType||t(i)}else t(i)},this.checkIsClickItemButtonOrA=e=>{const t=e.target;if(!t)return!1;const o=e.target&&e.target.tagName||"",i=t.closest("button")||t.closest("a");return"a"===o.toLowerCase()||"button"===o.toLowerCase()||i},this.handleItemKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||this.handleItemChange(e)},this.handleLinkClick=e=>{e.stopPropagation()},this.isItemAccept=(e,o)=>{const{isEditing:i,builderSupportModules:n,widgetId:s,appMode:l}=this.props;return function(e,t,o,i,n){var s,l;if(!e)return!1;const r=null===(l=null===(s=e.manifest)||void 0===s?void 0:s.properties)||void 0===l?void 0:l.supportRepeat,a=n.jimuForBuilderLib.getAppConfigAction().appConfig,c=n.widgetModules.selectionInList;return o&&r&&(!e.layoutInfo||e.layoutInfo&&c(e.layoutInfo,i,a,!1))}(e,0,l===t.AppMode.Express?window.jimuConfig.isInBuilder:i,s,n)},this.onClickCapture=e=>{clearTimeout(this.clickCaptureTimeoutRef),e.target&&this.layoutRef.current.contains(e.target)&&(this.clickCaptureTimeoutRef=setTimeout((()=>{this.handleItemChange(e)})))},this.getLayoutAndCurrentStatus=()=>{const{active:e,layouts:o,appMode:i,isHover:n,config:s}=this.props,{cardConfigs:r}=s,a=r[v.Selected].selectionMode!==l.None,c=r[v.Hover].enable;let d=v.Default;let u;return window.jimuConfig.isInBuilder&&i===t.AppMode.Design?u=o[v.Default]:(u=o[v.Default],c&&n&&(d=v.Hover,u=null==o?void 0:o[v.Hover]),a&&e&&(d=v.Selected,u=null==o?void 0:o[v.Selected])),{currentStatus:d,layout:u}},this.getBackgroundStyle=()=>{const{active:e,appMode:o,isHover:i,config:n,dynamicStyleOfCard:s,previewDynamicStyle:r,builderStatus:a}=this.props,{cardConfigs:c}=n,d=c[v.Selected].selectionMode!==l.None,u=c[v.Hover].enable,p=window.jimuConfig.isInBuilder;let h;return r&&a?(h=te(c[a].backgroundStyle,null==s?void 0:s[a]),h):(p&&o===t.AppMode.Design?h=te(c[v.Default].backgroundStyle,null==s?void 0:s[v.Default]):(h=te(c[v.Default].backgroundStyle,null==s?void 0:s[v.Default]),u&&i&&(h=te(c[v.Hover].backgroundStyle,null==s?void 0:s[v.Hover])),d&&e&&(h=te(c[v.Selected].backgroundStyle,null==s?void 0:s[v.Selected]))),h)},this.layoutRef=t.React.createRef(),this.linkRef=t.React.createRef()}shouldComponentUpdate(e,o){let i=this.shouldComponentUpdateExcept(e,o,["listStyle"]);return i=i||!t.utils.isDeepEqual(this.props.listStyle,e.listStyle),i}render(){var o;const{active:i,widgetId:n,listStyle:s,layouts:r,appMode:a,itemIdex:c,LayoutEntry:d,config:u,handleListMouseLeave:p,handleListMouseMove:h}=this.props,{cardConfigs:g}=u,f=g[v.Selected].selectionMode!==l.None,m=window.jimuConfig.isInBuilder&&a===t.AppMode.Express,{layout:S,currentStatus:y}=this.getLayoutAndCurrentStatus(),w=this.getBackgroundStyle(),b=(null===(o=g[y])||void 0===o?void 0:o.listLayout)||e.CUSTOM,x=r[v.Default],I=b===e.AUTO?x:S,C=Object.assign({},j.styleUtils.toCSSStyle(w||{})),T=Object.assign({},j.styleUtils.toCSSStyle({borderRadius:null==w?void 0:w.borderRadius}));return(0,t.jsx)(j.ListGroupItem,{active:f&&i,css:this.getStyle(y),style:Object.assign(Object.assign({},s),T),tabIndex:0,onClickCapture:this.onClickCapture,onClick:this.handleContentClick,className:(0,t.classNames)("surface-1 jimu-outline-inside",`list-card-${n}`),role:"option",tag:"div",onKeyDown:this.handleItemKeyDown,"aria-describedby":"describeByMessage","aria-selected":f&&i},(0,t.jsx)("div",{className:"list-card-content d-flex",onMouseLeave:p,onMouseMove:()=>{h(c)},style:C},(0,t.jsx)("div",{className:"position-relative h-100 w-100"},(0,t.jsx)("div",{className:"d-flex w-100 h-100 list-item-con",ref:this.layoutRef},m&&(0,t.jsx)(d,{isItemAccepted:this.isItemAccept,isRepeat:!0,layouts:I,isInWidget:!0}),!m&&(0,t.jsx)(A.LayoutEntry,{layouts:I})))))}}const{useRef:jo,useEffect:Do,Fragment:Lo}=t.React,ko=e=>{const o=jo((0,t.Immutable)({})),{id:i,cardConfig:n,useDataSources:s,dynamicStyleOfCard:l,handleDynamicStyleChange:r}=e;Do((()=>{o.current=l}),[l]);return(0,t.jsx)(Lo,null,(e=>Object.keys(e).filter((t=>{var o;const i=e[t],n=(null==i?void 0:i.dynamicStyleConfig)||{};return(null==i?void 0:i.enableDynamicStyle)&&(null===(o=Object.keys(n))||void 0===o?void 0:o.length)>0})))(n).map((e=>{var l;return(0,t.jsx)(t.DynamicStyleResolverComponent,{key:e,widgetId:i,useDataSources:s,dynamicStyleConfig:null===(l=n[e])||void 0===l?void 0:l.dynamicStyleConfig,onChange:t=>{((e,t)=>{const i=o.current.setIn([t],e);o.current=i,r(i)})(t,e)}})})))},{useEffect:zo}=t.React,No=e=>{const o=(0,ve.useTheme)(),i=t.hooks.useTranslation(j.defaultMessages),{config:n,id:s,recordIndex:l,previewDynamicStyle:r,updatePreviewDynamicStyle:a}=e,{records:c,showLoading:d,currentCardSize:u}=E(),p=t.ReactRedux.useSelector((e=>{var t,o,i;return"number"==typeof(null===(i=null===(o=null===(t=null==e?void 0:e.dynamicStyleState)||void 0===t?void 0:t.previewConditionInfo)||void 0===o?void 0:o[s])||void 0===i?void 0:i.conditionId)})),h=t.ReactRedux.useSelector((e=>{var t,o,i;return null===(i=null===(o=null===(t=null==e?void 0:e.dynamicStyleState)||void 0===t?void 0:t.previewRepeatedRecordInfo)||void 0===o?void 0:o[s])||void 0===i?void 0:i.recordIndex})),g=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),f=t.React.useCallback((()=>{const{isInBuilder:e}=window.jimuConfig,o=!c||c.length<1;return e&&p&&!(!d&&o)&&!r&&g!==t.AppMode.Design}),[p,c,d,r,g]);zo((()=>{a(l===h&&p)}),[h,l,p,a]);const m=t.css`
    .list-item-mask {
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 10;
      background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
    }
    .space-mask {
      &::before, &::after{
        display: block;
        content: '';
        position: absolute;
        z-index: 10;
        background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
      }
      &::before{
        top: ${u.height}px;
        left: 0;
        right: 0;
        bottom: 0;
      }
      &::after {
        top: 0;
        left: ${u.width}px;
        right: 0;
        bottom: 0;
      }
      &.space-mask-GRID::after {
        bottom: ${n.verticalSpace}px;
      }
    }
    .preview-remind {
      white-space: nowrap;
      z-index: 12;
      background-color: var(--sys-color-info-dark);
      color: var(--sys-color-info-text);
      height: 24px;
      line-height: 24px;
      font-size: 12px;
      top: ${u.height}px;
      left: 0;
      transform: translateZ(0);
    }
    .preview-remind-COLUMN {
      top: auto;
      bottom: 0;
      left: ${u.width}px;
    }
  `;return(0,t.jsx)("div",{css:m},f()&&(0,t.jsx)("div",{className:(0,t.classNames)("list-item-mask position-absolute",`list-item-mask-${null==n?void 0:n.layoutType}`)}),r&&(0,t.jsx)(t.React.Fragment,null,g!==t.AppMode.Design&&(0,t.jsx)("div",{className:(0,t.classNames)("space-mask",`space-mask-${null==n?void 0:n.layoutType}`)}),(0,t.jsx)("div",{className:(0,t.classNames)("preview-remind pl-2 pr-2 position-absolute",`preview-remind-${null==n?void 0:n.layoutType}`)},i("conditionalStylePreview"))))},{useRef:Po,useState:Ao,Fragment:_o}=t.React;let $o;const Bo=e=>{var o,i,n;const s=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),{data:l,index:r,style:a,isScrolling:c,columnIndex:d,rowIndex:u}=e,h=Po(0),g=Po(!1),f=Po(!1),m=Po({}),[v,S]=Ao((0,t.Immutable)({})),[y,w]=Ao({}),[b,x]=Ao(!1);if(!$o){const{builderSupportModules:e}=(null==l?void 0:l[0])||{};$o=null===(o=null==e?void 0:e.widgetModules)||void 0===o?void 0:o.ListCardEditor}const I=(e,t,o,i)=>{if(!(null==e?void 0:e[0]))return 0;const{config:n,widgetRect:s,currentCardSize:l}=e[0],r={rowIndex:i||0,columnIndex:o||0,config:n,widgetRect:s,currentCardSize:l};return(null==n?void 0:n.layoutType)===p.GRID?pe(r):t};h.current=I(l,r,d,u),g.current=((e,o,i,n)=>{if(!(null==e?void 0:e[0]))return!1;return 0===I(e,o,i,n)&&window.jimuConfig.isInBuilder&&s===t.AppMode.Design})(l,r,d,u),f.current=((e,t,o,i)=>{const n=I(e,t,o,i);return(null==e?void 0:e.length)>=n+1})(l,r,d,u);const C=e=>{const{config:t}=e[0];let o;switch(null==t?void 0:t.layoutType){case p.Column:o={width:parseFloat(a.width)-t.space+"px",height:"100%"};break;case p.Row:o={width:"100%",height:parseFloat(a.height)-t.space+"px"};break;case p.GRID:o={height:parseFloat(a.height)-(null==t?void 0:t.verticalSpace)+"px",width:parseFloat(null==a?void 0:a.width)-(null==t?void 0:t.horizontalSpace)+"px"}}return o},T=(e,t)=>Object.assign(Object.assign({},e[h.current]),{dynamicStyleOfCard:t});(0,Ge.useEffect)((()=>{R(l)}),[l,r,d,u]);const R=e=>{const t=e[h.current],o={widgetId:null==t?void 0:t.widgetId,dataSourceId:null==t?void 0:t.datasourceId,recordIndex:null==t?void 0:t.index,record:null==t?void 0:t.record},i=function(e,t){let o=!0;if(e)Object.keys(e).some((i=>t?e[i]!==t[i]&&(o=!1,!0):(o=!1,!0)));else if(t)return!1;return o}(o,m.current);i||(m.current=o,w(o))},O=l[h.current];return(0,t.jsx)(_o,null,f.current&&(0,t.jsx)("div",{style:(e=>{const{config:t,recordLength:o,widgetRect:i,currentCardSize:n}=e[0];let s=a;const l=d||0,c=u||0,h=ue(o,t,i,n),g=de(t,i,n),f=o-1===r;switch(null==t?void 0:t.layoutType){case p.Column:s=Object.assign(Object.assign({},s),{width:f?parseFloat(s.width)-t.space+"px":`${parseFloat(s.width)}px`});break;case p.Row:s=Object.assign(Object.assign({},s),{height:f?parseFloat(s.height)-t.space+"px":`${parseFloat(s.height)}px`});break;case p.GRID:s=Object.assign(Object.assign({},s),{height:h===c+1?parseFloat(s.height)-(null==t?void 0:t.verticalSpace)+"px":`${parseFloat(s.height)}px`,width:g===l+1?parseFloat(null==s?void 0:s.width)-(null==t?void 0:t.horizontalSpace)+"px":`${parseFloat(null==s?void 0:s.width)}px`})}return s})(l)},(0,t.jsx)(t.RepeatedDataSourceProvider,{data:y},(0,t.jsx)(_o,null,g.current&&$o&&(0,t.jsx)($o,Object.assign({},T(l,v),{listStyle:C(l),itemIdex:h.current,isScrolling:c,previewDynamicStyle:b})),!g.current&&(0,t.jsx)(Mo,Object.assign({},T(l,v),{listStyle:C(l),itemIdex:h.current,isScrolling:c,previewDynamicStyle:b})),(null==O?void 0:O.record)&&(null===(i=null==O?void 0:O.config)||void 0===i?void 0:i.cardConfigs)&&(0,t.jsx)(_o,null,(0,t.jsx)(ko,{cardConfig:null===(n=null==O?void 0:O.config)||void 0===n?void 0:n.cardConfigs,id:null==O?void 0:O.widgetId,dynamicStyleOfCard:v,useDataSources:null==O?void 0:O.useDataSources,handleDynamicStyleChange:e=>{S(e)}}),(0,t.jsx)(No,{config:null==O?void 0:O.config,id:null==O?void 0:O.widgetId,recordIndex:h.current,previewDynamicStyle:b,updatePreviewDynamicStyle:e=>{x(e)}}))))))},{useRef:Fo,useState:Ho}=t.React,Wo=e=>{var o;const{useDataSources:i,appMode:n,linkParam:s,widgetId:l,queryObject:r,children:a,role:c,changeIsCanClickLink:d}=e,u=Fo(null),p=Fo(null),h=t.React.useContext(t.jimuHistory.HistoryContext),[g,f]=Ho(!1),[m,v]=Ho(null),S=j.hooks.useApplyLinkResult(),y=e=>{if(d&&!d())return;const o=window.jimuConfig.isInBuilder;if(n===t.AppMode.Design&&o)return!1;const i=x(e),l=b();if(!i&&(null==s?void 0:s.linkType)&&(null==s?void 0:s.linkType)!==t.LinkType.None){const i=T(r);if(l){if(o)return w(),!1;"_self"===s.openType?window.location.href=i.linkTo.value:i.linkTo.value&&window.open(i.linkTo.value,s.openType)}else if((null==s?void 0:s.linkType)===t.LinkType.Block)u.current.click();else{if(o&&(null==s?void 0:s.linkType)===t.LinkType.PrintPreview)return w(),!1;S({evt:e,linkTo:i.linkTo,target:i.target,replace:!1,queryObject:i.queryObject})}}"linkClick"===e.exbEventType&&delete e.exbEventType},w=()=>{clearTimeout(p.current),f(!0),setTimeout((()=>{f(!1)}),3e3)},b=t.React.useCallback((()=>{var e,o;let i=!1;if((null==s?void 0:s.linkType)===t.LinkType.WebAddress){const n=m||s.value;n?i=t.urlUtils.isAbsoluteUrl(n):(null===(e=null==s?void 0:s.expression)||void 0===e?void 0:e.name)&&(i=t.urlUtils.isAbsoluteUrl(null===(o=null==s?void 0:s.expression)||void 0===o?void 0:o.name))}return i}),[s,m]),x=e=>{const t=e.target;return I(t,e)||I(null==t?void 0:t.parentNode,e)},I=(e,t)=>{if(!e)return!1;const o=null==e?void 0:e.getAttribute("z-index"),i=null==e?void 0:e.role,n=e&&e.tagName||"",s="button"===n.toLowerCase()||"button"===i,l="a"===n.toLowerCase()||"linkClick"===t.exbEventType,r="input"===n.toLowerCase()||"input"===i;return s||l||!!o&&o>-1||r},C=t.css`
    .list-clear-background {
      background: transparent !important;
    }
    .list-link {
      position: absolute;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
    }
  `,T=t.React.useCallback((e=>{const o=null==s?void 0:s.openType,i={linkType:null==s?void 0:s.linkType,value:null==s?void 0:s.value};let n=e;return(null==s?void 0:s.linkType)===t.LinkType.WebAddress&&(i.value=m||(null==i?void 0:i.value),n=void 0),{queryObject:n,target:o,linkTo:i}}),[s,m]),R=e=>{e.stopPropagation()},O=t.React.useCallback((()=>b()||(null==s?void 0:s.linkType)===t.LinkType.PrintPreview),[b,null==s?void 0:s.linkType]);return(0,t.jsx)("div",{className:"w-100 h-100","aria-label":null==e?void 0:e["aria-label"],role:c,onClick:y,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||y(e)},css:C},(()=>{var e;const o=T(r),i=null===(e=null==o?void 0:o.linkTo)||void 0===e?void 0:e.linkType;return i&&i!==t.LinkType.None&&(0,t.jsx)(j.Link,{className:"p-0 w-100 h-100 border-0 list-clear-background list-link",ref:u,unstyled:!0,to:o.linkTo,target:o.target,queryObject:o.queryObject,onClick:R,tabIndex:-1})})(),a,i&&(0,t.jsx)(t.ExpressionResolverComponent,{useDataSources:i,expression:null==s?void 0:s.expression,onChange:e=>{if(e.isSuccessful)v(e.value);else{v("")}},widgetId:l}),window.jimuConfig.isInBuilder&&O()&&(0,t.jsx)(j.LinkTip,{reference:null===(o=u.current)||void 0===o?void 0:o.id,open:g,href:(()=>{const e=T(r);return t.urlUtils.getHrefFromLinkTo(e.linkTo,r,h&&h.location)||""})()}))};var Uo=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const{useRef:Go,forwardRef:Vo,useEffect:qo,useState:Ko,Fragment:Yo}=t.React,Qo=e=>{const o=(0,ve.useTheme)(),i=t.hooks.useTranslation(me,j.defaultMessages,t.defaultMessages),n=Go(null),s=Go(null),r=Go(!0),a=Go(null),c=Go(null),d=Go(null),u=M(),{dataSource:h,records:g,currentCardSize:f,widgetRect:m,pageSize:S,isShowEditingMask:y}=E(),w=t.ReactRedux.useSelector((e=>null==e?void 0:e.browserSizeMode)),b=t.ReactRedux.useSelector((e=>null==e?void 0:e.queryObject)),x=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),I=t.ReactRedux.useSelector((e=>e.appContext.isRTL));c.current=w,d.current=x;const{useDataSources:C,listProps:T,hideCardTool:R,LayoutEntry:O}=e,{id:D,config:L,selectionIsInSelf:k,builderStatus:z,builderSupportModules:N}=T,{handleListScroll:P,handleResizeCard:A,handleListKeyUp:_,selectRecordsAndPublishMessageAction:$,resetListElement:B,toggleCardTool:F,setListOutDivRef:W,onItemsRendered:U,setListRef:G,scrollToEndCallback:V,getListSize:q}=e,[K,Y]=Ko(-1);qo((()=>{clearTimeout(a.current),a.current=setTimeout((()=>{B(!0)}))}),[f,m]),qo((()=>{Y(-1)}),[x]),qo((()=>{ae()}),[g]);const Q=e=>{if(!h||!e||!(null==e?void 0:e.getId))return;let t=h.getSelectedRecords()||[];if(L.cardConfigs[v.Selected].selectionMode&&L.cardConfigs[v.Selected].selectionMode!==l.None){const o=null==e?void 0:e.getId(),i=t.find((e=>e.getId()===o));L.cardConfigs[v.Selected].selectionMode===l.Single?i?($([]),u({type:"SET_SHOW_SELECTION_ONLY",value:!1})):$([e]):(t=i?t.filter((e=>e.getId()!==o)):t.concat([e]),$(t))}},Z=e=>{if(!h||!e||!(null==e?void 0:e.getId))return;const t=h.getSelectedRecords()||[];if(L.cardConfigs[v.Selected].selectionMode&&L.cardConfigs[v.Selected].selectionMode!==l.None){const o=null==e?void 0:e.getId(),i=t.find((e=>e.getId()===o));r.current=!i}},X=()=>{ee(T)||Y(-1)},J=t.hooks.useEventCallback((e=>{ee(T)||e!==K&&Y(e)})),ee=e=>{const{config:t,selectionIsInSelf:o,selectionIsSelf:i}=e;return oe(x,t,i,o)},te=()=>window.jimuConfig.isInBuilder&&x===t.AppMode.Design?0:S,ie=()=>H(L,z,w),ne=()=>{k&&se()},se=()=>{window.jimuConfig.isInBuilder&&N.widgetModules.selectSelf(D)},le=t.hooks.useEventCallback((e=>{var t,n,s;const{id:l,config:r,builderSupportModules:a,layouts:u}=e,p=(null===(n=null===(t=ie())||void 0===t?void 0:t.width)||void 0===n?void 0:n.unit)===j.DistanceUnits.PERCENTAGE;return{id:l,widgetId:l,config:r,recordLength:(null==g?void 0:g.length)||0,widgetRect:m,currentCardSize:f,useDataSources:C,handleListMouseMove:J,handleListMouseLeave:X,browserSizeMode:c.current,isRTL:I,builderSupportModules:a,interact:window.jimuConfig.isInBuilder&&(null===(s=null==a?void 0:a.widgetModules)||void 0===s?void 0:s.interact),appMode:d.current,theme:o,LayoutEntry:O,layouts:u,datasourceId:null==h?void 0:h.id,isWidthPercentage:p,formatMessage:i,selectCard:ne,handleResizeCard:A,onChange:Q,updateCanClickLinkWhenClickItem:Z,toggleCardTool:F}})),re=t.React.useCallback((e=>{const t=(null==L?void 0:L.horizontalSpace)||0;return((null==f?void 0:f.width)||0)+t}),[f,L]),ae=()=>{const e=`bottomBoundary${D}`;if(!s.current||document.getElementById(e))return;const t=document.createElement("div");t.id=e,t.className="bottom-boundary",t.setAttribute("data-testid","bottom-boundary");s.current.getElementsByTagName("div")[0].appendChild(t),function(e,t,o,i){const n=new IntersectionObserver((function(e,t){o(e[0].isIntersecting)}),i||{root:t});n.observe(e)}(document.getElementById(e),s.current,V)},he=e=>{W(e),s.current=e,ae()},ge=e=>{u({type:"SET_IS_RESIZING_CARD",value:e})},fe=t.hooks.useEventCallback(((e,t,o,i)=>{const{config:n,selectionIsInSelf:s,selectionIsSelf:l,builderStatus:r}=t,a=(h&&n.isItemStyleConfirm?h.getSelectedRecordIds():[]).map((e=>e+""));return e&&e.map(((e,c)=>{const d={hideCardTool:i,selectionIsList:l,selectionIsInList:s,isEditing:ee(t),builderStatus:r,lockItemRatio:n.lockItemRatio,changeIsResizingCard:ge};return Object.assign(Object.assign(Object.assign({index:c,isHover:o===c,record:n.isItemStyleConfirm?e:void 0},le(t)),{active:!e.fake&&n.isItemStyleConfirm&&h&&a.includes(e.getId())}),d)}))})),Se=()=>{const e=(null==L?void 0:L.layoutType)===p.GRID?null==L?void 0:L.verticalSpace:null==L?void 0:L.space;if(n.current!==e)return n.current=e,Vo(((o,i)=>{var{style:n}=o,s=Uo(o,["style"]);return(0,t.jsx)("div",Object.assign({ref:i,style:Object.assign(Object.assign({},n),{height:parseFloat(n.height)-(L.layoutType===p.Column?0:e)+"px",width:parseFloat(n.width)-(L.layoutType!==p.Column?0:e)+"px"})},s))}))};return(0,t.jsx)(Yo,null,(0,t.jsx)("div",{className:"widget-list-link-con position-relative","data-testid":"listContainer",onKeyUp:_},(0,t.jsx)(Wo,{widgetId:D,appMode:x,linkParam:L.linkParam,queryObject:b,useDataSources:C,changeIsCanClickLink:()=>r.current,role:"listbox","aria-label":i("listArea")},(null==L?void 0:L.layoutType)===p.GRID&&(0,t.jsx)(yo,{className:(0,t.classNames)("widget-list-list",{"hide-list":!g||0===(null==g?void 0:g.length),"hide-will-change":y}),ref:G,useIsScrolling:!0,outerRef:he,direction:I?"rtl":"ltr",itemCount:g.length,overscanCount:te(),itemKey:e=>((e,t,o,i,n)=>{const{columnIndex:s,rowIndex:l}=e,r=pe({rowIndex:l,columnIndex:s,config:o,widgetRect:i,currentCardSize:n}),a=t[r];return`${(null==a?void 0:a.getId)&&(null==a?void 0:a.getId())||r+100}`})(e,g,L,m,f),columnCount:de(L,m,f),columnWidth:re,rowCount:ue(g.length,L,m,f),rowHeight:e=>((e,t,o=0)=>Math.floor(t)+o)(0,f.height,null==L?void 0:L.verticalSpace),width:q().width,height:q().height,onItemsRendered:U,itemData:fe(g,T,K,R),innerElementType:Se(),onScroll:P},Bo),(null==L?void 0:L.layoutType)!==p.GRID&&(0,t.jsx)(Oo,{className:(0,t.classNames)("widget-list-list",{"hide-list":!g||0===(null==g?void 0:g.length),"hide-will-change":y}),ref:G,useIsScrolling:!0,outerRef:he,direction:I?"rtl":"ltr",role:"listbox",layout:L.layoutType===p.Column?"horizontal":"vertical",itemCount:g.length,overscanCount:te(),itemKey:e=>{const t=g[e];return`${(null==t?void 0:t.getId)&&(null==t?void 0:t.getId())||e}`},width:q().width,height:q().height,onItemsRendered:U,itemData:fe(g,T,K,R),innerElementType:Se(),itemSize:e=>ce(L,f),onScroll:P},Bo))))},{useEffect:Zo,useState:Xo,useRef:Jo}=t.React,ei=e=>{const o=t.hooks.useTranslation(j.defaultMessages,t.defaultMessages),i=Jo(null),{dataSource:n,dsInfo:s,widgetRect:l}=E(),[r,a]=Xo(null),[c,d]=Xo(null),[u,p]=Xo(null);Zo((()=>{clearTimeout(i.current),i.current=setTimeout((()=>{h(l,n,null==s?void 0:s.status)}),100)}),[l,n,s]);const h=t.hooks.useEventCallback(((e,o,i)=>{var n;const s=(null==e?void 0:e.width)||620,l=s<321?s-36:s/2,r=i===t.DataSourceStatus.NotReady?0:null==o?void 0:o.count,c=i===t.DataSourceStatus.NotReady?0:null===(n=null==o?void 0:o.getSelectedRecords())||void 0===n?void 0:n.length;a(g(r)),d(g(c)),p(l)})),g=e=>e?t.utils.formatNumber(e).join(""):"0";return(0,t.jsx)("div",{className:"position-absolute data-count d-flex align-items-center",style:{maxWidth:u}},(0,t.jsx)("div",{className:"flex-grow-1 total-count-text text-truncate",title:o("dataCount",{total:r,selected:c})},o("dataCount",{total:r,selected:c})))};var ti=a(45508),oi=a.n(ti),ii=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const ni=e=>{const o=window.SVG,{className:i}=e,n=ii(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:oi()},n)):t.React.createElement("svg",Object.assign({className:s},n))},{useEffect:si,useState:li,useRef:ri}=t.React,ai=6e4,ci=e=>{const o=t.hooks.useTranslation(me,j.defaultMessages,t.defaultMessages),i=ri(null),n=ri(null),s=M(),{dataSource:l,dsInfo:r,showLoading:a,widgetRect:c,lastRefreshTime:d}=E(),{config:u,appMode:h,LayoutEntry:g,showLoadingWhenConfirmSelectTemplate:f}=e,[m,v]=li(!1),[S,y]=li(!1),[w,b]=li(null),[x,I]=li(0);si((()=>{L(u)}),[u]),si((()=>{const e=(null==c?void 0:c.width)||620;y(e<321)}),[c]);const C=t.React.useCallback((e=>{s({type:"SET_SHOW_LOADING",value:e})}),[s]),T=t.React.useCallback(((e,o,i)=>{let n=!1;return(i||window.jimuConfig.isInBuilder&&!g||e&&o===t.DataSourceStatus.Loading)&&(n=!0),n}),[g]),R=t.React.useCallback((e=>{clearTimeout(n.current),e<=0&&clearInterval(i.current),n.current=setTimeout((()=>{e>0&&b(o("lastUpdateAFewTime"))}),0)}),[o]),O=t.React.useCallback((e=>{const t=(new Date).getTime()-e;let i=o("lastUpdateAFewTime");return t>ai&&t<=12e4?i=o("lastUpdateAMinute"):t>12e4&&(i=o("lastUpdateTime",{updateTime:Math.floor(t/ai)})),i}),[o]),D=t.React.useCallback((e=>{clearInterval(i.current),i.current=setInterval((()=>{b(O(e))}),ai)}),[O]),L=e=>{let t=null==e?void 0:e.isShowAutoRefresh;"boolean"!=typeof t&&(t=!0),v(t)},k=t.React.useCallback(((e,t)=>{R(e),e>0&&t&&D(t)}),[R,D]);return si((()=>{const e=T(l,null==r?void 0:r.status,f);C(e);const t=(e=>(null==e?void 0:e.getAutoRefreshInterval())||0)(l);I(t)}),[l,r,f,T,C]),si((()=>(m&&m&&k(x,d),()=>{clearInterval(i.current)})),[d,x,m,k]),(0,t.jsx)("div",{className:(0,t.classNames)("position-absolute refresh-loading-con d-flex align-items-center",((e,o)=>{const{scrollBarOpen:i,layoutType:n}=e,s=window.jimuConfig.isInBuilder&&o===t.AppMode.Design;return!i||s?"":n===p.Column?"horizon-loading":"vertical-loading"})(u,h))},a&&(0,t.jsx)("div",{className:"loading-con"}),x>0&&m&&(0,t.jsx)("div",{className:"flex-grow-1 auto-refresh-loading"},S&&(0,t.jsx)(j.Tooltip,{title:w,placement:"top"},(0,t.jsx)(j.Button,{className:"list-auto-refresh-button",type:"tertiary","aria-label":w},(0,t.jsx)(ni,null))),!S&&(0,t.jsx)("div",{className:"auto-refresh-string-con"},w)))},{useEffect:di,useState:ui,useRef:pi}=t.React,hi=e=>{const o=pi(null),i=pi(null),n=pi(0),s=pi(null),l=pi(1),a=pi(1),c=pi(null),d=pi(null),u=pi(!1),p=pi(null),h=pi(null),{useDataSources:g,id:f,config:m,activeSort:v,showLoadingWhenConfirmSelectTemplate:S,noLayoutEntry:y}=e,{updateQueryOptions:w,loadNextPageWhenListSizeOrTotalCountChange:b,updateCreateDataSourceFailed:x,scrollToSelectedItems:I}=e,[C,T]=ui({returnGeometry:!0}),{page:R,searchText:O,dataSource:j,showSelectionOnly:D,currentFilter:L,filterApplied:k,sortOptionName:z,pageSize:N,queryStatus:P,hasDsLoadedRecord:A}=E(),_=M(),$=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),B=t.React.useCallback((e=>{const t=s.current;if(e&&e[0]){const o=t&&t[0];o&&o.dataSourceId===e[0].dataSourceId||_({type:"SET_PAGE",value:1})}else d.current=void 0,_({type:"SET_DATA_SOURCE",value:void 0})}),[_]),F=t.React.useCallback((e=>{let i=function(e){var o;const i={returnGeometry:!0},{sortOptionName:n,searchText:s,currentFilter:l,filterApplied:r,datasource:a,config:c,useDataSources:d,pageSize:u,page:p,activeSort:h}=e,g=d&&d[0];if(!a||!g)return i;if(!a.query)return i;const f=ye(c.sorts,c.sortOpen,n,h);if(f.length>0&&(i.orderByFields=f),c.filterOpen&&r&&c.filter&&l&&l.sql&&(i.where=l.sql,i.sqlExpression=l),c.searchOpen&&c.searchFields&&s){const e=t.dataSourceUtils.getSQL(s,null===(o=c.searchFields)||void 0===o?void 0:o.asMutable({deep:!0}),a,null==c?void 0:c.searchExact);if(i.where){const o=t.dataSourceUtils.getMergedSQLExpressions([i.sqlExpression.asMutable({deep:!0}),e],a);i.where=o.sql,i.sqlExpression=(0,t.Immutable)(o)}else i.where=e.sql,i.sqlExpression=(0,t.Immutable)(e)}return u>0&&(i.page=p,i.pageSize=u),i}(e);var n,s,r;if(!(n=i,s=o.current,!!(r=d.current)&&(n=r.getRealQueryParams(n,"query"),s=r.getRealQueryParams(s,"query"),!(!n||!s)&&(delete n.page,delete n.pageSize,delete n.resultOffset,delete n.resultRecordCount,delete s.page,delete s.pageSize,delete s.resultOffset,delete s.resultRecordCount,t.utils.isDeepEqual(n,s))))&&d.current){const e=i;1!==l.current?(i=o.current,o.current=e,_({type:"SET_PAGE",value:1})):o.current=e}w(i),T(i)}),[_,w]),H=t.React.useCallback((()=>{let e=!1;return(S||window.jimuConfig.isInBuilder&&y||d.current&&c.current===t.DataSourceStatus.Loading)&&(e=!0),e}),[y,S]),W=t.React.useCallback(((e,o)=>{var i,n;const s=!!d.current&&ee(null===(i=d.current)||void 0===i?void 0:i.id);if(!u.current&&d.current&&!s&&(null===(n=p.current)||void 0===n?void 0:n.isItemStyleConfirm))return;const c=H(),g=function(e){const{SELECTION_DATA_VIEW_ID:o}=t.CONSTANTS,{config:i,appMode:n,showSelectionOnly:s,ds:l,showLoading:a,recordSizePerPage:c,page:d}=e,u=n===t.AppMode.Design,p=function(e=3){const t={fake:!0};e=e&&e>1?e:3;const o=[];for(let i=0;i<e;i++)o.push(t);return o}(c);let h=p;const g=l&&(null==i?void 0:i.isItemStyleConfirm)?l.getSelectedRecords():null;l&&(null==i?void 0:i.isItemStyleConfirm)&&(h=(null==l?void 0:l.dataViewId)===o?i.pageStyle===r.Scroll?l.getRecordsByPage(1,c*d):l.getRecordsByPage(d,c):i.pageStyle===r.Scroll?l.getRecordsByPageWithSelection(1,c*d):l.getRecordsByPageWithSelection(d,c),h=h||[],s&&(h=g));return window.jimuConfig.isInBuilder&&u&&!a&&h.length<1&&(h=p),h}({ds:d.current,showLoading:c,showSelectionOnly:e,config:p.current,appMode:o,page:l.current,recordSizePerPage:a.current});_({type:"SET_RECORDS",value:g}),0===g.length&&_({type:"SET_SHOW_SELECTION_ONLY",value:!1}),clearTimeout(h.current),h.current=setTimeout((()=>{d.current&&I(d.current)}),100)}),[_,H,I]),U=e=>{_({type:"SET_SORT_OPTION_NAME",value:e})},G=e=>{_({type:"SET_SHOW_SORT_STRING",value:e})},V=t.hooks.useEventCallback((e=>{j&&(W(D,$),j&&I(j))})),q=t.hooks.useEventCallback((e=>{_({type:"SET_DATA_SOURCE",value:e}),d.current=e;const o=e.getInfo().status;o===t.DataSourceStatus.Loaded||o===t.DataSourceStatus.LoadError?J(!0):J(!1),x(!1),(0,t.getAppStore)().dispatch(t.appActions.widgetStatePropChange(f,"dsId",e.id))})),K=e=>{var t;if(!e)return[];let o=[];for(const i in null==e?void 0:e.widgetQueries){const n=(null===(t=e.widgetQueries[i])||void 0===t?void 0:t.orderByFields)||[];o=o.concat(n)}return Array.from(new Set(o))},Y=t.hooks.useEventCallback(((e,o)=>{var s;_({type:"SET_DS_INFO",value:e}),W(D,$),(e=>{if(!ne(m))return;const o=null==j?void 0:j.count;e===t.DataSourceStatus.Loaded&&null!==o&&(n.current!==o&&(clearTimeout(i.current),i.current=setTimeout((()=>{_({type:"SET_PAGE",value:1})}),1),b()),n.current=o)})(null==e?void 0:e.status),Z(e,o);const l=d.current&&(null===(s=d.current)||void 0===s?void 0:s.getLastDataLoadTime()),r=null==e?void 0:e.lastAutoRefreshCheckTime;_({type:"LAST_REFRESH_TIME",value:Q(l,r)||null})})),Q=(e,t)=>e&&t?Math.max(e,t):t||e,Z=t.hooks.useEventCallback(((e,t)=>{if(!(null==m?void 0:m.sortOpen)||v||"boolean"!=typeof v)return;const o=K(e),i=K(t);if(!((e=[],t=[])=>JSON.stringify(e)!==JSON.stringify(t))(o,i))return;const n=o.filter((e=>!i.includes(e))),s=m.sorts.map((e=>{const t=ye(m.sorts,!0,e.ruleOptionName,!0)[0];return{ruleOptionName:e.ruleOptionName,orderByFieldsItem:t}})),l=s.filter((e=>n.includes(e.orderByFieldsItem)));(null==l?void 0:l.length)>0?(U(l[0].ruleOptionName),G(!1)):(U(null),G(!0))})),X=t.hooks.useEventCallback(((e,o)=>{e!==t.DataSourceStatus.Loaded&&e!==t.DataSourceStatus.LoadError||J(!0),_({type:"SET_QUERY_STATUS",value:e}),c.current=e})),J=e=>{u.current=e,_({type:"SET_HAS_DS_LOADED_RECORD",value:e})},ee=e=>{var o,i;return null===(i=null===(o=t.DataSourceManager.getInstance().getDataSource(e))||void 0===o?void 0:o.getDataSourceJson())||void 0===i?void 0:i.isOutputFromWidget};return di((()=>{B(g),s.current=g}),[g,B]),di((()=>{l.current=R,a.current=N,p.current=m;const e={sortOptionName:z,searchText:O,currentFilter:L,filterApplied:k,datasource:d.current,config:m,pageSize:N,useDataSources:(0,t.Immutable)(g),page:R,activeSort:v};F(e)}),[g,f,R,z,O,L,k,m,v,N,F]),di((()=>{W(D,$)}),[P,j,R,D,$,N,A,W]),(0,t.jsx)(t.React.Fragment,null,(e=>!!e&&!!e[0])(g)&&(0,t.jsx)(t.DataSourceComponent,{query:C,useDataSource:g&&g[0],onDataSourceCreated:q,onCreateDataSourceFailed:e=>{x(!0)},widgetId:f,queryCount:ne(m),onDataSourceInfoChange:Y,onSelectionChange:V,onDataSourceStatusChange:X,onQueryRequired:(e,t)=>{1!==l.current&&_({type:"SET_PAGE",value:1})}},e.children))},{useEffect:gi,useRef:fi}=t.React,mi=e=>{const o=fi(null),n=fi(null),s=fi(null),l=fi(!1),r=M(),{isResizingCard:a,currentCardSize:c,widgetRect:d}=E(),u=t.ReactRedux.useSelector((e=>null==e?void 0:e.browserSizeMode)),{id:h,showTopTools:g,showBottomTools:f,targetRef:m,paginatorDiv:v,config:S,isScrollEnd:y,isCurrentPageLastPage:w,builderStatus:b}=e,{loadNextPageWhenListSizeOrTotalCountChange:x,resetListElement:I,updateCardToolPosition:C,setListDivSize:T,handleResizeCard:R,updateHasGetListSizeByResizeDetector:O}=e,j=t.hooks.useEventCallback(((e,t)=>{O(!0);const o={width:e,height:t};if(a)return;const r=D(e,t),c=r.width<i||r.height<i,u=(o.width!==d.width||o.height!==d.height)&&0!==o.width&&0!==o.height;c&&!u||(L(r),k(o),z(o),l.current=!0,s.current&&I(),S.lockItemRatio&&(clearTimeout(n.current),n.current=setTimeout((()=>{R(r,!0,!1,!1,!0)}),500)),C(),T(),!w&&y&&x())}));gi((()=>{o.current=t.lodash.debounce((({width:e,height:t})=>{j(e,t)}),100)}),[j]);const D=t.hooks.useEventCallback(((e,t)=>{const o={width:e,height:t},i=G(o,U(v,f),g),n=P(o),l=S.layoutType===p.GRID?N(o):c,r={width:l.width,height:l.height};if(s.current=!_(null==c?void 0:c.width,null==l?void 0:l.width)||!_(null==c?void 0:c.height,null==l?void 0:l.height),S.lockItemRatio&&S.layoutType!==p.GRID){const t=r.width/r.height;switch(null==S?void 0:S.layoutType){case p.Column:r.height=i,r.width=i*t,_(r.width,n.width)||(s.current=!0);break;case p.Row:r.height=e/t,r.width=e,_(r.height,n.height)||(s.current=!0)}}else switch(null==S?void 0:S.layoutType){case p.Column:r.height=i;break;case p.Row:r.width=e}return r})),L=e=>{r({type:"SET_CURRENT_CARD_SIZE",value:e}),I()},k=e=>{r({type:"SET_WIDGET_RECT",value:e})},z=e=>{(0,t.getAppStore)().dispatch(t.appActions.widgetStatePropChange(h,"widgetRect",e))},N=t.hooks.useEventCallback((e=>B(S,b,u,e))),P=t.hooks.useEventCallback((e=>l.current?c:N(e)));return(0,t.jsx)(t.ReactResizeDetector,{targetRef:m,handleWidth:!0,handleHeight:!0,onResize:o.current})};var vi=a(28996),Si=a.n(vi),yi=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const wi=e=>{const o=window.SVG,{className:i}=e,n=yi(e,["className"]),s=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:s,src:Si()},n)):t.React.createElement("svg",Object.assign({className:s},n))},{useEffect:bi,useState:xi,Fragment:Ii}=t.React,Ci=e=>{const o=t.hooks.useTranslation(j.defaultMessages,t.defaultMessages),{records:i,dataSource:n,dsInfo:s,showLoading:l,hasDsLoadedRecord:r}=E(),{config:a,useDataSources:c}=e,[d,u]=xi(null);bi((()=>{var e,o,i;const n=null===t.appConfigUtils||void 0===t.appConfigUtils?void 0:t.appConfigUtils.getWidgetIdByOutputDataSource(null==c?void 0:c[0]),s=null===(e=(0,t.getAppStore)().getState())||void 0===e?void 0:e.appConfig,l=null===(i=null===(o=null==s?void 0:s.widgets)||void 0===o?void 0:o[n])||void 0===i?void 0:i.label;u(l)}),[c]);const p=(null==s?void 0:s.status)===t.DataSourceStatus.NotReady&&n;return(0,t.jsx)(Ii,null,!l&&(!i||i.length<1)&&(r||p)&&(0,t.jsx)("div",{className:"empty-con text-center"},(0,t.jsx)(wi,{size:16}),(0,t.jsx)("div",{className:"discribtion"},(null==a?void 0:a.noDataMessage)||o("noData"))),p&&(0,t.jsx)("div",{className:"placeholder-alert-con"},(0,t.jsx)(j.Alert,{form:"tooltip",size:"small",type:"warning",text:o("outputDataIsNotGenerated",{outputDsLabel:null==n?void 0:n.getLabel(),sourceWidgetName:d})})))};var Ti=a(51879),Ri=a.n(Ti);const{useEffect:Oi}=t.React,Ei=e=>{const o=t.hooks.useTranslation(me,t.defaultMessages),i=M(),{useDataSources:n,createDataSourceFailed:s}=e,{dataSource:l,showWidgetLoading:r}=E();Oi((()=>{a(l,n,s)}),[l,n,s]);const a=(e,t,o)=>{t&&0!==(null==t?void 0:t.length)?e&&!o&&i({type:"SET_SHOW_WIDGET_LOADING",value:!1}):i({type:"SET_SHOW_WIDGET_LOADING",value:!1})};return(0,t.jsx)(t.React.Fragment,null,r&&!s&&(0,t.jsx)("div",{className:"list-loading-con w-100 h-100"},(0,t.jsx)("div",{className:"jimu-secondary-loading"})),s&&(0,t.jsx)("div",{className:"list-error-con position-relative w-100 h-100"},(0,t.jsx)(j.WidgetPlaceholder,{icon:Ri(),name:o("_widgetLabel"),message:""}),(0,t.jsx)(j.Alert,{className:"position-absolute alert-panel-of-list",type:"warning",withIcon:!0,text:o("dataSourceCreateError")})))},{useEffect:Mi,useState:ji}=t.React,Di=e=>{const o=(0,ve.useTheme)(),{config:i,showTopTools:s,showBottomTools:l,bottomCon:r,isEditing:a}=e,{records:c,currentCardSize:d,widgetRect:u,showLoading:h}=E(),g=M(),f=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),[m,v]=ji(0),[S,y]=ji(0),[w,b]=ji(0),[x,I]=ji(!1);Mi((()=>{const e=C(c,h,a,f);I(e),g({type:"SET_IS_SHOW_EDITING_MASK",value:e})}),[c,h,a,f,g]),Mi((()=>{const e=he(i,u,d);v(e)}),[i,u,d]),Mi((()=>{y(s?n:0)}),[i,s]),Mi((()=>{if(r&&l){const e=U(r.current,l);b(e)}else b(0)}),[l,r]);const C=(e,o,i,n)=>{const{isInBuilder:s}=window.jimuConfig,l=!e||e.length<1;return s&&i&&!(!o&&l)&&n===t.AppMode.Design},T=t.css`
    &.editing-mask-con {
      &:before {
        content: '';
        position: absolute;
        left: 0;
        top: ${S}px;
        z-index: 10;
        height: ${d.height}px;
        width: ${m}px;
        background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
      }
      .editing-mask-list-grid {
        position: absolute;
        left: ${d.width+m}px;
        top: ${S}px;
        right: 0;
        z-index: 10;
        height: ${d.height}px;
        background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
      }
    }
    .editing-mask-list {
      position: absolute;
      top: ${(null==i?void 0:i.layoutType)!==p.Column&&(null==c?void 0:c.length)>0?d.height+S:S}px;
      left: ${(null==i?void 0:i.layoutType)===p.Column&&(null==c?void 0:c.length)>0?d.width:0}px;
      bottom: ${w}px;
      right: 0;
      z-index: 10;
      background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
    }
    .editing-mask-ds-tool {
      position: absolute;
      z-index: 10;
      top: 0;
      left: 0;
      height: ${S}px;
      right: 0;
      background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
    }

    .editing-mask-bottom-tool {
      position: absolute;
      z-index: 10;
      height: ${w}px;
      left: 0;
      bottom: 0;
      right: 0;
      background-color: ${t.polished.rgba(o.ref.palette.black,.5)};
    }
  `;return(0,t.jsx)(t.React.Fragment,null,x&&(0,t.jsx)("div",{className:"editing-mask-con",css:T},s&&(0,t.jsx)("div",{className:"editing-mask-ds-tool"}),(0,t.jsx)("div",{className:"editing-mask-list"}),(null==i?void 0:i.layoutType)===p.GRID&&(0,t.jsx)("div",{className:"editing-mask-list-grid"}),l&&(0,t.jsx)("div",{className:"editing-mask-bottom-tool"})))},Li=Object.assign({},me,j.defaultMessages,t.defaultMessages);class ki extends t.React.PureComponent{constructor(e){super(e),this.listRef=t.React.createRef(),this.isHasScrolled=!1,this.isHasRenderList=!1,this.needAutoScrollToSelectedItemWhenLoadPage=!1,this.autoScrollIndex=null,this.isScrollToNextStep=!1,this.isScrollEnd=!1,this.loadMoreDataTimeout=null,this.queryOptions=null,this.hasGetListSizeByResizeDetector=!1,this.isCurrentPageLastPage=!1,this.hideCardTool=!1,this.updateSizeAndCardPositionWhenPropsChangeInBuilder=(e,t)=>{if(!window.jimuConfig.isInBuilder)return;this.updateScrollContentSize(e.config);let o=this.layoutPropertiesChange(e,t);o=this.listDivSizeChange(e,t,o),o&&this.updateCardToolPosition()},this.selectRecordsWhenConfigChange=e=>{const{config:t}=this.props;t.cardConfigs[v.Selected].selectionMode!==e.config.cardConfigs[v.Selected].selectionMode&&this.selectRecordsAndPublishMessageAction([])},this.updateCurrentCardSize=e=>{this.context.dispatch({type:"SET_CURRENT_CARD_SIZE",value:e}),this.resetListElement()},this.layoutPropertiesChange=(e,t)=>{var o,i;const{config:n,top:s,left:l}=this.props;let r=!1;if(!window.jimuConfig.isInBuilder)return!1;let a=!1;const c=this.getCardSizeNumberInConfig(),d=this.getCardSizeNumberInConfig(null==t?void 0:t.widgetRect,e);this.updateScrollContentSize(e.config);const u=s!==e.top||l!==e.left,h=(null==n?void 0:n.layoutType)!==e.config.layoutType,g=(f=d,m=c,!((v=n.layoutType)===p.Column?_(f.width,m.width):(v===p.Row||_(f.width,m.width))&&_(f.height,m.height)));var f,m,v;if((h||g||u)&&(r=!0,g?(a=!0,this.updateCurrentCardSize(c),this.resetListElement()):h&&this.handleResizeCard(this.context.state.currentCardSize,!0,!1,!1,!0)),!a){((null==n?void 0:n.layoutType)===p.GRID?_(null==n?void 0:n.horizontalSpace,null===(o=e.config)||void 0===o?void 0:o.horizontalSpace)&&_(null==n?void 0:n.verticalSpace,null===(i=e.config)||void 0===i?void 0:i.verticalSpace):_(n.space,e.config.space))&&n.layoutType===e.config.layoutType||(a=!0,this.resetListElement())}return r},this.getCardSizeNumberInConfig=(e,t)=>{t=t||this.props,e=e||this.context.state.widgetRect;const{browserSizeMode:o,builderStatus:i,config:n}=t;return B(n,i,o,e)},this.listDivSizeChange=(e,t,o)=>{var s;const{config:l,isHeightAuto:r,showBottomTools:a,showTopTools:c,paginatorDiv:d}=this.props,{listDivSize:u,createDataSourceFailed:h}=this.state,{dataSource:g}=this.context.state,f=this.getCardSizeNumberInConfig();if(!this.isHasRenderList&&!h||g&&!this.preDataSource)return o;const m=null==e?void 0:e.showBottomTools,v=null==e?void 0:e.showTopTools;if(a!==m||c!==v)if(r)o=!0;else if(l.layoutType===p.Column){let e=(null===(s=this.context.state.widgetRect)||void 0===s?void 0:s.height)||(null==u?void 0:u.clientHeight);if(e-=U(d,a)+(c?1:0)*n,e<i)return;const t={height:e,width:f.width};this.handleResizeCard(t,!0,!1,!1,!0)}return o},this.appModeChange=e=>{const{appMode:o}=this.props;e.appMode!==o&&o===t.AppMode.Design&&this.scrollToIndex(0)},this.updateScrollContentSize=e=>{const{config:t}=this.props,o=(null==t?void 0:t.layoutType)===p.GRID?_(null==t?void 0:t.horizontalSpace,null==e?void 0:e.horizontalSpace)&&_(null==t?void 0:t.verticalSpace,null==e?void 0:e.verticalSpace):_(t.space,e.space);t.layoutType===e.layoutType&&o||this.setScrollContentSize()},this.checkIsSelectRecordsChange=e=>{var t;const o=(null==e?void 0:e.getSelectedRecordIds())||[],i=(null==this?void 0:this.lastSelectedRecordIds)||[];return(null==o?void 0:o.length)!==(null==i?void 0:i.length)||(null===(t=null==o?void 0:o.filter((e=>!(null==i?void 0:i.includes(e)))))||void 0===t?void 0:t.length)>0},this.getNewAddedSelectedRecordsId=e=>{const t=this.lastSelectedRecordIds||[],o=e.getSelectedRecordIds()||[];return null==o?void 0:o.filter((e=>!(null==t?void 0:t.includes(e))))},this.updateCreateDataSourceFailed=e=>{this.setState({createDataSourceFailed:e})},this.updateHasGetListSizeByResizeDetector=e=>{this.hasGetListSizeByResizeDetector=e},this.updateCardToolPosition=()=>{const{selectionIsSelf:e}=this.props;e&&!this.hideCardTool&&(this.setState({hideCardTool:!0}),this.hideCardTool=!0,clearTimeout(this.updateCardToolTimeout),this.updateCardToolTimeout=setTimeout((()=>{this.hideCardTool=!1,this.setState({hideCardTool:!1})}),500))},this.resetListElement=(e=!0)=>{var t,o,i,n,s;this.listRef.current&&((null===(t=this.props.config)||void 0===t?void 0:t.layoutType)===p.GRID?this.resetAfterIndices():(null===(i=null===(o=this.listRef)||void 0===o?void 0:o.current)||void 0===i?void 0:i.resetAfterIndex)&&(null===(s=null===(n=this.listRef)||void 0===n?void 0:n.current)||void 0===s||s.resetAfterIndex(0,e)))},this.toggleCardTool=(e=!1)=>{this.hideCardTool=e,this.setState({hideCardTool:e})},this.resetAfterIndices=(e=!0)=>{var t,o,i,n;(null===(o=null===(t=this.listRef)||void 0===t?void 0:t.current)||void 0===o?void 0:o.resetAfterIndices)&&(null===(n=null===(i=this.listRef)||void 0===i?void 0:i.current)||void 0===n||n.resetAfterIndices({columnIndex:0,rowIndex:0,shouldForceUpdate:e}))},this.selectRecordsAndPublishMessageAction=e=>{const{dataSource:o}=this.context.state;o&&(t.MessageManager.getInstance().publishMessage(new t.DataRecordsSelectionChangeMessage(this.props.id,e,[o.id])),e&&(this.lastSelectedRecordIds=(null==e?void 0:e.map((e=>e.getId())))||[],o.selectRecordsByIds(e.map((e=>e.getId())))))},this.formatMessage=(e,t)=>this.props.intl.formatMessage({id:e,defaultMessage:Li[e]},t),this.scrollToIndex=(e,t="start")=>{const{config:o}=this.props;if(this.listRef.current)if((null==o?void 0:o.layoutType)===p.GRID){const o=this.getItemColumnCount(),i=Math.floor(e/o);this.listRef.current.scrollToItem({columnIndex:e-i*o,rowIndex:i,align:t})}else this.listRef.current.scrollToItem(e,t)},this.scrollToSelectedItems=e=>{var t;const o=e.getSelectedRecordIds(),i=this.checkIsSelectRecordsChange(e);if(o&&o.length>0&&i&&(i||this.needScroll)){const i=this.getNewAddedSelectedRecordsId(e),n=(null==i?void 0:i.length)>0?i:o;let s=-1;if(null===(t=this.context.state.records)||void 0===t||t.forEach(((e,t)=>{var o;const i=null===(o=null==e?void 0:e.getId)||void 0===o?void 0:o.call(e);(null==n?void 0:n.includes(i))&&(s=t)})),-1===s){const t=e.getRecords();if(t&&t.forEach(((e,t)=>{var i;(null===(i=e.getId)||void 0===i?void 0:i.call(e))===o[0]&&(s=t)})),s>-1){const e=Math.ceil((s+1)/this.context.state.pageSize);this.needScroll=!0,this.updatePage(e)}}else this.scrollToIndex(s),this.needScroll=!1,this.autoScrollIndex=s,this.needAutoScrollToSelectedItemWhenLoadPage=!0,this.lastSelectedRecordIds=o||[]}},this.handleScrollUp=e=>{const{lastScrollOffset:t}=this,{config:o}=this.props,{currentCardSize:i}=this.context.state,n=this.getItemColumnCount();e&&(this.isScrollToNextStep=!0);const s=this.getScrollStep();let l=fe({lastScrollOffset:t,config:o,currentCardSize:i,columnCount:n})-s;l<0&&(l=0),this.scrollToIndex(l,"start"),this.isScrollToNextStep=!1},this.handleScrollDown=e=>{const{lastScrollOffset:t}=this,{config:o}=this.props,{currentCardSize:i}=this.context.state,n=this.getItemColumnCount();let s=0;if(e){s=function(e){const{lastScrollOffset:t,config:o,currentCardSize:i,columnCount:n,listItemContentSize:s}=e,l=ce(o,i),r=1*(t+((null==o?void 0:o.layoutType)===p.Column?s.width:s.height))/l;let a=Math.floor(r);const c=(r-a)*l,d=(null==o?void 0:o.layoutType)===p.GRID?null==o?void 0:o.verticalSpace:null==o?void 0:o.space;return a=(null==o?void 0:o.layoutType)===p.GRID?a*n-1:a,a<0&&(a=0),c>l-d&&(a=(null==o?void 0:o.layoutType)===p.GRID?a+n:a+1),a}({lastScrollOffset:t,config:o,currentCardSize:i,columnCount:n,listItemContentSize:this.getListSize()}),this.isScrollToNextStep=!0}else s=fe({lastScrollOffset:t,config:o,currentCardSize:i,columnCount:n});const l=this.getScrollStep(),{listVisibleStopIndex:r}=this;r+l>=this.context.state.records.length-1&&!this.isCurrentPageLastPage?(this.isSwitchPage=!0,this.updatePage(this.context.state.page+1)):this.needAutoScrollToSelectedItemWhenLoadPage?this.scrollToIndex(this.autoScrollIndex):this.scrollToIndex(s+l,"start")},this.getScrollStep=()=>{const{scrollStep:e,layoutType:t}=this.props.config,o=this.isScrollToNextStep?e:0,i=this.getItemColumnCount();return t===p.GRID?o*i:o},this.updatePage=(e,t)=>{e!==this.context.state.page&&(t&&(this.isSwitchPage=!0),this.context.dispatch({type:"SET_PAGE",value:e}))},this.lastScrollOffset=0,this.handleListScroll=({scrollDirection:e,scrollOffset:o,scrollTop:i,scrollUpdateWasRequested:n})=>{var s,l;const{appMode:a,config:c}=this.props,d=this.listOutDivRef,{scrollStatus:u,dataSource:h}=this.context.state;if(this.lastScrollOffset=(null==c?void 0:c.layoutType)===p.GRID?i:o,!d||(null!==(l=null===(s=this.context.state.records)||void 0===s?void 0:s.length)&&void 0!==l?l:0)<1)return;const g=c.pageStyle===r.Scroll&&this.context.state.queryStatus!==t.DataSourceStatus.Loading,f=!window.jimuConfig.isInBuilder||a!==t.AppMode.Design;g&&h&&f&&(this.isHasScrolled=!0,!function(e,t){return!e||t<2}(d,this.lastScrollOffset)?"mid"!==u&&this.updateScrollStatus("mid"):"start"!==u&&this.updateScrollStatus("start")),this.updateFirstItemIndexInViewport()},this.updateFirstItemIndexInViewport=()=>{const{lastScrollOffset:e}=this,{config:t}=this.props,{currentCardSize:o}=this.context.state,i=fe({lastScrollOffset:e,config:t,currentCardSize:o,columnCount:this.getItemColumnCount(),completelyVisibleItem:!0});this.context.dispatch({type:"SET_FIRST_ITEM_INDEX_IN_VIEWPORT",value:i||0})},this.updateScrollStatus=e=>{this.context.dispatch({type:"SET_SCROLL_STATUS",value:e})},this.handleResizeCard=(e,t=!1,o,i,n=!1)=>{if(t){const t=this.initNewCardSize(e),{id:o,browserSizeMode:i,config:s}=this.props,l={widgetId:o,browserSizeMode:i,newCardSize:t,widgetConfig:s};window.jimuConfig.isInBuilder&&this.props.builderSupportModules.widgetModules.handleResizeCard(l,n)}else this.updateCurrentCardSize(e),this.resetListElement(!1)},this.initNewCardSize=e=>{const{config:o,browserSizeMode:i,builderStatus:n}=this.props,{widgetRect:s}=this.context.state;return((e,o,i,n,s)=>{let l=(0,t.Immutable)(e);const r=H(o,i,n);return r.width.unit===j.DistanceUnits.PERCENTAGE&&(l=l.set("width",100*e.width/(s.width+(null==o?void 0:o.horizontalSpace)-8)+"%")),r.height.unit===j.DistanceUnits.PERCENTAGE&&(l=l.set("height",100*e.height/s.height+"%")),null==l?void 0:l.asMutable({deep:!0})})(e,o,n,i,s)},this.handleRefreshList=e=>{const{id:t,config:o}=this.props;e.load(this.queryOptions,{widgetId:t,refresh:!0}),o.showRecordCount&&e.loadCount(this.queryOptions,{widgetId:t,refresh:!0})},this.getListSize=()=>{const{widgetRect:e}=this.context.state,{id:t,config:o,useDataSources:n,paginatorDiv:s}=this.props,{dataSource:l}=this.context.state;return function(e){const{id:t,config:o,useDataSources:n,datasource:s,paginatorDiv:l,widgetRect:r}=e,a=q(t,o,n),c=G(r,U(l,V(o,s)),a)||1;return{width:r&&r.width||i,height:c}}({id:t,datasource:l,widgetRect:e,config:o,useDataSources:null==n?void 0:n.asMutable({deep:!0}),paginatorDiv:s})},this.setListRef=e=>{this.listRef.current=e},this.handleListKeyUp=e=>{"Escape"===e.key&&this.focusInteractiveNode(!1)},this.focusInteractiveNode=(e=!1)=>{var o;const{showBottomTools:i,showTopTools:n,paginatorDiv:s}=this.props,l=e?n:i,r=e?this.jumpOutNodeOfListInTop:this.jumpOutNodeOfListInBottom;if(l){const i=e?this.topToolsContainer:s,n=null===(o=(0,j.getFocusableElements)(i))||void 0===o?void 0:o.filter((e=>!(null==e?void 0:e.disabled)));(null==n?void 0:n.length)>0?(0,t.focusElementInKeyboardMode)(n[0]):(0,t.focusElementInKeyboardMode)(r)}else(0,t.focusElementInKeyboardMode)(r)},this.loadNextPageWhenListSizeOrTotalCountChange=()=>{const{config:e}=this.props;e.pageStyle===r.Scroll&&(clearTimeout(this.loadMoreDataTimeout),this.loadMoreDataTimeout=setTimeout((()=>{this.isScrollEnd&&(this.isHasScrolled=!0,this.scrollToEndCallback(!0))}),500))},this.setListOutDivRef=e=>{e&&(this.listOutDivRef=e,this.setListDivSize(),this.setScrollContentSize())},this.getDsSelectRecords=()=>{const e=this.context.state.dataSource,{config:t}=this.props;let o;return e&&t.isItemStyleConfirm&&(o=e.getSelectedRecords()),o},this.getListStyle=()=>{const{config:e,appMode:t,theme:o,isHeightAuto:i,isWidthAuto:n,showBottomTools:s,showTopTools:l,paginatorDiv:r}=this.props,{currentCardSize:a,widgetRect:c}=this.context.state,d=U(r,s),u=this.getCardSizeNumberInConfig(),p={pageStyle:null==e?void 0:e.pageStyle,scrollBarOpen:null==e?void 0:e.scrollBarOpen,direction:null==e?void 0:e.direction,appMode:t,theme:o,isHeightAuto:i,isWidthAuto:n,listTemplateDefaultCardSize:u,showTopTools:l,bottomToolH:d,mexSize:this.getListMaxSize(),layoutType:null==e?void 0:e.layoutType,listLeftPadding:he(e,c,a)};return D(p)},this.setScrollContentSize=()=>{var e;if(!this.listOutDivRef)return;const{layoutType:t}=null===(e=this.props)||void 0===e?void 0:e.config,o=this.listOutDivRef.getElementsByTagName("div")[0];t===p.Column?o.style.height="100%":o.style.width="100%"},this.scrollToEndCallback=e=>{var o,i;const{appMode:n,config:s}=this.props,l=this.listOutDivRef,{dataSource:a}=this.context.state;if(this.setState({isScrollEnd:e}),this.isScrollEnd=e,!l||(null!==(i=null===(o=this.context.state.records)||void 0===o?void 0:o.length)&&void 0!==i?i:0)<1)return;const c=s.pageStyle===r.Scroll,d=this.context.state.queryStatus!==t.DataSourceStatus.Loading,u=!window.jimuConfig.isInBuilder||n!==t.AppMode.Design&&e;c&&d&&a&&u&&this.isHasScrolled&&(this.isCurrentPageLastPage?e&&this.updateScrollStatus("end"):(this.updatePage(this.context.state.page+1),this.isSwitchPage=!0))},this.setListDivSize=()=>{const e=this.listOutDivRef,t=(null==e?void 0:e.clientWidth)||null,o=(null==e?void 0:e.clientHeight)||null;this.setState({listDivSize:{clientWidth:t,clientHeight:o}})},this.getListMaxSize=()=>{const{boundingBox:e,heightLayoutItemSizeModes:o,layoutId:i,appMode:n,pageMode:s,browserSizeMode:l}=this.props;return(e=>{var o,i,n,s,l,r,a,c,d,u,p;const{boundingBox:h,heightLayoutItemSizeModes:g,layoutId:f,appMode:m,pageMode:v,browserSizeMode:S}=e,y=ae(),w=g===A.LayoutItemSizeModes.Custom&&(null==h?void 0:h.height),b=se(f,S),x="auto"===(null===(i=null===(o=null==b?void 0:b.autoProps)||void 0===o?void 0:o.width)||void 0===i?void 0:i.toLowerCase())||"auto"===(null===(n=null==b?void 0:b.widthMode)||void 0===n?void 0:n.toLowerCase()),I=(null===(l=null===(s=null==b?void 0:b.autoProps)||void 0===s?void 0:s.height)||void 0===l?void 0:l.toLowerCase)&&"auto"===(null===(a=null===(r=null==b?void 0:b.autoProps)||void 0===r?void 0:r.height)||void 0===a?void 0:a.toLowerCase())||"auto"===(null===(c=null==b?void 0:b.heightMode)||void 0===c?void 0:c.toLowerCase())||!b,C=v===t.PageMode.AutoScroll&&I?600:y.clientHeight,T=m===t.AppMode.Design?C:y.clientHeight,R=w?null==h?void 0:h.height:T,O=w&&!((null===(d=null==h?void 0:h.height)||void 0===d?void 0:d.includes)&&(null===(u=null==h?void 0:h.height)||void 0===u?void 0:u.includes("%")));let E=(0,t.Immutable)({maxWidth:y.scrollWidth,maxHeight:R,maxSizeIsBodySize:!1});const M=(0,t.getAppStore)().getState().appConfig,{layouts:j}=M,D=null===(p=j[f])||void 0===p?void 0:p.type;if(D===t.LayoutType.ColumnLayout&&x&&(E=E.set("maxWidth",y.clientWidth).set("maxSizeIsBodySize",!0)),"ROW"===D&&I&&!O){const e=m===t.AppMode.Design?C:y.clientHeight,o=m!==t.AppMode.Design;E=E.set("maxHeight",e).set("maxSizeIsBodySize",o)}return E=E.set("maxHeight",le(E.maxHeight)),E=E.set("maxWidth",le(E.maxWidth)),E})({boundingBox:e,heightLayoutItemSizeModes:o,layoutId:i,appMode:n,pageMode:s,browserSizeMode:l})},this.onItemsRendered=({overscanStartIndex:e,overscanStopIndex:t,visibleStartIndex:o,visibleStopIndex:i,visibleColumnStartIndex:n,visibleColumnStopIndex:s,visibleRowStartIndex:l,visibleRowStopIndex:a})=>{const{config:c}=this.props;this.listVisibleStartIndex=(null==c?void 0:c.layoutType)===p.GRID?this.getItemIndexByRowAndColumnIndex(l,n):o,this.listVisibleStopIndex=(null==c?void 0:c.layoutType)===p.GRID?this.getItemIndexByRowAndColumnIndex(a,s):i,this.needRefreshListOnListRendered&&(this.needRefreshListOnListRendered=!1,this.resetListElement()),this.isSwitchPage||(c.pageStyle===r.Scroll?this.context.state.records.length>this.listVisibleStopIndex+1&&(this.isSwitchPage=!1,this.onItemsRenderedTimeout=setTimeout((()=>{this.handleScrollDown(null),this.isScrollToNextStep&&(this.isScrollToNextStep=!1)}),500)):this.isSwitchPage=!1)},this.getItemIndexByRowAndColumnIndex=(e,t)=>e*this.getItemColumnCount()+t,this.getItemColumnCount=()=>{const{config:e}=this.props,{currentCardSize:t,widgetRect:o}=this.context.state;return de(e,o,t)},this.onListContainerMouseMove=()=>{this.needAutoScrollToSelectedItemWhenLoadPage&&this.context.state.records&&(this.needAutoScrollToSelectedItemWhenLoadPage=!1)},this.updateQueryOptions=e=>{this.queryOptions=e},this.updateTopToolsContainer=e=>{this.topToolsContainer=e},this.updateBottomToolsContainer=e=>{this.bottomToolsContainer=e},this.renderContentOfListWidget=()=>{const{LayoutEntry:e,isScrollEnd:o}=this.state,{config:i,useDataSources:n,id:s,selectionIsInSelf:l,selectionIsSelf:r,appMode:a,builderStatus:c,builderSupportModules:d,layouts:u,isEditing:p,showBottomTools:h,showTopTools:g,paginatorDiv:f,setPaginatorDivRef:m}=this.props,{dataSource:v,page:S,records:y,pageSize:w}=this.context.state,b={id:s,config:i,selectionIsInSelf:l,selectionIsSelf:r,builderStatus:c,builderSupportModules:d,layouts:u};return this.isHasRenderList=!0,this.isCurrentPageLastPage=$(v,S,w,null==y?void 0:y.length),(0,t.jsx)("div",{className:"list-container animation",css:this.getListStyle()},(0,t.jsx)("div",{className:"sr-only",tabIndex:-1,ref:e=>{this.jumpOutNodeOfListInTop=e}},this.formatMessage("pressTabToContinue")),g&&(0,t.jsx)(Ot,{id:s,useDataSources:n,config:i,isEditing:p,selectRecords:this.getDsSelectRecords(),scrollToIndex:this.scrollToIndex,handleRefreshList:this.handleRefreshList,selectRecordsAndPublishMessageAction:this.selectRecordsAndPublishMessageAction,updateTopToolsContainer:this.updateTopToolsContainer}),(0,t.jsx)(Qo,{listProps:b,LayoutEntry:e,hideCardTool:this.hideCardTool,useDataSources:n,getListSize:this.getListSize,toggleCardTool:this.toggleCardTool,handleListScroll:this.handleListScroll,setListOutDivRef:this.setListOutDivRef,handleResizeCard:this.handleResizeCard,onItemsRendered:this.onItemsRendered,setListRef:this.setListRef,scrollToEndCallback:this.scrollToEndCallback,resetListElement:this.resetListElement,selectRecordsAndPublishMessageAction:this.selectRecordsAndPublishMessageAction,handleListKeyUp:this.handleListKeyUp}),h&&(0,t.jsx)("div",{ref:e=>{m(e)}},(0,t.jsx)(qt,{isScrollEnd:o,config:i,hidePageTotal:null==i?void 0:i.hidePageTotal,handleScrollUp:this.handleScrollUp,handleScrollDown:this.handleScrollDown,updatePage:this.updatePage})),(0,t.jsx)(Di,{isEditing:oe(a,i,r,l),config:i,showTopTools:g,showBottomTools:h,bottomCon:f}),(0,t.jsx)(Ci,{config:i,useDataSources:null==n?void 0:n.asMutable({deep:!0})}),(0,t.jsx)(ci,{config:i,appMode:this.props.appMode,LayoutEntry:e,showLoadingWhenConfirmSelectTemplate:this.props.showLoadingWhenConfirmSelectTemplate}),i.showRecordCount&&(0,t.jsx)(ei,null),(0,t.jsx)("div",{id:"describeByMessage",className:"sr-only"},this.formatMessage("describeMessage")),(0,t.jsx)("div",{className:"sr-only",tabIndex:-1,ref:e=>{this.jumpOutNodeOfListInBottom=e}},this.formatMessage("pressTabToContinue")))};const o={LayoutEntry:null,showList:!0,hideCardTool:!1,showLoading:!1,listDivSize:{clientWidth:null,clientHeight:null},isScrollEnd:!1,isMount:!1,createDataSourceFailed:!1};window.jimuConfig.isInBuilder?o.LayoutEntry=this.props.builderSupportModules.LayoutEntry:o.LayoutEntry=A.LayoutEntry,this.state=o,this.handleResizeCard=this.handleResizeCard.bind(this)}componentDidMount(){this.setState({isMount:!0})}componentWillUnmount(){clearTimeout(this.updateCardToolTimeout),clearTimeout(this.setPageTimeout),clearTimeout(this.onItemsRenderedTimeout)}componentDidUpdate(e,t){const{dataSource:o}=this.context.state;this.updateSizeAndCardPositionWhenPropsChangeInBuilder(e,t),this.appModeChange(e),this.selectRecordsWhenConfigChange(e),this.preDataSource=o}render(){const{config:e,id:o,useDataSources:i,activeSort:n,builderStatus:s,showTopTools:l,showBottomTools:r,paginatorDiv:a,showLoadingWhenConfirmSelectTemplate:c}=this.props,{createDataSourceFailed:d,isMount:u,LayoutEntry:p}=this.state;return(0,t.jsx)(t.React.Fragment,null,(0,t.jsx)("div",{className:"widget-list d-flex",onMouseMove:this.onListContainerMouseMove},u&&this.hasGetListSizeByResizeDetector&&!this.context.state.showWidgetLoading&&this.renderContentOfListWidget(),(0,t.jsx)(Ei,{id:o,useDataSources:i,createDataSourceFailed:d})),(0,t.jsx)(mi,{targetRef:this.props.listWidgetConRef,id:o,showTopTools:l,showBottomTools:r,paginatorDiv:a,config:e,builderStatus:s,isScrollEnd:this.isScrollEnd,isCurrentPageLastPage:this.isCurrentPageLastPage,resetListElement:this.resetListElement,loadNextPageWhenListSizeOrTotalCountChange:this.loadNextPageWhenListSizeOrTotalCountChange,updateCardToolPosition:this.updateCardToolPosition,setListDivSize:this.setListDivSize,handleResizeCard:this.handleResizeCard,updateHasGetListSizeByResizeDetector:this.updateHasGetListSizeByResizeDetector}),(0,t.jsx)(hi,{id:o,useDataSources:i,config:e,activeSort:n,noLayoutEntry:!p,showLoadingWhenConfirmSelectTemplate:c,updateQueryOptions:this.updateQueryOptions,scrollToSelectedItems:this.scrollToSelectedItems,updateCreateDataSourceFailed:this.updateCreateDataSourceFailed,loadNextPageWhenListSizeOrTotalCountChange:this.loadNextPageWhenListSizeOrTotalCountChange}))}}ki.contextType=R;const zi=ki,{useEffect:Ni,useState:Pi}=t.React,Ai=e=>{const o=t.ReactRedux.useSelector((e=>null==e?void 0:e.browserSizeMode)),i=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),[n,s]=Pi(!1);Ni((()=>{l(e)}),[e]);const l=t.hooks.useEventCallback((e=>{const{config:l,selectionIsInSelf:r,selectionIsSelf:a,builderStatus:c,layouts:d,forceShowMask:u}=e;let p=n;const h=(0,t.getAppStore)().getState().appConfig,g=window.jimuConfig.isInBuilder,f=null==h?void 0:h.layouts[A.searchUtils.findLayoutId((0,t.Immutable)(d[c]),o,h.mainSizeMode)],m=f&&f.type;p=!(!g||i===t.AppMode.Run)&&(i===t.AppMode.Express?!(l.isItemStyleConfirm||!m):u||!r&&!a||!l.isItemStyleConfirm&&m),s(p)}));return(0,t.jsx)(t.React.Fragment,null,n&&(0,t.jsx)("div",{className:"list-with-mask"}))},{useRef:_i,useState:$i,useEffect:Bi,Fragment:Fi}=t.React,Hi=e=>{const o=t.hooks.useTranslation(me,j.defaultMessages),n=_i(null),s=_i(null),l=_i(!1),c=_i(null),d=_i(null),u=_i(0),{id:h,config:g,appMode:f,selectionIsSelf:m,selectionIsInSelf:S,useDataSources:y,layouts:w,builderStatus:b,parentSize:x,browserSizeMode:I,dispatch:C,selectionStatus:T,layoutId:R,layoutItemId:O,isHeightAuto:D,isWidthAuto:L}=e,{dataSource:z,showSelectionOnly:N,widgetRect:P,currentCardSize:A,firstItemIndexInViewport:_,records:$}=E(),H=M(),W=t.ReactRedux.useSelector((e=>{var t,o;return null===(o=null===(t=null==e?void 0:e.appConfig.widgets)||void 0===t?void 0:t[h])||void 0===o?void 0:o.enableDataAction})),K=t.ReactRedux.useSelector((e=>{var t,o,i;return"number"==typeof(null===(i=null===(o=null===(t=null==e?void 0:e.dynamicStyleState)||void 0===t?void 0:t.previewConditionInfo)||void 0===o?void 0:o[h])||void 0===i?void 0:i.conditionId)})),Y=t.ReactRedux.useSelector((e=>{var t,o,i;return null===(i=null===(o=null===(t=null==e?void 0:e.dynamicStyleState)||void 0===t?void 0:t.previewRepeatedRecordInfo)||void 0===o?void 0:o[h])||void 0===i?void 0:i.needUpdateRecordIndex})),[Q,Z]=$i(!1),[X,J]=$i(!1),[ee,te]=$i(!1),[ie,ne]=$i(!1);Bi((()=>{const e=le(),t=B(g,b,I,e);H({type:"SET_CURRENT_CARD_SIZE",value:t}),H({type:"SET_WIDGET_RECT",value:e})}),[]),Bi((()=>{ae(f)}),[f]),Bi((()=>{const e=oe(f,g,m,S);Z(e)}),[f,g,m,S]),Bi((()=>{u.current=_}),[_]),Bi((()=>{(Q||K||Y)&&C(t.appActions.changeDynamicStylePreviewRepeatedRecordInfo(h,{recordIndex:u.current,needUpdateRecordIndex:!1}))}),[Q,$,K,C,h,f,Y]),Bi((()=>{const e=V(g,z);te(e)}),[z,g]),Bi((()=>{he(R,O,h,m)}),[R,O,h,m]),Bi((()=>{const e=q(h,g,null==y?void 0:y.asMutable({deep:!0}));J(e)}),[z,g,y,h,W]),Bi((()=>{var e,t;const o=g.itemsPerPage&&g.itemsPerPage!==(null===(e=c.current)||void 0===e?void 0:e.itemsPerPage),i=g.pageStyle&&g.pageStyle!==(null===(t=c.current)||void 0===t?void 0:t.pageStyle);(o||i)&&H({type:"SET_PAGE",value:1}),c.current=g}),[g]),Bi((()=>{const e=ge({config:g,isHeightAuto:D,isWidthAuto:L,builderStatus:b,browserSizeMode:I,showBottomTools:ee,showTopTools:X,widgetRect:P});H({type:"SET_PAGE_SIZE",value:e})}),[g,D,L,b,I,ee,X,P,g]),Bi((()=>{C(t.appActions.widgetStatePropChange(h,"selectionIsInSelf",S))}),[S,h,C]),Bi((()=>{fe(I,h,x,R)}),[I,h,x,R]);const se=t.hooks.useEventCallback((e=>{!window.jimuConfig.isInBuilder||f!==t.AppMode.Design||m||S||re(e)})),le=t.hooks.useEventCallback((()=>function(e,t,o){const n=F(e,t,o),s={width:i,height:i},l=j.utils.toLinearUnit(n.width),r=j.utils.toLinearUnit(n.height);return l.unit===j.DistanceUnits.PERCENTAGE&&(s.width=50/l.distance*100),r.unit===j.DistanceUnits.PERCENTAGE&&(s.height=50/r.distance*100),s}(g,b,I))),re=e=>{ne(!0),s.current&&clearTimeout(s.current),s.current=setTimeout((()=>{ne(!1)}),200)},ae=t.hooks.useEventCallback((e=>{e!==t.AppMode.Design?ce(v.Default):(T!==b&&(T?ce(T):m||ce(v.Default)),ue(!1))})),ce=e=>{pe("showCardSetting",e),pe("builderStatus",e)},ue=e=>{H({type:"SET_SHOW_SELECTION_ONLY",value:N})},pe=(e,o)=>{C(t.appActions.widgetStatePropChange(h,e,o))},he=(e,o,i,n)=>{e&&i&&o&&!l.current&&n&&(C(t.appActions.widgetStatePropChange(i,"layoutInfo",{layoutId:e,layoutItemId:o})),l.current=!0)},ge=e=>{const{config:t,isHeightAuto:o,isWidthAuto:i,builderStatus:n,browserSizeMode:s,showBottomTools:l,showTopTools:a,widgetRect:c}=e,u={widgetRect:c,listHeight:G(c,U(d.current,l),a)||1,columnCount:(null==t?void 0:t.layoutType)===p.GRID?de(t,c,A):null,config:t,isHeightAuto:o,isWidthAuto:i,builderStatus:n,browserSizeMode:s},h=Math.max(function(e){const{widgetRect:t,columnCount:o,config:i,isHeightAuto:n,isWidthAuto:s,builderStatus:l,browserSizeMode:a}=e;let{listHeight:c}=e;const d=B(i,l,a,t);let u;if(i.pageStyle===r.Scroll){if(!t)return 0;switch(null==i?void 0:i.layoutType){case p.Row:if(0===t.height)return 0;n&&(c=document.body.scrollHeight),u=Math.ceil((c+i.space)/(d.height+i.space))+1;break;case p.Column:if(0===t.width)return 0;let e=t.width;s&&(e=document.body.scrollWidth),u=Math.ceil((e+i.space)/(d.width+i.space))+1;break;case p.GRID:if(0===t.height)return 0;n&&(c=document.body.scrollHeight),u=Math.ceil((c+(null==i?void 0:i.verticalSpace))/(d.height+i.space))*o}i.navigatorOpen&&(u=Math.max(u,i.scrollStep))}else u=i.itemsPerPage;return u}(u),1);return h},fe=(e,o,i,n)=>{const s=(0,t.getAppStore)().getState().appConfig,l=t.utils.findViewportSize(s,e),r=`div.layout[data-layoutid=${n}]`,a=document.querySelector(r),c={width:(null==a?void 0:a.clientWidth)||l.width,height:(null==a?void 0:a.clientHeight)||l.height};i&&i.height===c.height&&i.width===c.width||C(t.appActions.widgetStatePropChange(o,"parentSize",c))};return(0,t.jsx)(Fi,null,!g.itemStyle&&(0,t.jsx)(j.WidgetPlaceholder,{name:o("_widgetLabel"),icon:a(70778),message:o("placeHolderTip")}),g.itemStyle&&(0,t.jsx)("div",{className:(0,t.classNames)("jimu-widget","widget-list","list-widget-"+h),ref:n,css:k(e,Q,ee),onPointerDown:se},(0,t.jsx)(zi,Object.assign({},e,{listWidgetConRef:n,isEditing:Q,showTopTools:X,showBottomTools:ee,setPaginatorDivRef:e=>{d.current=e},paginatorDiv:d.current})),(0,t.jsx)(Ai,{config:g,selectionIsInSelf:S,selectionIsSelf:m,builderStatus:b,forceShowMask:ie,layouts:w})))},{useSelector:Wi}=t.ReactRedux,Ui=e=>{const o=t.React.useRef(null),i=Wi((i=>{const n=function(e,o){var i,n,s,l,r,a,c,d,u,p,h,g,f,m,S,y,w,b,x,I,C,T,R,O,E,M,j,D,L;const k=null==e?void 0:e.appConfig,{layouts:z,layoutId:N,layoutItemId:P,builderSupportModules:_,id:$}=o,B=null==e?void 0:e.browserSizeMode,F=(null===(n=null===(i=null==e?void 0:e.widgetsState)||void 0===i?void 0:i[o.id])||void 0===n?void 0:n.builderStatus)||v.Default;let H;if(k){const o=k&&e.appConfig.layouts&&e.appConfig.layouts[A.searchUtils.findLayoutId((0,t.Immutable)(z[F]),B,k.mainSizeMode)];H=o&&o.type}const W=null===(s=k.layouts)||void 0===s?void 0:s[N],U=null===(r=null===(l=null==W?void 0:W.content)||void 0===l?void 0:l[P])||void 0===r?void 0:r.setting,G=(null===(a=null==U?void 0:U.autoProps)||void 0===a?void 0:a.height)===A.LayoutItemSizeModes.Auto||!0===(null===(c=null==U?void 0:U.autoProps)||void 0===c?void 0:c.height),V=(null===(d=null==U?void 0:U.autoProps)||void 0===d?void 0:d.width)===A.LayoutItemSizeModes.Auto||!0===(null===(u=null==U?void 0:U.autoProps)||void 0===u?void 0:u.width);let q;if(window.jimuConfig.isInBuilder){const e=null===(f=null===(g=null===(h=null===(p=k.layouts)||void 0===p?void 0:p[N])||void 0===h?void 0:h.content)||void 0===g?void 0:g[P])||void 0===f?void 0:f.bbox;q=e&&{left:e.left,top:e.top}}const K=e&&e.appRuntimeInfo&&e.appRuntimeInfo.selection,Y=K&&(null===(m=null==_?void 0:_.widgetModules)||void 0===m?void 0:m.selectionInList(K,$,k,!1));let Q;Y&&(Q=Object.keys(z).find((e=>A.searchUtils.findLayoutId((0,t.Immutable)(z[e]),B,k.mainSizeMode)===K.layoutId)));const Z=!(!K||K.layoutId!==N||K.layoutItemId!==P),X=null===(S=null==e?void 0:e.appRuntimeInfo)||void 0===S?void 0:S.currentPageId,J=null===(b=null===(w=null===(y=null==e?void 0:e.appConfig)||void 0===y?void 0:y.pages)||void 0===w?void 0:w[X])||void 0===b?void 0:b.mode;return{selectionIsSelf:Z,selectionIsInSelf:!!Y,selectionStatus:Q,appMode:null===(x=null==e?void 0:e.appRuntimeInfo)||void 0===x?void 0:x.appMode,browserSizeMode:e&&e.browserSizeMode,builderStatus:(null===(C=null===(I=e.widgetsState)||void 0===I?void 0:I[o.id])||void 0===C?void 0:C.builderStatus)||v.Default,showLoadingWhenConfirmSelectTemplate:null===(R=null===(T=null==e?void 0:e.widgetsState)||void 0===T?void 0:T[o.id])||void 0===R?void 0:R.showLoading,activeSort:null===(E=null===(O=null==e?void 0:e.widgetsState)||void 0===O?void 0:O[o.id])||void 0===E?void 0:E.activeSort,isRTL:e&&e.appContext&&e.appContext.isRTL,subLayoutType:H,left:q&&q.left,top:q&&q.top,isHeightAuto:G,isWidthAuto:V,queryObject:e.queryObject,boundingBox:null===(j=null===(M=null==W?void 0:W.content)||void 0===M?void 0:M[P])||void 0===j?void 0:j.bbox,heightLayoutItemSizeModes:null===(D=null==U?void 0:U.autoProps)||void 0===D?void 0:D.height,parentSize:(null===(L=e.widgetsState[o.id])||void 0===L?void 0:L.parentSize)||null,pageMode:J}}(i,e);return JSON.stringify(o.current)===JSON.stringify(n)?o.current:(o.current=n,n)}));return t.React.createElement("div",{className:"jimu-widget widget-chart"},t.React.createElement(O,null,t.React.createElement(Hi,Object.assign({},i,e))))};Ui.versionManager=b;const Gi=Ui;function Vi(e){a.p=e}})(),c})())}}}));