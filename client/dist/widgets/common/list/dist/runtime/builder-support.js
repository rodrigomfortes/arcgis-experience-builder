System.register(["jimu-core","jimu-core/dnd","jimu-ui","jimu-for-builder","jimu-layouts/layout-runtime","jimu-layouts/layout-builder","jimu-theme"],(function(e,t){var o={},i={},s={},n={},r={},l={},a={};return{setters:[function(e){o.AppMode=e.AppMode,o.BrowserSizeMode=e.BrowserSizeMode,o.Immutable=e.Immutable,o.LayoutItemType=e.LayoutItemType,o.React=e.React,o.ReactRedux=e.ReactRedux,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.defaultMessages=e.defaultMessages,o.getAppStore=e.getAppStore,o.hooks=e.hooks,o.jsx=e.jsx,o.utils=e.utils},function(e){i.interact=e.interact},function(e){s.Button=e.Button,s.ButtonGroup=e.ButtonGroup,s.Dropdown=e.Dropdown,s.DropdownButton=e.DropdownButton,s.DropdownItem=e.DropdownItem,s.DropdownMenu=e.DropdownMenu,s.ListGroupItem=e.ListGroupItem,s.Popper=e.Popper,s.defaultMessages=e.defaultMessages,s.styleUtils=e.styleUtils},function(e){n.LayoutServiceProvider=e.LayoutServiceProvider,n.builderAppSync=e.builderAppSync,n.getAppConfigAction=e.getAppConfigAction,n.widgetService=e.widgetService},function(e){r.searchUtils=e.searchUtils},function(e){l.GLOBAL_DRAGGING_CLASS_NAME=e.GLOBAL_DRAGGING_CLASS_NAME,l.GLOBAL_H5_DRAGGING_CLASS_NAME=e.GLOBAL_H5_DRAGGING_CLASS_NAME,l.GLOBAL_RESIZING_CLASS_NAME=e.GLOBAL_RESIZING_CLASS_NAME},function(e){a.withBuilderTheme=e.withBuilderTheme}],execute:function(){e((()=>{var e={1888:e=>{"use strict";e.exports=a},4108:e=>{"use strict";e.exports=n},6055:e=>{"use strict";e.exports=l},10527:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="m2.116 1.5.969 1.678H1.05v3H0l1.5 2 1.5-2h-.951v-2h1.614l4.618 8H2.049v-2H1.05v3h7.809l1.257 2.178.866-.5L2.982 1zm9.982 8.678h.95v2h-2.611l.576 1h3.036v-3h1.05l-1.501-2zm.951-4v-2H5.817l-.578-1h8.81v3z" clip-rule="evenodd"></path></svg>'},14321:e=>{"use strict";e.exports=s},26245:e=>{"use strict";e.exports=i},41496:e=>{"use strict";e.exports=r},73027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path fill="#000" fill-rule="evenodd" d="M1.049 6V3h13v3h-1V4h-11v2H3L1.5 7.999 0 6zm12 4h-.952l1.5-2 1.5 2h-1.049v3H1.05v-3h1v2h11z" clip-rule="evenodd"></path></svg>'},79244:e=>{"use strict";e.exports=o}},t={};function d(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,d),s.exports}d.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return d.d(t,{a:t}),t},d.d=(e,t)=>{for(var o in t)d.o(t,o)&&!d.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.p="";var c={};return d.p=window.jimuConfig.baseUrl,(()=>{"use strict";d.r(c),d.d(c,{default:()=>H});var e,t=d(79244),o=d(26245),i=d(14321),s=d(4108),n=d(41496);!function(e){e.AUTO="Auto",e.CUSTOM="Custom"}(e||(e={}));var r,l,a,u,p,g,h,m,f,S,y;!function(e){e.None="NONE",e.Arrangement="ARRANGEMENT",e.States="STATES",e.Tools="TOOLS"}(r||(r={})),function(e){e.None="NONE",e.Single="SINGLE",e.Multiple="MULTIPLE"}(l||(l={})),function(e){e.Scroll="SCROLL",e.MultiPage="MULTIPAGE"}(a||(a={})),function(e){e.Start="FLEX-START",e.Center="CENTER",e.End="FLEX-END"}(u||(u={})),function(e){e.Horizon="HORIZON",e.Vertical="VERTICAL"}(p||(p={})),function(e){e.Row="ROW",e.Column="COLUMN",e.GRID="GRID"}(g||(g={})),function(e){e.Glide="GLIDE",e.Fade="FADE",e.Float="FLOAT"}(h||(h={})),function(e){e.Hover0="HOVER0",e.Hover1="HOVER1",e.Hover2="HOVER2",e.Hover3="HOVER3"}(m||(m={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3"}(f||(f={})),function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3",e.Style4="STYLE4",e.Style5="STYLE5",e.Style6="STYLE6",e.Style7="STYLE7",e.Style8="STYLE8",e.Style9="STYLE9",e.Style10="STYLE10",e.Style11="STYLE11",e.Style12="STYLE12"}(S||(S={})),function(e){e.Default="DEFAULT",e.Selected="SELECTED",e.Hover="HOVER"}(y||(y={}));var v=d(6055);class b extends t.React.PureComponent{constructor(e){super(e),this.onDropDownToggle=e=>{e.stopPropagation();const{isDropDownOpen:t,onDropDownOpenChange:o}=this.props;if(void 0!==t)o&&o(!t);else{const{isOpen:e}=this.state;this.setState({isOpen:!e})}},this.onItemClick=(e,t)=>{const{isDropDownOpen:o,onDropDownOpenChange:i}=this.props;void 0!==o?i&&i(!1):this.setState({isOpen:!1}),t.event(e,t),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.onDropDownMouseClick=e=>{e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},this.getStyle=()=>{var e,o,i,s;const{theme:n}=this.props;return t.css`
      & button {
        padding: 0;
      }
      .list-toggle-button {
        background: ${null===(o=null===(e=null==n?void 0:n.ref.palette)||void 0===e?void 0:e.neutral)||void 0===o?void 0:o[500]};
        border: none;
        &:hover, &[aria-expanded="true"] {
          background: ${null===(s=null===(i=null==n?void 0:n.ref.palette)||void 0===i?void 0:i.neutral)||void 0===s?void 0:s[700]};
        }
      }
    `},this.state={isOpen:!1};const{withBuilderTheme:o}=e;this.MyDropdown=o?o(i.Dropdown):i.Dropdown,this.MyDropdownButton=o?o(i.DropdownButton):i.DropdownButton,this.MyDropdownMenu=o?o(i.DropdownMenu):i.DropdownMenu,this.MyDropdownItem=o?o(i.DropdownItem):i.DropdownItem}render(){const{items:e,toggleContent:o,toggleType:i,toggleArrow:s,menuContent:n,appMode:r,modifiers:l,toggleIsIcon:a,theme:d,isDropDownOpen:c,size:u,appendToBody:p,toggleTitle:g,direction:h,menuCss:m,className:f,showActive:S,activeLabel:y,fluid:v,activeIcon:b}=this.props;let{isOpen:I}=this.state;I=void 0===c?I:c;const{MyDropdown:w,MyDropdownButton:L,MyDropdownMenu:C,MyDropdownItem:A}=this;return(0,t.jsx)(w,{size:u,toggle:this.onDropDownToggle,direction:h,fluid:v,isOpen:I&&r!==t.AppMode.Design,className:`my-dropdown ${f}`,css:this.getStyle(),activeIcon:b,menuRole:"listbox"},o&&(0,t.jsx)(L,{icon:a,title:g,size:u,type:i,className:"list-toggle-button",arrow:s,role:"combobox"},o&&o(d)),(0,t.jsx)(C,{appendToBody:p,modifiers:l,css:m&&m(d),referenceHiddenVisibility:!0},n?n(d):e&&e.asMutable().map(((e,o)=>!e.hide&&(0,t.jsx)(A,{key:o,className:"no-user-select",title:e.label,active:S&&e.label===y,onClick:t=>{this.onItemClick(t,e)}},e.label)))))}}class I extends t.React.Component{constructor(){super(...arguments),this.shouldComponentUpdateExcept=(e,t,o,i=[])=>{let s=!1;return this.props&&Object.keys(this.props).some((t=>!o.includes(t)&&(this.props[t]!==e[t]&&(s=!0,!0)))),this.state&&Object.keys(this.state).some((e=>!i.includes(e)&&(this.state[e]!==t[e]&&(s=!0,!0)))),s},this.formatMessage=(e,t)=>this.props.formatMessage(e,t),this.getStyle=e=>{const{widgetId:o,config:i,appMode:s}=this.props,n=i.cardConfigs[y.Selected].selectionMode!==l.None,r=this.checkIsBackgroundTransparent(e);return t.css`
      ${"&.list-card-"+o} {
        padding: 0;
        border: 0;
        background-color: transparent;
        .list-card-content {
          width: 100%;
          height: 100%;
          overflow: hidden;
        }
      }
      .flex-row-layout {
        width: 100%;
      }
      &.surface-1 {
        border: none !important;
        background: ${r&&"none !important"};
      }
      .list-item-con {
        overflow: hidden;
      }
      ${"&.list-card-"+o}:hover {
        ${window.jimuConfig.isInBuilder&&s===t.AppMode.Design||!n?"":"cursor: pointer;"}
      }
      .card-editor-mask {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        z-index: 100;
      }
      .jimu-link {
        text-align: left;
      }
    `}}checkIsBackgroundTransparent(e){var t,o,i,s;const{config:n}=this.props;return"rgba(0,0,0,0)"===(null===(s=null===(i=null===(o=null===(t=null==n?void 0:n.cardConfigs)||void 0===t?void 0:t[e])||void 0===o?void 0:o.backgroundStyle)||void 0===i?void 0:i.background)||void 0===s?void 0:s.color)}}const w={_widgetLabel:"List",_widgetDescription:"A widget to display data in a list view.",_action_filter_label:"Filter",_layout_REGULAR_label:"Regular",_layout_DEFAULT_label:"Default",_layout_HOVER_label:"Hover",_layout_SELECTED_label:"Selected",applyTo:"Apply to {status}",listLoading:"Loading",pleaseSelect:"Please select",listNoData:"No data",selectSortFields:"Select sorting fields",clearFilter:"Clear filter",isolate:"Isolate",linkedToAnd:"Linked to {where1} and {where2}",linkedTo:"Linked to {where}",placeHolderTip:"Please select a list template.",showSelected:"Show selected",clearSelected:"Clear selected",listSorting:"Sorting",listSort:"Sort",guideStep2Title:"Template",guideStep2Content:"Click on a template and click start.",guideStep3Title:"Data",guideStep3Content:"Click on select data to add a data source.",guideStep4Title:"Add new data",guideStep4Content:"Click add new data to select a web map.",guideStep5Title:"Select data",guideStep5Content:"Click the feature layer in the select data panel and close the panel.",guideStep6Title:"Data",guideStep6Content:"Specifies the data source, allows you to filter the data and limit the number of features that appear in the list.",guideStep7Title:"Arrangement",guideStep7Content:"Click the expand icon to explore the Arrangement section. In here, it allows you to define the direction, height, spacing, and paging style for your list.",guideStep8Title:"States",guideStep8Content:"Click the expand icon to explore the available States. In this section, it provides a visual representation to communicate the state of the list items. There are three states: regular, selected, and hover. By default, the selected state is always on.",guideStep9Title:"Tools",guideStep9Content:"Click the expand icon to explore the available Tools. In here, you can include search, sort, filter, and show selected tools in your list.",guideStep10Title:"Select image",guideStep10Content:"Click the image widget to configure it in the content panel.",guideStep10Title2:"Image settings",guideStep10Content2:"Allows you to select the image source and other settings for your widget.",guideStep11Title:"Select text",guideStep11Content:"Click the text widget to add attributes in the widget toolbar.",guideStep11Title2:"Text settings",guideStep11Content2:"Provides the configurations and style, including adding dynamic content from the widget toolbar. ",guideStep12Title:"End of tour",guideStep12Content:"Add other widgets to enhance your experience.",clearSearch:"Clear search",minimize:"Minimize",topToolBack:"Back",showAllListRecords:"Show all records",listDataActionLabel:"{layer} list selection",searchResult:"Search result",describeMessage:"List item",listArea:"list area"};var L=d(73027),C=d.n(L),A=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(o[i[s]]=e[i[s]])}return o};const x=e=>{const o=window.SVG,{className:i}=e,s=A(e,["className"]),n=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:n,src:C()},s)):t.React.createElement("svg",Object.assign({className:n},s))};var T=d(10527),R=d.n(T),M=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(o[i[s]]=e[i[s]])}return o};const E=e=>{const o=window.SVG,{className:i}=e,s=M(e,["className"]),n=(0,t.classNames)("jimu-icon jimu-icon-component",i);return o?t.React.createElement(o,Object.assign({className:n,src:R()},s)):t.React.createElement("svg",Object.assign({className:n},s))},{useState:O,useEffect:D,useRef:k,Fragment:j}=t.React,N=[0,5],B=[{name:"flip",options:{boundary:document.body,fallbackPlacements:["right-start","left-start","bottom-start","top-end","top-start"]}}],z=[{name:"offset",options:{offset:[0,10]}},{name:"arrow",enabled:!0}],G=o=>{var s,r,a,d;const c=t.hooks.useTranslation(w,i.defaultMessages,t.defaultMessages),u=k(null),p=k(null),g=k(null),h=k(null),{builderSupportModules:m,widgetId:f,reference:S,layouts:v,builderStatus:b,selection:I,selectionIsInList:L,datasourceId:C,selectionIsList:A,hideCardTool:T,config:R}=o,{selectCard:M}=o,{BuilderPopper:G,BuilderDropDown:_,BuilderButton:P,GLOBAL_RESIZING_CLASS_NAME:U,GLOBAL_H5_DRAGGING_CLASS_NAME:H,GLOBAL_DRAGGING_CLASS_NAME:$}=m.widgetModules,F=t.ReactRedux.useSelector((e=>{var t;return null===(t=null==e?void 0:e.appRuntimeInfo)||void 0===t?void 0:t.appMode})),Y=t.ReactRedux.useSelector((e=>null==e?void 0:e.browserSizeMode)),[W,V]=O(!1),[Z,q]=O(!1),[X,J]=O(""),[K,Q]=O(1);D((()=>{let e=!0;(!L&&!A||F===t.AppMode.Run||T||!C)&&(e=!1),V(e)}),[L,A,F,T,C]),D((()=>{const e=m.jimuForBuilderLib.getAppConfigAction().appConfig,t=(null===n.searchUtils||void 0===n.searchUtils?void 0:n.searchUtils.getRelatedLayoutItemsInWidgetByLayoutInfo(e,I,f,Y))||[],o=!A&&I&&t.length>1;q(o)}),[A,I,f,Y,n.searchUtils,K]),D((()=>{ee(Z,v,I,b,R)}),[Z,v,I,b,R,Y]);const ee=(e,t,o,i,s)=>{const n=se(e,t,o,i,s);h.current=n,ae(e)},te=t.hooks.useEventCallback((()=>{Q(K+1)})),oe=(e,t)=>{ie("showCardSetting",t),ie("builderStatus",t),M(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},ie=(e,o)=>{(0,t.getAppStore)().dispatch(t.appActions.widgetStatePropChange(f,e,o))},se=(o,i,s,r,a)=>{var d,h;const m=null==a?void 0:a.cardConfigs,f=re(),S=n.searchUtils.findLayoutItem(f,s);if(!s||!S||!window.jimuConfig.isInBuilder)return(0,t.Immutable)([]);const v=[];g.current=!0,p.current=m[y.Selected].selectionMode!==l.None,u.current=!!m[y.Hover].enable;const b=(null===(d=m[y.Hover])||void 0===d?void 0:d.listLayout)!==(null==e?void 0:e.AUTO),I=(null===(h=m[y.Selected])||void 0===h?void 0:h.listLayout)!==(null==e?void 0:e.AUTO),w=()=>{if(m[y.Hover].enable){const e=ne(y.Hover,i);v.push(e)}},L=()=>{if(m[y.Selected].selectionMode!==l.None){const e=ne(y.Selected,i);v.push(e)}},C=()=>{const e=ne(y.Default,i);v.push(e)};return r===y.Default?(b&&w(),I&&L()):r===y.Hover?(C(),I&&L()):(C(),b&&w()),o&&v.push({label:c("isolate"),event:de}),v},ne=(e,t)=>{const o=re(),i=n.searchUtils.findLayoutId(t[e],Y,o.mainSizeMode),s=o.layouts[I.layoutId].content[I.layoutItemId].widgetId;le(i,s)||(e===y.Default&&(g.current=!1),e===y.Hover&&(u.current=!1),e===y.Selected&&(p.current=!1));let r="",l=!1;switch(e){case y.Default:r="default",l=g.current;break;case y.Hover:r="hover",l=u.current;break;case y.Selected:r="selected",l=p.current}return{label:c("applyTo",{status:c(r).toLocaleLowerCase()}),event:t=>{ce(t,e,l)}}},re=t.hooks.useEventCallback((()=>m.jimuForBuilderLib.getAppConfigAction().appConfig)),le=(e,o)=>{const i=re();return m.widgetModules.searchUtils.getContentsInLayoutWithRecursiveLayouts(i,e,t.LayoutItemType.Widget,Y).indexOf(o)>-1},ae=e=>{let t="";const o=re(),i=n.searchUtils.findLayoutItem(o,I);return I&&i&&window.jimuConfig.isInBuilder?e?(b===y.Default?u.current&&p.current?t=c("linkedToAnd",{where1:c("selected").toLocaleLowerCase(),where2:c("hover").toLocaleLowerCase()}):u.current?t=c("linkedTo",{where:c("hover").toLocaleLowerCase()}):p.current&&(t=c("linkedTo",{where:c("selected").toLocaleLowerCase()})):b===y.Hover?g.current&&p.current?t=c("linkedToAnd",{where1:c("default").toLocaleLowerCase(),where2:c("selected").toLocaleLowerCase()}):g.current?t=c("linkedTo",{where:c("default").toLocaleLowerCase()}):p.current&&(t=c("linkedTo",{where:c("selected").toLocaleLowerCase()})):g.current&&u.current?t=c("linkedToAnd",{where1:c("default").toLocaleLowerCase(),where2:c("hover").toLocaleLowerCase()}):g.current?t=c("linkedTo",{where:c("default").toLocaleLowerCase()}):u.current&&(t=c("linkedTo",{where:c("hover").toLocaleLowerCase()})),void J(t)):(t=c("isolate"),void J(t)):(t="",void J(t))},de=t.hooks.useEventCallback((e=>{const o=m.jimuForBuilderLib.getAppConfigAction(),i=re(),s=n.searchUtils.findLayoutItem(i,I);if(!s)return;const r=i.widgets[f].layouts[b][Y],l=o.duplicateLayoutItemInSameLayout({layoutId:r,layoutItemId:s.id});o.editLayoutItemProperty({layoutId:r,layoutItemId:l},"bbox",s.bbox).removeLayoutItem({layoutId:r,layoutItemId:s.id},!1),o.exec(),(0,t.getAppStore)().dispatch(t.appActions.selectionChanged({layoutId:r,layoutItemId:l})),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()})),ce=t.hooks.useEventCallback(((e,t,o)=>{let i=m.jimuForBuilderLib.getAppConfigAction();const s=n.searchUtils.findLayoutItem(i.appConfig,I);if(!s)return;let r=i.appConfig;const l=n.searchUtils.findLayoutId(v[b],Y,r.mainSizeMode),a=n.searchUtils.findLayoutId(v[t],Y,r.mainSizeMode);if(o){const e=m.widgetModules.searchUtils,t=s.widgetId,o=r.widgets[t].parent[Y],n=o.find((e=>e.layoutId===l)),d=o.find((e=>e.layoutId===a)),c=e.findLayoutItem(r,n);i.editLayoutItemProperty(d,"bbox",c.bbox).editLayoutItemProperty(d,"setting",c.setting)}else{const e=m.jimuForBuilderLib.LayoutServiceProvider.getService(r,a).createBlankItem(r,a);r=e[0];const t=e[1],o={layoutId:a,layoutItemId:t},d=n.searchUtils.findLayoutItem(r,{layoutId:l,layoutItemId:s.id});r=m.jimuForBuilderLib.widgetService.addParent(r,s.widgetId,o,Y),i=m.jimuForBuilderLib.getAppConfigAction(r),i.editLayoutItemProperty(o,"bbox",d.bbox).editLayoutItemProperty(o,"setting",d.setting).editLayoutItemProperty(o,"type",d.type).editLayoutItemProperty(o,"widgetId",d.widgetId).adjustOrderOfItem(o,-1)}i.exec(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),te()}));return(0,t.jsx)(j,null,(0,t.jsx)(G,{placement:"left-start",trapFocus:!1,autoFocus:!1,css:t.css`
        .${$} &,
        .${U} &,
        .${H} & {
          &.popper {
            display: none;
          }
        }
      `,reference:S,offset:N,modifiers:B,open:W},(0,t.jsx)("div",{className:"status-group d-flex flex-column align-items-center p-2",css:t.css`
      width: 100%;
      .btn {
        width: 100%;
      }
      .dropdown-toggle {
        justify-content: center;
      }
    `},(0,t.jsx)(P,{active:b===y.Default,onClick:e=>{oe(e,y.Default)}},c("default")),(null===(r=null===(s=R.cardConfigs)||void 0===s?void 0:s[y.Hover])||void 0===r?void 0:r.enable)&&(0,t.jsx)(P,{active:b===y.Hover,className:"mt-1",onClick:e=>{oe(e,y.Hover)}},c("hover")),(null===(d=null===(a=null==R?void 0:R.cardConfigs)||void 0===a?void 0:a[y.Selected])||void 0===d?void 0:d.selectionMode)!==l.None&&(0,t.jsx)(P,{active:b===y.Selected,className:"mt-1",onClick:e=>{oe(e,y.Selected)}},c("selected")),((t,o,i)=>{var s;const n=h.current&&h.current.length>0,r=(null===(s=null==i?void 0:i.cardConfigs[b])||void 0===s?void 0:s.listLayout)||e.CUSTOM;return!o&&(n||t)&&r===e.CUSTOM})(Z,A,R)&&(0,t.jsx)(_,{className:"mt-1 w-100",toggleIsIcon:!0,toggleTitle:X,toggleType:"default",direction:"left",toggleArrow:!1,toggleContent:e=>Z?(0,t.jsx)(x,{size:16}):(0,t.jsx)(E,{size:16}),modifiers:z,items:(0,t.Immutable)(h.current)}))))},_=16;const P=t.ReactRedux.connect(((e,o)=>{const{appMode:i}=o;if(!window.jimuConfig.isInBuilder||i===t.AppMode.Run)return{selection:void 0};return{selection:0===o.itemIdex&&o.selectionIsInList&&e&&e.appRuntimeInfo&&e.appRuntimeInfo.selection}}))(class extends I{constructor(e){super(e),this.lastResizeCall=null,this.getNewCardSize=(e,t=!1)=>{const{config:o,isWidthPercentage:i}=this.props,{layoutType:s,horizontalSpace:n,gridItemSizeRatio:r,keepAspectRatio:l}=o;let a,d=e.right-e.left;return!t&&i&&(d=e.right-e.left+n),a=s===g.GRID&&l?{width:d,height:d*r}:{width:d,height:e.bottom-e.top},a},this.handleItemClick=e=>{const{selectCard:t}=this.props;e&&e.stopPropagation(),t()},this._renderAction=()=>{const e=[],{theme:o,config:i}=this.props,{layoutType:s,keepAspectRatio:n}=i,r=t.css`
      box-shadow: none;

      &:after {
        position: absolute;
        content: '';
        width: ${12}px;
        height: ${12}px;
        background-color: ${o.sys.color.primary.main};
        border: 2px solid ${o.ref.palette.white};
        border-radius: 50%;
        z-index: ${20};
      }
    `,l=t.css`
      box-shadow: none;
      height: ${_}px;
      left: 0px;
      right: 0px;
      bottom: ${-8}px;
      &:after {
        position: absolute;
        content: '';
        bottom: 50%;
        left: 0;
        right: 0;
        height: 2px;
        background-color: ${o.sys.color.primary.light};
        z-index: ${20};
      }
    `,a=t.css`
      box-shadow: none;
      width: ${_}px;
      top: 0px;
      bottom: 0px;
      right: ${-8}px;
      &:after {
        position: absolute;
        content: '';
        right: 50%;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: ${o.sys.color.primary.light};
        z-index: ${20};
      }
    `,d=t.css`
      position: absolute;
    `,c=t.css`
      width: ${_}px;
      top: ${10}px;
      bottom: ${10}px;
      right: ${-8}px;

      &:after {
        top: 50%;
        right: 50%;
        margin-top: ${-5}px;
        margin-right: ${-5}px;
      }
    `,u=t.css`
      height: ${_}px;
      left: ${10}px;
      right: ${10}px;
      bottom: ${-8}px;

      &:after {
        left: 50%;
        bottom: 50%;
        margin-left: ${-5}px;
        margin-bottom: ${-5}px;
      }
    `;switch(s){case g.Column:e.push((0,t.jsx)("span",{key:"10",className:"list-card-rnd-resize-left-line",css:[d,a]})),e.push((0,t.jsx)("span",{key:"4",className:"list-card-rnd-resize-right",css:[d,r,c]}));break;case g.Row:e.push((0,t.jsx)("span",{key:"9",className:"list-card-rnd-resize-bottom-line",css:[d,l]})),e.push((0,t.jsx)("span",{key:"6",className:"list-card-rnd-resize-bottom",css:[d,r,u]}));break;case g.GRID:e.push((0,t.jsx)("span",{key:"10",className:"list-card-rnd-resize-left-line",css:[d,a]})),e.push((0,t.jsx)("span",{key:"4",className:"list-card-rnd-resize-right",css:[d,r,c]})),n||(e.push((0,t.jsx)("span",{key:"9",className:"list-card-rnd-resize-bottom-line",css:[d,l]})),e.push((0,t.jsx)("span",{key:"6",className:"list-card-rnd-resize-bottom",css:[d,r,u]})))}return e},this.getCardToolsStyle=e=>t.css`
      width: 100%;
      .btn {
        width: 100%;
      }
      .dropdown-toggle {
        justify-content: center;
      }
    `,this.renderCardTools=()=>{const{itemIdex:e}=this.props;if(!window.jimuConfig.isInBuilder||e>0)return;const{builderSupportModules:o,datasourceId:i,selectionIsInList:s,selectionIsList:n,hideCardTool:r,selection:a,widgetId:d,config:c,isEditing:u,builderStatus:p,layouts:g,selectCard:h}=this.props,m=null==c?void 0:c.cardConfigs;return u&&(m[y.Hover].enable||m[y.Selected].selectionMode!==l.None)&&(0,t.jsx)(G,{builderSupportModules:o,widgetId:d,selection:a,config:c,selectionIsInList:s,selectionIsList:n,hideCardTool:r,datasourceId:i,reference:this.resizeRef.current,itemIdex:e,builderStatus:p,layouts:g,selectCard:h})},this.isItemAccept=(e,t)=>{const{isEditing:o,builderSupportModules:i,widgetId:s}=this.props;return function(e,t,o,i,s){var n,r;if(!e)return!1;const l=null===(r=null===(n=e.manifest)||void 0===n?void 0:n.properties)||void 0===r?void 0:r.supportRepeat,a=s.jimuForBuilderLib.getAppConfigAction().appConfig,d=s.widgetModules.selectionInList;return o&&l&&(!e.layoutInfo||e.layoutInfo&&d(e.layoutInfo,i,a,!1))}(e,0,o,s,i)},this.getEditorStyle=()=>t.css`
      &.list-card-content {
        .fixed-layout {
          border: 0 !important;
        }
      }
    `,this.state={didMount:!1},this.resizeRef=t.React.createRef()}shouldComponentUpdate(e,o){let i=this.shouldComponentUpdateExcept(e,o,["listStyle","selection"]);if(i=i||!t.utils.isDeepEqual(this.props.listStyle,e.listStyle),!i){const{selectionIsInList:o,selectionIsList:s}=this.props;(s||o)&&(i=!t.utils.isDeepEqual(this.props.selection,e.selection))}return i}componentDidUpdate(e){const{selectionIsInList:t,isEditing:o,config:i,isRTL:s,itemIdex:n}=this.props,{layoutType:r,keepAspectRatio:l,lockItemRatio:a}=i;window.jimuConfig.isInBuilder&&0===n&&this.interactable&&(o&&!t?r===g.GRID?(this.interactable.resizable({edges:{top:!1,left:s,bottom:!l,right:!s}}),this.interactable.resizable(!0)):a?this.interactable.resizable(!1):(this.interactable.resizable({edges:{top:!1,left:r===g.Column&&s,bottom:r===g.Row,right:r===g.Column&&!s}}),this.interactable.resizable(!0)):this.interactable.resizable(!1))}componentDidMount(){const{itemIdex:e,toggleCardTool:t,config:o}=this.props,{layoutType:i,keepAspectRatio:s,lockItemRatio:n}=o;if(0===e&&window.jimuConfig.isInBuilder&&this.resizeRef.current){const{interact:e,handleResizeCard:o,isRTL:r}=this.props;this.interactable=e(this.resizeRef.current).resizable({edges:{top:!1,left:(i===g.Column||i===g.GRID)&&r,bottom:i===g.Row&&!n||i===g.GRID&&!s,right:(i===g.Column&&!n||i===g.GRID)&&!r},modifiers:[e.modifiers.restrictEdges({endOnly:!0}),e.modifiers.restrictSize({min:{width:20,height:20}})],inertia:!1,onstart:e=>{const{changeIsResizingCard:t}=this.props;t&&t(!0),e.stopPropagation()},onmove:e=>{e.stopPropagation(),this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall);const i=e.rect,s=this.getNewCardSize(i,!0);t(!0),this.lastResizeCall=requestAnimationFrame((()=>{const e={};o(s,!1,e.top,e.left)}))},onend:e=>{e.stopPropagation(),this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall),this.lastResizeCall=requestAnimationFrame((()=>{const i=e.rect,s=this.getNewCardSize(i);o(s,!0);const{changeIsResizingCard:n}=this.props;t(!1),n&&n(!1)}))}})}this.setState({didMount:!0})}componentWillUnMount(){this.lastResizeCall&&cancelAnimationFrame(this.lastResizeCall),this.interactable&&(this.interactable.unset(),this.interactable=null)}render(){var o,s;const{active:n,LayoutEntry:r,selectionIsInList:a,isEditing:d,widgetId:c,listStyle:u,builderStatus:p,layouts:h,config:m,dynamicStyleOfCard:f}=this.props,{cardConfigs:S,layoutType:v,lockItemRatio:b}=m,I=m.cardConfigs[y.Selected].selectionMode!==l.None,{didMount:w}=this.state,L=h[p],C=(null===(o=S[p])||void 0===o?void 0:o.listLayout)||e.CUSTOM,A=h[y.Default],x=C===e.AUTO?A:L,T=function(e,o){var s,n,r,l,a,d,c,u;if(null==o?void 0:o.background){const t=(null===(s=null==e?void 0:e.background)||void 0===s?void 0:s.asMutable({deep:!0}))||{},i=(null===(n=null==o?void 0:o.background)||void 0===n?void 0:n.asMutable({deep:!0}))||{};(null==i?void 0:i.color)&&(t.color=null==i?void 0:i.color),(null==i?void 0:i.fillType)&&(t.fillType=null==i?void 0:i.fillType),(null==i?void 0:i.image)&&(t.image=null==i?void 0:i.image),e=e.set("background",t)}if(null==o?void 0:o.borderRadius){const t=i.styleUtils.mixinBorderRadiusWithDynamicStyle(null===(r=null==o?void 0:o.borderRadius)||void 0===r?void 0:r.asMutable({deep:!0}),null===(l=null==e?void 0:e.borderRadius)||void 0===l?void 0:l.asMutable({deep:!0}));e=e.set("borderRadius",t)}if(null==o?void 0:o.border){const s=(null===(a=null==e?void 0:e.border)||void 0===a?void 0:a.color)?{border:null===(d=null==e?void 0:e.border)||void 0===d?void 0:d.asMutable({deep:!0})}:null===(c=null==e?void 0:e.border)||void 0===c?void 0:c.asMutable({deep:!0}),n=i.styleUtils.mixinBorderWithDynamicStyle(null===(u=null==o?void 0:o.border)||void 0===u?void 0:u.asMutable({deep:!0}),s);e=(0,t.Immutable)(Object.assign(Object.assign({},e),n))}if(null==e?void 0:e.border){const o=["border","borderLeft","borderRight","borderTop","borderBottom"];Object.keys(null==e?void 0:e.border).some((e=>o.includes(e)))&&(e=(0,t.Immutable)(Object.assign(Object.assign({},e),e.border)))}return e}(S[p].backgroundStyle,null==f?void 0:f[p]),R=C===e.AUTO&&p!==y.Default,M=Object.assign({},i.styleUtils.toCSSStyle(T||{})),E=Object.assign({},i.styleUtils.toCSSStyle({borderRadius:null===(s=null==T?void 0:T.asMutable({deep:!0}))||void 0===s?void 0:s.borderRadius})),O=v!==g.GRID&&b;return(0,t.jsx)(i.ListGroupItem,{active:I&&n,css:this.getStyle(p),style:Object.assign(Object.assign({},E),u),className:(0,t.classNames)("surface-1",`list-card-${c}`),onClick:this.handleItemClick,role:"listCardEditor"},R&&(0,t.jsx)("div",{className:"card-editor-mask position-absolute"}),w&&this.renderCardTools(),(0,t.jsx)("div",{className:"list-card-content d-flex",style:M,css:this.getEditorStyle(),ref:this.resizeRef},(0,t.jsx)(r,{isItemAccepted:this.isItemAccept,isRepeat:!0,layouts:x,isInWidget:!0}),d&&!a&&!O&&this._renderAction()))}});var U=d(1888);const H={ButtonGroup:i.ButtonGroup,interact:o.interact,searchUtils:n.searchUtils,getAppConfigAction:s.getAppConfigAction,LayoutServiceProvider:s.LayoutServiceProvider,widgetService:s.widgetService,GLOBAL_DRAGGING_CLASS_NAME:v.GLOBAL_DRAGGING_CLASS_NAME,GLOBAL_RESIZING_CLASS_NAME:v.GLOBAL_RESIZING_CLASS_NAME,GLOBAL_H5_DRAGGING_CLASS_NAME:v.GLOBAL_H5_DRAGGING_CLASS_NAME,withBuilderTheme:U.withBuilderTheme,BuilderDropDown:(0,U.withBuilderTheme)((e=>t.React.createElement(b,Object.assign({},e,{withBuilderTheme:U.withBuilderTheme})))),BuilderPopper:(0,U.withBuilderTheme)(i.Popper),BuilderButton:(0,U.withBuilderTheme)(i.Button),ListCardEditor:P,handleResizeCard:(e,t=!1)=>{const o=function(e){const{widgetId:t,browserSizeMode:o,newCardSize:i,widgetConfig:n}=e;let r=null==e?void 0:e.appConfig;r||(r=(0,s.getAppConfigAction)().appConfig);const l=(0,s.getAppConfigAction)(r);return l.editWidgetConfig(t,n.setIn(["cardConfigs",y.Default,"cardSize",o],i).setIn(["cardConfigs",y.Hover,"cardSize",o],i).setIn(["cardConfigs",y.Selected,"cardSize",o],i)),l}(e);o&&o.exec(t)},selectSelf:e=>{!function(e,o){const i=(0,t.getAppStore)().getState().browserSizeMode,r=(0,s.getAppConfigAction)().appConfig,l=n.searchUtils.getContentLayoutInfosInOneSizeMode(r,e,t.LayoutItemType.Widget,i);if(l)if(l.length>1){const e=n.searchUtils.getWidgetIdThatUseTheLayoutId(r,l[0].layoutId);if(e){const a=r.widgets[e];if(a&&a.manifest&&a.manifest.name&&"list"===a.manifest.name){const e=(0,t.getAppStore)().getState().widgetsState&&(0,t.getAppStore)().getState().widgetsState[a.id]&&(0,t.getAppStore)().getState().widgetsState[a.id].builderStatus;if(e){const d=n.searchUtils.findLayoutId(a.layouts[e],i,r.mainSizeMode),c=l.find((e=>e.layoutId===d));o?(0,t.getAppStore)().dispatch(t.appActions.selectionChanged(c)):s.builderAppSync.publishChangeSelectionToApp(c)}}}}else l.length>0&&(o?(0,t.getAppStore)().dispatch(t.appActions.selectionChanged(l[0])):s.builderAppSync.publishChangeSelectionToApp(l[0]))}(e,!0)},selectionInList:(e,o,i,s=!0)=>{if(!e||!e.layoutItemId||!e.layoutId)return!1;let r;return s?r=n.searchUtils.getRelatedLayoutItemsInWidgetByLayoutInfo(i,e,o,(0,t.getAppStore)().getState().browserSizeMode):(r=[],r.push(...n.searchUtils.getRelatedLayoutItemsInWidgetByLayoutInfo(i,e,o,t.BrowserSizeMode.Large)),r.push(...n.searchUtils.getRelatedLayoutItemsInWidgetByLayoutInfo(i,e,o,t.BrowserSizeMode.Medium)),r.push(...n.searchUtils.getRelatedLayoutItemsInWidgetByLayoutInfo(i,e,o,t.BrowserSizeMode.Small))),r.length>0}}})(),c})())}}}));