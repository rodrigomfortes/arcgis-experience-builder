System.register(["jimu-layouts/layout-runtime","jimu-arcgis","jimu-for-builder","jimu-ui","jimu-for-builder/templates","jimu-ui/basic/guide","jimu-core","jimu-for-builder/service"],(function(e,t){var n={},i={},s={},a={},d={},o={},r={},l={};return{setters:[function(e){n.init=e.init},function(e){i.init=e.init},function(e){s.AppStateHistoryExtension=e.AppStateHistoryExtension,s.AppStateReduxStoreExtension=e.AppStateReduxStoreExtension,s.BuilderStateReduxStoreExtension=e.BuilderStateReduxStoreExtension,s.BuilderStateResourceExtension=e.BuilderStateResourceExtension,s.builderAppSync=e.builderAppSync,s.helpUtils=e.helpUtils,s.init=e.init,s.templateUtils=e.templateUtils},function(e){a.Link=e.Link,a.init=e.init},function(e){d.init=e.init},function(e){o.EVENTS=e.EVENTS,o.GuideComponent=e.GuideComponent,o.STATUS=e.STATUS},function(e){r.AppRoot=e.AppRoot,r.ArcGISDependencyDefineExtension=e.ArcGISDependencyDefineExtension,r.ExtensionManager=e.ExtensionManager,r.GuideLevels=e.GuideLevels,r.GuideManager=e.GuideManager,r.GuideTypes=e.GuideTypes,r.PageMode=e.PageMode,r.React=e.React,r.ReactDOMClient=e.ReactDOMClient,r.ReactRedux=e.ReactRedux,r.SessionManager=e.SessionManager,r.appActions=e.appActions,r.extensionSpec=e.extensionSpec,r.getAppStore=e.getAppStore,r.init=e.init,r.injectIntl=e.injectIntl,r.jimuHistory=e.jimuHistory,r.jsx=e.jsx,r.privilegeUtils=e.privilegeUtils,r.useIntl=e.useIntl,r.utils=e.utils},function(e){l.userServices=e.userServices}],execute:function(){e((()=>{"use strict";var e={1496:e=>{e.exports=n},2686:e=>{e.exports=i},4108:e=>{e.exports=s},4321:e=>{e.exports=a},6884:e=>{e.exports=d},8151:e=>{e.exports=o},9027:e=>{e.exports=JSON.parse('{"steps":[{"injectedGuide":"express-welcome-introduction"},{"injectedGuide":"express-map-widget"},{"injectedGuide":"express-widget-controller"},{"injectedGuide":"express-placeholder"},{"injectedGuide":"express-grid"},{"injectedGuide":"express-section"},{"injectedGuide":"express-sidebar"},{"injectedGuide":"express-window"},{"injectedGuide":"express-theme"},{"injectedGuide":"express-app-setting"},{"injectedGuide":"express-general-setting"},{"title":"${expressEndGuideTitle}","content":{"image":{"src":"builder/assets/congratulations.png","alt":"${expressEndGuideTitle}","width":183,"height":160},"text":"${expressEndGuideContent}","direction":"horizontal"},"placement":"center","width":540,"height":260,"target":"[data-widgetid=\'app-loader\']"}]}')},9244:e=>{e.exports=r},9565:e=>{e.exports=JSON.parse('{"steps":[{"type":"splash","title":"${openingGuideStep1Title}","content":{"image":{"src":"builder/assets/start-splash.svg","alt":"${openingGuideStep1Title}","width":237,"height":286},"text":"${openingGuideStep1Content}","direction":"horizontal"},"placement":"center","target":"#app","width":600},{"title":"${openingGuideStep2Title}","content":{"image":{"src":"builder/assets/start1-canvas.svg","alt":"Canvas","width":400,"height":220,"autoFlip":true},"text":"${openingGuideStep2Content}"},"target":"[data-widgetid=\'app-loader\']"},{"title":"${openingGuideStep3Title}","placement":"right","content":{"image":{"src":"builder/assets/start2-sidebar.gif","alt":"${openingGuideStep3Title}","width":400,"height":220,"border":true,"autoFlip":true},"text":"${openingGuideStep3Content}"},"target":"[data-widgetid=\'left-sidebar\'] .side"},{"injectedGuide":"insert-widget","params":{"widgetName":"arcgis-map"}},{"title":"${openingGuideStep5Title}","content":{"image":{"src":"builder/assets/resize-widget.gif","alt":"${openingGuideStep5Title}","width":400,"height":220,"autoFlip":true},"text":"${openingGuideStep5Content}"},"target":".selected.is-widget .widget-map-usemask","spotlightPadding":15,"targetInCanvas":true,"spotlightClicks":true},{"injectedGuide":"ds-selection"},{"title":"${openingGuideStep7Title}","content":"${openingGuideStep7Content}","placement":"left","target":"[data-widgetid=\'dynamic-setting\'] .widget-setting-tab:not([data-is-parent=\'true\'])  .tab-title-item:nth-child(2)","requiredAction":{"type":"click"},"disableNextButton":true},{"steps":[{"title":"${openingGuideStep8Title}","content":"${openingGuideStep8Content}","placement":"left","target":"[data-widgetid=\'dynamic-setting\'] .widget-setting-tab:not([data-is-parent=\'true\'])  .tab-content","spotlightClicks":true},{"title":"${openingGuideStep8Title2}","content":"${openingGuideStep8Content2}","placement":"left","target":"[data-widgetid=\'dynamic-setting\'] .widget-setting-tab:not([data-is-parent=\'true\'])  .tab-content","spotlightClicks":true}]},{"title":"${openingGuideStep9Title}","content":"${openingGuideStep9Content}","placement":"left","target":"[data-widgetid=\'dynamic-setting\'] .widget-setting-tab:not([data-is-parent=\'true\'])  .tab-title-item:nth-child(3)","requiredAction":{"type":"click"},"disableNextButton":true},{"title":"${openingGuideStep10Title}","content":{"image":{"src":"builder/assets/start-action.gif","alt":"${openingGuideStep10Title}","width":400,"height":220},"text":"${openingGuideStep10Content}"},"placement":"left","target":"[data-widgetid=\'dynamic-setting\'] .widget-setting-tab:not([data-is-parent=\'true\'])  .tab-content"},{"title":"${openingGuideStep11Title}","content":"${openingGuideStep11Content}","placement":"bottom","target":".widget-builder-header","spotlightClicks":true},{"title":"${openingGuideStep12Title}","content":"${openingGuideStep12Content}","placement":"right","target":"[data-sectionid=\'opts-section\']"},{"title":"${openingGuideStep13Title}","content":"${openingGuideStep13Content}","placement":"right","target":"[data-sectionid=\'opts-section\']"},{"title":"${openingGuideStep14Title}","content":"${openingGuideStep14Content}","placement":"right","target":"[data-sectionid=\'opts-section\']"},{"title":"${openingGuideStep15Title}","content":"${openingGuideStep15Content}","placement":"center","target":"[data-widgetid=\'app-loader\']"}]}')},9860:e=>{e.exports=l}},t={};function u(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,u),s.exports}var c=u(9244),p=u(4108),g=u(2686),m=u(1496),x=u(4321),h=u(6884),S=u(9860),v=u(8151);class I extends c.React.PureComponent{constructor(e){var t,n,i,s;super(e),this.currentStep=0,this.handleChange=e=>{var t,n,i;const{index:s,nextIndex:a,event:d}=e;if(2===s?c.jimuHistory.changeView("opts-section","insert"):4===s?(0,c.getAppStore)().dispatch(c.appActions.widgetStatePropChange("right-sidebar","collapse",!0)):11===s?c.jimuHistory.changeView("opts-section","page"):12===s?c.jimuHistory.changeView("opts-section","data"):13===s&&c.jimuHistory.changeView("opts-section","theme"),2===a&&d===v.EVENTS.STEP_AFTER)(0,c.getAppStore)().dispatch(c.appActions.widgetStatePropChange("left-sidebar","collapse",!0));else if(7===a&&d===v.EVENTS.STEP_AFTER){const e=null===(t=this.props)||void 0===t?void 0:t.pageMode;this.setState({conditionalStepIndexes:Object.assign(Object.assign({},this.state.conditionalStepIndexes),{7:e===c.PageMode.AutoScroll?1:0})})}null===(i=null===(n=this.props)||void 0===n?void 0:n.onStepChange)||void 0===i||i.call(n,e)},this.handleClick=(e,t,n)=>{this.setState({stepIndex:n+1})};const a=e.intl,d=c.utils.replaceI18nPlaceholdersInObject(u(9565),a,a.messages);this.state={stepIndex:null!==(t=e.stepIndex)&&void 0!==t?t:0,steps:null!==(n=d.steps)&&void 0!==n?n:[],conditionalStepIndexes:null!==(i=e.conditionalStepIndexes)&&void 0!==i?i:{},run:null===(s=e.run)||void 0===s||s}}componentDidUpdate(e){(null==e?void 0:e.run)!==this.props.run&&this.setState({run:this.props.run}),(null==e?void 0:e.stepIndex)!==this.props.stepIndex&&this.setState({stepIndex:this.props.stepIndex})}render(){const{stepIndex:e,steps:t,run:n,conditionalStepIndexes:i}=this.state;return(0,c.jsx)(v.GuideComponent,{run:n,stepIndex:e,steps:t,conditionalStepIndexes:i,onStepChange:this.handleChange,onActionTriggered:this.handleClick})}}const w=c.ReactRedux.connect((e=>{var t,n,i,s,a,d;const o=null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appRuntimeInfo)||void 0===n?void 0:n.currentPageId;return{queryObject:e.queryObject,pageMode:null===(d=null===(a=null===(s=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig)||void 0===s?void 0:s.pages)||void 0===a?void 0:a[o])||void 0===d?void 0:d.mode}}))((0,c.injectIntl)(I)),{useState:f,useEffect:G}=c.React;const C=c.ReactRedux.connect(((e,t)=>{var n,i,s,a,d,o;const r=null===(n=null==t?void 0:t.widgetJson)||void 0===n?void 0:n.id,l=null===(i=e.appStateInBuilder)||void 0===i?void 0:i.appConfig;return{layouts:null==l?void 0:l.layouts,widgets:null==l?void 0:l.widgets,sections:null==l?void 0:l.sections,messageConfigs:null==l?void 0:l.messageConfigs,controllerPanels:null==l?void 0:l.controllerPanels,placeholderInfos:null==l?void 0:l.placeholderInfos,dataSourcesInfo:null===(s=e.appStateInBuilder)||void 0===s?void 0:s.dataSourcesInfo,widgetsState:null===(a=e.appStateInBuilder)||void 0===a?void 0:a.widgetsState,widgetDs:null===(o=null===(d=null==l?void 0:l.widgets)||void 0===d?void 0:d[r])||void 0===o?void 0:o.useDataSources}}))((e=>{const t=(0,c.useIntl)(),n=c.utils.replaceI18nPlaceholdersInObject(u(9027),t,t.messages),{dataSourcesInfo:i,widgetDs:s}=e,[a,d]=f(!1),[o,r]=f(0),[l,p]=f(!1),g=function(e,t){if(!e||!t)return!1;const n=Object.keys(null!=e?e:{}).length;return Object.keys(null!=t?t:{}).length>n}(function(e){const t=c.React.useRef();return G((()=>{t.current=e})),t.current}(i),i);return G((()=>{}),[e.stepIndex]),G((()=>{d(e.run)}),[e.run]),G((()=>{r(e.stepIndex)}),[e.stepIndex]),G((()=>{a&&s&&p(!s.length),!a&&g&&(r(2),d(!0))}),[s,g,a]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:a,stepIndex:o,steps:n.steps,onActionTriggered:(t,n,i)=>{var s;null===(s=null==e?void 0:e.onActionTriggered)||void 0===s||s.call(e,t,n,i)},onStepChange:t=>{null==e||e.onStepChange(t)},disabled:l}))})),{useState:T,useEffect:E,useMemo:b}=c.React,R=c.ReactRedux.connect(null)((e=>{const[t,n]=T(!1),[i,s]=T(0),a=(0,c.useIntl)(),d=e=>a.formatMessage({id:e}),o=b((()=>[{type:"splash",title:d("openingGuideStep1Title"),content:{image:{src:"builder/assets/start-splash.svg",alt:d("openingGuideStep1Title"),width:237,height:286},text:d("welcomeStep1Content"),direction:"horizontal"},placement:"center",target:"#app",width:600}]),[]);return E((()=>{n(e.run)}),[e.run]),E((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:y,useEffect:j,useMemo:M}=c.React,A=c.ReactRedux.connect(null)((e=>{const[t,n]=y(!1),[i,s]=y(0),a=(0,c.useIntl)(),d=M((()=>[{title:o("expressTopBarTitle"),content:{htm:o("expressTopBarContent"),direction:"horizontal"},placement:"auto",target:"div.widget-builder-header > div.d-flex.align-items-center.justify-content-end",width:480}]),[]);function o(e){return a.formatMessage({id:e})}return j((()=>{n(e.run)}),[e.run]),j((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:d,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:P,useEffect:$,useMemo:B}=c.React,O=c.ReactRedux.connect(null)((e=>{const[t,n]=P(!1),[i,s]=P(0),a=(0,c.useIntl)(),d=B((()=>[{title:o("expressFullEditModeTitle"),content:{text:o("expressFullEditModeContent"),direction:"horizontal"},placement:"auto",target:".tool_more_content .jimu-dropdown button",width:380}]),[]);function o(e){return a.formatMessage({id:e})}return $((()=>{n(e.run)}),[e.run]),$((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:d,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:N,useEffect:D,useMemo:L}=c.React,k=c.ReactRedux.connect(((e,t)=>{var n,i;return{widgets:null===(i=null===(n=e.appStateInBuilder)||void 0===n?void 0:n.appConfig)||void 0===i?void 0:i.widgets}}))((e=>{const[t,n]=N(!1),[i,s]=N(0),[a,d]=N(null),o=(0,c.useIntl)();function r(e){return o.formatMessage({id:e})}const l=L((()=>[{title:r("mapWidgetTitle"),content:{image:{src:"builder/assets/configure-widget-1.svg",alt:r("mapWidgetTitle"),width:340,height:220},htm:r("mapWidgetContent"),direction:"vertical"},requiredAction:{type:"click"},disableNextButton:!0,targetInCanvas:!0,placement:"bottom",target:a?`[data-widgetid="${null==a?void 0:a.id}"] .arcgis-map`:".arcgis-map",width:380,height:420},{title:r("expressSelectDataTitle"),content:{image:{src:"builder/assets/configure-map.gif",alt:r("expressSelectDataTitle"),width:340,height:220},text:r("expressSelectDataContent"),direction:"vertical"},placement:"left-start",target:"[data-widgetid='dynamic-setting'] .widget-setting-tab:not([data-is-parent='true'])",width:380},{title:r("expressMessageActionTitle"),content:{image:{src:"builder/assets/message-action.gif",alt:r("expressMessageActionTitle"),width:340,height:220},text:r("expressMessageActionContent")},placement:"left-end",target:"[data-widgetid='dynamic-setting'] .widget-setting-tab:not([data-is-parent='true']) .message-action-con .message-action-con",width:380,height:400}]),[a]);return D((()=>{n(e.run)}),[e.run]),D((()=>{if(!e.widgets)return;const t=Object.values(e.widgets).find((e=>"arcgis-map"===e.manifest.name));t?d(t):(d(null),e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED}))}),[e.widgets]),D((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:l,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:U,useEffect:_,useMemo:W}=c.React,H=c.ReactRedux.connect(null)((e=>{const[t,n]=U(!1),[i,s]=U(0),a=(0,c.useIntl)();function d(e){return a.formatMessage({id:e})}const o=W((()=>[{type:"splash",title:d("openingGuideStep1Title"),content:{image:{src:"builder/assets/start-splash.svg",alt:d("openingGuideStep1Title"),width:237,height:286},text:d("welcomeStep1Content"),direction:"horizontal"},placement:"center",target:"#app",width:600}]),[]);return _((()=>{n(e.run)}),[e.run]),_((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:q,useEffect:F,useMemo:z}=c.React,V=c.ReactRedux.connect(null)((e=>{const[t,n]=q(!1),[i,s]=q(0),a=(0,c.useIntl)();function d(e){return a.formatMessage({id:e})}const o=z((()=>[{title:d("expressPlaceholderTitle"),content:{image:{src:"builder/assets/placeholder.gif",alt:d("expressPlaceholderTitle"),width:340,height:220},htm:d("expressPlaceholderContent"),direction:"vertical"},targetInCanvas:!0,placement:"auto",target:"div.builder-layout-item div.add-btn",width:380}]),[]);return F((()=>{var t;const n=document.querySelector('iframe[name="_appWindow"]');(null===(t=null==n?void 0:n.contentDocument)||void 0===t?void 0:t.querySelector("div.builder-layout-item div.add-btn"))||e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED})}),[]),F((()=>{n(e.run)}),[e.run]),F((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:X,useEffect:J,useMemo:K}=c.React,Y=c.ReactRedux.connect((e=>{var t,n;return{widgets:null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets}}))((e=>{const[t,n]=X(!1),[i,s]=X(0),[a,d]=X(null),o=(0,c.useIntl)();function r(e){return o.formatMessage({id:e})}const l=K((()=>[{title:r("expressSectionTitle"),content:{image:{src:"builder/assets/section-view.gif",alt:r("expressSectionTitle")},htm:r("expressSectionContent"),direction:"vertical"},targetInCanvas:!0,placement:"auto",target:a?`[data-widgetid="${null==a?void 0:a.id}"] .widget-view-navigation`:".widget-view-navigation",width:380}]),[a]);return J((()=>{if(!e.widgets)return;const t=Object.values(e.widgets).find((e=>"navigator"===e.manifest.name));t?d(t):(d(null),e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED}))}),[e.widgets]),J((()=>{n(e.run)}),[e.run]),J((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:l,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:Q,useEffect:Z,useMemo:ee}=c.React,te=c.ReactRedux.connect((e=>{var t,n,i;return{widgets:null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets,widgetsState:null===(i=e.appStateInBuilder)||void 0===i?void 0:i.widgetsState}}))((e=>{const[t,n]=Q(!1),[i,s]=Q(0),[a,d]=Q(null),o=(0,c.useIntl)(),r=e=>o.formatMessage({id:e}),l=ee((()=>[{title:r("expressSidebarTitle"),content:{image:{src:"builder/assets/sidebar-visible.gif",alt:r("expressSidebarTitle"),width:340,height:220},htm:r("expressSidebarContent1")+r("expressSidebarContent"),direction:"vertical"},requiredAction:{type:"click"},disableNextButton:!0,placement:"auto",target:a?`[data-widgetid="${null==a?void 0:a.id}"] .side-collapsable>div:not(.side)>div`:".side-collapsable>div:not(.side)>div",width:380,targetInCanvas:!0}]),[a]);return Z((()=>{var t,n;if(!e.widgets)return;const i=Object.values(e.widgets).find((e=>"sidebar"===e.manifest.name));if(i&&(null===(t=null==i?void 0:i.config)||void 0===t?void 0:t.toggleBtn)){d(i);const e=document.querySelector('iframe[name="_appWindow"]'),t=null===(n=null==e?void 0:e.contentDocument)||void 0===n?void 0:n.querySelector(`[data-widgetid="${i.id}"] .side-collapsable>div:not(.side)>div`);t&&t.classList.add("active")}else e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED})}),[e.widgets]),Z((()=>{n(e.run)}),[e.run]),Z((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:l,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:ne,useEffect:ie,useMemo:se}=c.React,ae=c.ReactRedux.connect(null)((e=>{const[t,n]=ne(!1),[i,s]=ne(0),a=(0,c.useIntl)(),d=e=>a.formatMessage({id:e}),o=se((()=>[{title:d("expressThemeTitle"),content:{text:d("expressThemeContent"),direction:"vertical"},placement:"auto",target:"div.d-flex.layout-item.is-widget > div > div > div > ul",width:480}]),[]);return ie((()=>{n(e.run)}),[e.run]),ie((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:de,useEffect:oe,useMemo:re}=c.React,le=c.ReactRedux.connect((e=>{var t,n;return{widgets:null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets}}))((e=>{const[t,n]=de(!1),[i,s]=de(0),[a,d]=de(null),o=(0,c.useIntl)(),r=e=>o.formatMessage({id:e}),l=re((()=>[{title:r("expressTextTitle"),content:{image:{src:"builder/assets/start-splash.svg",alt:r("expressTextTitle"),width:237,height:286},text:r("expressTextContent"),direction:"horizontal"},targetInCanvas:!0,placement:"auto",target:a?`[data-widgetid="${null==a?void 0:a.id}"] .rich-displayer`:".rich-displayer",width:480}]),[a]);return oe((()=>{e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED})}),[]),oe((()=>{if(!e.widgets)return;const t=Object.values(e.widgets).find((e=>"text"===e.manifest.name));t?d(t):(d(null),e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED}))}),[e.widgets]),oe((()=>{n(e.run)}),[e.run]),oe((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:l,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:ue,useEffect:ce,useMemo:pe}=c.React,ge=c.ReactRedux.connect(null)((e=>{const[t,n]=ue(!1),[i,s]=ue(0),a=(0,c.useIntl)(),d=e=>a.formatMessage({id:e}),o=pe((()=>[{type:"splash",title:d("openingGuideStep1Title"),content:{image:{src:"builder/assets/guide-cover.png",alt:d("openingGuideStep1Title"),width:272,height:256},text:d("welcomeStep1Content"),direction:"horizontal"},placement:"center",target:"#app",width:600,height:350}]),[]);return ce((()=>{n(e.run)}),[e.run]),ce((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:me,useEffect:xe,useMemo:he}=c.React,Se=c.ReactRedux.connect((e=>{var t,n;return{widgets:null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets}}))((e=>{const[t,n]=me(!1),[i,s]=me(0),[a,d]=me(null),o=(0,c.useIntl)(),r=e=>o.formatMessage({id:e}),l=he((()=>[{title:r("widgetControllerTitle"),content:{image:{src:"builder/assets/widget-controller.gif",alt:r("widgetControllerTitle"),width:340,height:220},htm:r("widgetControllerContent"),direction:"vertical"},targetInCanvas:!0,requiredAction:{type:"click"},disableNextButton:!0,placement:"auto",target:a?`[data-widgetid="${null==a?void 0:a.id}"] .widget-controller`:".widget-controller",width:380},{title:r("expressWidgetControllerAddWidgetTitle"),content:{image:{src:"builder/assets/wc-add-widget.gif",alt:r("expressWidgetControllerAddWidgetTitle"),width:340,height:220},text:r("expressWidgetControllerAddWidgetContent"),direction:"vertical"},targetInCanvas:!1,placement:"auto",target:'[data-widgetid="header"] .d-flex.align-items-center.justify-content-end div.d-flex.align-items-center',width:380}]),[a]);return xe((()=>{if(!e.widgets)return;const t=Object.values(e.widgets).find((e=>"controller"===e.manifest.name));t?d(t):(d(null),e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED}))}),[e.widgets]),xe((()=>{n(e.run)}),[e.run]),xe((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:l,onStepChange:t=>{null==e||e.onStepChange(t)},onActionTriggered:(e,t,n)=>{if(0===n){const e=setInterval((()=>{document.querySelector('[data-widgetid="header"] [data-extname="controller-add-widget"]')&&(clearInterval(e),s(1))}),100)}},isInjected:!0}))})),{useState:ve,useEffect:Ie,useMemo:we}=c.React,fe=c.ReactRedux.connect(null)((e=>{const[t,n]=ve(!1),[i,s]=ve(0),a=(0,c.useIntl)(),d=e=>a.formatMessage({id:e}),o=we((()=>[{title:d("expressWindowTitle"),content:{htm:d("expressWindowContent"),direction:"horizontal"},requiredAction:{type:"click"},disableNextButton:!0,placement:"auto",target:".page-window-select",width:380,height:160},{title:d("expressWindowTitle2"),content:{image:{src:"builder/assets/configure-window-1.gif",alt:d("expressWindowTitle2"),width:340,height:220},htm:d("expressWindowContent2"),direction:"vertical"},requiredAction:{type:"click"},disableNextButton:!0,placement:"right",target:"div .popper-box div.dropdown-menu--inner div:nth-child(2)",width:380},{title:d("expressWindowTitle1"),content:{image:{src:"builder/assets/configure-window-2.gif",alt:d("expressWindowTitle1"),width:340,height:220},text:d("expressWindowContent1"),direction:"vertical"},targetInCanvas:!0,placement:"auto",target:"div.modal-content.app-dialog-content",width:380}]),[]);return Ie((()=>{n(e.run)}),[e.run]),Ie((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:Ge,useEffect:Ce,useMemo:Te}=c.React,Ee=c.ReactRedux.connect((e=>{var t,n;return{widgets:null===(n=null===(t=e.appStateInBuilder)||void 0===t?void 0:t.appConfig)||void 0===n?void 0:n.widgets}}))((e=>{const[t,n]=Ge(!1),[i,s]=Ge(0),a=(0,c.useIntl)(),d=e=>a.formatMessage({id:e}),o=Te((()=>[{title:d("expressGridTitle"),content:{image:{src:"builder/assets/manage-grids.gif",alt:d("expressGridTitle"),width:340,height:220},text:d("expressGridContent"),direction:"vertical"},placement:"auto",target:".grid-col-item:first-of-type",width:380,targetInCanvas:!0}]),[]);return Ce((()=>{var t;const n=document.querySelector('iframe[name="_appWindow"]');(null===(t=null==n?void 0:n.contentDocument)||void 0===t?void 0:t.querySelector(".grid-col-item"))||e.onStepChange({isInjected:!0,status:v.STATUS.FINISHED})}),[]),Ce((()=>{n(e.run)}),[e.run]),Ce((()=>{s(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:i,steps:o,onStepChange:t=>{null==e||e.onStepChange(t)},isInjected:!0}))})),{useState:be,useEffect:Re,useMemo:ye}=c.React,je=c.ReactRedux.connect(null)((e=>{const[t,n]=be(!1),[i,s]=be(""),[a,d]=be(0),o=(0,c.useIntl)(),r=ye((()=>[{title:l("expressModeStep1Title"),content:{text:l("expressModeStep1Content")},placement:"auto",target:".page-renderer .header .express-mode-switch-container .typography",spotlightClicks:!1,spotlightPadding:8,width:440}]),[]);function l(e){return o.formatMessage({id:e})}return Re((()=>{p.helpUtils.getBuildAppsHelpLink("express-mode").then((e=>{e&&s(e)}))})),Re((()=>{n(e.run)}),[e.run]),Re((()=>{d(e.stepIndex)}),[e.stepIndex]),c.React.createElement(v.GuideComponent,Object.assign({},e,{run:t,stepIndex:a,steps:r,footerNav:(()=>{const e=l("expressModeLearnMore");return c.React.createElement(x.Link,{style:{marginRight:"auto",textDecoration:"none",paddingLeft:0,minWidth:"auto"},to:i,target:"_blank",title:e,"aria-label":e},e)})(),onStepChange:t=>{null==e||e.onStepChange(t)}}))}));var Me=function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function d(e){try{r(i.next(e))}catch(e){a(e)}}function o(e){try{r(i.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,o)}r((i=i.apply(e,t||[])).next())}))};let Ae=!1;return window.addEventListener("message",(e=>{"EXB_EXTENSION_PASS_PRIVILEGE_CHECK"===e.data.type&&(Ae=!0)})),window.__EXB_MESSAGE_EVENT_LISTENER_FOR_EXTENSION_READY__=!0,(0,c.init)().then(x.init).then(m.init).then(p.init).then(h.init).then(g.init).then((()=>{c.ExtensionManager.getInstance().registerExtension({epName:c.extensionSpec.ExtensionPoints.ReduxStore,extension:new p.AppStateReduxStoreExtension}),c.ExtensionManager.getInstance().registerExtension({epName:c.extensionSpec.ExtensionPoints.ReduxStore,extension:new p.AppStateHistoryExtension}),c.ExtensionManager.getInstance().registerExtension({epName:c.extensionSpec.ExtensionPoints.ReduxStore,extension:new p.BuilderStateReduxStoreExtension}),c.ExtensionManager.getInstance().registerExtension({epName:c.extensionSpec.ExtensionPoints.ReduxStore,extension:new p.BuilderStateResourceExtension}),c.ExtensionManager.getInstance().registerExtension({epName:c.extensionSpec.ExtensionPoints.DependencyDefine,extension:new c.ArcGISDependencyDefineExtension}),Me(void 0,void 0,void 0,(function*(){c.GuideManager.getInstance().registerGuide({id:"opening-tour",module:w,type:c.GuideTypes.Program,level:c.GuideLevels.Builder}),c.GuideManager.getInstance().registerGuide({id:"general-express-mode",module:C,type:c.GuideTypes.Program,level:c.GuideLevels.Builder}),(yield p.templateUtils.getExpressModeTemplateNames("app")).forEach((e=>{c.GuideManager.getInstance().registerGuide({id:`general-express-mode-${e}`,module:C,type:c.GuideTypes.Program,level:c.GuideLevels.Builder})})),c.GuideManager.getInstance().registerGuide({id:"express-welcome-introduction",module:ge,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-add-data",module:R,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-app-setting",module:A,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-general-setting",module:O,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-map-widget",module:k,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-message-action",module:H,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-placeholder",module:V,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-section",module:Y,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-theme",module:ae,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-title",module:le,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-widget-controller",module:Se,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-window",module:fe,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-sidebar",module:te,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-grid",module:Ee,type:c.GuideTypes.Program,level:c.GuideLevels.Common,isInjected:!0}),c.GuideManager.getInstance().registerGuide({id:"express-mode",module:je,type:c.GuideTypes.Program,level:c.GuideLevels.Builder})})),p.builderAppSync.listenAppEvents(),function(){const e=c.SessionManager.getInstance();if(e.getMainSession())return;e.gotoSignInPage()}(),c.privilegeUtils.checkExbAccess(c.privilegeUtils.CheckTarget.Builder,Ae).then((e=>{e.valid||(0,c.getAppStore)().dispatch(c.appActions.hasPrivilegeChanged(e.invalidMessage))})).catch((e=>{console.error(e),(0,c.getAppStore)().dispatch(c.appActions.hasPrivilegeChanged(e.message))})),S.userServices.initUserResource();c.ReactDOMClient.createRoot(document.getElementById("app")).render(c.React.createElement(c.AppRoot,null))})).catch((e=>{console.error(e)})),{}})())}}}));